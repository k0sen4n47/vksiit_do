var k5={exports:{}};(function(z_){(function(){var qm=function(e){if(e===null)return"null";if(e===void 0)return"undefined";var t=typeof e;return t==="object"&&(Array.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="Array")?"array":t==="object"&&(String.prototype.isPrototypeOf(e)||e.constructor&&e.constructor.name==="String")?"string":t},H_=function(e){return["undefined","boolean","number","string","function","xml","null"].indexOf(e)!==-1},W_=function(e,t){var n=Array.prototype.slice.call(e);return n.sort(t)},V_=function(e,t){return yr(function(n,s){return e.eq(t(n),t(s))})},yr=function(e){return{eq:e}},j_=yr(function(e,t){return e===t}),q_=j_,Km=function(e){return yr(function(t,n){if(t.length!==n.length)return!1;for(var s=t.length,o=0;o<s;o++)if(!e.eq(t[o],n[o]))return!1;return!0})},K_=function(e,t){return V_(Km(e),function(n){return W_(n,t)})},Gm=function(e){return yr(function(t,n){var s=Object.keys(t),o=Object.keys(n);if(!K_(q_).eq(s,o))return!1;for(var r=s.length,a=0;a<r;a++){var i=s[a];if(!e.eq(t[i],n[i]))return!1}return!0})},gc=yr(function(e,t){if(e===t)return!0;var n=qm(e),s=qm(t);return n!==s?!1:H_(n)?e===t:n==="array"?Km(gc).eq(e,t):n==="object"?Gm(gc).eq(e,t):!1});const G_=Object.getPrototypeOf,Ym=(e,t,n)=>{var s;return n(e,t.prototype)?!0:((s=e.constructor)===null||s===void 0?void 0:s.name)===t.name},Y_=e=>{const t=typeof e;return e===null?"null":t==="object"&&Array.isArray(e)?"array":t==="object"&&Ym(e,String,(n,s)=>s.isPrototypeOf(n))?"string":t},pc=e=>t=>Y_(t)===e,hc=e=>t=>typeof t===e,Xm=e=>t=>e===t,ni=(e,t)=>nt(e)&&Ym(e,t,(n,s)=>G_(n)===s),J=pc("string"),nt=pc("object"),si=e=>ni(e,Object),De=pc("array"),bt=Xm(null),Xn=hc("boolean"),st=Xm(void 0),Ve=e=>e==null,U=e=>!Ve(e),we=hc("function"),rn=hc("number"),Ls=(e,t)=>{if(De(e)){for(let n=0,s=e.length;n<s;++n)if(!t(e[n]))return!1;return!0}return!1},ce=()=>{},Nn=(e,t)=>(...n)=>e(t.apply(null,n)),Zm=(e,t)=>n=>e(t(n)),W=e=>()=>e,Ft=e=>e,Qm=(e,t)=>e===t;function G(e,...t){return(...n)=>{const s=t.concat(n);return e.apply(null,s)}}const vr=e=>t=>!e(t),Jm=e=>()=>{throw new Error(e)},bc=e=>e(),Er=e=>{e()},Pe=W(!1),Ue=W(!0);class m{constructor(t,n){this.tag=t,this.value=n}static some(t){return new m(!0,t)}static none(){return m.singletonNone}fold(t,n){return this.tag?n(this.value):t()}isSome(){return this.tag}isNone(){return!this.tag}map(t){return this.tag?m.some(t(this.value)):m.none()}bind(t){return this.tag?t(this.value):m.none()}exists(t){return this.tag&&t(this.value)}forall(t){return!this.tag||t(this.value)}filter(t){return!this.tag||t(this.value)?this:m.none()}getOr(t){return this.tag?this.value:t}or(t){return this.tag?this:t}getOrThunk(t){return this.tag?this.value:t()}orThunk(t){return this.tag?this:t()}getOrDie(t){if(this.tag)return this.value;throw new Error(t??"Called getOrDie on None")}static from(t){return U(t)?m.some(t):m.none()}getOrNull(){return this.tag?this.value:null}getOrUndefined(){return this.value}each(t){this.tag&&t(this.value)}toArray(){return this.tag?[this.value]:[]}toString(){return this.tag?`some(${this.value})`:"none()"}}m.singletonNone=new m(!1);const Cc=Array.prototype.slice,X_=Array.prototype.indexOf,Z_=Array.prototype.push,eg=(e,t)=>X_.call(e,t),Q_=(e,t)=>{const n=eg(e,t);return n===-1?m.none():m.some(n)},Se=(e,t)=>eg(e,t)>-1,Be=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return!0}return!1},he=(e,t)=>{const n=e.length,s=new Array(n);for(let o=0;o<n;o++){const r=e[o];s[o]=t(r,o)}return s},D=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];t(o,n)}},tg=(e,t)=>{for(let n=e.length-1;n>=0;n--){const s=e[n];t(s,n)}},So=(e,t)=>{const n=[],s=[];for(let o=0,r=e.length;o<r;o++){const a=e[o];(t(a,o)?n:s).push(a)}return{pass:n,fail:s}},ne=(e,t)=>{const n=[];for(let s=0,o=e.length;s<o;s++){const r=e[s];t(r,s)&&n.push(r)}return n},Sr=(e,t,n)=>(tg(e,(s,o)=>{n=t(n,s,o)}),n),Tt=(e,t,n)=>(D(e,(s,o)=>{n=t(n,s,o)}),n),ng=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++){const r=e[s];if(t(r,s))return m.some(r);if(n(r,s))break}return m.none()},Ye=(e,t)=>ng(e,t,Pe),wr=(e,t)=>{for(let n=0,s=e.length;n<s;n++){const o=e[n];if(t(o,n))return m.some(n)}return m.none()},sg=e=>{const t=[];for(let n=0,s=e.length;n<s;++n){if(!De(e[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+e);Z_.apply(t,e[n])}return t},Kt=(e,t)=>sg(he(e,t)),Zn=(e,t)=>{for(let n=0,s=e.length;n<s;++n){const o=e[n];if(t(o,n)!==!0)return!1}return!0},kr=e=>{const t=Cc.call(e,0);return t.reverse(),t},oi=(e,t)=>ne(e,n=>!Se(t,n)),yc=(e,t)=>{const n={};for(let s=0,o=e.length;s<o;s++){const r=e[s];n[String(r)]=t(r,s)}return n},$s=(e,t)=>{const n=Cc.call(e,0);return n.sort(t),n},_r=(e,t)=>t>=0&&t<e.length?m.some(e[t]):m.none(),_t=e=>_r(e,0),ds=e=>_r(e,e.length-1),Lt=we(Array.from)?Array.from:e=>Cc.call(e),wo=(e,t)=>{for(let n=0;n<e.length;n++){const s=t(e[n],n);if(s.isSome())return s}return m.none()},og=(e,t)=>{const n=[],s=we(t)?o=>Be(n,r=>t(r,o)):o=>Se(n,o);for(let o=0,r=e.length;o<r;o++){const a=e[o];s(a)||n.push(a)}return n},$t=Object.keys,J_=Object.hasOwnProperty,Ae=(e,t)=>{const n=$t(e);for(let s=0,o=n.length;s<o;s++){const r=n[s],a=e[r];t(a,r)}},ri=(e,t)=>eA(e,(n,s)=>({k:s,v:t(n,s)})),eA=(e,t)=>{const n={};return Ae(e,(s,o)=>{const r=t(s,o);n[r.k]=r.v}),n},vc=e=>(t,n)=>{e[n]=t},rg=(e,t,n,s)=>{Ae(e,(o,r)=>{(t(o,r)?n:s)(o,r)})},tA=(e,t)=>{const n={},s={};return rg(e,t,vc(n),vc(s)),{t:n,f:s}},Ar=(e,t)=>{const n={};return rg(e,t,vc(n),ce),n},ai=(e,t)=>{const n=[];return Ae(e,(s,o)=>{n.push(t(s,o))}),n},Ec=e=>ai(e,Ft),Oe=(e,t)=>se(e,t)?m.from(e[t]):m.none(),se=(e,t)=>J_.call(e,t),ko=(e,t)=>se(e,t)&&e[t]!==void 0&&e[t]!==null,nA=(e,t,n=gc)=>Gm(n).eq(e,t),Rn={generate:e=>{if(!De(e))throw new Error("cases must be an array");if(e.length===0)throw new Error("there must be at least one case");const t=[],n={};return D(e,(s,o)=>{const r=$t(s);if(r.length!==1)throw new Error("one and only one name per case");const a=r[0],i=s[a];if(n[a]!==void 0)throw new Error("duplicate key detected:"+a);if(a==="cata")throw new Error("cannot have a case named cata (sorry)");if(!De(i))throw new Error("case arguments must be an array");t.push(a),n[a]=(...l)=>{const c=l.length;if(c!==i.length)throw new Error("Wrong number of arguments to case "+a+". Expected "+i.length+" ("+i+"), got "+c);return{fold:(...f)=>{if(f.length!==e.length)throw new Error("Wrong number of arguments to fold. Expected "+e.length+", got "+f.length);return f[o].apply(null,l)},match:f=>{const d=$t(f);if(t.length!==d.length)throw new Error("Wrong number of arguments to match. Expected: "+t.join(",")+`
Actual: `+d.join(","));if(!Zn(t,h=>Se(d,h)))throw new Error("Not all branches were specified when using match. Specified: "+d.join(", ")+`
Required: `+t.join(", "));return f[a].apply(null,l)},log:f=>{console.log(f,{constructors:t,constructor:a,params:l})}}}}),n}},et=e=>{let t=e;return{get:()=>t,set:o=>{t=o}}},ag=e=>{const t=r=>r(e),n=W(e),s=()=>o,o={tag:!0,inner:e,fold:(r,a)=>a(e),isValue:Ue,isError:Pe,map:r=>Mt.value(r(e)),mapError:s,bind:t,exists:t,forall:t,getOr:n,or:s,getOrThunk:n,orThunk:s,getOrDie:n,each:r=>{r(e)},toOptional:()=>m.some(e)};return o},ig=e=>{const t=()=>n,n={tag:!1,inner:e,fold:(s,o)=>s(e),isValue:Pe,isError:Ue,map:t,mapError:s=>Mt.error(s(e)),bind:t,exists:Pe,forall:Ue,getOr:Ft,or:Ft,getOrThunk:bc,orThunk:bc,getOrDie:Jm(String(e)),each:ce,toOptional:m.none};return n},Mt={value:ag,error:ig,fromOption:(e,t)=>e.fold(()=>ig(t),ag)},sA=typeof window<"u"?window:Function("return this;")(),oA=(e,t,n)=>Math.min(Math.max(e,t),n),lg=()=>window.crypto.getRandomValues(new Uint32Array(1))[0]/4294967295;let cg=0;const xr=e=>{const n=new Date().getTime(),s=Math.floor(lg()*1e9);return cg++,e+"_"+s+cg+String(n)},rA=(e,t)=>t,aA=(e,t)=>si(e)&&si(t)?ii(e,t):t,ug=e=>(...t)=>{if(t.length===0)throw new Error("Can't merge zero objects");const n={};for(let s=0;s<t.length;s++){const o=t[s];for(const r in o)se(o,r)&&(n[r]=e(n[r],o[r]))}return n},ii=ug(aA),fg=ug(rA),_o=(e,t,n=Qm)=>e.exists(s=>n(s,t)),dg=(e,t,n=Qm)=>at(e,t,n).getOr(e.isNone()&&t.isNone()),iA=e=>{const t=[],n=s=>{t.push(s)};for(let s=0;s<e.length;s++)e[s].each(n);return t},at=(e,t,n)=>e.isSome()&&t.isSome()?m.some(n(e.getOrDie(),t.getOrDie())):m.none(),lA=(e,t,n,s)=>e.isSome()&&t.isSome()&&n.isSome()?m.some(s(e.getOrDie(),t.getOrDie(),n.getOrDie())):m.none(),Ao=(e,t)=>e?m.some(t):m.none(),cA=(e,t)=>{let n=t??sA;for(let s=0;s<e.length&&n!==void 0&&n!==null;++s)n=n[e[s]];return n},mg=(e,t)=>{const n=e.split(".");return cA(n,t)};Rn.generate([{bothErrors:["error1","error2"]},{firstError:["error1","value2"]},{secondError:["value1","error2"]},{bothValues:["value1","value2"]}]);const uA=e=>{const t=[],n=[];return D(e,s=>{s.fold(o=>{t.push(o)},o=>{n.push(o)})}),{errors:t,values:n}},fA=e=>{const t=et(m.none()),n=()=>t.get().each(e);return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(i))}}},dA=e=>{const t=et(m.none()),n=()=>t.get().each(i=>clearInterval(i));return{clear:()=>{n(),t.set(m.none())},isSet:()=>t.get().isSome(),get:()=>t.get(),set:i=>{n(),t.set(m.some(setInterval(i,e)))}}},Qn=()=>{const e=fA(ce);return{...e,on:n=>e.get().each(n)}},mA=(e,t)=>e.substring(t),gg=(e,t,n)=>t===""||e.length>=t.length&&e.substr(n,n+t.length)===t,pg=(e,t)=>Xe(e,t)?mA(e,t.length):e,lt=(e,t,n=0,s)=>{const o=e.indexOf(t,n);return o!==-1?st(s)?!0:o+t.length<=s:!1},Xe=(e,t)=>gg(e,t,0),Sc=(e,t)=>gg(e,t,e.length-t.length),wc=e=>t=>t.replace(e,""),xo=wc(/^\s+|\s+$/g),gA=wc(/^\s+/g),hg=wc(/\s+$/g),Tn=e=>e.length>0,Nr=e=>!Tn(e),pA=(e,t)=>t<=0?"":new Array(t+1).join(e),li=(e,t=10)=>{const n=parseInt(e,t);return isNaN(n)?m.none():m.some(n)},ci=(e,t)=>{let n=null;return{cancel:()=>{bt(n)||(clearTimeout(n),n=null)},throttle:(...r)=>{bt(n)&&(n=setTimeout(()=>{n=null,e.apply(null,r)},t))}}},kc=(e,t)=>{let n=null;const s=()=>{bt(n)||(clearTimeout(n),n=null)};return{cancel:s,throttle:(...r)=>{s(),n=setTimeout(()=>{n=null,e.apply(null,r)},t)}}},Dn=e=>{let t=!1,n;return(...s)=>(t||(t=!0,n=e.apply(null,s)),n)},Rr="\uFEFF",Ze=" ",_c=e=>e===Rr,hA=e=>e.replace(/\uFEFF/g,""),bg=e=>{const t={};return D(e,n=>{t[n]={}}),$t(t)},Cg=e=>e.length!==void 0,Ac=Array.isArray,bA=e=>{if(Ac(e))return e;{const t=[];for(let n=0,s=e.length;n<s;n++)t[n]=e[n];return t}},ui=(e,t,n)=>{if(!e)return!1;if(n=n||e,Cg(e)){for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e)===!1)return!1}else for(const s in e)if(se(e,s)&&t.call(n,e[s],s,e)===!1)return!1;return!0},xc=(e,t)=>{const n=[];return ui(e,(s,o)=>{n.push(t(s,o,e))}),n},Tr=(e,t)=>{const n=[];return ui(e,(s,o)=>{(!t||t(s,o,e))&&n.push(s)}),n},CA=(e,t)=>{if(e){for(let n=0,s=e.length;n<s;n++)if(e[n]===t)return n}return-1},fi=(e,t,n,s)=>{let o=st(n)?e[0]:n;for(let r=0;r<e.length;r++)o=t.call(s,o,e[r],r);return o},yg=(e,t,n)=>{for(let s=0,o=e.length;s<o;s++)if(t.call(n,e[s],s,e))return s;return-1},Ms=e=>e[e.length-1],yA=(e,t,n,s)=>{const o=e.isiOS()&&/ipad/i.test(n)===!0,r=e.isiOS()&&!o,a=e.isiOS()||e.isAndroid(),i=a||s("(pointer:coarse)"),l=o||!r&&a&&s("(min-device-width:768px)"),c=r||a&&!l,u=t.isSafari()&&e.isiOS()&&/safari/i.test(n)===!1,f=!c&&!l&&!u;return{isiPad:W(o),isiPhone:W(r),isTablet:W(l),isPhone:W(c),isTouch:W(i),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:W(u),isDesktop:W(f)}},vA=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n];if(s.test(t))return s}},EA=(e,t)=>{const n=vA(e,t);if(!n)return{major:0,minor:0};const s=o=>Number(t.replace(n,"$"+o));return Nc(s(1),s(2))},SA=(e,t)=>{const n=String(t).toLowerCase();return e.length===0?vg():EA(e,n)},vg=()=>Nc(0,0),Nc=(e,t)=>({major:e,minor:t}),Dr={nu:Nc,detect:SA,unknown:vg},wA=(e,t)=>wo(t.brands,n=>{const s=n.brand.toLowerCase();return Ye(e,o=>{var r;return s===((r=o.brand)===null||r===void 0?void 0:r.toLowerCase())}).map(o=>({current:o.name,version:Dr.nu(parseInt(n.version,10),0)}))}),Eg=(e,t)=>{const n=String(t).toLowerCase();return Ye(e,s=>s.search(n))},kA=(e,t)=>Eg(e,t).map(n=>{const s=Dr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),_A=(e,t)=>Eg(e,t).map(n=>{const s=Dr.detect(n.versionRegexes,t);return{current:n.name,version:s}}),Rc=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,Jn=e=>t=>lt(t,e),AA=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:e=>lt(e,"edge/")&&lt(e,"chrome")&&lt(e,"safari")&&lt(e,"applewebkit")},{name:"Chromium",brand:"Chromium",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Rc],search:e=>lt(e,"chrome")&&!lt(e,"chromeframe")},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:e=>lt(e,"msie")||lt(e,"trident")},{name:"Opera",versionRegexes:[Rc,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:Jn("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:Jn("firefox")},{name:"Safari",versionRegexes:[Rc,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:e=>(lt(e,"safari")||lt(e,"mobile/"))&&lt(e,"applewebkit")}],xA=[{name:"Windows",search:Jn("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:e=>lt(e,"iphone")||lt(e,"ipad"),versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:Jn("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"macOS",search:Jn("mac os x"),versionRegexes:[/.*?mac\ os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:Jn("linux"),versionRegexes:[]},{name:"Solaris",search:Jn("sunos"),versionRegexes:[]},{name:"FreeBSD",search:Jn("freebsd"),versionRegexes:[]},{name:"ChromeOS",search:Jn("cros"),versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/]}],Sg={browsers:W(AA),oses:W(xA)},wg="Edge",kg="Chromium",_g="IE",Ag="Opera",xg="Firefox",Ng="Safari",NA=()=>Rg({current:void 0,version:Dr.unknown()}),Rg=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isEdge:s(wg),isChromium:s(kg),isIE:s(_g),isOpera:s(Ag),isFirefox:s(xg),isSafari:s(Ng)}},Tg={unknown:NA,nu:Rg,edge:W(wg),chromium:W(kg),ie:W(_g),opera:W(Ag),firefox:W(xg),safari:W(Ng)},Dg="Windows",Pg="iOS",Bg="Android",Og="Linux",Ig="macOS",Fg="Solaris",Lg="FreeBSD",$g="ChromeOS",RA=()=>Mg({current:void 0,version:Dr.unknown()}),Mg=e=>{const t=e.current,n=e.version,s=o=>()=>t===o;return{current:t,version:n,isWindows:s(Dg),isiOS:s(Pg),isAndroid:s(Bg),isMacOS:s(Ig),isLinux:s(Og),isSolaris:s(Fg),isFreeBSD:s(Lg),isChromeOS:s($g)}},Ug={unknown:RA,nu:Mg,windows:W(Dg),ios:W(Pg),android:W(Bg),linux:W(Og),macos:W(Ig),solaris:W(Fg),freebsd:W(Lg),chromeos:W($g)},TA={detect:(e,t,n)=>{const s=Sg.browsers(),o=Sg.oses(),r=t.bind(l=>wA(s,l)).orThunk(()=>kA(s,e)).fold(Tg.unknown,Tg.nu),a=_A(o,e).fold(Ug.unknown,Ug.nu),i=yA(a,r,e,n);return{browser:r,os:a,deviceType:i}}},DA=e=>window.matchMedia(e).matches;let PA=Dn(()=>TA.detect(window.navigator.userAgent,m.from(window.navigator.userAgentData),DA));const pn=()=>PA(),BA=(e,t)=>mg(e,t),OA=(e,t)=>{const n=BA(e,t);if(n==null)throw new Error(e+" not available on this browser");return n},IA=Object.getPrototypeOf,FA=e=>OA("HTMLElement",e),LA=e=>{const t=mg("ownerDocument.defaultView",e);return nt(e)&&(FA(t).prototype.isPrototypeOf(e)||/^HTML\w*Element$/.test(IA(e).constructor.name))},$A=window.navigator.userAgent,Tc=pn(),Pn=Tc.browser,Bn=Tc.os,Us=Tc.deviceType,MA=$A.indexOf("Windows Phone")!==-1,Ce={transparentSrc:"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7",documentMode:Pn.isIE()?document.documentMode||7:10,cacheSuffix:null,container:null,canHaveCSP:!Pn.isIE(),windowsPhone:MA,browser:{current:Pn.current,version:Pn.version,isChromium:Pn.isChromium,isEdge:Pn.isEdge,isFirefox:Pn.isFirefox,isIE:Pn.isIE,isOpera:Pn.isOpera,isSafari:Pn.isSafari},os:{current:Bn.current,version:Bn.version,isAndroid:Bn.isAndroid,isChromeOS:Bn.isChromeOS,isFreeBSD:Bn.isFreeBSD,isiOS:Bn.isiOS,isLinux:Bn.isLinux,isMacOS:Bn.isMacOS,isSolaris:Bn.isSolaris,isWindows:Bn.isWindows},deviceType:{isDesktop:Us.isDesktop,isiPad:Us.isiPad,isiPhone:Us.isiPhone,isPhone:Us.isPhone,isTablet:Us.isTablet,isTouch:Us.isTouch,isWebView:Us.isWebView}},UA=/^\s*|\s*$/g,zg=e=>Ve(e)?"":(""+e).replace(UA,""),zA=(e,t)=>t?t==="array"&&Ac(e)?!0:typeof e===t:e!==void 0,HA=(e,t,n={})=>{const s=J(e)?e.split(t||","):e||[];let o=s.length;for(;o--;)n[s[o]]={};return n},WA=se,VA=(e,...t)=>{for(let n=0;n<t.length;n++){const s=t[n];for(const o in s)if(se(s,o)){const r=s[o];r!==void 0&&(e[o]=r)}}return e},Hg=function(e,t,n,s){s=s||this,e&&(n&&(e=e[n]),ui(e,(o,r)=>t.call(s,o,r,n)===!1?!1:(Hg(o,t,n,s),!0)))},L={trim:zg,isArray:Ac,is:zA,toArray:bA,makeMap:HA,each:ui,map:xc,grep:Tr,inArray:CA,hasOwn:WA,extend:VA,walk:Hg,resolve:(e,t=window)=>{const n=e.split(".");for(let s=0,o=n.length;s<o&&(t=t[n[s]],!!t);s++);return t},explode:(e,t)=>De(e)?e:e===""?[]:xc(e.split(t||","),zg),_addCacheSuffix:e=>{const t=Ce.cacheSuffix;return t&&(e+=(e.indexOf("?")===-1?"?":"&")+t),e}},jA=(e,t)=>{const s=(t||document).createElement("div");if(s.innerHTML=e,!s.hasChildNodes()||s.childNodes.length>1){const o="HTML does not have a single root node";throw console.error(o,e),new Error(o)}return Pr(s.childNodes[0])},qA=(e,t)=>{const s=(t||document).createElement(e);return Pr(s)},KA=(e,t)=>{const s=(t||document).createTextNode(e);return Pr(s)},Pr=e=>{if(e==null)throw new Error("Node cannot be null or undefined");return{dom:e}},C={fromHtml:jA,fromTag:qA,fromText:KA,fromDom:Pr,fromPoint:(e,t,n)=>m.from(e.dom.elementFromPoint(t,n)).map(Pr)},GA=(e,t)=>{t.fold(n=>{e.setStartBefore(n.dom)},(n,s)=>{e.setStart(n.dom,s)},n=>{e.setStartAfter(n.dom)})},YA=(e,t)=>{t.fold(n=>{e.setEndBefore(n.dom)},(n,s)=>{e.setEnd(n.dom,s)},n=>{e.setEndAfter(n.dom)})},Wg=(e,t,n)=>{const s=e.document.createRange();return GA(s,t),YA(s,n),s},Dc=(e,t,n,s,o)=>{const r=e.document.createRange();return r.setStart(t.dom,n),r.setEnd(s.dom,o),r},Br=Rn.generate([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),Vg=(e,t,n)=>t(C.fromDom(n.startContainer),n.startOffset,C.fromDom(n.endContainer),n.endOffset),XA=(e,t)=>t.match({domRange:n=>({ltr:W(n),rtl:m.none}),relative:(n,s)=>({ltr:Dn(()=>Wg(e,n,s)),rtl:Dn(()=>m.some(Wg(e,s,n)))}),exact:(n,s,o,r)=>({ltr:Dn(()=>Dc(e,n,s,o,r)),rtl:Dn(()=>m.some(Dc(e,o,r,n,s)))})}),ZA=(e,t)=>{const n=t.ltr();return n.collapsed?t.rtl().filter(o=>o.collapsed===!1).map(o=>Br.rtl(C.fromDom(o.endContainer),o.endOffset,C.fromDom(o.startContainer),o.startOffset)).getOrThunk(()=>Vg(e,Br.ltr,n)):Vg(e,Br.ltr,n)},QA=(e,t)=>{const n=XA(e,t);return ZA(e,n)};Br.ltr,Br.rtl;const di=8,jg=9,qg=11,Or=1,Kg=3,hn=(e,t)=>{const n=e.dom;if(n.nodeType!==Or)return!1;{const s=n;if(s.matches!==void 0)return s.matches(t);if(s.msMatchesSelector!==void 0)return s.msMatchesSelector(t);if(s.webkitMatchesSelector!==void 0)return s.webkitMatchesSelector(t);if(s.mozMatchesSelector!==void 0)return s.mozMatchesSelector(t);throw new Error("Browser lacks native selectors")}},Gg=e=>e.nodeType!==Or&&e.nodeType!==jg&&e.nodeType!==qg||e.childElementCount===0,JA=(e,t)=>{const n=t===void 0?document:t.dom;return Gg(n)?[]:he(n.querySelectorAll(e),C.fromDom)},ex=(e,t)=>{const n=t===void 0?document:t.dom;return Gg(n)?m.none():m.from(n.querySelector(e)).map(C.fromDom)},Ee=(e,t)=>e.dom===t.dom,bn=(e,t)=>{const n=e.dom,s=t.dom;return n===s?!1:n.contains(s)},Yg=(e,t)=>{const n=[],s=r=>(n.push(r),t(r));let o=t(e);do o=o.bind(s);while(o.isSome());return n},be=e=>e.dom.nodeName.toLowerCase(),Xg=e=>e.dom.nodeType,mi=e=>t=>Xg(t)===e,tx=e=>Xg(e)===di||be(e)==="#comment",Ir=e=>Ut(e)&&LA(e.dom),Ut=mi(Or),At=mi(Kg),nx=mi(jg),sx=mi(qg),Fr=e=>t=>Ut(t)&&be(t)===e,Zg=e=>C.fromDom(e.dom.ownerDocument),ms=e=>nx(e)?e:Zg(e),ox=e=>C.fromDom(ms(e).dom.documentElement),Lr=e=>C.fromDom(ms(e).dom.defaultView),On=e=>m.from(e.dom.parentNode).map(C.fromDom),$r=e=>m.from(e.dom.parentElement).map(C.fromDom),Qg=(e,t)=>{const n=we(t)?t:Pe;let s=e.dom;const o=[];for(;s.parentNode!==null&&s.parentNode!==void 0;){const r=s.parentNode,a=C.fromDom(r);if(o.push(a),n(a)===!0)break;s=r}return o},rx=e=>{const t=n=>ne(n,s=>!Ee(e,s));return On(e).map(ct).map(t).getOr([])},gs=e=>m.from(e.dom.previousSibling).map(C.fromDom),Mr=e=>m.from(e.dom.nextSibling).map(C.fromDom),Jg=e=>kr(Yg(e,gs)),ep=e=>Yg(e,Mr),ct=e=>he(e.dom.childNodes,C.fromDom),No=(e,t)=>{const n=e.dom.childNodes;return m.from(n[t]).map(C.fromDom)},Pc=e=>No(e,0),Bc=e=>No(e,e.dom.childNodes.length-1),Oc=e=>e.dom.childNodes.length,ax=e=>{const t=e.dom.head;if(t==null)throw new Error("Head is not available yet");return C.fromDom(t)},Ic=e=>sx(e)&&U(e.dom.host),ps=e=>C.fromDom(e.dom.getRootNode()),Fc=e=>Ic(e)?e:ax(ms(e)),ix=e=>Ic(e)?e:C.fromDom(ms(e).dom.body),lx=e=>{const t=ps(e);return Ic(t)?m.some(t):m.none()},cx=e=>C.fromDom(e.dom.host),tp=e=>{if(U(e.target)){const t=C.fromDom(e.target);if(Ut(t)&&ux(t)&&e.composed&&e.composedPath){const n=e.composedPath();if(n)return _t(n)}}return m.from(e.target)},ux=e=>U(e.dom.shadowRoot),fx=(e,t,n,s,o,r,a)=>({target:e,x:t,y:n,stop:s,prevent:o,kill:r,raw:a}),dx=e=>{const t=C.fromDom(tp(e).getOr(e.target)),n=()=>e.stopPropagation(),s=()=>e.preventDefault(),o=Nn(s,n);return fx(t,e.clientX,e.clientY,n,s,o,e)},mx=(e,t)=>n=>{e(n)&&t(dx(n))},gx=(e,t,n,s,o)=>{const r=mx(n,s);return e.dom.addEventListener(t,r,o),{unbind:G(hx,e,t,r,o)}},px=(e,t,n,s)=>gx(e,t,n,s,!1),hx=(e,t,n,s)=>{e.dom.removeEventListener(t,n,s)},bx=Ue,Cx=(e,t,n)=>px(e,t,bx,n),np=()=>C.fromDom(document),sp=(e,t=!1)=>e.dom.focus({preventScroll:t}),op=e=>{const t=ps(e).dom;return e.dom===t.activeElement},Lc=(e=np())=>m.from(e.dom.activeElement).map(C.fromDom),yx=e=>Lc(ps(e)).filter(t=>e.dom.contains(t.dom)),Dt=(e,t)=>{On(e).each(s=>{s.dom.insertBefore(t.dom,e.dom)})},es=(e,t)=>{Mr(e).fold(()=>{On(e).each(o=>{je(o,t)})},s=>{Dt(s,t)})},$c=(e,t)=>{Pc(e).fold(()=>{je(e,t)},s=>{e.dom.insertBefore(t.dom,s.dom)})},je=(e,t)=>{e.dom.appendChild(t.dom)},rp=(e,t)=>{Dt(e,t),je(t,e)},vx=(e,t)=>{D(t,(n,s)=>{const o=s===0?e:t[s-1];es(o,n)})},zs=(e,t)=>{D(t,n=>{je(e,n)})},ap=(e,t,n)=>{if(J(n)||Xn(n)||rn(n))e.setAttribute(t,n+"");else throw console.error("Invalid call to Attribute.set. Key ",t,":: Value ",n,":: Element ",e),new Error("Attribute value was not simple")},ot=(e,t,n)=>{ap(e.dom,t,n)},ts=(e,t)=>{const n=e.dom;Ae(t,(s,o)=>{ap(n,o,s)})},zt=(e,t)=>{const n=e.dom.getAttribute(t);return n===null?void 0:n},ns=(e,t)=>m.from(zt(e,t)),Ur=(e,t)=>{const n=e.dom;return n&&n.hasAttribute?n.hasAttribute(t):!1},rt=(e,t)=>{e.dom.removeAttribute(t)},Ex=e=>{const t=e.dom.attributes;return t==null||t.length===0},ip=e=>Tt(e.dom.attributes,(t,n)=>(t[n.name]=n.value,t),{}),Ro=e=>{e.dom.textContent="",D(ct(e),t=>{Ne(t)})},Ne=e=>{const t=e.dom;t.parentNode!==null&&t.parentNode.removeChild(t)},hs=e=>{const t=ct(e);t.length>0&&vx(e,t),Ne(e)},lp=(e,t)=>C.fromDom(e.dom.cloneNode(t)),Hs=e=>lp(e,!1),cp=e=>lp(e,!0),Sx=(e,t)=>{const n=C.fromTag(t),s=ip(e);return ts(n,s),n},wx=(e,t)=>{const n=Sx(e,t);es(e,n);const s=ct(e);return zs(n,s),Ne(e),n},kx=(e,t)=>{const s=(t||document).createElement("div");return s.innerHTML=e,ct(C.fromDom(s))},Mc=e=>he(e,C.fromDom),up=e=>e.dom.innerHTML,gi=(e,t)=>{const s=Zg(e).dom,o=C.fromDom(s.createDocumentFragment()),r=kx(t,s);zs(o,r),Ro(e),je(e,o)},_x=e=>{const t=C.fromTag("div"),n=C.fromDom(e.dom.cloneNode(!0));return je(t,n),up(t)},zr=e=>e.style!==void 0&&we(e.style.getPropertyValue),To=e=>{const t=At(e)?e.dom.parentNode:e.dom;if(t==null||t.ownerDocument===null)return!1;const n=t.ownerDocument;return lx(C.fromDom(t)).fold(()=>n.body.contains(t),Zm(To,cx))},fp=(e,t,n)=>{if(!J(n))throw console.error("Invalid call to CSS.set. Property ",t,":: Value ",n,":: Element ",e),new Error("CSS value must be a string: "+n);zr(e)&&e.style.setProperty(t,n)},Ax=(e,t)=>{zr(e)&&e.style.removeProperty(t)},dp=(e,t,n)=>{const s=e.dom;fp(s,t,n)},pi=(e,t)=>{const n=e.dom;Ae(t,(s,o)=>{fp(n,o,s)})},In=(e,t)=>{const n=e.dom,o=window.getComputedStyle(n).getPropertyValue(t);return o===""&&!To(e)?mp(n,t):o},mp=(e,t)=>zr(e)?e.style.getPropertyValue(t):"",hi=(e,t)=>{const n=e.dom,s=mp(n,t);return m.from(s).filter(o=>o.length>0)},Uc=e=>{const t={},n=e.dom;if(zr(n))for(let s=0;s<n.style.length;s++){const o=n.style.item(s);t[o]=n.style[o]}return t},gp=(e,t)=>{const n=e.dom;Ax(n,t),_o(ns(e,"style").map(xo),"")&&rt(e,"style")},xx=e=>e.dom.offsetWidth,Nx=((e,t)=>{const n=(i,l)=>{if(!rn(l)&&!l.match(/^[0-9]+$/))throw new Error(e+".set accepts only positive integer values. Value was "+l);const c=i.dom;zr(c)&&(c.style[e]=l+"px")},s=i=>{const l=t(i);if(l<=0||l===null){const c=In(i,e);return parseFloat(c)||0}return l},o=s,r=(i,l)=>Tt(l,(c,u)=>{const f=In(i,u),d=f===void 0?0:parseInt(f,10);return isNaN(d)?c:c+d},0);return{set:n,get:s,getOuter:o,aggregate:r,max:(i,l,c)=>{const u=r(i,c);return l>u?l-u:0}}})("height",e=>{const t=e.dom;return To(e)?t.getBoundingClientRect().height:t.offsetHeight}),Rx=e=>Nx.get(e),pp=(e,t)=>({left:e,top:t,translate:(s,o)=>pp(e+s,t+o)}),Do=pp,Tx=e=>{const t=e.getBoundingClientRect();return Do(t.left,t.top)},bi=(e,t)=>e!==void 0?e:t!==void 0?t:0,Dx=e=>{const t=e.dom.ownerDocument,n=t.body,s=t.defaultView,o=t.documentElement;if(n===e.dom)return Do(n.offsetLeft,n.offsetTop);const r=bi(s==null?void 0:s.pageYOffset,o.scrollTop),a=bi(s==null?void 0:s.pageXOffset,o.scrollLeft),i=bi(o.clientTop,n.clientTop),l=bi(o.clientLeft,n.clientLeft);return zc(e).translate(a-l,r-i)},zc=e=>{const t=e.dom,s=t.ownerDocument.body;return s===t?Do(s.offsetLeft,s.offsetTop):To(e)?Tx(t):Do(0,0)},Hc=e=>{const t=e!==void 0?e.dom:document,n=t.body.scrollLeft||t.documentElement.scrollLeft,s=t.body.scrollTop||t.documentElement.scrollTop;return Do(n,s)},hp=(e,t,n)=>{const o=(n!==void 0?n.dom:document).defaultView;o&&o.scrollTo(e,t)},bp=(e,t)=>{pn().browser.isSafari()&&we(e.dom.scrollIntoViewIfNeeded)?e.dom.scrollIntoViewIfNeeded(!1):e.dom.scrollIntoView(t)},Px=(e,t)=>{const n=r=>{if(!e(r))throw new Error("Can only get "+t+" value of a "+t+" node");return s(r).getOr("")},s=r=>e(r)?m.from(r.dom.nodeValue):m.none();return{get:n,getOption:s,set:(r,a)=>{if(!e(r))throw new Error("Can only set raw "+t+" value of a "+t+" node");r.dom.nodeValue=a}}},Wc=(e,t)=>{const s=(t||document).createDocumentFragment();return D(e,o=>{s.appendChild(o.dom)}),C.fromDom(s)},Vc=Px(At,"text"),Hr=e=>Vc.get(e),Bx=e=>Vc.getOption(e),Cp=(e,t)=>Vc.set(e,t),jc=(e,t)=>{const n=zt(e,t);return n===void 0||n===""?[]:n.split(" ")},Ox=(e,t,n)=>{const o=jc(e,t).concat([n]);return ot(e,t,o.join(" ")),!0},Ix=(e,t,n)=>{const s=ne(jc(e,t),o=>o!==n);return s.length>0?ot(e,t,s.join(" ")):rt(e,t),!1};var yp=(e,t,n,s,o)=>e(n,s)?m.some(n):we(o)&&o(n)?m.none():t(n,s,o);const ss=(e,t,n)=>{let s=e.dom;const o=we(n)?n:Pe;for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s);if(t(r))return m.some(r);if(o(r))break}return m.none()},bs=(e,t,n)=>yp((o,r)=>r(o),ss,e,t,n),Fx=(e,t)=>{const n=e.dom;return n.parentNode?Lx(C.fromDom(n.parentNode),s=>!Ee(e,s)&&t(s)):m.none()},Lx=(e,t)=>{const n=o=>t(C.fromDom(o));return Ye(e.dom.childNodes,n).map(C.fromDom)},qc=(e,t)=>{const n=s=>{for(let o=0;o<s.childNodes.length;o++){const r=C.fromDom(s.childNodes[o]);if(t(r))return m.some(r);const a=n(s.childNodes[o]);if(a.isSome())return a}return m.none()};return n(e.dom)},Wr=(e,t,n)=>ss(e,s=>hn(s,t),n),Ci=(e,t)=>ex(t,e),Po=(e,t,n)=>yp((o,r)=>hn(o,r),Wr,e,t,n),Vr=e=>e.dom.classList!==void 0,vp=e=>jc(e,"class"),Ep=(e,t)=>Ox(e,"class",t),Sp=(e,t)=>Ix(e,"class",t),$x=(e,t)=>Se(vp(e),t)?Sp(e,t):Ep(e,t),Bo=(e,t)=>{Vr(e)?e.dom.classList.add(t):Ep(e,t)},wp=e=>{(Vr(e)?e.dom.classList:vp(e)).length===0&&rt(e,"class")},jr=(e,t)=>{Vr(e)?e.dom.classList.remove(t):Sp(e,t),wp(e)},Mx=(e,t)=>{const n=Vr(e)?e.dom.classList.toggle(t):$x(e,t);return wp(e),n},Kc=(e,t)=>Vr(e)&&e.dom.classList.contains(t),Ux=(e,t)=>{D(t,n=>{Bo(e,n)})},zx=(e,t)=>{D(t,n=>{jr(e,n)})},Hx=e=>Po(e,"[contenteditable]"),Cs=(e,t=!1)=>To(e)?e.dom.isContentEditable:Hx(e).fold(W(t),n=>Wx(n)==="true"),Wx=e=>e.dom.contentEditable,yi=(e,t)=>{e.dom.contentEditable=t?"true":"false"},Vx=(e,t)=>ne(ct(e),t),kp=(e,t)=>{let n=[];return D(ct(e),s=>{t(s)&&(n=n.concat([s])),n=n.concat(kp(s,t))}),n},ut=(e,t)=>JA(t,e),_p=(e,t,n)=>ss(e,t,n).isSome(),jx=(e,t)=>Fx(e,t).isSome(),Gc=(e,t)=>qc(e,t).isSome(),qx=(e,t,n)=>Wr(e,t,n).isSome(),Ap=e=>we(e)?e:Pe,Kx=(e,t,n)=>{let s=e.dom;const o=Ap(n);for(;s.parentNode;){s=s.parentNode;const r=C.fromDom(s),a=t(r);if(a.isSome())return a;if(o(r))break}return m.none()},Yc=(e,t,n)=>{const s=t(e),o=Ap(n);return s.orThunk(()=>o(e)?m.none():Kx(e,t,o))},Gx=e=>Bx(e).filter(t=>t.trim().length!==0||t.indexOf(Ze)>-1).isSome(),Yx=e=>Ir(e)&&zt(e,"contenteditable")==="false",Xx=["img","br"],Zx=e=>Gx(e)||Se(Xx,be(e))||Yx(e),Qx=e=>qc(e,Zx),xp={create:(e,t,n,s)=>({start:e,soffset:t,finish:n,foffset:s})},Xc=Rn.generate([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Jx=(e,t,n,s)=>e.fold(t,n,s),eN=e=>e.fold(Ft,Ft,Ft),tN=Xc.before,nN=Xc.on,sN=Xc.after,os={before:tN,on:nN,after:sN,cata:Jx,getStart:eN},vi=Rn.generate([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),oN=e=>vi.exact(e.start,e.soffset,e.finish,e.foffset),rN=e=>e.match({domRange:t=>C.fromDom(t.startContainer),relative:(t,n)=>os.getStart(t),exact:(t,n,s,o)=>t}),aN=vi.domRange,iN=vi.relative,lN=vi.exact,cN=e=>{const t=rN(e);return Lr(t)},uN=xp.create,Oo={domRange:aN,relative:iN,exact:lN,exactFromRange:oN,getWin:cN,range:uN},fN=(e,t,n)=>{var s;return m.from((s=e.caretPositionFromPoint)===null||s===void 0?void 0:s.call(e,t,n)).bind(o=>{if(o.offsetNode===null)return m.none();const r=e.createRange();return r.setStart(o.offsetNode,o.offset),r.collapse(),m.some(r)})},dN=(e,t,n)=>{var s;return m.from((s=e.caretRangeFromPoint)===null||s===void 0?void 0:s.call(e,t,n))},mN=(e,t,n)=>e.caretPositionFromPoint?fN(e,t,n):e.caretRangeFromPoint?dN(e,t,n):m.none(),gN=(e,t,n)=>{const s=e.document;return mN(s,t,n).map(o=>xp.create(C.fromDom(o.startContainer),o.startOffset,C.fromDom(o.endContainer),o.endOffset))},Ei=(e,t)=>{const n=be(e);return n==="input"?os.after(e):Se(["br","img"],n)?t===0?os.before(e):os.after(e):os.on(e,t)},pN=(e,t)=>{const n=e.fold(os.before,Ei,os.after),s=t.fold(os.before,Ei,os.after);return Oo.relative(n,s)},Np=(e,t,n,s)=>{const o=Ei(e,t),r=Ei(n,s);return Oo.relative(o,r)},hN=e=>e.match({domRange:t=>{const n=C.fromDom(t.startContainer),s=C.fromDom(t.endContainer);return Np(n,t.startOffset,s,t.endOffset)},relative:pN,exact:Np}),bN=e=>{const t=Oo.getWin(e).dom,n=(o,r,a,i)=>Dc(t,o,r,a,i),s=hN(e);return QA(t,s).match({ltr:n,rtl:n})},CN=(e,t,n)=>gN(e,t,n),yN=e=>{const t=e===void 0?window:e;return pn().browser.isFirefox()?m.none():m.from(t.visualViewport)},Rp=(e,t,n,s)=>({x:e,y:t,width:n,height:s,right:e+n,bottom:t+s}),Zc=e=>{const t=e===void 0?window:e,n=t.document,s=Hc(C.fromDom(n));return yN(t).fold(()=>{const o=t.document.documentElement,r=o.clientWidth,a=o.clientHeight;return Rp(s.left,s.top,r,a)},o=>Rp(Math.max(o.pageLeft,s.left),Math.max(o.pageTop,s.top),o.width,o.height))};class tt{constructor(t,n){this.node=t,this.rootNode=n,this.current=this.current.bind(this),this.next=this.next.bind(this),this.prev=this.prev.bind(this),this.prev2=this.prev2.bind(this)}current(){return this.node}next(t){return this.node=this.findSibling(this.node,"firstChild","nextSibling",t),this.node}prev(t){return this.node=this.findSibling(this.node,"lastChild","previousSibling",t),this.node}prev2(t){return this.node=this.findPreviousNode(this.node,t),this.node}findSibling(t,n,s,o){if(t){if(!o&&t[n])return t[n];if(t!==this.rootNode){let r=t[s];if(r)return r;for(let a=t.parentNode;a&&a!==this.rootNode;a=a.parentNode)if(r=a[s],r)return r}}}findPreviousNode(t,n){if(t){const s=t.previousSibling;if(this.rootNode&&s===this.rootNode)return;if(s){if(!n){for(let r=s.lastChild;r;r=r.lastChild)if(!r.lastChild)return r}return s}const o=t.parentNode;if(o&&o!==this.rootNode)return o}}}const vN=/^[ \t\r\n]*$/,Io=e=>vN.test(e),EN=e=>{for(const t of e)if(!_c(t))return!1;return!0},SN=e=>" \f	\v".indexOf(e)!==-1,Tp=e=>e===`
`||e==="\r",wN=(e,t)=>t<e.length&&t>=0?Tp(e[t]):!1,Dp=(e,t=4,n=!0,s=!0)=>{const o=pA(" ",t),r=e.replace(/\t/g,o);return Tt(r,(i,l)=>SN(l)||l===Ze?i.pcIsSpace||i.str===""&&n||i.str.length===r.length-1&&s||wN(r,i.str.length+1)?{pcIsSpace:!1,str:i.str+Ze}:{pcIsSpace:!0,str:i.str+" "}:{pcIsSpace:Tp(l),str:i.str+l},{pcIsSpace:!1,str:""}).str},Ws=e=>t=>!!t&&t.nodeType===e,Si=e=>!!e&&!Object.getPrototypeOf(e),q=Ws(1),Fn=e=>q(e)&&Ir(C.fromDom(e)),kN=e=>q(e)&&e.namespaceURI==="http://www.w3.org/2000/svg",Fo=e=>{const t=e.toLowerCase();return n=>U(n)&&n.nodeName.toLowerCase()===t},Cn=e=>{const t=e.map(n=>n.toLowerCase());return n=>{if(n&&n.nodeName){const s=n.nodeName.toLowerCase();return Se(t,s)}return!1}},wi=(e,t)=>{const n=t.toLowerCase().split(" ");return s=>{if(q(s)){const o=s.ownerDocument.defaultView;if(o)for(let r=0;r<n.length;r++){const a=o.getComputedStyle(s,null);if((a?a.getPropertyValue(e):null)===n[r])return!0}}return!1}},_N=e=>t=>q(t)&&t.hasAttribute(e),Vs=e=>q(e)&&e.hasAttribute("data-mce-bogus"),AN=e=>q(e)&&e.getAttribute("data-mce-bogus")==="all",Ln=e=>q(e)&&e.tagName==="TABLE",Pp=e=>t=>!!(Fn(t)&&(t.contentEditable===e||t.getAttribute("data-mce-contenteditable")===e)),Qc=Cn(["textarea","input"]),I=Ws(3),xN=Ws(4),NN=Ws(7),ys=Ws(8),qr=Ws(9),Jc=Ws(11),Ie=Fo("br"),Bp=Fo("img"),RN=Fo("a"),an=Pp("true"),xe=Pp("false"),eu=e=>Fn(e)&&e.isContentEditable&&U(e.parentElement)&&!e.parentElement.isContentEditable,ki=Cn(["td","th"]),TN=Cn(["td","th","caption"]),$n=Cn(["video","audio","object","embed"]),DN=Fo("li"),tu=Fo("details"),PN=Fo("summary"),Op={skipBogus:!0,includeZwsp:!1,checkRootAsContent:!1},BN=(e,t,n)=>{const s=C.fromDom(t),o=C.fromDom(e),r=n.getWhitespaceElements();return _p(o,i=>se(r,be(i)),G(Ee,s))},ON=e=>q(e)&&e.nodeName==="A"&&!e.hasAttribute("href")&&(e.hasAttribute("name")||e.hasAttribute("id")),IN=(e,t)=>q(e)&&se(t.getNonEmptyElements(),e.nodeName),FN=_N("data-mce-bookmark"),LN=e=>$r(C.fromDom(e)).exists(t=>!Cs(t)),$N=(e,t,n)=>Io(e.data)&&!BN(e,t,n),MN=(e,t,n,s)=>I(e)&&!$N(e,t,n)&&(!s.includeZwsp||!EN(e.data)),nu=(e,t,n,s)=>we(s.isContent)&&s.isContent(t)||IN(t,e)||FN(t)||ON(t)||MN(t,n,e,s)||xe(t)||an(t)&&LN(t),rs=(e,t,n)=>{const s={...Op,...n};if(s.checkRootAsContent&&nu(e,t,t,s))return!1;let o=t.firstChild,r=0;if(!o)return!0;const a=new tt(o,t);do{if(s.skipBogus&&q(o)){const i=o.getAttribute("data-mce-bogus");if(i){o=a.next(i==="all");continue}}if(ys(o)){o=a.next(!0);continue}if(Ie(o)){r++,o=a.next();continue}if(nu(e,o,t,s))return!1;o=a.next()}while(o);return r<=1},ft=(e,t,n)=>rs(e,t.dom,{checkRootAsContent:!0,...n}),Ip=(e,t,n)=>nu(e,t,t,{includeZwsp:Op.includeZwsp,...n}),Fp=e=>{const t=e.toLowerCase();return t==="svg"?"svg":t==="math"?"math":"html"},js=e=>Fp(e)!=="html",su=e=>js(e.nodeName),Lp=e=>Fp(e.nodeName),UN=["svg","math"],zN=()=>{const e=Qn(),t=()=>e.get().map(Lp).getOr("html");return{track:o=>(su(o)?e.set(o):e.get().exists(r=>!r.contains(o))&&e.clear(),t()),current:t,reset:()=>{e.clear()}}},_i="data-mce-block",HN=e=>ne($t(e),t=>!/[A-Z]/.test(t)),ou=e=>he(HN(e),t=>{const n=CSS.escape(t);return`${n}:`+he(UN,s=>`not(${s} ${n})`).join(":")}).join(","),$p=(e,t)=>U(t.querySelector(e))?(t.setAttribute(_i,"true"),t.getAttribute("data-mce-selected")==="inline-boundary"&&t.removeAttribute("data-mce-selected"),!0):(t.removeAttribute(_i),!1),Mp=(e,t)=>{const n=ou(e.getTransparentElements()),s=ou(e.getBlockElements());return ne(t.querySelectorAll(n),o=>$p(s,o))},Up=(e,t,n)=>{var s;const o=n?"lastChild":"firstChild";for(let r=t[o];r;r=r[o])if(rs(e,r,{checkRootAsContent:!0})){(s=r.parentNode)===null||s===void 0||s.removeChild(r);return}},WN=(e,t,n)=>{const s=document.createRange(),o=t.parentNode;if(o){s.setStartBefore(t),s.setEndBefore(n);const r=s.extractContents();Up(e,r,!0),s.setStartAfter(n),s.setEndAfter(t);const a=s.extractContents();Up(e,a,!1),rs(e,r,{checkRootAsContent:!0})||o.insertBefore(r,t),rs(e,n,{checkRootAsContent:!0})||o.insertBefore(n,t),rs(e,a,{checkRootAsContent:!0})||o.insertBefore(a,t),o.removeChild(t)}},VN=(e,t,n)=>{const s=e.getBlockElements(),o=C.fromDom(t),r=i=>be(i)in s,a=i=>Ee(i,o);D(Mc(n),i=>{ss(i,r,a).each(l=>{const c=Vx(i,u=>r(u)&&!e.isValidChild(be(l),be(u)));if(c.length>0){const u=$r(l);D(c,f=>{ss(f,r,a).each(d=>{WN(e,d.dom,f.dom)})}),u.each(f=>Mp(e,f.dom))}})})},jN=(e,t,n)=>{D([...n,...qs(e,t)?[t]:[]],s=>D(ut(C.fromDom(s),s.nodeName.toLowerCase()),o=>{GN(e,o.dom)&&hs(o)}))},ru=(e,t)=>{const n=Mp(e,t);VN(e,t,n),jN(e,t,n)},qN=(e,t)=>{if(lu(e,t)){const n=ou(e.getBlockElements());$p(n,t)}},KN=(e,t,n)=>{const s=r=>Ee(r,C.fromDom(t)),o=Qg(C.fromDom(n),s);_r(o,o.length-2).filter(Ut).fold(()=>ru(e,t),r=>ru(e,r.dom))},au=e=>e.hasAttribute(_i),iu=(e,t)=>se(e.getTransparentElements(),t),lu=(e,t)=>q(t)&&iu(e,t.nodeName),qs=(e,t)=>lu(e,t)&&au(t),GN=(e,t)=>lu(e,t)&&!au(t),cu=(e,t)=>t.type===1&&iu(e,t.name)&&J(t.attr(_i)),YN=pn().browser,zp=e=>Ye(e,Ut),XN=e=>YN.isFirefox()&&be(e)==="table"?zp(ct(e)).filter(t=>be(t)==="caption").bind(t=>zp(ep(t)).map(n=>{const s=n.dom.offsetTop,o=t.dom.offsetTop,r=t.dom.offsetHeight;return s<=o?-r:0})).getOr(0):0,Hp=(e,t)=>e.children&&Se(e.children,t),ZN=(e,t,n)=>{let s=0,o=0;const r=e.ownerDocument;if(n=n||e,t){if(n===e&&t.getBoundingClientRect&&In(C.fromDom(e),"position")==="static"){const i=t.getBoundingClientRect();return s=i.left+(r.documentElement.scrollLeft||e.scrollLeft)-r.documentElement.clientLeft,o=i.top+(r.documentElement.scrollTop||e.scrollTop)-r.documentElement.clientTop,{x:s,y:o}}let a=t;for(;a&&a!==n&&a.nodeType&&!Hp(a,n);){const i=a;s+=i.offsetLeft||0,o+=i.offsetTop||0,a=i.offsetParent}for(a=t.parentNode;a&&a!==n&&a.nodeType&&!Hp(a,n);)s-=a.scrollLeft||0,o-=a.scrollTop||0,a=a.parentNode;o+=XN(C.fromDom(t))}return{x:s,y:o}},Wp=(e,t={})=>{let n=0;const s={},o=C.fromDom(e),r=ms(o),a=y=>{t.referrerPolicy=y},i=y=>{t.contentCssCors=y},l=y=>{je(Fc(o),y)},c=y=>{const v=Fc(o);Ci(v,"#"+y).each(Ne)},u=y=>Oe(s,y).getOrThunk(()=>({id:"mce-u"+n++,passed:[],failed:[],count:0})),f=y=>new Promise((v,E)=>{let w;const T=L._addCacheSuffix(y),B=u(T);s[T]=B,B.count++;const H=(z,X)=>{D(z,Er),B.status=X,B.passed=[],B.failed=[],w&&(w.onload=null,w.onerror=null,w=null)},x=()=>H(B.passed,2),_=()=>H(B.failed,3);if(v&&B.passed.push(v),E&&B.failed.push(E),B.status===1)return;if(B.status===2){x();return}if(B.status===3){_();return}B.status=1;const P=C.fromTag("link",r.dom);ts(P,{rel:"stylesheet",type:"text/css",id:B.id}),t.contentCssCors&&ot(P,"crossOrigin","anonymous"),t.referrerPolicy&&ot(P,"referrerpolicy",t.referrerPolicy),w=P.dom,w.onload=x,w.onerror=_,l(P),ot(P,"href",T)}),d=(y,v)=>{const E=u(y);s[y]=E,E.count++;const w=C.fromTag("style",r.dom);ts(w,{rel:"stylesheet",type:"text/css",id:E.id,"data-mce-key":y}),w.dom.innerHTML=v,l(w)},g=y=>Promise.allSettled(he(y,E=>f(E).then(W(E)))).then(E=>{const w=So(E,T=>T.status==="fulfilled");return w.fail.length>0?Promise.reject(he(w.fail,T=>T.reason)):he(w.pass,T=>T.value)}),h=y=>{const v=L._addCacheSuffix(y);Oe(s,v).each(E=>{--E.count===0&&(delete s[v],c(E.id))})};return{load:f,loadRawCss:d,loadAll:g,unload:h,unloadRawCss:y=>{Oe(s,y).each(v=>{--v.count===0&&(delete s[y],c(v.id))})},unloadAll:y=>{D(y,v=>{h(v)})},_setReferrerPolicy:a,_setContentCssCors:i}},Vp=(()=>{const e=new WeakMap;return{forElement:(n,s)=>{const r=ps(n).dom;return m.from(e.get(r)).getOrThunk(()=>{const a=Wp(r,s);return e.set(r,a),a})}}})(),QN=e=>e.nodeName.toLowerCase()==="span",jp=(e,t)=>U(e)&&(Ip(t,e)||t.isInline(e.nodeName.toLowerCase())),JN=(e,t,n)=>{const s=new tt(e,t).prev(!1),o=new tt(e,t).next(!1),r=st(s)||jp(s,n),a=st(o)||jp(o,n);return r&&a},qp=e=>QN(e)&&e.getAttribute("data-mce-type")==="bookmark",eR=(e,t,n)=>I(e)&&e.data.length>0&&JN(e,t,n),tR=e=>q(e)?e.childNodes.length>0:!1,nR=e=>Jc(e)||qr(e),uu=(e,t,n,s)=>{var o;const r=s||t;if(q(t)&&qp(t))return t;const a=t.childNodes;for(let i=a.length-1;i>=0;i--)uu(e,a[i],n,r);if(q(t)){const i=t.childNodes;i.length===1&&qp(i[0])&&((o=t.parentNode)===null||o===void 0||o.insertBefore(i[0],t))}return!nR(t)&&!Ip(n,t)&&!tR(t)&&!eR(t,r,n)&&e.remove(t),t},sR=L.makeMap,Ai=/[&<>\"\u0060\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,xi=/[<>&\u007E-\uD7FF\uE000-\uFFEF]|[\uD800-\uDBFF][\uDC00-\uDFFF]/g,oR=/[<>&\"\']/g,rR=/&#([a-z0-9]+);?|&([a-z0-9]+);/gi,aR={128:"€",130:"‚",131:"ƒ",132:"„",133:"…",134:"†",135:"‡",136:"ˆ",137:"‰",138:"Š",139:"‹",140:"Œ",142:"Ž",145:"‘",146:"’",147:"“",148:"”",149:"•",150:"–",151:"—",152:"˜",153:"™",154:"š",155:"›",156:"œ",158:"ž",159:"Ÿ"},Ks={'"':"&quot;","'":"&#39;","<":"&lt;",">":"&gt;","&":"&amp;","`":"&#96;"},iR={"&lt;":"<","&gt;":">","&amp;":"&","&quot;":'"',"&apos;":"'"},lR=e=>{const t=C.fromTag("div").dom;return t.innerHTML=e,t.textContent||t.innerText||e},Kp=(e,t)=>{const n={};if(e){const s=e.split(",");t=t||10;for(let o=0;o<s.length;o+=2){const r=String.fromCharCode(parseInt(s[o],t));if(!Ks[r]){const a="&"+s[o+1]+";";n[r]=a,n[a]=r}}return n}else return},fu=Kp("50,nbsp,51,iexcl,52,cent,53,pound,54,curren,55,yen,56,brvbar,57,sect,58,uml,59,copy,5a,ordf,5b,laquo,5c,not,5d,shy,5e,reg,5f,macr,5g,deg,5h,plusmn,5i,sup2,5j,sup3,5k,acute,5l,micro,5m,para,5n,middot,5o,cedil,5p,sup1,5q,ordm,5r,raquo,5s,frac14,5t,frac12,5u,frac34,5v,iquest,60,Agrave,61,Aacute,62,Acirc,63,Atilde,64,Auml,65,Aring,66,AElig,67,Ccedil,68,Egrave,69,Eacute,6a,Ecirc,6b,Euml,6c,Igrave,6d,Iacute,6e,Icirc,6f,Iuml,6g,ETH,6h,Ntilde,6i,Ograve,6j,Oacute,6k,Ocirc,6l,Otilde,6m,Ouml,6n,times,6o,Oslash,6p,Ugrave,6q,Uacute,6r,Ucirc,6s,Uuml,6t,Yacute,6u,THORN,6v,szlig,70,agrave,71,aacute,72,acirc,73,atilde,74,auml,75,aring,76,aelig,77,ccedil,78,egrave,79,eacute,7a,ecirc,7b,euml,7c,igrave,7d,iacute,7e,icirc,7f,iuml,7g,eth,7h,ntilde,7i,ograve,7j,oacute,7k,ocirc,7l,otilde,7m,ouml,7n,divide,7o,oslash,7p,ugrave,7q,uacute,7r,ucirc,7s,uuml,7t,yacute,7u,thorn,7v,yuml,ci,fnof,sh,Alpha,si,Beta,sj,Gamma,sk,Delta,sl,Epsilon,sm,Zeta,sn,Eta,so,Theta,sp,Iota,sq,Kappa,sr,Lambda,ss,Mu,st,Nu,su,Xi,sv,Omicron,t0,Pi,t1,Rho,t3,Sigma,t4,Tau,t5,Upsilon,t6,Phi,t7,Chi,t8,Psi,t9,Omega,th,alpha,ti,beta,tj,gamma,tk,delta,tl,epsilon,tm,zeta,tn,eta,to,theta,tp,iota,tq,kappa,tr,lambda,ts,mu,tt,nu,tu,xi,tv,omicron,u0,pi,u1,rho,u2,sigmaf,u3,sigma,u4,tau,u5,upsilon,u6,phi,u7,chi,u8,psi,u9,omega,uh,thetasym,ui,upsih,um,piv,812,bull,816,hellip,81i,prime,81j,Prime,81u,oline,824,frasl,88o,weierp,88h,image,88s,real,892,trade,89l,alefsym,8cg,larr,8ch,uarr,8ci,rarr,8cj,darr,8ck,harr,8dl,crarr,8eg,lArr,8eh,uArr,8ei,rArr,8ej,dArr,8ek,hArr,8g0,forall,8g2,part,8g3,exist,8g5,empty,8g7,nabla,8g8,isin,8g9,notin,8gb,ni,8gf,prod,8gh,sum,8gi,minus,8gn,lowast,8gq,radic,8gt,prop,8gu,infin,8h0,ang,8h7,and,8h8,or,8h9,cap,8ha,cup,8hb,int,8hk,there4,8hs,sim,8i5,cong,8i8,asymp,8j0,ne,8j1,equiv,8j4,le,8j5,ge,8k2,sub,8k3,sup,8k4,nsub,8k6,sube,8k7,supe,8kl,oplus,8kn,otimes,8l5,perp,8m5,sdot,8o8,lceil,8o9,rceil,8oa,lfloor,8ob,rfloor,8p9,lang,8pa,rang,9ea,loz,9j0,spades,9j3,clubs,9j5,hearts,9j6,diams,ai,OElig,aj,oelig,b0,Scaron,b1,scaron,bo,Yuml,m6,circ,ms,tilde,802,ensp,803,emsp,809,thinsp,80c,zwnj,80d,zwj,80e,lrm,80f,rlm,80j,ndash,80k,mdash,80o,lsquo,80p,rsquo,80q,sbquo,80s,ldquo,80t,rdquo,80u,bdquo,810,dagger,811,Dagger,81g,permil,81p,lsaquo,81q,rsaquo,85c,euro",32),Gp=(e,t)=>e.replace(t?Ai:xi,n=>Ks[n]||n),cR=e=>(""+e).replace(oR,t=>Ks[t]||t),Yp=(e,t)=>e.replace(t?Ai:xi,n=>n.length>1?"&#"+((n.charCodeAt(0)-55296)*1024+(n.charCodeAt(1)-56320)+65536)+";":Ks[n]||"&#"+n.charCodeAt(0)+";"),du=(e,t,n)=>{const s=n||fu;return e.replace(t?Ai:xi,o=>Ks[o]||s[o]||o)},Gs={encodeRaw:Gp,encodeAllRaw:cR,encodeNumeric:Yp,encodeNamed:du,getEncodeFunc:(e,t)=>{const n=Kp(t)||fu,s=(a,i)=>a.replace(i?Ai:xi,l=>Ks[l]!==void 0?Ks[l]:n[l]!==void 0?n[l]:l.length>1?"&#"+((l.charCodeAt(0)-55296)*1024+(l.charCodeAt(1)-56320)+65536)+";":"&#"+l.charCodeAt(0)+";"),o=(a,i)=>du(a,i,n),r=sR(e.replace(/\+/g,","));return r.named&&r.numeric?s:r.named?t?o:du:r.numeric?Yp:Gp},decode:e=>e.replace(rR,(t,n)=>n?(n.charAt(0).toLowerCase()==="x"?n=parseInt(n.substr(1),16):n=parseInt(n,10),n>65535?(n-=65536,String.fromCharCode(55296+(n>>10),56320+(n&1023))):aR[n]||String.fromCharCode(n)):iR[t]||fu[t]||lR(t))},it=(e,t)=>(e=L.trim(e),e?e.split(t||" "):[]),Xp=e=>new RegExp("^"+e.replace(/([?+*])/g,".$1")+"$"),uR=e=>nt(e)&&e.source&&Object.prototype.toString.call(e)==="[object RegExp]",fR=e=>{const t=n=>De(n)?he(n,t):uR(n)?new RegExp(n.source,n.flags):nt(n)?ri(n,t):n;return t(e)},dR=e=>{const t=/^(~)?(.+)$/;return Kt(it(e,","),n=>{const s=t.exec(n);if(s){const r=s[1]==="~"?"span":"div",a=s[2];return[{cloneName:r,name:a}]}else return[]})},Zp=e=>Object.freeze(["id","accesskey","class","dir","lang","style","tabindex","title","role",...e!=="html4"?["contenteditable","contextmenu","draggable","dropzone","hidden","spellcheck","translate","itemprop","itemscope","itemtype"]:[],...e!=="html5-strict"?["xml:lang"]:[]]),Qp=e=>{let t,n;t="address blockquote div dl fieldset form h1 h2 h3 h4 h5 h6 hr menu ol p pre table ul",n="a abbr b bdo br button cite code del dfn em embed i iframe img input ins kbd label map noscript object q s samp script select small span strong sub sup textarea u var #text #comment",e!=="html4"&&(t+=" article aside details dialog figure main header footer hgroup section nav "+"a ins del canvas map",n+=" audio canvas command data datalist mark meter output picture progress time wbr video ruby bdi keygen svg"),e!=="html5-strict"&&(n=[n,"acronym applet basefont big font strike tt"].join(" "),t=[t,"center dir isindex noframes"].join(" "));const s=[t,n].join(" ");return{blockContent:t,phrasingContent:n,flowContent:s}},mu=e=>{const{blockContent:t,phrasingContent:n,flowContent:s}=Qp(e),o=r=>Object.freeze(r.split(" "));return Object.freeze({blockContent:o(t),phrasingContent:o(n),flowContent:o(s)})},mR={html4:Dn(()=>mu("html4")),html5:Dn(()=>mu("html5")),"html5-strict":Dn(()=>mu("html5-strict"))},Jp=(e,t)=>{const{blockContent:n,phrasingContent:s,flowContent:o}=mR[e]();return t==="blocks"?m.some(n):t==="phrasing"?m.some(s):t==="flow"?m.some(o):m.none()},gR=e=>{const t=Zp(e),{phrasingContent:n,flowContent:s}=Qp(e),o={},r=(l,c,u)=>{o[l]={attributes:yc(c,W({})),attributesOrder:c,children:yc(u,W({}))}},a=(l,c="",u="")=>{const f=it(u),d=it(l);let g=d.length;const h=[...t,...it(c)];for(;g--;)r(d[g],h.slice(),f)},i=(l,c)=>{const u=it(l),f=it(c);let d=u.length;for(;d--;){const g=o[u[d]];for(let h=0,p=f.length;h<p;h++)g.attributes[f[h]]={},g.attributesOrder.push(f[h])}};return e!=="html5-strict"&&(D(it("acronym applet basefont big font strike tt"),u=>{a(u,"",n)}),D(it("center dir isindex noframes"),u=>{a(u,"",s)})),a("html","manifest","head body"),a("head","","base command link meta noscript script style title"),a("title hr noscript br"),a("base","href target"),a("link","href rel media hreflang type sizes hreflang"),a("meta","name http-equiv content charset"),a("style","media type scoped"),a("script","src async defer type charset"),a("body","onafterprint onbeforeprint onbeforeunload onblur onerror onfocus onhashchange onload onmessage onoffline ononline onpagehide onpageshow onpopstate onresize onscroll onstorage onunload",s),a("dd div","",s),a("address dt caption","",e==="html4"?n:s),a("h1 h2 h3 h4 h5 h6 pre p abbr code var samp kbd sub sup i b u bdo span legend em strong small s cite dfn","",n),a("blockquote","cite",s),a("ol","reversed start type","li"),a("ul","","li"),a("li","value",s),a("dl","","dt dd"),a("a","href target rel media hreflang type",e==="html4"?n:s),a("q","cite",n),a("ins del","cite datetime",s),a("img","src sizes srcset alt usemap ismap width height"),a("iframe","src name width height",s),a("embed","src type width height"),a("object","data type typemustmatch name usemap form width height",[s,"param"].join(" ")),a("param","name value"),a("map","name",[s,"area"].join(" ")),a("area","alt coords shape href target rel media hreflang type"),a("table","border","caption colgroup thead tfoot tbody tr"+(e==="html4"?" col":"")),a("colgroup","span","col"),a("col","span"),a("tbody thead tfoot","","tr"),a("tr","","td th"),a("td","colspan rowspan headers",s),a("th","colspan rowspan headers scope abbr",s),a("form","accept-charset action autocomplete enctype method name novalidate target",s),a("fieldset","disabled form name",[s,"legend"].join(" ")),a("label","form for",n),a("input","accept alt autocomplete checked dirname disabled form formaction formenctype formmethod formnovalidate formtarget height list max maxlength min multiple name pattern readonly required size src step type value width"),a("button","disabled form formaction formenctype formmethod formnovalidate formtarget name type value",e==="html4"?s:n),a("select","disabled form multiple name required size","option optgroup"),a("optgroup","disabled label","option"),a("option","disabled label selected value"),a("textarea","cols dirname disabled form maxlength name readonly required rows wrap"),a("menu","type label",[s,"li"].join(" ")),a("noscript","",s),e!=="html4"&&(a("wbr"),a("ruby","",[n,"rt rp"].join(" ")),a("figcaption","",s),a("mark rt rp bdi","",n),a("summary","",[n,"h1 h2 h3 h4 h5 h6"].join(" ")),a("canvas","width height",s),a("data","value",n),a("video","src crossorigin poster preload autoplay mediagroup loop muted controls width height buffered",[s,"track source"].join(" ")),a("audio","src crossorigin preload autoplay mediagroup loop muted controls buffered volume",[s,"track source"].join(" ")),a("picture","","img source"),a("source","src srcset type media sizes"),a("track","kind src srclang label default"),a("datalist","",[n,"option"].join(" ")),a("article section nav aside main header footer","",s),a("hgroup","","h1 h2 h3 h4 h5 h6"),a("figure","",[s,"figcaption"].join(" ")),a("time","datetime",n),a("dialog","open",s),a("command","type label icon disabled checked radiogroup command"),a("output","for form name",n),a("progress","value max",n),a("meter","value min max low high optimum",n),a("details","open",[s,"summary"].join(" ")),a("keygen","autofocus challenge disabled form keytype name"),r("svg","id tabindex lang xml:space class style x y width height viewBox preserveAspectRatio zoomAndPan transform".split(" "),[])),e!=="html5-strict"&&(i("script","language xml:space"),i("style","xml:space"),i("object","declare classid code codebase codetype archive standby align border hspace vspace"),i("embed","align name hspace vspace"),i("param","valuetype type"),i("a","charset name rev shape coords"),i("br","clear"),i("applet","codebase archive code object alt name width height align hspace vspace"),i("img","name longdesc align border hspace vspace"),i("iframe","longdesc frameborder marginwidth marginheight scrolling align"),i("font basefont","size color face"),i("input","usemap align"),i("select"),i("textarea"),i("h1 h2 h3 h4 h5 h6 div p legend caption","align"),i("ul","type compact"),i("li","type"),i("ol dl menu dir","compact"),i("pre","width xml:space"),i("hr","align noshade size width"),i("isindex","prompt"),i("table","summary width frame rules cellspacing cellpadding align bgcolor"),i("col","width align char charoff valign"),i("colgroup","width align char charoff valign"),i("thead","align char charoff valign"),i("tr","align char charoff valign bgcolor"),i("th","axis align char charoff valign nowrap bgcolor width height"),i("form","accept"),i("td","abbr axis scope align char charoff valign nowrap bgcolor width height"),i("tfoot","align char charoff valign"),i("tbody","align char charoff valign"),i("area","nohref"),i("body","background bgcolor text link vlink alink")),e!=="html4"&&(i("input button select textarea","autofocus"),i("input textarea","placeholder"),i("a","download"),i("link script img","crossorigin"),i("img","loading"),i("iframe","sandbox seamless allow allowfullscreen loading referrerpolicy")),e!=="html4"&&D([o.video,o.audio],l=>{delete l.children.audio,delete l.children.video}),D(it("a form meter progress dfn"),l=>{o[l]&&delete o[l].children[l]}),delete o.caption.children.table,delete o.script,o},pR=e=>e==="-"?"remove":"add",gu=e=>{const t=/^(@?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)$/;return m.from(t.exec(e)).map(n=>({preset:n[1]==="@",name:n[2]}))},hR=e=>{const t=/^([+\-]?)([A-Za-z0-9_\-.\u00b7\u00c0-\u00d6\u00d8-\u00f6\u00f8-\u037d\u037f-\u1fff\u200c-\u200d\u203f-\u2040\u2070-\u218f\u2c00-\u2fef\u3001-\ud7ff\uf900-\ufdcf\ufdf0-\ufffd]+)\[([^\]]+)]$/;return Kt(it(e,","),n=>{const s=t.exec(n);if(s){const o=s[1],r=o?pR(o):"replace",a=s[2],i=Kt(it(s[3],"|"),l=>gu(l).toArray());return[{operation:r,name:a,validChildren:i}]}else return[]})},bR=(e,t)=>{const n=/^([!\-])?(\w+[\\:]:\w+|[^=~<]+)?(?:([=~<])(.*))?$/,s=/[*?+]/,{attributes:o,attributesOrder:r}=t;return D(it(e,"|"),a=>{const i=n.exec(a);if(i){const l={},c=i[1],u=i[2].replace(/[\\:]:/g,":"),f=i[3],d=i[4];if(c==="!"&&(t.attributesRequired=t.attributesRequired||[],t.attributesRequired.push(u),l.required=!0),c==="-"){delete o[u],r.splice(L.inArray(r,u),1);return}if(f&&(f==="="?(t.attributesDefault=t.attributesDefault||[],t.attributesDefault.push({name:u,value:d}),l.defaultValue=d):f==="~"?(t.attributesForced=t.attributesForced||[],t.attributesForced.push({name:u,value:d}),l.forcedValue=d):f==="<"&&(l.validValues=L.makeMap(d,"?"))),s.test(u)){const g=l;t.attributePatterns=t.attributePatterns||[],g.pattern=Xp(u),t.attributePatterns.push(g)}else o[u]||r.push(u),o[u]=l}})},CR=(e,t)=>{Ae(e.attributes,(n,s)=>{t.attributes[s]=n}),t.attributesOrder.push(...e.attributesOrder)},yR=(e,t)=>{const n=/^([#+\-])?([^\[!\/]+)(?:\/([^\[!]+))?(?:(!?)\[([^\]]+)])?$/;return Kt(it(t,","),s=>{const o=n.exec(s);if(o){const r=o[1],a=o[2],i=o[3],l=o[4],c=o[5],u={attributes:{},attributesOrder:[]};if(e.each(f=>CR(f,u)),r==="#"?u.paddEmpty=!0:r==="-"&&(u.removeEmpty=!0),l==="!"&&(u.removeEmptyAttrs=!0),c&&bR(c,u),i&&(u.outputName=a),a==="@")if(e.isNone())e=m.some(u);else return[];return[i?{name:a,element:u,aliasName:i}:{name:a,element:u}]}else return[]})},Ni={},Kr=L.makeMap,yn=L.each,eh=L.extend,th=L.explode,nh=(e,t={})=>{const n=Kr(e," ",Kr(e.toUpperCase()," "));return eh(n,t)},sh=e=>nh("td th li dt dd figcaption caption details summary",e.getTextBlockElements()),pu=(e,t)=>{if(e){const n={};return J(e)&&(e={"*":e}),yn(e,(s,o)=>{n[o]=n[o.toUpperCase()]=t==="map"?Kr(s,/[, ]/):th(s,/[, ]/)}),n}else return},vs=(e={})=>{var t;const n={},s={};let o=[];const r={},a={},i=(Q,fe,Fe)=>{const He=e[Q];if(He)return Kr(He,/[, ]/,Kr(He.toUpperCase(),/[, ]/));{let Ge=Ni[Q];return Ge||(Ge=nh(fe,Fe),Ni[Q]=Ge),Ge}},l=(t=e.schema)!==null&&t!==void 0?t:"html5",c=gR(l);e.verify_html===!1&&(e.valid_elements="*[*]");const u=pu(e.valid_styles),f=pu(e.invalid_styles,"map"),d=pu(e.valid_classes,"map"),g=i("whitespace_elements","pre script noscript style textarea video audio iframe object code"),h=i("self_closing_elements","colgroup dd dt li option p td tfoot th thead tr"),p=i("void_elements","area base basefont br col frame hr img input isindex link meta param embed source wbr track"),b=i("boolean_attributes","checked compact declare defer disabled ismap multiple nohref noresize noshade nowrap readonly selected autoplay loop controls allowfullscreen"),y="td th iframe video audio object script code",v=i("non_empty_elements",y+" pre svg textarea summary",p),E=i("move_caret_before_on_enter_elements",y+" table",p),w="h1 h2 h3 h4 h5 h6",T=i("text_block_elements",w+" p div address pre form blockquote center dir fieldset header footer article section hgroup aside main nav figure"),B=i("block_elements","hr table tbody thead tfoot th tr td li ol ul caption dl dt dd noscript menu isindex option datalist select optgroup figcaption details summary html body multicol listing",T),H=i("text_inline_elements","span strong b em i font s strike u var cite dfn code mark q sup sub samp"),x=i("transparent_elements","a ins del canvas map"),_=i("wrap_block_elements","pre "+w);yn("script noscript iframe noframes noembed title style textarea xmp plaintext".split(" "),Q=>{a[Q]=new RegExp("</"+Q+"[^>]*>","gi")});const P=Q=>{const fe=m.from(n["@"]),Fe=/[*?+]/;D(yR(fe,Q??""),({name:He,element:Ge,aliasName:Me})=>{if(Me&&(n[Me]=Ge),Fe.test(He)){const Re=Ge;Re.pattern=Xp(He),o.push(Re)}else n[He]=Ge})},z=Q=>{o=[],D($t(n),fe=>{delete n[fe]}),P(Q)},X=(Q,fe)=>{var Fe,He;delete Ni.text_block_elements,delete Ni.block_elements;const Ge=fe.extends?!pt(fe.extends):!1,Me=fe.extends;if(s[Q]=Me?s[Me]:{},r[Q]=Me??Q,v[Q.toUpperCase()]={},v[Q]={},Ge||(B[Q.toUpperCase()]={},B[Q]={}),Me&&!n[Q]&&n[Me]){const Re=fR(n[Me]);delete Re.removeEmptyAttrs,delete Re.removeEmpty,n[Q]=Re}else n[Q]={attributesOrder:[],attributes:{}};if(De(fe.attributes)){const Re=wt=>{Te.attributesOrder.push(wt),Te.attributes[wt]={}},Te=(Fe=n[Q])!==null&&Fe!==void 0?Fe:{};delete Te.attributesDefault,delete Te.attributesForced,delete Te.attributePatterns,delete Te.attributesRequired,Te.attributesOrder=[],Te.attributes={},D(fe.attributes,wt=>{const dn=Zp(l);gu(wt).each(({preset:Gn,name:An})=>{Gn?An==="global"&&D(dn,Re):Re(An)})}),n[Q]=Te}if(Xn(fe.padEmpty)){const Re=(He=n[Q])!==null&&He!==void 0?He:{};Re.paddEmpty=fe.padEmpty,n[Q]=Re}if(De(fe.children)){const Re={},Te=dn=>{Re[dn]={}},wt=dn=>{Jp(l,dn).each(Gn=>{D(Gn,Te)})};D(fe.children,dn=>{gu(dn).each(({preset:Gn,name:An})=>{Gn?wt(An):Te(An)})}),s[Q]=Re}Me&&Ae(s,(Re,Te)=>{Re[Me]&&(s[Te]=Re=eh({},s[Te]),Re[Q]=Re[Me])})},oe=Q=>{D(dR(Q??""),({name:fe,cloneName:Fe})=>{X(fe,{extends:Fe})})},ae=Q=>{nt(Q)?Ae(Q,(fe,Fe)=>X(Fe,fe)):J(Q)&&oe(Q)},ge=Q=>{D(hR(Q??""),({operation:fe,name:Fe,validChildren:He})=>{const Ge=fe==="replace"?{"#comment":{}}:s[Fe],Me=Te=>{fe==="remove"?delete Ge[Te]:Ge[Te]={}},Re=Te=>{Jp(l,Te).each(wt=>{D(wt,Me)})};D(He,({preset:Te,name:wt})=>{Te?Re(wt):Me(wt)}),s[Fe]=Ge})},ve=Q=>{const fe=n[Q];if(fe)return fe;let Fe=o.length;for(;Fe--;){const He=o[Fe];if(He.pattern.test(Q))return He}},$e=()=>{e.valid_elements?(z(e.valid_elements),yn(c,(Q,fe)=>{s[fe]=Q.children})):(yn(c,(Q,fe)=>{n[fe]={attributes:Q.attributes,attributesOrder:Q.attributesOrder},s[fe]=Q.children}),yn(it("strong/b em/i"),Q=>{const fe=it(Q,"/");n[fe[1]].outputName=fe[0]}),yn(H,(Q,fe)=>{n[fe]&&(e.padd_empty_block_inline_children&&(n[fe].paddInEmptyBlock=!0),n[fe].removeEmpty=!0)}),yn(it("ol ul blockquote a table tbody"),Q=>{n[Q]&&(n[Q].removeEmpty=!0)}),yn(it("p h1 h2 h3 h4 h5 h6 th td pre div address caption li summary"),Q=>{n[Q]&&(n[Q].paddEmpty=!0)}),yn(it("span"),Q=>{n[Q].removeEmptyAttrs=!0})),delete n.svg,ae(e.custom_elements),ge(e.valid_children),P(e.extended_valid_elements),ge("+ol[ul|ol],+ul[ul|ol]"),yn({dd:"dl",dt:"dl",li:"ul ol",td:"tr",th:"tr",tr:"tbody thead tfoot",tbody:"table",thead:"table",tfoot:"table",legend:"fieldset",area:"map",param:"video audio object"},(Q,fe)=>{n[fe]&&(n[fe].parentsRequired=it(Q))}),e.invalid_elements&&yn(th(e.invalid_elements),Q=>{n[Q]&&delete n[Q]}),ve("span")||P("span[!data-mce-type|*]")},ze=W(u),Ke=W(f),M=W(d),Y=W(b),me=W(B),pe=W(T),R=W(H),O=W(Object.seal(p)),K=W(h),ie=W(v),le=W(E),ye=W(g),sn=W(x),Kn=W(_),Et=W(Object.seal(a)),fn=(Q,fe)=>{const Fe=s[Q.toLowerCase()];return!!(Fe&&Fe[fe.toLowerCase()])},jt=(Q,fe)=>{const Fe=ve(Q);if(Fe)if(fe){if(Fe.attributes[fe])return!0;const He=Fe.attributePatterns;if(He){let Ge=He.length;for(;Ge--;)if(He[Ge].pattern.test(fe))return!0}}else return!0;return!1},pt=Q=>se(me(),Q),St=Q=>!Xe(Q,"#")&&jt(Q)&&!pt(Q),on=Q=>se(Kn(),Q)||St(Q),Os=W(r);return $e(),{type:l,children:s,elements:n,getValidStyles:ze,getValidClasses:M,getBlockElements:me,getInvalidStyles:Ke,getVoidElements:O,getTextBlockElements:pe,getTextInlineElements:R,getBoolAttrs:Y,getElementRule:ve,getSelfClosingElements:K,getNonEmptyElements:ie,getMoveCaretBeforeOnEnterElements:le,getWhitespaceElements:ye,getTransparentElements:sn,getSpecialElements:Et,isValidChild:fn,isValid:jt,isBlock:pt,isInline:St,isWrapper:on,getCustomElements:Os,addValidElements:P,setValidElements:z,addCustomElements:ae,addValidChildren:ge}},vR=e=>({value:ER(e)}),ER=e=>pg(e,"#").toUpperCase(),hu=e=>{const t=e.toString(16);return(t.length===1?"0"+t:t).toUpperCase()},SR=e=>{const t=hu(e.red)+hu(e.green)+hu(e.blue);return vR(t)},oh=/^\s*rgb\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*\)\s*$/i,rh=/^\s*rgba\s*\(\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*(\d+)\s*[,\s]\s*((?:\d?\.\d+|\d+)%?)\s*\)\s*$/i,wR=(e,t,n,s)=>({red:e,green:t,blue:n,alpha:s}),ah=(e,t,n,s)=>{const o=parseInt(e,10),r=parseInt(t,10),a=parseInt(n,10),i=parseFloat(s);return wR(o,r,a,i)},kR=e=>oh.test(e)?"rgb":rh.test(e)?"rgba":"other",ih=e=>{const t=oh.exec(e);if(t!==null)return m.some(ah(t[1],t[2],t[3],"1"));const n=rh.exec(e);return n!==null?m.some(ah(n[1],n[2],n[3],n[4])):m.none()},_R=e=>`rgba(${e.red},${e.green},${e.blue},${e.alpha})`,Gr=e=>ih(e).map(SR).map(t=>"#"+t.value).getOr(e),bu=(e={},t)=>{const n=/(?:url(?:(?:\(\s*\"([^\"]+)\"\s*\))|(?:\(\s*\'([^\']+)\'\s*\))|(?:\(\s*([^)\s]+)\s*\))))|(?:\'([^\']+)\')|(?:\"([^\"]+)\")/gi,s=/\s*([^:]+):\s*([^;]+);?/g,o=/\s+$/,r={};let a,i;const l=Rr;t&&(a=t.getValidStyles(),i=t.getInvalidStyles());const c=(`\\" \\' \\; \\: ; : `+l).split(" ");for(let f=0;f<c.length;f++)r[c[f]]=l+f,r[l+f]=c[f];const u={parse:f=>{const d={};let g=!1;const h=e.url_converter,p=e.url_converter_scope||u,b=(x,_,P)=>{const z=d[x+"-top"+_];if(!z)return;const X=d[x+"-right"+_];if(!X)return;const oe=d[x+"-bottom"+_];if(!oe)return;const ae=d[x+"-left"+_];if(!ae)return;const ge=[z,X,oe,ae];let ve=ge.length-1;for(;ve--&&ge[ve]===ge[ve+1];);ve>-1&&P||(d[x+_]=ve===-1?ge[0]:ge.join(" "),delete d[x+"-top"+_],delete d[x+"-right"+_],delete d[x+"-bottom"+_],delete d[x+"-left"+_])},y=x=>{const _=d[x];if(!_)return;const P=_.indexOf(",")>-1?[_]:_.split(" ");let z=P.length;for(;z--;)if(P[z]!==P[0])return!1;return d[x]=P[0],!0},v=(x,_,P,z)=>{y(_)&&y(P)&&y(z)&&(d[x]=d[_]+" "+d[P]+" "+d[z],delete d[_],delete d[P],delete d[z])},E=x=>(g=!0,r[x]),w=(x,_)=>(g&&(x=x.replace(/\uFEFF[0-9]/g,P=>r[P])),_||(x=x.replace(/\\([\'\";:])/g,"$1")),x),T=x=>String.fromCharCode(parseInt(x.slice(1),16)),B=x=>x.replace(/\\[0-9a-f]+/gi,T),H=(x,_,P,z,X,oe)=>{if(X=X||oe,X)return X=w(X),"'"+X.replace(/\'/g,"\\'")+"'";if(_=w(_||P||z||""),!e.allow_script_urls){const ae=_.replace(/[\s\r\n]+/g,"");if(/(java|vb)script:/i.test(ae)||!e.allow_svg_data_urls&&/^data:image\/svg/i.test(ae))return""}return h&&(_=h.call(p,_,"style")),"url('"+_.replace(/\'/g,"\\'")+"')"};if(f){f=f.replace(/[\u0000-\u001F]/g,""),f=f.replace(/\\[\"\';:\uFEFF]/g,E).replace(/\"[^\"]+\"|\'[^\']+\'/g,_=>_.replace(/[;:]/g,E));let x;for(;x=s.exec(f);){s.lastIndex=x.index+x[0].length;let _=x[1].replace(o,"").toLowerCase(),P=x[2].replace(o,"");if(_&&P){if(_=B(_),P=B(P),_.indexOf(l)!==-1||_.indexOf('"')!==-1||!e.allow_script_urls&&(_==="behavior"||/expression\s*\(|\/\*|\*\//.test(P)))continue;_==="font-weight"&&P==="700"?P="bold":(_==="color"||_==="background-color")&&(P=P.toLowerCase()),kR(P)==="rgb"&&ih(P).each(z=>{P=Gr(_R(z)).toLowerCase()}),P=P.replace(n,H),d[_]=g?w(P,!0):P}}b("border","",!0),b("border","-width"),b("border","-color"),b("border","-style"),b("padding",""),b("margin",""),v("border","border-width","border-style","border-color"),d.border==="medium none"&&delete d.border,d["border-image"]==="none"&&delete d["border-image"]}return d},serialize:(f,d)=>{let g="";const h=(b,y)=>{const v=y[b];if(v)for(let E=0,w=v.length;E<w;E++){const T=v[E],B=f[T];B&&(g+=(g.length>0?" ":"")+T+": "+B+";")}},p=(b,y)=>{if(!i||!y)return!0;let v=i["*"];return v&&v[b]?!1:(v=i[y],!(v&&v[b]))};return d&&a?(h("*",a),h(d,a)):Ae(f,(b,y)=>{b&&p(y,d)&&(g+=(g.length>0?" ":"")+y+": "+b+";")}),g}};return u},AR={keyLocation:!0,layerX:!0,layerY:!0,returnValue:!0,webkitMovementX:!0,webkitMovementY:!0,keyIdentifier:!0,mozPressure:!0},xR=e=>e instanceof Event||we(e.initEvent),NR=e=>e.isDefaultPrevented===Ue||e.isDefaultPrevented===Pe,RR=e=>Ve(e.preventDefault)||xR(e),lh=(e,t)=>{const n=t??{};for(const s in e)se(AR,s)||(n[s]=e[s]);return U(e.composedPath)&&(n.composedPath=()=>e.composedPath()),U(e.getModifierState)&&(n.getModifierState=s=>e.getModifierState(s)),U(e.getTargetRanges)&&(n.getTargetRanges=()=>e.getTargetRanges()),n},Cu=(e,t,n,s)=>{var o;const r=lh(t,s);return r.type=e,Ve(r.target)&&(r.target=(o=r.srcElement)!==null&&o!==void 0?o:n),RR(t)&&(r.preventDefault=()=>{r.defaultPrevented=!0,r.isDefaultPrevented=Ue,we(t.preventDefault)&&t.preventDefault()},r.stopPropagation=()=>{r.cancelBubble=!0,r.isPropagationStopped=Ue,we(t.stopPropagation)&&t.stopPropagation()},r.stopImmediatePropagation=()=>{r.isImmediatePropagationStopped=Ue,r.stopPropagation()},NR(r)||(r.isDefaultPrevented=r.defaultPrevented===!0?Ue:Pe,r.isPropagationStopped=r.cancelBubble===!0?Ue:Pe,r.isImmediatePropagationStopped=Pe)),r},TR="mce-data-",DR=/^(?:mouse|contextmenu)|click/,yu=(e,t,n,s)=>{e.addEventListener(t,n,s||!1)},Ri=(e,t,n,s)=>{e.removeEventListener(t,n,s||!1)},PR=e=>U(e)&&DR.test(e.type),Yr=(e,t)=>{const n=Cu(e.type,e,document,t);if(PR(e)&&st(e.pageX)&&!st(e.clientX)){const s=n.target.ownerDocument||document,o=s.documentElement,r=s.body,a=n;a.pageX=e.clientX+(o&&o.scrollLeft||r&&r.scrollLeft||0)-(o&&o.clientLeft||r&&r.clientLeft||0),a.pageY=e.clientY+(o&&o.scrollTop||r&&r.scrollTop||0)-(o&&o.clientTop||r&&r.clientTop||0)}return n},BR=(e,t,n)=>{const s=e.document,o={type:"ready"};if(n.domLoaded){t(o);return}const r=()=>s.readyState==="complete"||s.readyState==="interactive"&&s.body,a=()=>{Ri(e,"DOMContentLoaded",a),Ri(e,"load",a),n.domLoaded||(n.domLoaded=!0,t(o)),e=null};r()?a():yu(e,"DOMContentLoaded",a),n.domLoaded||yu(e,"load",a)};class Ys{constructor(){this.domLoaded=!1,this.events={},this.count=1,this.expando=TR+(+new Date).toString(32),this.hasFocusIn="onfocusin"in document.documentElement,this.count=1}bind(t,n,s,o){const r=this;let a;const i=window,l=d=>{r.executeHandlers(Yr(d||i.event),c)};if(!t||I(t)||ys(t))return s;let c;t[r.expando]?c=t[r.expando]:(c=r.count++,t[r.expando]=c,r.events[c]={}),o=o||t;const u=n.split(" ");let f=u.length;for(;f--;){let d=u[f],g=l,h=!1,p=!1;if(d==="DOMContentLoaded"&&(d="ready"),r.domLoaded&&d==="ready"&&t.readyState==="complete"){s.call(o,Yr({type:d}));continue}!r.hasFocusIn&&(d==="focusin"||d==="focusout")&&(h=!0,p=d==="focusin"?"focus":"blur",g=b=>{const y=Yr(b||i.event);y.type=y.type==="focus"?"focusin":"focusout",r.executeHandlers(y,c)}),a=r.events[c][d],a?d==="ready"&&r.domLoaded?s(Yr({type:d})):a.push({func:s,scope:o}):(r.events[c][d]=a=[{func:s,scope:o}],a.fakeName=p,a.capture=h,a.nativeHandler=g,d==="ready"?BR(t,g,r):yu(t,p||d,g,h))}return t=a=null,s}unbind(t,n,s){if(!t||I(t)||ys(t))return this;const o=t[this.expando];if(o){let r=this.events[o];if(n){const a=n.split(" ");let i=a.length;for(;i--;){const l=a[i],c=r[l];if(c){if(s){let u=c.length;for(;u--;)if(c[u].func===s){const f=c.nativeHandler,d=c.fakeName,g=c.capture,h=c.slice(0,u).concat(c.slice(u+1));h.nativeHandler=f,h.fakeName=d,h.capture=g,r[l]=h}}(!s||c.length===0)&&(delete r[l],Ri(t,c.fakeName||l,c.nativeHandler,c.capture))}}}else Ae(r,(a,i)=>{Ri(t,a.fakeName||i,a.nativeHandler,a.capture)}),r={};for(const a in r)if(se(r,a))return this;delete this.events[o];try{delete t[this.expando]}catch{t[this.expando]=null}}return this}fire(t,n,s){return this.dispatch(t,n,s)}dispatch(t,n,s){if(!t||I(t)||ys(t))return this;const o=Yr({type:n,target:t},s);do{const r=t[this.expando];r&&this.executeHandlers(o,r),t=t.parentNode||t.ownerDocument||t.defaultView||t.parentWindow}while(t&&!o.isPropagationStopped());return this}clean(t){if(!t||I(t)||ys(t))return this;if(t[this.expando]&&this.unbind(t),t.getElementsByTagName||(t=t.document),t&&t.getElementsByTagName){this.unbind(t);const n=t.getElementsByTagName("*");let s=n.length;for(;s--;)t=n[s],t[this.expando]&&this.unbind(t)}return this}destroy(){this.events={}}cancel(t){return t&&(t.preventDefault(),t.stopImmediatePropagation()),!1}executeHandlers(t,n){const s=this.events[n],o=s&&s[t.type];if(o)for(let r=0,a=o.length;r<a;r++){const i=o[r];if(i&&i.func.call(i.scope,t)===!1&&t.preventDefault(),t.isImmediatePropagationStopped())return}}}Ys.Event=new Ys;const vu=L.each,OR=L.grep,Eu="data-mce-style",IR=L.makeMap("fill-opacity font-weight line-height opacity orphans widows z-index zoom"," "),Xr=(e,t,n)=>{Ve(n)||n===""?rt(e,t):ot(e,t,n)},ch=e=>e.replace(/[A-Z]/g,t=>"-"+t.toLowerCase()),Lo=(e,t)=>{let n=0;if(e)for(let s=e.nodeType,o=e.previousSibling;o;o=o.previousSibling){const r=o.nodeType;t&&I(o)&&(r===s||!o.data.length)||(n++,s=r)}return n},uh=(e,t)=>{const n=zt(t,"style"),s=e.serialize(e.parse(n),be(t));Xr(t,Eu,s)},FR=(e,t)=>rn(e)?se(IR,t)?e+"":e+"px":e,fh=(e,t,n)=>{const s=ch(t);Ve(n)||n===""?gp(e,s):dp(e,s,FR(n,s))},LR=(e,t,n)=>{const s=t.keep_values,o={set:(a,i,l)=>{const c=C.fromDom(a);we(t.url_converter)&&U(i)&&(i=t.url_converter.call(t.url_converter_scope||n(),String(i),l,a));const u="data-mce-"+l;Xr(c,u,i),Xr(c,l,i)},get:(a,i)=>{const l=C.fromDom(a);return zt(l,"data-mce-"+i)||zt(l,i)}},r={style:{set:(a,i)=>{const l=C.fromDom(a);s&&Xr(l,Eu,i),rt(l,"style"),J(i)&&pi(l,e.parse(i))},get:a=>{const i=C.fromDom(a),l=zt(i,Eu)||zt(i,"style");return e.serialize(e.parse(l),be(i))}}};return s&&(r.href=r.src=o),r},_e=(e,t={})=>{const n={},s=window,o={};let r=0;const a=!0,i=!0,l=Vp.forElement(C.fromDom(e),{contentCssCors:t.contentCssCors,referrerPolicy:t.referrerPolicy}),c=[],u=t.schema?t.schema:vs({}),f=bu({url_converter:t.url_converter,url_converter_scope:t.url_converter_scope},t.schema),d=t.ownEvents?new Ys:Ys.Event,g=u.getBlockElements(),h=S=>J(S)?se(g,S):q(S)&&(se(g,S.nodeName)||qs(u,S)),p=S=>S&&e&&J(S)?e.getElementById(S):S,b=S=>{const k=p(S);return U(k)?C.fromDom(k):null},y=(S,k,$="")=>{let F;const ee=b(S);if(U(ee)&&Ut(ee)){const de=mc[k];de&&de.get?F=de.get(ee.dom,k):F=zt(ee,k)}return U(F)?F:$},v=S=>{const k=p(S);return Ve(k)?[]:k.attributes},E=(S,k,$)=>{Y(S,F=>{if(q(F)){const ee=C.fromDom(F),de=$===""?null:$,Le=zt(ee,k),xn=mc[k];xn&&xn.set?xn.set(ee.dom,de,k):Xr(ee,k,de),Le!==de&&t.onSetAttrib&&t.onSetAttrib({attrElm:ee.dom,attrName:k,attrValue:de})}})},w=(S,k)=>S.cloneNode(k),T=()=>t.root_element||e.body,B=S=>{const k=Zc(S);return{x:k.x,y:k.y,w:k.width,h:k.height}},H=(S,k)=>ZN(e.body,p(S),k),x=(S,k,$)=>{Y(S,F=>{const ee=C.fromDom(F);fh(ee,k,$),t.update_styles&&uh(f,ee)})},_=(S,k)=>{Y(S,$=>{const F=C.fromDom($);Ae(k,(ee,de)=>{fh(F,de,ee)}),t.update_styles&&uh(f,F)})},P=(S,k,$)=>{const F=p(S);if(!(Ve(F)||!Fn(F)&&!kN(F)))return $?In(C.fromDom(F),ch(k)):(k=k.replace(/-(\D)/g,(ee,de)=>de.toUpperCase()),k==="float"&&(k="cssFloat"),F.style?F.style[k]:void 0)},z=S=>{const k=p(S);if(!k)return{w:0,h:0};let $=P(k,"width"),F=P(k,"height");return(!$||$.indexOf("px")===-1)&&($="0"),(!F||F.indexOf("px")===-1)&&(F="0"),{w:parseInt($,10)||k.offsetWidth||k.clientWidth,h:parseInt(F,10)||k.offsetHeight||k.clientHeight}},X=S=>{const k=p(S),$=H(k),F=z(k);return{x:$.x,y:$.y,w:F.w,h:F.h}},oe=(S,k)=>{if(!S)return!1;const $=De(S)?S:[S];return Be($,F=>hn(C.fromDom(F),k))},ae=(S,k,$,F)=>{const ee=[];let de=p(S);F=F===void 0;const Le=$||(T().nodeName!=="BODY"?T().parentNode:null);if(J(k))if(k==="*")k=q;else{const xn=k;k=gn=>oe(gn,xn)}for(;de&&!(de===Le||Ve(de.nodeType)||qr(de)||Jc(de));){if(!k||k(de))if(F)ee.push(de);else return[de];de=de.parentNode}return F?ee:null},ge=(S,k,$)=>{const F=ae(S,k,$,!1);return F&&F.length>0?F[0]:null},ve=(S,k,$)=>{let F=k;if(S){J(k)&&(F=ee=>oe(ee,k));for(let ee=S[$];ee;ee=ee[$])if(we(F)&&F(ee))return ee}return null},$e=(S,k)=>ve(S,k,"nextSibling"),ze=(S,k)=>ve(S,k,"previousSibling"),Ke=S=>we(S.querySelectorAll),M=(S,k)=>{var $,F;const ee=(F=($=p(k))!==null&&$!==void 0?$:t.root_element)!==null&&F!==void 0?F:e;return Ke(ee)?Lt(ee.querySelectorAll(S)):[]},Y=function(S,k,$){const F=$??this;if(De(S)){const ee=[];return vu(S,(de,Le)=>{const xn=p(de);xn&&ee.push(k.call(F,xn,Le))}),ee}else{const ee=p(S);return ee?k.call(F,ee):!1}},me=(S,k)=>{Y(S,$=>{Ae(k,(F,ee)=>{E($,ee,F)})})},pe=(S,k)=>{Y(S,$=>{const F=C.fromDom($);gi(F,k)})},R=(S,k,$,F,ee)=>Y(S,de=>{const Le=J(k)?e.createElement(k):k;return U($)&&me(Le,$),F&&(!J(F)&&F.nodeType?Le.appendChild(F):J(F)&&pe(Le,F)),ee?Le:de.appendChild(Le)}),O=(S,k,$)=>R(e.createElement(S),S,k,$,!0),K=Gs.decode,ie=Gs.encodeAllRaw,le=(S,k,$="")=>{let F="<"+S;for(const ee in k)ko(k,ee)&&(F+=" "+ee+'="'+ie(k[ee])+'"');return Nr($)&&se(u.getVoidElements(),S)?F+" />":F+">"+$+"</"+S+">"},ye=S=>{const k=e.createElement("div"),$=e.createDocumentFragment();$.appendChild(k),S&&(k.innerHTML=S);let F;for(;F=k.firstChild;)$.appendChild(F);return $.removeChild(k),$},sn=(S,k)=>Y(S,$=>{const F=C.fromDom($);return k&&D(ct(F),ee=>{At(ee)&&ee.dom.length===0?Ne(ee):Dt(F,ee)}),Ne(F),F.dom}),Kn=S=>Y(S,k=>{const $=k.attributes;for(let F=$.length-1;F>=0;F--)k.removeAttributeNode($.item(F))}),Et=S=>f.parse(S),fn=(S,k)=>f.serialize(S,k),jt=S=>{if(Fs!==_e.DOM&&e===document){if(n[S])return;n[S]=!0}let k=e.getElementById("mceDefaultStyles");if(!k){k=e.createElement("style"),k.id="mceDefaultStyles",k.type="text/css";const $=e.head;$.firstChild?$.insertBefore(k,$.firstChild):$.appendChild(k)}k.styleSheet?k.styleSheet.cssText+=S:k.appendChild(e.createTextNode(S))},pt=S=>{S||(S=""),D(S.split(","),k=>{o[k]=!0,l.load(k).catch(ce)})},St=(S,k,$)=>{Y(S,F=>{if(q(F)){const ee=C.fromDom(F),de=k.split(" ");D(de,Le=>{U($)?($?Bo:jr)(ee,Le):Mx(ee,Le)})}})},on=(S,k)=>{St(S,k,!0)},Os=(S,k)=>{St(S,k,!1)},Q=(S,k)=>{const $=b(S),F=k.split(" ");return U($)&&Zn(F,ee=>Kc($,ee))},fe=S=>{Y(S,k=>gp(C.fromDom(k),"display"))},Fe=S=>{Y(S,k=>dp(C.fromDom(k),"display","none"))},He=S=>{const k=b(S);return U(k)&&_o(hi(k,"display"),"none")},Ge=S=>(S||"mce_")+r++,Me=S=>{const k=b(S);return U(k)?q(k.dom)?k.dom.outerHTML:_x(k):""},Re=(S,k)=>{Y(S,$=>{q($)&&($.outerHTML=k)})},Te=(S,k)=>{const $=p(k);return Y(S,F=>{const ee=$==null?void 0:$.parentNode,de=$==null?void 0:$.nextSibling;return ee&&(de?ee.insertBefore(F,de):ee.appendChild(F)),F})},wt=(S,k,$)=>Y(k,F=>{var ee;const de=De(k)?S.cloneNode(!0):S;return $&&vu(OR(F.childNodes),Le=>{de.appendChild(Le)}),(ee=F.parentNode)===null||ee===void 0||ee.replaceChild(de,F),F}),dn=(S,k)=>{if(S.nodeName!==k.toUpperCase()){const $=O(k);return vu(v(S),F=>{E($,F.nodeName,y(S,F.nodeName))}),wt($,S,!0),$}else return S},Gn=(S,k)=>{let $=S;for(;$;){let F=k;for(;F&&$!==F;)F=F.parentNode;if($===F)break;$=$.parentNode}return!$&&S.ownerDocument?S.ownerDocument.documentElement:$},An=(S,k,$)=>si(k)?rs(u,S,{...$,isContent:ee=>{const de=ee.nodeName.toLowerCase();return!!k[de]}}):rs(u,S,$),pr=()=>e.createRange(),hr=(S,k,$)=>{let F=pr(),ee,de;if(S&&k&&S.parentNode&&k.parentNode){const Le=S.parentNode;return F.setStart(Le,Lo(S)),F.setEnd(k.parentNode,Lo(k)),ee=F.extractContents(),F=pr(),F.setStart(k.parentNode,Lo(k)+1),F.setEnd(Le,Lo(S)+1),de=F.extractContents(),Le.insertBefore(uu(Fs,ee,u),S),$?Le.insertBefore($,S):Le.insertBefore(k,S),Le.insertBefore(uu(Fs,de,u),S),sn(S),$||k}else return},Eo=(S,k,$,F)=>{if(De(S)){let ee=S.length;const de=[];for(;ee--;)de[ee]=Eo(S[ee],k,$,F);return de}else return t.collect&&(S===e||S===s)&&c.push([S,k,$,F]),d.bind(S,k,$,F||Fs)},mn=(S,k,$)=>{if(De(S)){let F=S.length;const ee=[];for(;F--;)ee[F]=mn(S[F],k,$);return ee}else{if(c.length>0&&(S===e||S===s)){let F=c.length;for(;F--;){const[ee,de,Le]=c[F];S===ee&&(!k||k===de)&&(!$||$===Le)&&d.unbind(ee,de,Le)}}return d.unbind(S,k,$)}},Is=(S,k,$)=>d.dispatch(S,k,$),Za=(S,k,$)=>d.dispatch(S,k,$),br=S=>{if(S&&Fn(S)){const k=S.getAttribute("data-mce-contenteditable");return k&&k!=="inherit"?k:S.contentEditable!=="inherit"?S.contentEditable:null}else return null},Fs={doc:e,settings:t,win:s,files:o,stdMode:a,boxModel:i,styleSheetLoader:l,boundEvents:c,styles:f,schema:u,events:d,isBlock:h,root:null,clone:w,getRoot:T,getViewPort:B,getRect:X,getSize:z,getParent:ge,getParents:ae,get:p,getNext:$e,getPrev:ze,select:M,is:oe,add:R,create:O,createHTML:le,createFragment:ye,remove:sn,setStyle:x,getStyle:P,setStyles:_,removeAllAttribs:Kn,setAttrib:E,setAttribs:me,getAttrib:y,getPos:H,parseStyle:Et,serializeStyle:fn,addStyle:jt,loadCSS:pt,addClass:on,removeClass:Os,hasClass:Q,toggleClass:St,show:fe,hide:Fe,isHidden:He,uniqueId:Ge,setHTML:pe,getOuterHTML:Me,setOuterHTML:Re,decode:K,encode:ie,insertAfter:Te,replace:wt,rename:dn,findCommonAncestor:Gn,run:Y,getAttribs:v,isEmpty:An,createRng:pr,nodeIndex:Lo,split:hr,bind:Eo,unbind:mn,fire:Za,dispatch:Is,getContentEditable:br,getContentEditableParent:S=>{const k=T();let $=null;for(let F=S;F&&F!==k&&($=br(F),$===null);F=F.parentNode);return $},isEditable:S=>{if(U(S)){const k=q(S)?S:S.parentElement;return U(k)&&Fn(k)&&Cs(C.fromDom(k))}else return!1},destroy:()=>{if(c.length>0){let S=c.length;for(;S--;){const[k,$,F]=c[S];d.unbind(k,$,F)}}Ae(o,(S,k)=>{l.unload(k),delete o[k]})},isChildOf:(S,k)=>S===k||k.contains(S),dumpRng:S=>"startContainer: "+S.startContainer.nodeName+", startOffset: "+S.startOffset+", endContainer: "+S.endContainer.nodeName+", endOffset: "+S.endOffset},mc=LR(f,t,W(Fs));return Fs};_e.DOM=_e(document),_e.nodeIndex=Lo;const $R=_e.DOM,MR=0,UR=1,Ti=2,dh=3;class as{constructor(t={}){this.states={},this.queue=[],this.scriptLoadedCallbacks={},this.queueLoadedCallbacks=[],this.loading=!1,this.settings=t}_setReferrerPolicy(t){this.settings.referrerPolicy=t}loadScript(t){return new Promise((n,s)=>{const o=$R;let r;const a=()=>{o.remove(c),r&&(r.onerror=r.onload=r=null)},i=()=>{a(),n()},l=()=>{a(),s("Failed to load script: "+t)},c=o.uniqueId();r=document.createElement("script"),r.id=c,r.type="text/javascript",r.src=L._addCacheSuffix(t),this.settings.referrerPolicy&&o.setAttrib(r,"referrerpolicy",this.settings.referrerPolicy),r.onload=i,r.onerror=l,(document.getElementsByTagName("head")[0]||document.body).appendChild(r)})}isDone(t){return this.states[t]===Ti}markDone(t){this.states[t]=Ti}add(t){const n=this;return n.queue.push(t),n.states[t]===void 0&&(n.states[t]=MR),new Promise((o,r)=>{n.scriptLoadedCallbacks[t]||(n.scriptLoadedCallbacks[t]=[]),n.scriptLoadedCallbacks[t].push({resolve:o,reject:r})})}load(t){return this.add(t)}remove(t){delete this.states[t],delete this.scriptLoadedCallbacks[t]}loadQueue(){const t=this.queue;return this.queue=[],this.loadScripts(t)}loadScripts(t){const n=this,s=(l,c)=>{Oe(n.scriptLoadedCallbacks,c).each(u=>{D(u,f=>f[l](c))}),delete n.scriptLoadedCallbacks[c]},o=l=>{const c=ne(l,u=>u.status==="rejected");return c.length>0?Promise.reject(Kt(c,({reason:u})=>De(u)?u:[u])):Promise.resolve()},r=l=>Promise.allSettled(he(l,c=>n.states[c]===Ti?(s("resolve",c),Promise.resolve()):n.states[c]===dh?(s("reject",c),Promise.reject(c)):(n.states[c]=UR,n.loadScript(c).then(()=>{n.states[c]=Ti,s("resolve",c);const u=n.queue;return u.length>0?(n.queue=[],r(u).then(o)):Promise.resolve()},()=>(n.states[c]=dh,s("reject",c),Promise.reject(c)))))),a=l=>(n.loading=!0,r(l).then(c=>{n.loading=!1;const u=n.queueLoadedCallbacks.shift();return m.from(u).each(Er),o(c)})),i=bg(t);return n.loading?new Promise((l,c)=>{n.queueLoadedCallbacks.push(()=>{a(i).then(l,c)})}):a(i)}}as.ScriptLoader=new as;const zR=(e,t)=>{const n=e.indexOf(t);return n!==-1&&e.indexOf(t,n+1)>n},HR=e=>nt(e)&&se(e,"raw"),WR=e=>De(e)&&e.length>1,Zr={},Su=et("en"),mh=()=>Oe(Zr,Su.get()),vn={getData:()=>ri(Zr,e=>({...e})),setCode:e=>{e&&Su.set(e)},getCode:()=>Su.get(),add:(e,t)=>{let n=Zr[e];n||(Zr[e]=n={});const s=he($t(t),o=>o.toLowerCase());Ae(t,(o,r)=>{const a=r.toLowerCase();a!==r&&zR(s,a)?(se(t,a)||(n[a]=o),n[r]=o):n[a]=o})},translate:e=>{const t=mh().getOr({}),n=a=>we(a)?Object.prototype.toString.call(a):s(a)?"":""+a,s=a=>a===""||a===null||a===void 0,o=a=>{const i=n(a);return se(t,i)?n(t[i]):Oe(t,i.toLowerCase()).map(n).getOr(i)},r=a=>a.replace(/{context:\w+}$/,"");if(s(e))return"";if(HR(e))return n(e.raw);if(WR(e)){const a=e.slice(1),i=o(e[0]).replace(/\{([0-9]+)\}/g,(l,c)=>se(a,c)?n(a[c]):l);return r(i)}return r(o(e))},isRtl:()=>mh().bind(e=>Oe(e,"_dir")).exists(e=>e==="rtl"),hasCode:e=>se(Zr,e)},Ct=()=>{const e=[],t={},n={},s=[],o=(p,b)=>{const y=ne(s,v=>v.name===p&&v.state===b);D(y,v=>v.resolve())},r=p=>se(t,p),a=p=>se(n,p),i=p=>{if(n[p])return n[p].instance},l=(p,b)=>{const y=vn.getCode(),v=","+(b||"")+",";!y||b&&v.indexOf(","+y+",")===-1||as.ScriptLoader.add(t[p]+"/langs/"+y+".js")},c=(p,b)=>{Ct.languageLoad!==!1&&(r(p)?l(p,b):h(p,"loaded").then(()=>l(p,b)))},u=(p,b)=>(e.push(b),n[p]={instance:b},o(p,"added"),b),f=p=>{delete t[p],delete n[p]},d=(p,b)=>J(b)?J(p)?{prefix:"",resource:b,suffix:""}:{prefix:p.prefix,resource:b,suffix:p.suffix}:b,g=(p,b)=>{if(t[p])return Promise.resolve();let y=J(b)?b:b.prefix+b.resource+b.suffix;y.indexOf("/")!==0&&y.indexOf("://")===-1&&(y=Ct.baseURL+"/"+y),t[p]=y.substring(0,y.lastIndexOf("/"));const v=()=>(o(p,"loaded"),Promise.resolve());return n[p]?v():as.ScriptLoader.add(y).then(v)},h=(p,b="added")=>b==="added"&&a(p)||b==="loaded"&&r(p)?Promise.resolve():new Promise(y=>{s.push({name:p,state:b,resolve:y})});return{items:e,urls:t,lookup:n,get:i,requireLangPack:c,add:u,remove:f,createUrl:d,load:g,waitFor:h}};Ct.languageLoad=!0,Ct.baseURL="",Ct.PluginManager=Ct(),Ct.ThemeManager=Ct(),Ct.ModelManager=Ct();const Qr=W("mce-annotation"),Xs=W("data-mce-annotation"),$o=W("data-mce-annotation-uid"),Jr=W("data-mce-annotation-active"),ea=W("data-mce-annotation-classes"),ta=W("data-mce-annotation-attrs"),gh=e=>t=>Ee(t,e),ph=(e,t)=>{const n=e.selection.getRng(),s=C.fromDom(n.startContainer),o=C.fromDom(e.getBody()),r=t.fold(()=>"."+Qr(),l=>`[${Xs()}="${l}"]`),a=No(s,n.startOffset).getOr(s);return Po(a,r,gh(o)).bind(l=>ns(l,`${$o()}`).bind(c=>ns(l,`${Xs()}`).map(u=>{const f=bh(e,c);return{uid:c,name:u,elements:f}})))},VR=e=>Ut(e)&&Kc(e,Qr()),hh=(e,t)=>Ur(e,"data-mce-bogus")||qx(e,'[data-mce-bogus="all"]',gh(t)),bh=(e,t)=>{const n=C.fromDom(e.getBody()),s=ut(n,`[${$o()}="${t}"]`);return ne(s,o=>!hh(o,n))},Ch=(e,t)=>{const n=C.fromDom(e.getBody()),s=ut(n,`[${Xs()}="${t}"]`),o={};return D(s,r=>{if(!hh(r,n)){const a=zt(r,$o()),i=Oe(o,a).getOr([]);o[a]=i.concat([r])}}),o},jR=(e,t)=>{const n=et({}),s=()=>({listeners:[],previous:Qn()}),o=(f,d)=>{r(f,g=>(d(g),g))},r=(f,d)=>{const g=n.get(),h=Oe(g,f).getOrThunk(s),p=d(h);g[f]=p,n.set(g)},a=(f,d,g)=>{o(f,h=>{D(h.listeners,p=>p(!0,f,{uid:d,nodes:he(g,b=>b.dom)}))})},i=f=>{o(f,d=>{D(d.listeners,g=>g(!1,f))})},l=(f,d)=>{D(bh(e,f),g=>{d?ot(g,Jr(),"true"):rt(g,Jr())})},c=kc(()=>{const f=$s(t.getNames());D(f,d=>{r(d,g=>{const h=g.previous.get();return ph(e,m.some(d)).fold(()=>{h.each(p=>{i(d),g.previous.clear(),l(p,!1)})},({uid:p,name:b,elements:y})=>{_o(h,p)||(h.each(v=>l(v,!1)),a(b,p,y),g.previous.set(p),l(p,!0))}),{previous:g.previous,listeners:g.listeners}})})},30);return e.on("remove",()=>{c.cancel()}),e.on("NodeChange",()=>{c.throttle()}),{addListener:(f,d)=>{r(f,g=>({previous:g.previous,listeners:g.listeners.concat([d])}))}}},qR=(e,t)=>{const n=Xs(),s=r=>m.from(r.attr(n)).bind(t.lookup),o=r=>{var a,i;r.attr($o(),null),r.attr(Xs(),null),r.attr(Jr(),null);const l=m.from(r.attr(ta())).map(d=>d.split(",")).getOr([]),c=m.from(r.attr(ea())).map(d=>d.split(",")).getOr([]);D(l,d=>r.attr(d,null));const u=(i=(a=r.attr("class"))===null||a===void 0?void 0:a.split(" "))!==null&&i!==void 0?i:[],f=oi(u,[Qr()].concat(c));r.attr("class",f.length>0?f.join(" "):null),r.attr(ea(),null),r.attr(ta(),null)};e.serializer.addTempAttr(Jr()),e.serializer.addAttributeFilter(n,r=>{for(const a of r)s(a).each(i=>{i.persistent===!1&&(a.name==="span"?a.unwrap():o(a))})})},KR=()=>{const e={};return{register:(o,r)=>{e[o]={name:o,settings:r}},lookup:o=>Oe(e,o).map(r=>r.settings),getNames:()=>$t(e)}},yh=(e,t,n=Pe)=>{const s=new tt(e,t),o=r=>{let a;do a=s[r]();while(a&&!I(a)&&!n(a));return m.from(a).filter(I)};return{current:()=>m.from(s.current()).filter(I),next:()=>o("next"),prev:()=>o("prev"),prev2:()=>o("prev2")}},Zs=(e,t)=>{const n=t||(a=>e.isBlock(a)||Ie(a)||xe(a)),s=(a,i,l,c)=>{if(I(a)){const u=c(a,i,a.data);if(u!==-1)return m.some({container:a,offset:u})}return l().bind(u=>s(u.container,u.offset,l,c))};return{backwards:(a,i,l,c)=>{const u=yh(a,c??e.getRoot(),n);return s(a,i,()=>u.prev().map(f=>({container:f,offset:f.length})),l).getOrNull()},forwards:(a,i,l,c)=>{const u=yh(a,c??e.getRoot(),n);return s(a,i,()=>u.next().map(f=>({container:f,offset:0})),l).getOrNull()}}},GR=["td","th"],YR=["thead","tbody","tfoot"],XR=["h1","h2","h3","h4","h5","h6","p","div","address","pre","form","blockquote","center","dir","fieldset","header","footer","article","section","hgroup","aside","nav","figure"],ZR=["li","dd","dt"],QR=["ul","ol","dl"],JR=["pre","script","textarea","style"],Mo=e=>{let t;return n=>(t=t||yc(e,Ue),se(t,be(n)))},eT=e=>be(e)==="table",Qs=e=>Ut(e)&&be(e)==="br",vh=Mo(XR),wu=Mo(QR),Uo=Mo(ZR),tT=Mo(YR),na=Mo(GR),Di=Mo(JR),nT=e=>{const t=[];let n=e.dom;for(;n;)t.push(C.fromDom(n)),n=n.lastChild;return t},sT=e=>{const t=ut(e,"br"),n=ne(nT(e).slice(-1),Qs);t.length===n.length&&D(n,Ne)},zo=()=>{const e=C.fromTag("br");return ot(e,"data-mce-bogus","1"),e},Es=e=>{Ro(e),je(e,zo())},oT=(e,t)=>{Bc(e).each(n=>{gs(n).each(s=>{t.isBlock(be(e))&&Qs(n)&&t.isBlock(be(s))&&Ne(n)})})},Qe=Rr,Pi=_c,Ht=hA,rT=e=>e.insertContent(Qe,{preserve_zwsp:!0}),aT=q,Ho=I,Wo=e=>(Ho(e)&&(e=e.parentNode),aT(e)&&e.hasAttribute("data-mce-caret")),Ss=e=>Ho(e)&&Pi(e.data),Gt=e=>Wo(e)||Ss(e),Eh=e=>e.firstChild!==e.lastChild||!Ie(e.firstChild),iT=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Qe),r=e.parentNode;if(t){const a=e.previousSibling;if(Ho(a)){if(Gt(a))return a;if(Oi(a))return a.splitText(a.data.length-1)}r==null||r.insertBefore(o,e)}else{const a=e.nextSibling;if(Ho(a)){if(Gt(a))return a;if(Bi(a))return a.splitText(1),a}e.nextSibling?r==null||r.insertBefore(o,e.nextSibling):r==null||r.appendChild(o)}return o},ku=e=>{const t=e.container();return I(t)?t.data.charAt(e.offset())===Qe||e.isAtStart()&&Ss(t.previousSibling):!1},_u=e=>{const t=e.container();return I(t)?t.data.charAt(e.offset()-1)===Qe||e.isAtEnd()&&Ss(t.nextSibling):!1},lT=(e,t,n)=>{var s;const r=((s=t.ownerDocument)!==null&&s!==void 0?s:document).createElement(e);r.setAttribute("data-mce-caret",n?"before":"after"),r.setAttribute("data-mce-bogus","all"),r.appendChild(zo().dom);const a=t.parentNode;return n?a==null||a.insertBefore(r,t):t.nextSibling?a==null||a.insertBefore(r,t.nextSibling):a==null||a.appendChild(r),r},Bi=e=>Ho(e)&&e.data[0]===Qe,Oi=e=>Ho(e)&&e.data[e.data.length-1]===Qe,cT=e=>{var t;const n=e.getElementsByTagName("br"),s=n[n.length-1];Vs(s)&&((t=s.parentNode)===null||t===void 0||t.removeChild(s))},Au=e=>e&&e.hasAttribute("data-mce-caret")?(cT(e),e.removeAttribute("data-mce-caret"),e.removeAttribute("data-mce-bogus"),e.removeAttribute("style"),e.removeAttribute("data-mce-style"),e.removeAttribute("_moz_abspos"),e):null,Sh=e=>Wo(e.startContainer),Vo=Math.round,Js=e=>e?{left:Vo(e.left),top:Vo(e.top),bottom:Vo(e.bottom),right:Vo(e.right),width:Vo(e.width),height:Vo(e.height)}:{left:0,top:0,bottom:0,right:0,width:0,height:0},wh=(e,t)=>(e=Js(e),t||(e.left=e.left+e.width),e.right=e.left,e.width=0,e),uT=(e,t)=>e.left===t.left&&e.top===t.top&&e.bottom===t.bottom&&e.right===t.right,kh=(e,t,n)=>e>=0&&e<=Math.min(t.height,n.height)/2,sa=(e,t)=>{const n=Math.min(t.height/2,e.height/2);return e.bottom-n<t.top?!0:e.top>t.bottom?!1:kh(t.top-e.bottom,e,t)},oa=(e,t)=>e.top>t.bottom?!0:e.bottom<t.top?!1:kh(t.bottom-e.top,e,t),fT=(e,t,n)=>t>=e.left&&t<=e.right&&n>=e.top&&n<=e.bottom,dT=e=>Tt(e,(t,n)=>t.fold(()=>m.some(n),s=>{const o=Math.min(n.left,s.left),r=Math.min(n.top,s.top),a=Math.max(n.right,s.right),i=Math.max(n.bottom,s.bottom);return m.some({top:r,right:a,bottom:i,left:o,width:a-o,height:i-r})}),m.none()),_h=(e,t,n)=>{const s=Math.max(Math.min(t,e.left+e.width),e.left),o=Math.max(Math.min(n,e.top+e.height),e.top);return Math.sqrt((t-s)*(t-s)+(n-o)*(n-o))},mT=(e,t)=>Math.max(0,Math.min(e.bottom,t.bottom)-Math.max(e.top,t.top)),Ii=e=>{const t=e.startContainer,n=e.startOffset;return t===e.endContainer&&t.hasChildNodes()&&e.endOffset===n+1?t.childNodes[n]:null},ws=(e,t)=>{if(q(e)&&e.hasChildNodes()){const n=e.childNodes,s=oA(t,0,n.length-1);return n[s]}else return e},gT=(e,t)=>{if(!(t<0&&q(e)&&e.hasChildNodes()))return ws(e,t)},pT=new RegExp("[̀-ͯ҃-҇҈-҉֑-ֽֿׁ-ׂׄ-ׇׅؐ-ًؚ-ٰٟۖ-ۜ۟-ۤۧ-۪ۨ-ܑۭܰ-݊ަ-ް߫-߳ࠖ-࠙ࠛ-ࠣࠥ-ࠧࠩ-࡙࠭-࡛ࣣ-ंऺ़ु-ै्॑-ॗॢ-ॣঁ়াু-ৄ্ৗৢ-ৣਁ-ਂ਼ੁ-ੂੇ-ੈੋ-੍ੑੰ-ੱੵઁ-ં઼ુ-ૅે-ૈ્ૢ-ૣଁ଼ାିୁ-ୄ୍ୖୗୢ-ୣஂாீ்ௗఀా-ీె-ైొ-్ౕ-ౖౢ-ౣಁ಼ಿೂೆೌ-್ೕ-ೖೢ-ೣഁാു-ൄ്ൗൢ-ൣ්ාි-ුූෟัิ-ฺ็-๎ັິ-ູົ-ຼ່-ໍ༘-ཱ༹༙༵༷-ཾྀ-྄྆-྇ྍ-ྗྙ-ྼ࿆ိ-ူဲ-့္-်ွ-ှၘ-ၙၞ-ၠၱ-ၴႂႅ-ႆႍႝ፝-፟ᜒ-᜔ᜲ-᜴ᝒ-ᝓᝲ-ᝳ឴-឵ិ-ួំ៉-៓៝᠋-᠍ᢩᤠ-ᤢᤧ-ᤨᤲ᤹-᤻ᨗ-ᨘᨛᩖᩘ-ᩞ᩠ᩢᩥ-ᩬᩳ-᩿᩼᪰-᪽᪾ᬀ-ᬃ᬴ᬶ-ᬺᬼᭂ᭫-᭳ᮀ-ᮁᮢ-ᮥᮨ-ᮩ᮫-ᮭ᯦ᯨ-ᯩᯭᯯ-ᯱᰬ-ᰳᰶ-᰷᳐-᳔᳒-᳢᳠-᳨᳭᳴᳸-᳹᷀-᷵᷼-᷿‌-‍⃐-⃜⃝-⃠⃡⃢-⃤⃥-⃰⳯-⵿⳱ⷠ-〪ⷿ-〭〮-゙〯-゚꙯꙰-꙲ꙴ-꙽ꚞ-ꚟ꛰-꛱ꠂ꠆ꠋꠥ-ꠦ꣄꣠-꣱ꤦ-꤭ꥇ-ꥑꦀ-ꦂ꦳ꦶ-ꦹꦼꧥꨩ-ꨮꨱ-ꨲꨵ-ꨶꩃꩌꩼꪰꪲ-ꪴꪷ-ꪸꪾ-꪿꫁ꫬ-ꫭ꫶ꯥꯨ꯭ﬞ︀-️︠-︯ﾞ-ﾟ]"),Ah=e=>J(e)&&e.charCodeAt(0)>=768&&pT.test(e),hT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(e[n](t))return!0;return!1},bT=(...e)=>t=>{for(let n=0;n<e.length;n++)if(!e[n](t))return!1;return!0},xh=an,CT=xe,yT=Ie,vT=I,ET=Cn(["script","style","textarea"]),Nh=Cn(["img","input","textarea","hr","iframe","video","audio","object","embed"]),ST=Cn(["table"]),wT=Gt,En=e=>wT(e)?!1:vT(e)?!ET(e.parentNode):Nh(e)||yT(e)||ST(e)||xu(e),kT=e=>q(e)&&e.getAttribute("unselectable")==="true",xu=e=>!kT(e)&&CT(e),_T=(e,t)=>{for(let n=e.parentNode;n&&n!==t;n=n.parentNode){if(xu(n))return!1;if(xh(n))return!0}return!0},AT=e=>xu(e)?!Tt(Lt(e.getElementsByTagName("*")),(t,n)=>t||xh(n),!1):!1,xT=e=>Nh(e)||AT(e),Rh=(e,t)=>En(e)&&_T(e,t),Th=q,NT=En,Dh=wi("display","block table"),RT=wi("float","left right"),ra=bT(Th,NT,vr(RT)),TT=vr(wi("white-space","pre pre-line pre-wrap")),aa=I,Nu=Ie,Ph=_e.nodeIndex,Fi=gT,Ru=e=>e?e.createRange():_e.DOM.createRng(),Tu=e=>J(e)&&/[\r\n\t ]/.test(e),Bh=e=>!!e.setStart&&!!e.setEnd,Du=e=>{const t=e.startContainer,n=e.startOffset;if(Tu(e.toString())&&TT(t.parentNode)&&I(t)){const s=t.data;if(Tu(s[n-1])||Tu(s[n+1]))return!0}return!1},DT=e=>{const t=e.ownerDocument,n=Ru(t),s=t.createTextNode(Ze),o=e.parentNode;o.insertBefore(s,e),n.setStart(s,0),n.setEnd(s,1);const r=Js(n.getBoundingClientRect());return o.removeChild(s),r},PT=e=>{const t=e.startContainer,n=e.endContainer,s=e.startOffset,o=e.endOffset;if(t===n&&I(n)&&s===0&&o===1){const r=e.cloneRange();return r.setEndAfter(n),ks(r)}else return null},Oh=e=>e.left===0&&e.right===0&&e.top===0&&e.bottom===0,ks=e=>{var t;let n;const s=e.getClientRects();return s.length>0?n=Js(s[0]):n=Js(e.getBoundingClientRect()),!Bh(e)&&Nu(e)&&Oh(n)?DT(e):Oh(n)&&Bh(e)&&(t=PT(e))!==null&&t!==void 0?t:n},eo=(e,t)=>{const n=wh(e,t);return n.width=1,n.right=n.left+1,n},BT=e=>{const t=[],n=a=>{a.height!==0&&(t.length>0&&uT(a,t[t.length-1])||t.push(a))},s=(a,i)=>{const l=Ru(a.ownerDocument);if(i<a.data.length){if(Ah(a.data[i]))return;if(Ah(a.data[i-1])&&(l.setStart(a,i),l.setEnd(a,i+1),!Du(l))){n(eo(ks(l),!1));return}}i>0&&(l.setStart(a,i-1),l.setEnd(a,i),Du(l)||n(eo(ks(l),!1))),i<a.data.length&&(l.setStart(a,i),l.setEnd(a,i+1),Du(l)||n(eo(ks(l),!0)))},o=e.container(),r=e.offset();if(aa(o))return s(o,r),t;if(Th(o))if(e.isAtEnd()){const a=Fi(o,r);aa(a)&&s(a,a.data.length),ra(a)&&!Nu(a)&&n(eo(ks(a),!1))}else{const a=Fi(o,r);if(aa(a)&&s(a,0),ra(a)&&e.isAtEnd())return n(eo(ks(a),!1)),t;const i=Fi(e.container(),e.offset()-1);ra(i)&&!Nu(i)&&(Dh(i)||Dh(a)||!ra(a))&&n(eo(ks(i),!1)),ra(a)&&n(eo(ks(a),!0))}return t},N=(e,t,n)=>{const s=()=>(aa(e),t===0),o=()=>aa(e)?t>=e.data.length:t>=e.childNodes.length,r=()=>{const u=Ru(e.ownerDocument);return u.setStart(e,t),u.setEnd(e,t),u},a=()=>(n||(n=BT(N(e,t))),n),i=()=>a().length>0,l=u=>u&&e===u.container()&&t===u.offset(),c=u=>Fi(e,u?t-1:t);return{container:W(e),offset:W(t),toRange:r,getClientRects:a,isVisible:i,isAtStart:s,isAtEnd:o,isEqual:l,getNode:c}};N.fromRangeStart=e=>N(e.startContainer,e.startOffset),N.fromRangeEnd=e=>N(e.endContainer,e.endOffset),N.after=e=>N(e.parentNode,Ph(e)+1),N.before=e=>N(e.parentNode,Ph(e)),N.isAbove=(e,t)=>at(_t(t.getClientRects()),ds(e.getClientRects()),sa).getOr(!1),N.isBelow=(e,t)=>at(ds(t.getClientRects()),_t(e.getClientRects()),oa).getOr(!1),N.isAtStart=e=>e?e.isAtStart():!1,N.isAtEnd=e=>e?e.isAtEnd():!1,N.isTextPosition=e=>e?I(e.container()):!1,N.isElementPosition=e=>!N.isTextPosition(e);const Li=(e,t)=>{I(t)&&t.data.length===0&&e.remove(t)},OT=(e,t,n)=>{t.insertNode(n),Li(e,n.previousSibling),Li(e,n.nextSibling)},IT=(e,t,n)=>{const s=m.from(n.firstChild),o=m.from(n.lastChild);t.insertNode(n),s.each(r=>Li(e,r.previousSibling)),o.each(r=>Li(e,r.nextSibling))},Pu=(e,t,n)=>{Jc(n)?IT(e,t,n):OT(e,t,n)},Sn=I,Ih=Vs,Fh=_e.nodeIndex,Lh=e=>{const t=e.parentNode;return Ih(t)?Lh(t):t},Bu=e=>e?fi(e.childNodes,(t,n)=>(Ih(n)&&n.nodeName!=="BR"?t=t.concat(Bu(n)):t.push(n),t),[]):[],FT=(e,t)=>{let n=e;for(;(n=n.previousSibling)&&Sn(n);)t+=n.data.length;return t},$h=e=>t=>e===t,LT=e=>{let t,n;t=Bu(Lh(e)),n=yg(t,$h(e),e),t=t.slice(0,n+1);const s=fi(t,(o,r,a)=>(Sn(r)&&Sn(t[a-1])&&o++,o),0);return t=Tr(t,Cn([e.nodeName])),n=yg(t,$h(e),e),n-s},Mh=e=>(Sn(e)?"text()":e.nodeName.toLowerCase())+"["+LT(e)+"]",$T=(e,t,n)=>{const s=[];for(let o=t.parentNode;o&&o!==e&&!(n&&n(o));o=o.parentNode)s.push(o);return s},Uh=(e,t)=>{let n=[],s=t.container(),o=t.offset(),r;if(Sn(s))r=FT(s,o);else{const i=s.childNodes;o>=i.length?(r="after",o=i.length-1):r="before",s=i[o]}n.push(Mh(s));let a=$T(e,s);return a=Tr(a,vr(Vs)),n=n.concat(xc(a,i=>Mh(i))),n.reverse().join("/")+","+r},MT=(e,t,n)=>{let s=Bu(e);return s=Tr(s,(o,r)=>!Sn(o)||!Sn(s[r-1])),s=Tr(s,Cn([t])),s[n]},UT=(e,t)=>{let n=e,s=0;for(;Sn(n);){const o=n.data.length;if(t>=s&&t<=s+o){e=n,t=t-s;break}if(!Sn(n.nextSibling)){e=n,t=o;break}s+=o,n=n.nextSibling}return Sn(e)&&t>e.data.length&&(t=e.data.length),N(e,t)},zh=(e,t)=>{if(!t)return null;const n=t.split(","),s=n[0].split("/"),o=n.length>1?n[1]:"before",r=fi(s,(a,i)=>{const l=/([\w\-\(\)]+)\[([0-9]+)\]/.exec(i);return l?(l[1]==="text()"&&(l[1]="#text"),MT(a,l[1],parseInt(l[2],10))):null},e);if(!r)return null;if(!Sn(r)&&r.parentNode){let a;return o==="after"?a=Fh(r)+1:a=Fh(r),N(r.parentNode,a)}return UT(r,parseInt(o,10))},$i=xe,zT=(e,t,n)=>{let s=e(t.data.slice(0,n)).length;for(let o=t.previousSibling;o&&I(o);o=o.previousSibling)s+=e(o.data).length;return s},Hh=(e,t,n,s,o)=>{const r=o?s.startContainer:s.endContainer;let a=o?s.startOffset:s.endOffset;const i=[],l=e.getRoot();if(I(r))i.push(n?zT(t,r,a):a);else{let c=0;const u=r.childNodes;a>=u.length&&u.length&&(c=1,a=Math.max(0,u.length-1)),i.push(e.nodeIndex(u[a],n)+c)}for(let c=r;c&&c!==l;c=c.parentNode)i.push(e.nodeIndex(c,n));return i},HT=(e,t,n,s)=>{const o=t.dom,r=Hh(o,e,n,s,!0),a=t.isForward(),i=Sh(s)?{isFakeCaret:!0}:{};if(t.isCollapsed())return{start:r,forward:a,...i};{const l=Hh(o,e,n,s,!1);return{start:r,end:l,forward:a,...i}}},Ou=(e,t,n)=>{let s=0;return L.each(e.select(t),o=>{if(o.getAttribute("data-mce-bogus")!=="all"){if(o===n)return!1;s++;return}}),s},Wh=(e,t)=>{let n=t?e.startContainer:e.endContainer,s=t?e.startOffset:e.endOffset;if(q(n)&&n.nodeName==="TR"){const o=n.childNodes;n=o[Math.min(t?s:s-1,o.length-1)],n&&(s=t?0:n.childNodes.length,t?e.setStart(n,s):e.setEnd(n,s))}},Vh=e=>(Wh(e,!0),Wh(e,!1),e),jh=(e,t)=>{if(q(e)&&(e=ws(e,t),$i(e)))return e;if(Gt(e)){I(e)&&Wo(e)&&(e=e.parentNode);let n=e.previousSibling;if($i(n)||(n=e.nextSibling,$i(n)))return n}},WT=e=>jh(e.startContainer,e.startOffset)||jh(e.endContainer,e.endOffset),qh=(e,t,n)=>{const s=n.getNode(),o=n.getRng();if(s.nodeName==="IMG"||$i(s)){const a=s.nodeName;return{name:a,index:Ou(n.dom,a,s)}}const r=WT(o);if(r){const a=r.tagName;return{name:a,index:Ou(n.dom,a,r)}}return HT(e,n,t,o)},VT=e=>{const t=e.getRng();return{start:Uh(e.dom.getRoot(),N.fromRangeStart(t)),end:Uh(e.dom.getRoot(),N.fromRangeEnd(t)),forward:e.isForward()}},jT=e=>({rng:e.getRng(),forward:e.isForward()}),Kh=(e,t,n)=>{const s={"data-mce-type":"bookmark",id:t,style:"overflow:hidden;line-height:0px"};return n?e.create("span",s,"&#xFEFF;"):e.create("span",s)},Gh=(e,t)=>{const n=e.dom;let s=e.getRng();const o=n.uniqueId(),r=e.isCollapsed(),a=e.getNode(),i=a.nodeName,l=e.isForward();if(i==="IMG")return{name:i,index:Ou(n,i,a)};const c=Vh(s.cloneRange());if(!r){c.collapse(!1);const f=Kh(n,o+"_end",t);Pu(n,c,f)}s=Vh(s),s.collapse(!0);const u=Kh(n,o+"_start",t);return Pu(n,s,u),e.moveToBookmark({id:o,keep:!0,forward:l}),{id:o,forward:l}},qT=(e,t,n=!1)=>t===2?qh(Ht,n,e):t===3?VT(e):t?jT(e):Gh(e,!1),Iu=G(qh,Ft,!0),KT=e=>e.type==="inline-command"||e.type==="inline-format",GT=e=>e.type==="block-command"||e.type==="block-format",YT=(e,t)=>(e.type==="block-command"||e.type==="block-format")&&e.trigger===t,XT=e=>{var t;const n=o=>Mt.error({message:o,pattern:e}),s=(o,r,a)=>{if(e.format!==void 0){let i;if(De(e.format)){if(!Zn(e.format,J))return n(o+" pattern has non-string items in the `format` array");i=e.format}else if(J(e.format))i=[e.format];else return n(o+" pattern has non-string `format` parameter");return Mt.value(r(i))}else return e.cmd!==void 0?J(e.cmd)?Mt.value(a(e.cmd,e.value)):n(o+" pattern has non-string `cmd` parameter"):n(o+" pattern is missing both `format` and `cmd` parameters")};if(!nt(e))return n("Raw pattern is not an object");if(!J(e.start))return n("Raw pattern is missing `start` parameter");if(e.end!==void 0){if(!J(e.end))return n("Inline pattern has non-string `end` parameter");if(e.start.length===0&&e.end.length===0)return n("Inline pattern has empty `start` and `end` parameters");let o=e.start,r=e.end;return r.length===0&&(r=o,o=""),s("Inline",a=>({type:"inline-format",start:o,end:r,format:a}),(a,i)=>({type:"inline-command",start:o,end:r,cmd:a,value:i}))}else{if(e.replacement!==void 0)return J(e.replacement)?e.start.length===0?n("Replacement pattern has empty `start` parameter"):Mt.value({type:"inline-command",start:"",end:e.start,cmd:"mceInsertContent",value:e.replacement}):n("Replacement pattern has non-string `replacement` parameter");{const o=(t=e.trigger)!==null&&t!==void 0?t:"space";return e.start.length===0?n("Block pattern has empty `start` parameter"):s("Block",r=>({type:"block-format",start:e.start,format:r[0],trigger:o}),(r,a)=>({type:"block-command",start:e.start,cmd:r,value:a,trigger:o}))}}},Yh=e=>ne(e,GT),Xh=e=>ne(e,KT),ZT=(e,t)=>({inlinePatterns:Xh(e),blockPatterns:Yh(e),dynamicPatternsLookup:t}),Fu=(e,t)=>({...e,blockPatterns:ne(e.blockPatterns,n=>YT(n,t))}),Zh=e=>{const t=uA(he(e,XT));return D(t.errors,n=>console.error(n.message,n.pattern)),t.values},QT=e=>t=>{const n=e(t);return Zh(n)},JT=(e,t)=>e.dispatch("PreProcess",t),eD=(e,t)=>e.dispatch("PostProcess",t),tD=e=>{e.dispatch("remove")},nD=e=>{e.dispatch("detach")},sD=(e,t)=>{e.dispatch("SwitchMode",{mode:t})},oD=(e,t,n,s,o)=>{e.dispatch("ObjectResizeStart",{target:t,width:n,height:s,origin:o})},rD=(e,t,n,s,o)=>{e.dispatch("ObjectResized",{target:t,width:n,height:s,origin:o})},aD=e=>{e.dispatch("PreInit")},iD=e=>{e.dispatch("PostRender")},lD=e=>{e.dispatch("Init")},cD=(e,t)=>{e.dispatch("PlaceholderToggle",{state:t})},Qh=(e,t,n)=>{e.dispatch(t,n)},Jh=(e,t,n,s)=>{e.dispatch("FormatApply",{format:t,node:n,vars:s})},eb=(e,t,n,s)=>{e.dispatch("FormatRemove",{format:t,node:n,vars:s})},uD=(e,t)=>e.dispatch("BeforeSetContent",t),tb=(e,t)=>e.dispatch("SetContent",t),fD=(e,t)=>e.dispatch("BeforeGetContent",t),nb=(e,t)=>e.dispatch("GetContent",t),dD=(e,t)=>{e.dispatch("AutocompleterStart",t)},mD=(e,t)=>{e.dispatch("AutocompleterUpdate",t)},Lu=(e,t)=>{e.dispatch("AutocompleterUpdateActiveRange",t)},gD=e=>{e.dispatch("AutocompleterEnd")},pD=(e,t,n)=>e.dispatch("PastePreProcess",{content:t,internal:n}),hD=(e,t,n)=>e.dispatch("PastePostProcess",{node:t,internal:n}),sb=(e,t)=>e.dispatch("PastePlainTextToggle",{state:t}),bD=(e,t)=>e.dispatch("EditableRootStateChange",{state:t}),CD=(e,t)=>e.dispatch("DisabledStateChange",{state:t}),$u=pn().deviceType,yD=$u.isTouch(),vD=_e.DOM,ED=e=>{const t=e.indexOf("=")>0?e.split(/[;,](?![^=;,]*(?:[;,]|$))/):e.split(",");return Tt(t,(n,s)=>{const o=s.split("="),r=o[0],a=o.length>1?o[1]:r;return n[xo(r)]=xo(a),n},{})},ob=e=>ni(e,RegExp),V=e=>t=>t.options.get(e),Mi=e=>J(e)||nt(e),rb=(e,t="")=>n=>{const s=J(n);if(s)if(n.indexOf("=")!==-1){const o=ED(n);return{value:Oe(o,e.id).getOr(t),valid:s}}else return{value:n,valid:s};else return{valid:!1,message:"Must be a string."}},SD=e=>{const t=e.options.register;t("id",{processor:"string",default:e.id}),t("selector",{processor:"string"}),t("target",{processor:"object"}),t("suffix",{processor:"string"}),t("cache_suffix",{processor:"string"}),t("base_url",{processor:"string"}),t("referrer_policy",{processor:"string",default:""}),t("language_load",{processor:"boolean",default:!0}),t("inline",{processor:"boolean",default:!1}),t("iframe_attrs",{processor:"object",default:{}}),t("doctype",{processor:"string",default:"<!DOCTYPE html>"}),t("document_base_url",{processor:"string",default:e.documentBaseUrl}),t("body_id",{processor:rb(e,"tinymce"),default:"tinymce"}),t("body_class",{processor:rb(e),default:""}),t("content_security_policy",{processor:"string",default:""}),t("br_in_pre",{processor:"boolean",default:!0}),t("forced_root_block",{processor:n=>{const s=J(n)&&Tn(n);return s?{value:n,valid:s}:{valid:!1,message:"Must be a non-empty string."}},default:"p"}),t("forced_root_block_attrs",{processor:"object",default:{}}),t("newline_behavior",{processor:n=>{const s=Se(["block","linebreak","invert","default"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: block, linebreak, invert or default."}},default:"default"}),t("br_newline_selector",{processor:"string",default:".mce-toc h2,figcaption,caption"}),t("no_newline_selector",{processor:"string",default:""}),t("keep_styles",{processor:"boolean",default:!0}),t("end_container_on_empty_block",{processor:n=>Xn(n)?{valid:!0,value:n}:J(n)?{valid:!0,value:n}:{valid:!1,message:"Must be boolean or a string"},default:"blockquote"}),t("font_size_style_values",{processor:"string",default:"xx-small,x-small,small,medium,large,x-large,xx-large"}),t("font_size_legacy_values",{processor:"string",default:"xx-small,small,medium,large,x-large,xx-large,300%"}),t("font_size_classes",{processor:"string",default:""}),t("automatic_uploads",{processor:"boolean",default:!0}),t("images_reuse_filename",{processor:"boolean",default:!1}),t("images_replace_blob_uris",{processor:"boolean",default:!0}),t("icons",{processor:"string",default:""}),t("icons_url",{processor:"string",default:""}),t("images_upload_url",{processor:"string",default:""}),t("images_upload_base_path",{processor:"string",default:""}),t("images_upload_credentials",{processor:"boolean",default:!1}),t("images_upload_handler",{processor:"function"}),t("language",{processor:"string",default:"en"}),t("language_url",{processor:"string",default:""}),t("entity_encoding",{processor:"string",default:"named"}),t("indent",{processor:"boolean",default:!0}),t("indent_before",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_after",{processor:"string",default:"p,h1,h2,h3,h4,h5,h6,blockquote,div,title,style,pre,script,td,th,ul,ol,li,dl,dt,dd,area,table,thead,tfoot,tbody,tr,section,details,summary,article,hgroup,aside,figure,figcaption,option,optgroup,datalist"}),t("indent_use_margin",{processor:"boolean",default:!1}),t("indentation",{processor:"string",default:"40px"}),t("content_css",{processor:n=>{const s=n===!1||J(n)||Ls(n,J);return s?J(n)?{value:he(n.split(","),xo),valid:s}:De(n)?{value:n,valid:s}:n===!1?{value:[],valid:s}:{value:n,valid:s}:{valid:!1,message:"Must be false, a string or an array of strings."}},default:zu(e)?[]:["default"]}),t("content_style",{processor:"string"}),t("content_css_cors",{processor:"boolean",default:!1}),t("font_css",{processor:n=>{const s=J(n)||Ls(n,J);return s?{value:De(n)?n:he(n.split(","),xo),valid:s}:{valid:!1,message:"Must be a string or an array of strings."}},default:[]}),t("extended_mathml_attributes",{processor:"string[]"}),t("extended_mathml_elements",{processor:"string[]"}),t("inline_boundaries",{processor:"boolean",default:!0}),t("inline_boundaries_selector",{processor:"string",default:"a[href],code,span.mce-annotation"}),t("object_resizing",{processor:n=>{const s=Xn(n)||J(n);return s?n===!1||$u.isiPhone()||$u.isiPad()?{value:"",valid:s}:{value:n===!0?"table,img,figure.image,div,video,iframe":n,valid:s}:{valid:!1,message:"Must be boolean or a string"}},default:!yD}),t("resize_img_proportional",{processor:"boolean",default:!0}),t("event_root",{processor:"string"}),t("service_message",{processor:"string"}),t("onboarding",{processor:"boolean",default:!0}),t("tiny_cloud_entry_url",{processor:"string"}),t("theme",{processor:n=>n===!1||J(n)||we(n),default:"silver"}),t("theme_url",{processor:"string"}),t("formats",{processor:"object"}),t("format_empty_lines",{processor:"boolean",default:!1}),t("format_noneditable_selector",{processor:"string",default:""}),t("preview_styles",{processor:n=>{const s=n===!1||J(n);return s?{value:n===!1?"":n,valid:s}:{valid:!1,message:"Must be false or a string"}},default:"font-family font-size font-weight font-style text-decoration text-transform color background-color border border-radius outline text-shadow"}),t("custom_ui_selector",{processor:"string",default:""}),t("hidden_input",{processor:"boolean",default:!0}),t("submit_patch",{processor:"boolean",default:!0}),t("encoding",{processor:"string"}),t("add_form_submit_trigger",{processor:"boolean",default:!0}),t("add_unload_trigger",{processor:"boolean",default:!0}),t("custom_undo_redo_levels",{processor:"number",default:0}),t("disable_nodechange",{processor:"boolean",default:!1}),t("disabled",{processor:n=>Xn(n)?(e.initialized&&Hi(e)!==n&&Promise.resolve().then(()=>{CD(e,n)}),{valid:!0,value:n}):{valid:!1,message:"The value must be a boolean."},default:!1}),t("readonly",{processor:"boolean",default:!1}),t("editable_root",{processor:"boolean",default:!0}),t("plugins",{processor:"string[]",default:[]}),t("external_plugins",{processor:"object"}),t("forced_plugins",{processor:"string[]"}),t("model",{processor:"string",default:e.hasPlugin("rtc")?"plugin":"dom"}),t("model_url",{processor:"string"}),t("block_unsupported_drop",{processor:"boolean",default:!0}),t("visual",{processor:"boolean",default:!0}),t("visual_table_class",{processor:"string",default:"mce-item-table"}),t("visual_anchor_class",{processor:"string",default:"mce-item-anchor"}),t("iframe_aria_text",{processor:"string",default:"Rich Text Area".concat(e.hasPlugin("help")?". Press ALT-0 for help.":"")}),t("setup",{processor:"function"}),t("init_instance_callback",{processor:"function"}),t("url_converter",{processor:"function",default:e.convertURL}),t("url_converter_scope",{processor:"object",default:e}),t("urlconverter_callback",{processor:"function"}),t("allow_conditional_comments",{processor:"boolean",default:!1}),t("allow_html_data_urls",{processor:"boolean",default:!1}),t("allow_svg_data_urls",{processor:"boolean"}),t("allow_html_in_named_anchor",{processor:"boolean",default:!1}),t("allow_script_urls",{processor:"boolean",default:!1}),t("allow_unsafe_link_target",{processor:"boolean",default:!1}),t("allow_mathml_annotation_encodings",{processor:n=>{const s=Ls(n,J);return s?{value:n,valid:s}:{valid:!1,message:"Must be an array of strings."}},default:[]}),t("convert_fonts_to_spans",{processor:"boolean",default:!0,deprecated:!0}),t("fix_list_elements",{processor:"boolean",default:!1}),t("preserve_cdata",{processor:"boolean",default:!1}),t("remove_trailing_brs",{processor:"boolean",default:!0}),t("pad_empty_with_br",{processor:"boolean",default:!1}),t("inline_styles",{processor:"boolean",default:!0,deprecated:!0}),t("element_format",{processor:"string",default:"html"}),t("entities",{processor:"string"}),t("schema",{processor:"string",default:"html5"}),t("convert_urls",{processor:"boolean",default:!0}),t("relative_urls",{processor:"boolean",default:!0}),t("remove_script_host",{processor:"boolean",default:!0}),t("custom_elements",{processor:Mi}),t("extended_valid_elements",{processor:"string"}),t("invalid_elements",{processor:"string"}),t("invalid_styles",{processor:Mi}),t("valid_children",{processor:"string"}),t("valid_classes",{processor:Mi}),t("valid_elements",{processor:"string"}),t("valid_styles",{processor:Mi}),t("verify_html",{processor:"boolean",default:!0}),t("auto_focus",{processor:n=>J(n)||n===!0}),t("browser_spellcheck",{processor:"boolean",default:!1}),t("protect",{processor:"array"}),t("images_file_types",{processor:"string",default:"jpeg,jpg,jpe,jfi,jif,jfif,png,gif,bmp,webp"}),t("deprecation_warnings",{processor:"boolean",default:!0}),t("a11y_advanced_options",{processor:"boolean",default:!1}),t("api_key",{processor:"string"}),t("license_key",{processor:"string"}),t("paste_block_drop",{processor:"boolean",default:!1}),t("paste_data_images",{processor:"boolean",default:!0}),t("paste_preprocess",{processor:"function"}),t("paste_postprocess",{processor:"function"}),t("paste_webkit_styles",{processor:"string",default:"none"}),t("paste_remove_styles_if_webkit",{processor:"boolean",default:!0}),t("paste_merge_formats",{processor:"boolean",default:!0}),t("smart_paste",{processor:"boolean",default:!0}),t("paste_as_text",{processor:"boolean",default:!1}),t("paste_tab_spaces",{processor:"number",default:4}),t("text_patterns",{processor:n=>Ls(n,nt)||n===!1?{value:Zh(n===!1?[]:n),valid:!0}:{valid:!1,message:"Must be an array of objects or false."},default:[{start:"*",end:"*",format:"italic"},{start:"**",end:"**",format:"bold"},{start:"#",format:"h1",trigger:"space"},{start:"##",format:"h2",trigger:"space"},{start:"###",format:"h3",trigger:"space"},{start:"####",format:"h4",trigger:"space"},{start:"#####",format:"h5",trigger:"space"},{start:"######",format:"h6",trigger:"space"},{start:"1.",cmd:"InsertOrderedList",trigger:"space"},{start:"*",cmd:"InsertUnorderedList",trigger:"space"},{start:"-",cmd:"InsertUnorderedList",trigger:"space"},{start:">",cmd:"mceBlockQuote",trigger:"space"},{start:"---",cmd:"InsertHorizontalRule",trigger:"space"}]}),t("text_patterns_lookup",{processor:n=>we(n)?{value:QT(n),valid:!0}:{valid:!1,message:"Must be a single function"},default:n=>[]}),t("noneditable_class",{processor:"string",default:"mceNonEditable"}),t("editable_class",{processor:"string",default:"mceEditable"}),t("noneditable_regexp",{processor:n=>Ls(n,ob)?{value:n,valid:!0}:ob(n)?{value:[n],valid:!0}:{valid:!1,message:"Must be a RegExp or an array of RegExp."},default:[]}),t("table_tab_navigation",{processor:"boolean",default:!0}),t("highlight_on_focus",{processor:"boolean",default:!0}),t("xss_sanitization",{processor:"boolean",default:!0}),t("details_initial_state",{processor:n=>{const s=Se(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("details_serialized_state",{processor:n=>{const s=Se(["inherited","collapsed","expanded"],n);return s?{value:n,valid:s}:{valid:!1,message:"Must be one of: inherited, collapsed, or expanded."}},default:"inherited"}),t("init_content_sync",{processor:"boolean",default:!1}),t("newdocument_content",{processor:"string",default:""}),t("sandbox_iframes",{processor:"boolean",default:!0}),t("sandbox_iframes_exclusions",{processor:"string[]",default:["youtube.com","youtu.be","vimeo.com","player.vimeo.com","dailymotion.com","embed.music.apple.com","open.spotify.com","giphy.com","dai.ly","codepen.io"]}),t("convert_unsafe_embeds",{processor:"boolean",default:!0}),e.on("ScriptsLoaded",()=>{t("directionality",{processor:"string",default:vn.isRtl()?"rtl":void 0}),t("placeholder",{processor:"string",default:vD.getAttrib(e.getElement(),"placeholder")})})},wD=V("iframe_attrs"),kD=V("doctype"),ab=V("document_base_url"),_D=V("body_id"),AD=V("body_class"),ib=V("content_security_policy"),xD=V("br_in_pre"),dt=V("forced_root_block"),ia=V("forced_root_block_attrs"),ND=V("newline_behavior"),RD=V("br_newline_selector"),TD=V("no_newline_selector"),DD=V("keep_styles"),PD=V("end_container_on_empty_block"),lb=V("automatic_uploads"),cb=V("images_reuse_filename"),BD=V("images_replace_blob_uris"),ub=V("icons"),OD=V("icons_url"),ID=V("images_upload_url"),FD=V("images_upload_base_path"),LD=V("images_upload_credentials"),$D=V("images_upload_handler"),MD=V("content_css_cors"),Mu=V("referrer_policy"),fb=V("language"),UD=V("language_url"),db=V("indent_use_margin"),zD=V("indentation"),HD=V("content_css"),WD=V("content_style"),mb=V("font_css"),VD=V("directionality"),jD=V("inline_boundaries_selector"),gb=V("object_resizing"),qD=V("resize_img_proportional"),KD=V("placeholder"),pb=V("event_root"),GD=V("service_message"),jo=V("theme"),YD=V("theme_url"),Uu=V("model"),XD=V("model_url"),la=V("inline_boundaries"),ZD=V("formats"),QD=V("preview_styles"),JD=V("format_empty_lines"),eP=V("format_noneditable_selector"),tP=V("custom_ui_selector"),zu=V("inline"),nP=V("hidden_input"),sP=V("submit_patch"),oP=V("add_form_submit_trigger"),rP=V("add_unload_trigger"),aP=V("custom_undo_redo_levels"),iP=V("disable_nodechange"),hb=V("readonly"),lP=V("editable_root"),bb=V("content_css_cors"),Ui=V("plugins"),cP=V("external_plugins"),uP=V("block_unsupported_drop"),fP=V("visual"),dP=V("visual_table_class"),Cb=V("visual_anchor_class"),yb=V("iframe_aria_text"),mP=V("setup"),gP=V("init_instance_callback"),pP=V("urlconverter_callback"),hP=V("auto_focus"),bP=V("browser_spellcheck"),CP=V("protect"),yP=V("paste_block_drop"),zi=V("paste_data_images"),vP=V("paste_preprocess"),EP=V("paste_postprocess"),SP=V("newdocument_content"),wP=V("paste_webkit_styles"),kP=V("paste_remove_styles_if_webkit"),_P=V("paste_merge_formats"),AP=V("smart_paste"),xP=V("paste_as_text"),NP=V("paste_tab_spaces"),RP=V("allow_html_data_urls"),TP=V("text_patterns"),DP=V("text_patterns_lookup"),vb=V("noneditable_class"),PP=V("editable_class"),BP=V("noneditable_regexp"),OP=V("preserve_cdata"),IP=V("highlight_on_focus"),Eb=V("xss_sanitization"),FP=V("init_content_sync"),LP=e=>e.options.isSet("text_patterns_lookup"),$P=e=>L.explode(e.options.get("font_size_style_values")),MP=e=>L.explode(e.options.get("font_size_classes")),UP=e=>e.options.get("encoding")==="xml",Sb=e=>L.explode(e.options.get("images_file_types")),zP=V("table_tab_navigation"),HP=V("details_initial_state"),WP=V("details_serialized_state"),wb=V("sandbox_iframes"),Hu=e=>e.options.get("sandbox_iframes_exclusions"),VP=V("convert_unsafe_embeds"),jP=V("license_key"),qP=V("api_key"),Hi=V("disabled"),KP=q,kb=I,_b=e=>{const t=e.parentNode;t&&t.removeChild(e)},Ab=e=>{const t=Ht(e);return{count:e.length-t.length,text:t}},xb=e=>{let t;for(;(t=e.data.lastIndexOf(Qe))!==-1;)e.deleteData(t,1)},Nb=(e,t)=>(to(e),t),GP=(e,t)=>{const n=Ab(e.data.substr(0,t.offset())),s=Ab(e.data.substr(t.offset()));return(n.text+s.text).length>0?(xb(e),N(e,t.offset()-n.count)):t},YP=(e,t)=>{const n=t.container(),s=Q_(Lt(n.childNodes),e).map(o=>o<t.offset()?N(n,t.offset()-1):t).getOr(t);return to(e),s},XP=(e,t)=>kb(e)&&t.container()===e?GP(e,t):Nb(e,t),ZP=(e,t)=>t.container()===e.parentNode?YP(e,t):Nb(e,t),QP=(e,t)=>N.isTextPosition(t)?XP(e,t):ZP(e,t),to=e=>{KP(e)&&Gt(e)&&(Eh(e)?e.removeAttribute("data-mce-caret"):_b(e)),kb(e)&&(xb(e),e.data.length===0&&_b(e))},JP=xe,eB=$n,tB=ki,nB="*[contentEditable=false],video,audio,embed,object",Rb=(e,t,n)=>{const s=wh(t.getBoundingClientRect(),n);let o,r;if(e.tagName==="BODY"){const i=e.ownerDocument.documentElement;o=e.scrollLeft||i.scrollLeft,r=e.scrollTop||i.scrollTop}else{const i=e.getBoundingClientRect();o=e.scrollLeft-i.left,r=e.scrollTop-i.top}s.left+=o,s.right+=o,s.top+=r,s.bottom+=r,s.width=1;let a=t.offsetWidth-t.clientWidth;return a>0&&(n&&(a*=-1),s.left+=a,s.right+=a),s},sB=e=>{var t,n;const s=ut(C.fromDom(e),nB);for(let o=0;o<s.length;o++){const r=s[o].dom;let a=r.previousSibling;if(Oi(a)){const i=a.data;i.length===1?(t=a.parentNode)===null||t===void 0||t.removeChild(a):a.deleteData(i.length-1,1)}a=r.nextSibling,Bi(a)&&(a.data.length===1?(n=a.parentNode)===null||n===void 0||n.removeChild(a):a.deleteData(0,1))}},oB=(e,t,n,s)=>{const o=Qn();let r,a;const i=dt(e),l=e.dom,c=(p,b)=>{let y;if(u(),tB(b))return null;if(n(b)){const v=lT(i,b,p),E=Rb(t,b,p);l.setStyle(v,"top",E.top),l.setStyle(v,"caret-color","transparent"),a=v;const w=l.create("div",{class:"mce-visual-caret","data-mce-bogus":"all"});l.setStyles(w,{...E}),l.add(t,w),o.set({caret:w,element:b,before:p}),p&&l.addClass(w,"mce-visual-caret-before"),f(),y=b.ownerDocument.createRange(),y.setStart(v,0),y.setEnd(v,0)}else return a=iT(b,p),y=b.ownerDocument.createRange(),ca(a.nextSibling)?(y.setStart(a,0),y.setEnd(a,0)):(y.setStart(a,1),y.setEnd(a,1)),y;return y},u=()=>{sB(t),a&&(to(a),a=null),o.on(p=>{l.remove(p.caret),o.clear()}),r&&(clearInterval(r),r=void 0)},f=()=>{r=window.setInterval(()=>{o.on(p=>{s()?l.toggleClass(p.caret,"mce-visual-caret-hidden"):l.addClass(p.caret,"mce-visual-caret-hidden")})},500)},d=()=>{o.on(p=>{const b=Rb(t,p.element,p.before);l.setStyles(p.caret,{...b})})},g=()=>clearInterval(r),h=()=>".mce-visual-caret {position: absolute;background-color: black;background-color: currentcolor;}.mce-visual-caret-hidden {display: none;}*[data-mce-caret] {position: absolute;left: -1000px;right: auto;top: 0;margin: 0;padding: 0;}";return{isShowing:o.isSet,show:c,hide:u,getCss:h,reposition:d,destroy:g}},Tb=()=>Ce.browser.isFirefox(),ca=e=>JP(e)||eB(e),ua=e=>(ca(e)||Ln(e)&&Tb())&&$r(C.fromDom(e)).exists(Cs),rB=an,Wu=xe,aB=$n,Db=wi("display","block table table-cell table-row table-caption list-item"),Pb=Gt,Bb=Wo,iB=q,lB=I,cB=En,qo=e=>e===1,no=e=>e===-1,Wi=(e,t)=>{let n;for(;n=e(t);)if(!Bb(n))return n;return null},fa=(e,t,n,s,o)=>{const r=new tt(e,s),a=Wu(e)||Bb(e);let i;if(no(t)){if(a&&(i=Wi(r.prev.bind(r),!0),n(i)))return i;for(;i=Wi(r.prev.bind(r),o);)if(n(i))return i}if(qo(t)){if(a&&(i=Wi(r.next.bind(r),!0),n(i)))return i;for(;i=Wi(r.next.bind(r),o);)if(n(i))return i}return null},uB=(e,t)=>{const n=o=>rB(o.dom),s=o=>o.dom===t;return ss(C.fromDom(e),n,s).map(o=>o.dom).getOr(t)},_s=(e,t)=>{for(;e&&e!==t;){if(Db(e))return e;e=e.parentNode}return null},Mn=(e,t,n)=>_s(e.container(),n)===_s(t.container(),n),Vu=(e,t)=>{if(!t)return m.none();const n=t.container(),s=t.offset();return iB(n)?m.from(n.childNodes[s+e]):m.none()},Ob=(e,t)=>{var n;const o=((n=t.ownerDocument)!==null&&n!==void 0?n:document).createRange();return e?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)),o},fB=(e,t,n)=>_s(t,e)===_s(n,e),Ib=(e,t,n)=>{const s=e?"previousSibling":"nextSibling";let o=n;for(;o&&o!==t;){let r=o[s];if(r&&Pb(r)&&(r=r[s]),Wu(r)||aB(r)){if(fB(t,r,o))return r;break}if(cB(r))break;o=o.parentNode}return null},da=G(Ob,!0),ma=G(Ob,!1),ju=(e,t,n)=>{let s;const o=G(Ib,!0,t),r=G(Ib,!1,t),a=n.startContainer,i=n.startOffset;if(Wo(a)){const l=lB(a)?a.parentNode:a,c=l.getAttribute("data-mce-caret");if(c==="before"&&(s=l.nextSibling,ua(s)))return da(s);if(c==="after"&&(s=l.previousSibling,ua(s)))return ma(s)}if(!n.collapsed)return n;if(I(a)){if(Pb(a)){if(e===1){if(s=r(a),s)return da(s);if(s=o(a),s)return ma(s)}if(e===-1){if(s=o(a),s)return ma(s);if(s=r(a),s)return da(s)}return n}if(Oi(a)&&i>=a.data.length-1)return e===1&&(s=r(a),s)?da(s):n;if(Bi(a)&&i<=1)return e===-1&&(s=o(a),s)?ma(s):n;if(i===a.data.length)return s=r(a),s?da(s):n;if(i===0)return s=o(a),s?ma(s):n}return n},Fb=(e,t)=>Vu(e?0:-1,t).filter(Wu),ga=(e,t,n)=>{const s=ju(e,t,n);return e===-1?N.fromRangeStart(s):N.fromRangeEnd(s)},Vi=e=>m.from(e.getNode()).map(C.fromDom),dB=e=>m.from(e.getNode(!0)).map(C.fromDom),qu=(e,t)=>{let n=t;for(;n=e(n);)if(n.isVisible())return n;return n},ji=(e,t)=>{const n=Mn(e,t);return!n&&Ie(e.getNode())?!0:n},mB=xe,Un=I,Lb=q,Ku=Ie,Ko=En,$b=xT,qi=Rh,gB=(e,t)=>{const n=[];let s=e;for(;s&&s!==t;)n.push(s),s=s.parentNode;return n},Mb=(e,t)=>e.hasChildNodes()&&t<e.childNodes.length?e.childNodes[t]:null,Ub=(e,t)=>{if(qo(e)){if(Ko(t.previousSibling)&&!Un(t.previousSibling))return N.before(t);if(Un(t))return N(t,0)}if(no(e)){if(Ko(t.nextSibling)&&!Un(t.nextSibling))return N.after(t);if(Un(t))return N(t,t.data.length)}return no(e)?Ku(t)?N.before(t):N.after(t):N.before(t)},pB=(e,t)=>{const n=t.nextSibling;return n&&Ko(n)?Un(n)?N(n,0):N.before(n):Gu(1,N.after(t),e)},Gu=(e,t,n)=>{let s,o,r,a;if(!Lb(n)||!t)return null;if(t.isEqual(N.after(n))&&n.lastChild){if(a=N.after(n.lastChild),no(e)&&Ko(n.lastChild)&&Lb(n.lastChild))return Ku(n.lastChild)?N.before(n.lastChild):a}else a=t;const i=a.container();let l=a.offset();if(Un(i)){if(no(e)&&l>0)return N(i,--l);if(qo(e)&&l<i.length)return N(i,++l);s=i}else{if(no(e)&&l>0&&(o=Mb(i,l-1),Ko(o)))return!$b(o)&&(r=fa(o,e,qi,o),r)?Un(r)?N(r,r.data.length):N.after(r):Un(o)?N(o,o.data.length):N.before(o);if(qo(e)&&l<i.childNodes.length&&(o=Mb(i,l),Ko(o)))return Ku(o)?pB(n,o):!$b(o)&&(r=fa(o,e,qi,o),r)?Un(r)?N(r,0):N.before(r):Un(o)?N(o,0):N.after(o);s=o||a.getNode()}if(s&&(qo(e)&&a.isAtEnd()||no(e)&&a.isAtStart())&&(s=fa(s,e,Ue,n,!0),qi(s,n)))return Ub(e,s);o=s&&fa(s,e,qi,n);const c=Ms(ne(gB(i,n),mB));return c&&(!o||!c.contains(o))?(qo(e)?a=N.after(c):a=N.before(c),a):o?Ub(e,o):null},zn=e=>({next:t=>Gu(1,t,e),prev:t=>Gu(-1,t,e)}),hB=(e,t,n)=>{const s=e?N.before(n):N.after(n);return Yt(e,t,s)},bB=e=>Ie(e)?N.before(e):N.after(e),zb=e=>N.isTextPosition(e)?e.offset()===0:En(e.getNode()),Hb=e=>{if(N.isTextPosition(e)){const t=e.container();return e.offset()===t.data.length}else return En(e.getNode(!0))},Wb=(e,t)=>!N.isTextPosition(e)&&!N.isTextPosition(t)&&e.getNode()===t.getNode(!0),CB=e=>!N.isTextPosition(e)&&Ie(e.getNode()),yB=(e,t,n)=>e?!Wb(t,n)&&!CB(t)&&Hb(t)&&zb(n):!Wb(n,t)&&zb(t)&&Hb(n),Yt=(e,t,n)=>{const s=zn(t);return m.from(e?s.next(n):s.prev(n))},Go=(e,t,n)=>Yt(e,t,n).bind(s=>Mn(n,s,t)&&yB(e,n,s)?Yt(e,t,s):m.some(s)),Vb=(e,t,n,s)=>Go(e,t,n).bind(o=>s(o)?Vb(e,t,o,s):m.some(o)),Yo=(e,t)=>{const n=e?t.firstChild:t.lastChild;return I(n)?m.some(N(n,e?0:n.data.length)):n?En(n)?m.some(e?N.before(n):bB(n)):hB(e,t,n):m.none()},xt=G(Yt,!0),Pt=G(Yt,!1),mt=G(Yo,!0),ln=G(Yo,!1),Yu="_mce_caret",Xt=e=>q(e)&&e.id===Yu,so=(e,t)=>{let n=t;for(;n&&n!==e;){if(Xt(n))return n;n=n.parentNode}return null},vB=e=>J(e.start),EB=e=>se(e,"rng"),SB=e=>se(e,"id"),jb=e=>se(e,"name"),qb=e=>L.isArray(e.start),Ki=e=>!jb(e)&&Xn(e.forward)?e.forward:!0,Kb=(e,t)=>(q(t)&&e.isBlock(t)&&!t.innerHTML&&(t.innerHTML='<br data-mce-bogus="1" />'),t),wB=(e,t)=>{const n=m.from(zh(e.getRoot(),t.start)),s=m.from(zh(e.getRoot(),t.end));return at(n,s,(o,r)=>{const a=e.createRng();return a.setStart(o.container(),o.offset()),a.setEnd(r.container(),r.offset()),{range:a,forward:Ki(t)}})},kB=(e,t)=>{var n;const o=((n=e.ownerDocument)!==null&&n!==void 0?n:document).createTextNode(Qe);e.appendChild(o),t.setStart(o,0),t.setEnd(o,0)},_B=e=>!e.hasChildNodes(),AB=(e,t)=>ln(e).fold(Pe,n=>(t.setStart(n.container(),n.offset()),t.setEnd(n.container(),n.offset()),!0)),Gb=(e,t,n)=>_B(t)&&so(e,t)?(kB(t,n),!0):!1,Yb=(e,t,n,s)=>{const o=n[t?"start":"end"],r=e.getRoot();if(o){let a=r,i=o[0];for(let l=o.length-1;a&&l>=1;l--){const c=a.childNodes;if(Gb(r,a,s))return!0;if(o[l]>c.length-1)return Gb(r,a,s)?!0:AB(a,s);a=c[o[l]]}I(a)&&(i=Math.min(o[0],a.data.length)),q(a)&&(i=Math.min(o[0],a.childNodes.length)),t?s.setStart(a,i):s.setEnd(a,i)}return!0},Xu=e=>I(e)&&e.data.length>0,Xb=(e,t,n)=>{const s=e.get(n.id+"_"+t),o=s==null?void 0:s.parentNode,r=n.keep;if(s&&o){let a,i;if(t==="start"?r?s.hasChildNodes()?(a=s.firstChild,i=1):Xu(s.nextSibling)?(a=s.nextSibling,i=0):Xu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)+1):(a=o,i=e.nodeIndex(s)):r?s.hasChildNodes()?(a=s.firstChild,i=1):Xu(s.previousSibling)?(a=s.previousSibling,i=s.previousSibling.data.length):(a=o,i=e.nodeIndex(s)):(a=o,i=e.nodeIndex(s)),!r){const l=s.previousSibling,c=s.nextSibling;L.each(L.grep(s.childNodes),f=>{I(f)&&(f.data=f.data.replace(/\uFEFF/g,""))});let u;for(;u=e.get(n.id+"_"+t);)e.remove(u,!0);if(I(c)&&I(l)&&!Ce.browser.isOpera()){const f=l.data.length;l.appendData(c.data),e.remove(c),a=l,i=f}}return m.some(N(a,i))}else return m.none()},xB=(e,t)=>{const n=e.createRng();return Yb(e,!0,t,n)&&Yb(e,!1,t,n)?m.some({range:n,forward:Ki(t)}):m.none()},NB=(e,t)=>{const n=Xb(e,"start",t),s=Xb(e,"end",t);return at(n,s.or(n),(o,r)=>{const a=e.createRng();return a.setStart(Kb(e,o.container()),o.offset()),a.setEnd(Kb(e,r.container()),r.offset()),{range:a,forward:Ki(t)}})},RB=(e,t)=>m.from(e.select(t.name)[t.index]).map(n=>{const s=e.createRng();return s.selectNode(n),{range:s,forward:!0}}),TB=(e,t)=>{const n=e.dom;if(t){if(qb(t))return xB(n,t);if(vB(t))return wB(n,t);if(SB(t))return NB(n,t);if(jb(t))return RB(n,t);if(EB(t))return m.some({range:t.rng,forward:Ki(t)})}return m.none()},DB=(e,t,n)=>qT(e,t,n),PB=(e,t)=>{TB(e,t).each(({range:n,forward:s})=>{e.setRng(n,s)})},Zt=e=>q(e)&&e.tagName==="SPAN"&&e.getAttribute("data-mce-type")==="bookmark",Gi=(e=>t=>e===t)(Ze),oo=e=>e!==""&&` \f
\r	\v`.indexOf(e)!==-1,Zu=e=>!oo(e)&&!Gi(e)&&!_c(e),Qu=e=>{const t=[];if(e)for(let n=0;n<e.rangeCount;n++)t.push(e.getRangeAt(n));return t},BB=e=>Kt(e,t=>{const n=Ii(t);return n?[C.fromDom(n)]:[]}),OB=e=>Qu(e).length>1,IB=e=>ne(BB(e),na),FB=e=>ut(e,"td[data-mce-selected],th[data-mce-selected]"),Zb=(e,t)=>{const n=FB(t);return n.length>0?n:IB(e)},Xo=e=>Zb(Qu(e.selection.getSel()),C.fromDom(e.getBody())),pa=(e,t)=>Wr(e,"table",t),LB=e=>{const t=e.startContainer,n=e.startOffset;return I(t)?n===0?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n]).map(C.fromDom)},$B=e=>{const t=e.endContainer,n=e.endOffset;return I(t)?n===t.data.length?m.some(C.fromDom(t)):m.none():m.from(t.childNodes[n-1]).map(C.fromDom)},Qb=e=>Pc(e).fold(W([e]),t=>[e].concat(Qb(t))),Ju=e=>Bc(e).fold(W([e]),t=>be(t)==="br"?gs(t).map(n=>[e].concat(Ju(n))).getOr([]):[e].concat(Ju(t))),ef=(e,t)=>at(LB(t),$B(t),(n,s)=>{const o=Ye(Qb(e),G(Ee,n)),r=Ye(Ju(e),G(Ee,s));return o.isSome()&&r.isSome()}).getOr(!1),tf=(e,t,n,s)=>{const o=n,r=new tt(n,o),a=Ar(e.schema.getMoveCaretBeforeOnEnterElements(),(l,c)=>!Se(["td","th","table"],c.toLowerCase()));let i=n;do{if(I(i)&&L.trim(i.data).length!==0){s?t.setStart(i,0):t.setEnd(i,i.data.length);return}if(a[i.nodeName]){s?t.setStartBefore(i):i.nodeName==="BR"?t.setEndBefore(i):t.setEndAfter(i);return}}while(i=s?r.next():r.prev());o.nodeName==="BODY"&&(s?t.setStart(o,0):t.setEnd(o,o.childNodes.length))},Yi=e=>{const t=e.selection.getSel();return U(t)&&t.rangeCount>0},nf=(e,t)=>{const n=Xo(e);n.length>0?D(n,s=>{const o=s.dom,r=e.dom.createRng();r.setStartBefore(o),r.setEndAfter(o),t(r,!0)}):t(e.selection.getRng(),!1)},Jb=(e,t,n)=>{const s=Gh(e,t);n(s),e.moveToBookmark(s)},ha=e=>rn(e==null?void 0:e.nodeType),sf=e=>q(e)&&!Zt(e)&&!Xt(e)&&!Vs(e),MB=(e,t)=>{if(sf(t)&&!/^(TD|TH)$/.test(t.nodeName)){const n=e.getAttrib(t,"data-mce-selected"),s=parseInt(n,10);return!isNaN(s)&&s>0}else return!1},eC=(e,t,n)=>{const{selection:s,dom:o}=e,r=s.getNode(),a=xe(r);Jb(s,!0,()=>{t()}),a&&xe(r)&&o.isChildOf(r,e.getBody())?e.selection.select(r):n(s.getStart())&&UB(o,s)},UB=(e,t)=>{var n,s;const o=t.getRng(),{startContainer:r,startOffset:a}=o,i=t.getNode();if(!MB(e,i)&&q(r)){const l=r.childNodes,c=e.getRoot();let u;if(a<l.length){const f=l[a];u=new tt(f,(n=e.getParent(f,e.isBlock))!==null&&n!==void 0?n:c)}else{const f=l[l.length-1];u=new tt(f,(s=e.getParent(f,e.isBlock))!==null&&s!==void 0?s:c),u.next(!0)}for(let f=u.current();f;f=u.next()){if(e.getContentEditable(f)==="false")return;if(I(f)&&!rf(f)){o.setStart(f,0),t.setRng(o);return}}}},tC=(e,t,n)=>{if(e){const s=t?"nextSibling":"previousSibling";for(e=n?e:e[s];e;e=e[s])if(q(e)||!rf(e))return e}},of=(e,t)=>!!e.getTextBlockElements()[t.nodeName.toLowerCase()]||qs(e,t),Zo=(e,t,n)=>e.schema.isValidChild(t,n),rf=(e,t=!1)=>{if(U(e)&&I(e)){const n=t?e.data.replace(/ /g," "):e.data;return Io(n)}else return!1},zB=e=>U(e)&&I(e)&&e.length===0,HB=(e,t)=>{const n="[data-mce-cef-wrappable]",s=eP(e),o=Nr(s)?n:`${n},${s}`;return hn(C.fromDom(t),o)},nC=(e,t)=>{const n=e.dom;return sf(t)&&n.getContentEditable(t)==="false"&&HB(e,t)&&n.select('[contenteditable="true"]',t).length===0},As=(e,t)=>we(e)?e(t):(U(t)&&(e=e.replace(/%(\w+)/g,(n,s)=>t[s]||n)),e),af=(e,t)=>(e=e||"",t=t||"",e=""+(e.nodeName||e),t=""+(t.nodeName||t),e.toLowerCase()===t.toLowerCase()),lf=(e,t)=>{if(Ve(e))return null;{let n=String(e);return(t==="color"||t==="backgroundColor")&&(n=Gr(n)),t==="fontWeight"&&e===700&&(n="bold"),t==="fontFamily"&&(n=n.replace(/[\'\"]/g,"").replace(/,\s+/g,",")),n}},Xi=(e,t,n)=>{const s=e.getStyle(t,n);return lf(s,n)},sC=(e,t)=>{let n;return e.getParent(t,s=>q(s)?(n=e.getStyle(s,"text-decoration"),!!n&&n!=="none"):!1),n},Zi=(e,t,n)=>e.getParents(t,n,e.getRoot()),cf=(e,t,n)=>{const s=e.formatter.get(t);return U(s)&&Be(s,n)},WB=(e,t)=>cf(e,t,s=>{const o=r=>we(r)||r.length>1&&r.charAt(0)==="%";return Be(["styles","attributes"],r=>Oe(s,r).exists(a=>{const i=De(a)?a:Ec(a);return Be(i,o)}))}),VB=(e,t,n)=>{const s=["inline","block","selector","attributes","styles","classes"],o=r=>Ar(r,(a,i)=>Be(s,l=>l===i));return cf(e,t,r=>{const a=o(r);return cf(e,n,i=>{const l=o(i);return nA(a,l)})})},Hn=e=>ko(e,"block"),jB=e=>Hn(e)&&e.wrapper===!0,qB=e=>Hn(e)&&e.wrapper!==!0,Qt=e=>ko(e,"selector"),Je=e=>ko(e,"inline"),KB=e=>Qt(e)&&Je(e)&&_o(Oe(e,"mixed"),!0),uf=e=>Qt(e)&&e.expand!==!1&&!Je(e),GB=e=>{const t=[];let n=e;for(;n;){if(I(n)&&n.data!==Qe||n.childNodes.length>1)return[];q(n)&&t.push(n),n=n.firstChild}return t},oC=e=>GB(e).length>0,ff=e=>Xt(e.dom)&&oC(e.dom),Qo=Zt,rC=Zi,aC=rf,YB=of,XB=e=>Ie(e)&&e.getAttribute("data-mce-bogus")&&!e.nextSibling,iC=(e,t)=>{let n=t;for(;n;){if(q(n)&&e.getContentEditable(n))return e.getContentEditable(n)==="false"?n:t;n=n.parentNode}return t},lC=(e,t,n,s)=>{const o=t.data;if(e){for(let r=n;r>0;r--)if(s(o.charAt(r-1)))return r}else for(let r=n;r<o.length;r++)if(s(o.charAt(r)))return r;return-1},ZB=(e,t,n)=>lC(e,t,n,s=>Gi(s)||oo(s)),QB=(e,t,n)=>lC(e,t,n,Zu),cC=(e,t,n,s,o,r)=>{let a;const i=e.getParent(n,f=>eu(f)||e.isBlock(f)),l=U(i)?i:t,c=(f,d,g)=>{const h=Zs(e),p=o?h.backwards:h.forwards;return m.from(p(f,d,(b,y)=>Qo(b.parentNode)?-1:(a=b,g(o,b,y)),l))};return c(n,s,ZB).bind(f=>r?c(f.container,f.offset+(o?-1:0),QB):m.some(f)).orThunk(()=>a?m.some({container:a,offset:o?0:a.length}):m.none())},uC=(e,t,n,s,o)=>{const r=s[o];I(s)&&Nr(s.data)&&r&&(s=r);const a=rC(e,s);for(let i=0;i<a.length;i++)for(let l=0;l<t.length;l++){const c=t[l];if(!(U(c.collapsed)&&c.collapsed!==n.collapsed)&&Qt(c)&&e.is(a[i],c.selector))return a[i]}return s},fC=(e,t,n,s)=>{var o;let r=n;const a=e.getRoot(),i=t[0];if(Hn(i)&&(r=i.wrapper?null:e.getParent(n,i.block,a)),!r){const l=(o=e.getParent(n,"LI,TD,TH,SUMMARY"))!==null&&o!==void 0?o:a;r=e.getParent(I(n)?n.parentNode:n,c=>c!==a&&YB(e.schema,c),l)}if(r&&Hn(i)&&i.wrapper&&(r=rC(e,r,"ul,ol").reverse()[0]||r),!r)for(r=n;r&&r[s]&&!e.isBlock(r[s])&&(r=r[s],!af(r,"br")););return r||n},dC=(e,t,n,s)=>{const o=n.parentNode;return U(n[s])?!1:o===t||Ve(o)||e.isBlock(o)?!0:dC(e,t,o,s)},Qi=(e,t,n,s,o,r)=>{let a=n;const i=o?"previousSibling":"nextSibling",l=e.getRoot();if(I(n)&&!aC(n)&&(o?s>0:s<n.data.length))return n;for(;a;){if(eu(a))return n;if(!t[0].block_expand&&e.isBlock(a))return r?a:n;for(let c=a[i];c;c=c[i]){const u=I(c)&&!dC(e,l,c,i);if(!Qo(c)&&!XB(c)&&!aC(c,u))return a}if(a===l||a.parentNode===l){n=a;break}a=a.parentNode}return n},mC=e=>Qo(e.parentNode)||Qo(e),ro=(e,t,n,s={})=>{const{includeTrailingSpace:o=!1,expandToBlock:r=!0}=s,a=e.getParent(t.commonAncestorContainer,g=>eu(g)),i=U(a)?a:e.getRoot();let{startContainer:l,startOffset:c,endContainer:u,endOffset:f}=t;const d=n[0];return q(l)&&l.hasChildNodes()&&(l=ws(l,c),I(l)&&(c=0)),q(u)&&u.hasChildNodes()&&(u=ws(u,t.collapsed?f:f-1),I(u)&&(f=u.data.length)),l=iC(e,l),u=iC(e,u),mC(l)&&(l=Qo(l)?l:l.parentNode,t.collapsed?l=l.previousSibling||l:l=l.nextSibling||l,I(l)&&(c=t.collapsed?l.length:0)),mC(u)&&(u=Qo(u)?u:u.parentNode,t.collapsed?u=u.nextSibling||u:u=u.previousSibling||u,I(u)&&(f=t.collapsed?0:u.length)),t.collapsed&&(cC(e,i,l,c,!0,o).each(({container:p,offset:b})=>{l=p,c=b}),cC(e,i,u,f,!1,o).each(({container:p,offset:b})=>{u=p,f=b})),(Je(d)||d.block_expand)&&((!Je(d)||!I(l)||c===0)&&(l=Qi(e,n,l,c,!0,r)),(!Je(d)||!I(u)||f===u.data.length)&&(u=Qi(e,n,u,f,!1,r))),uf(d)&&(l=uC(e,n,t,l,"previousSibling"),u=uC(e,n,t,u,"nextSibling")),(Hn(d)||Qt(d))&&(l=fC(e,n,l,"previousSibling"),u=fC(e,n,u,"nextSibling"),Hn(d)&&(e.isBlock(l)||(l=Qi(e,n,l,c,!0,r),I(l)&&(c=0)),e.isBlock(u)||(u=Qi(e,n,u,f,!1,r),I(u)&&(f=u.data.length)))),q(l)&&l.parentNode&&(c=e.nodeIndex(l),l=l.parentNode),q(u)&&u.parentNode&&(f=e.nodeIndex(u)+1,u=u.parentNode),{startContainer:l,startOffset:c,endContainer:u,endOffset:f}},ba=(e,t,n)=>{var s;const o=t.startOffset,r=ws(t.startContainer,o),a=t.endOffset,i=ws(t.endContainer,a-1),l=b=>{const y=b[0];I(y)&&y===r&&o>=y.data.length&&b.splice(0,1);const v=b[b.length-1];return a===0&&b.length>0&&v===i&&I(v)&&b.splice(b.length-1,1),b},c=(b,y,v)=>{const E=[];for(;b&&b!==v;b=b[y])E.push(b);return E},u=(b,y)=>e.getParent(b,v=>v.parentNode===y,y),f=(b,y,v)=>{const E=v?"nextSibling":"previousSibling";for(let w=b,T=w.parentNode;w&&w!==y;w=T){T=w.parentNode;const B=c(w===b?w:w[E],E);B.length&&(v||B.reverse(),n(l(B)))}};if(r===i)return n(l([r]));const d=(s=e.findCommonAncestor(r,i))!==null&&s!==void 0?s:e.getRoot();if(e.isChildOf(r,i))return f(r,d,!0);if(e.isChildOf(i,r))return f(i,d);const g=u(r,d)||r,h=u(i,d)||i;f(r,g,!0);const p=c(g===r?g:g.nextSibling,"nextSibling",h===i?h.nextSibling:h);p.length&&n(l(p)),f(i,h)},JB=['pre[class*=language-][contenteditable="false"]',"figure.image","div[data-ephox-embed-iri]","div.tiny-pageembed","div.mce-toc","div[data-mce-toc]","div.mce-footnotes"],e1=e=>At(e)&&Hr(e)===Qe,t1=(e,t,n,s)=>$r(t).fold(()=>"skipping",o=>s==="br"||e1(t)?"valid":VR(t)?"existing":Xt(t.dom)?"caret":Be(JB,r=>hn(t,r))?"valid-block":!Zo(e,n,s)||!Zo(e,be(o),n)?"invalid-child":"valid"),n1=(e,t)=>{const n=ro(e.dom,t,[{inline:"span"}]);t.setStart(n.startContainer,n.startOffset),t.setEnd(n.endContainer,n.endOffset),e.selection.setRng(t)},gC=(e,t,n,s,o,r)=>{const{uid:a=t,...i}=n;Bo(e,Qr()),ot(e,`${$o()}`,a),ot(e,`${Xs()}`,s);const{attributes:l={},classes:c=[]}=o(a,i);if(ts(e,l),Ux(e,c),r){c.length>0&&ot(e,`${ea()}`,c.join(","));const u=$t(l);u.length>0&&ot(e,`${ta()}`,u.join(","))}},s1=e=>{jr(e,Qr()),rt(e,`${$o()}`),rt(e,`${Xs()}`),rt(e,`${Jr()}`);const t=ns(e,`${ta()}`).map(s=>s.split(",")).getOr([]),n=ns(e,`${ea()}`).map(s=>s.split(",")).getOr([]);D(t,s=>rt(e,s)),zx(e,n),rt(e,`${ea()}`),rt(e,`${ta()}`)},pC=(e,t,n,s,o)=>{const r=C.fromTag("span",e);return gC(r,t,n,s,o,!1),r},o1=(e,t,n,s,o,r)=>{const a=[],i=pC(e.getDoc(),n,r,s,o),l=Qn(),c=()=>{l.clear()},u=()=>l.get().getOrThunk(()=>{const h=Hs(i);return a.push(h),l.set(h),h}),f=h=>{D(h,d)},d=h=>{switch(t1(e,h,"span",be(h))){case"invalid-child":{c();const b=ct(h);f(b),c();break}case"valid-block":{c(),gC(h,n,r,s,o,!0);break}case"valid":{const b=u();rp(h,b);break}}},g=h=>{const p=he(h,C.fromDom);f(p)};return ba(e.dom,t,h=>{c(),g(h)}),a},r1=(e,t,n,s)=>{e.undoManager.transact(()=>{const o=e.selection,r=o.getRng(),a=Xo(e).length>0,i=xr("mce-annotation");if(r.collapsed&&!a&&n1(e,r),o.getRng().collapsed&&!a){const l=pC(e.getDoc(),i,s,t,n.decorate);gi(l,Ze),o.getRng().insertNode(l.dom),o.select(l.dom)}else Jb(o,!1,()=>{nf(e,l=>{o1(e,l,i,t,n.decorate,s)})})})},hC=e=>{const t=KR();qR(e,t);const n=jR(e,t),s=Fr("span"),o=r=>{D(r,a=>{s(a)?hs(a):s1(a)})};return{register:(r,a)=>{t.register(r,a)},annotate:(r,a)=>{t.lookup(r).each(i=>{r1(e,r,i,a)})},annotationChanged:(r,a)=>{n.addListener(r,a)},remove:r=>{ph(e,m.some(r)).each(({elements:a})=>{const i=e.selection.getBookmark();o(a),e.selection.moveToBookmark(i)})},removeAll:r=>{const a=e.selection.getBookmark();Ae(Ch(e,r),(i,l)=>{o(i)}),e.selection.moveToBookmark(a)},getAll:r=>{const a=Ch(e,r);return ri(a,i=>he(i,l=>l.dom))}}},Ca=e=>({getBookmark:G(DB,e),moveToBookmark:G(PB,e)});Ca.isBookmarkNode=Zt;const bC=(e,t,n)=>n.collapsed?!1:Be(n.getClientRects(),s=>fT(s,e,t)),CC=(e,t)=>{const n=At(t)?Hr(t).length:ct(t).length+1;return e>n?n:e<0?0:e},a1=e=>Oo.range(e.start,CC(e.soffset,e.start),e.finish,CC(e.foffset,e.finish)),yC=(e,t)=>!Si(t.dom)&&(bn(e,t)||Ee(e,t)),vC=e=>t=>yC(e,t.start)&&yC(e,t.finish),i1=e=>e.inline||Ce.browser.isFirefox(),l1=e=>Oo.range(C.fromDom(e.startContainer),e.startOffset,C.fromDom(e.endContainer),e.endOffset),c1=e=>{const t=e.getSelection();return(!t||t.rangeCount===0?m.none():m.from(t.getRangeAt(0))).map(l1)},u1=e=>{const t=Lr(e);return c1(t.dom).filter(vC(e))},f1=(e,t)=>m.from(t).filter(vC(e)).map(a1),d1=e=>{const t=document.createRange();try{return t.setStart(e.start.dom,e.soffset),t.setEnd(e.finish.dom,e.foffset),m.some(t)}catch{return m.none()}},Ji=e=>{const t=i1(e)?u1(C.fromDom(e.getBody())):m.none();e.bookmark=t.isSome()?t:e.bookmark},df=e=>(e.bookmark?e.bookmark:m.none()).bind(n=>f1(C.fromDom(e.getBody()),n)).bind(d1),m1=e=>{df(e).each(t=>e.selection.setRng(t))},EC={isEditorUIElement:e=>{const t=e.className.toString();return t.indexOf("tox-")!==-1||t.indexOf("mce-")!==-1}},g1=(e,t)=>(rn(t)||(t=0),window.setTimeout(e,t)),p1=(e,t)=>(rn(t)||(t=0),window.setInterval(e,t)),Jt={setEditorTimeout:(e,t,n)=>g1(()=>{e.removed||t()},n),setEditorInterval:(e,t,n)=>{const s=p1(()=>{e.removed?window.clearInterval(s):t()},n);return s}},SC=(e,t)=>e.view(t).fold(W([]),s=>{const o=e.owner(s),r=SC(e,o);return[s].concat(r)}),h1=(e,t)=>{const n=t.owner(e);return SC(t,n)};var b1=Object.freeze({__proto__:null,view:e=>{var t;return(e.dom===document?m.none():m.from((t=e.dom.defaultView)===null||t===void 0?void 0:t.frameElement)).map(C.fromDom)},owner:e=>ms(e)});const wC=e=>{const t=np(),n=Hc(t),s=h1(e,b1),o=zc(e),r=Sr(s,(a,i)=>{const l=zc(i);return{left:a.left+l.left,top:a.top+l.top}},{left:0,top:0});return Do(r.left+o.left+n.left,r.top+o.top+n.top)},C1=e=>e.type==="nodechange"&&e.selectionChange,y1=(e,t)=>{const n=()=>{t.throttle()};_e.DOM.bind(document,"mouseup",n),e.on("remove",()=>{_e.DOM.unbind(document,"mouseup",n)})},v1=(e,t)=>{e.on("mouseup touchend",n=>{t.throttle()})},E1=(e,t)=>{v1(e,t),e.on("keyup NodeChange AfterSetSelectionRange",n=>{C1(n)||Ji(e)})},S1=e=>{const t=ci(()=>{Ji(e)},0);e.on("init",()=>{e.inline&&y1(e,t),E1(e,t)}),e.on("remove",()=>{t.cancel()})};let Jo;const mf=_e.DOM,w1=e=>q(e)&&EC.isEditorUIElement(e),gf=e=>{const t=e.classList;return t!==void 0?t.contains("tox-edit-area")||t.contains("tox-edit-area__iframe")||t.contains("mce-content-body"):!1},el=(e,t)=>{const n=tP(e);return mf.getParent(t,o=>w1(o)||(n?e.dom.is(o,n):!1))!==null},pf=e=>{try{const t=ps(C.fromDom(e.getElement()));return Lc(t).fold(()=>document.body,n=>n.dom)}catch{return document.body}},k1=(e,t)=>{const n=t.editor;S1(n);const s=(r,a)=>{if(IP(r)&&r.inline!==!0){const i=C.fromDom(r.getContainer());a(i,"tox-edit-focus")}},o=r=>{if(!r.iframeElement)return;const i=C.fromDom(r.iframeElement),l=wC(i),c=Zc(window);(l.top<c.y||l.top>c.bottom-25)&&i.dom.scrollIntoView({block:"center"})};n.on("focusin",()=>{const r=e.focusedEditor;if(gf(pf(n))&&s(n,Bo),r!==n){r&&r.dispatch("blur",{focusedEditor:n}),e.setActive(n),e.focusedEditor=n,n.dispatch("focus",{blurredEditor:r}),n.focus(!0);const a=pn().browser;n.inline!==!0&&(a.isSafari()||a.isChromium())&&o(n)}}),n.on("focusout",()=>{Jt.setEditorTimeout(n,()=>{const r=e.focusedEditor;(!gf(pf(n))||r!==n)&&s(n,jr),!el(n,pf(n))&&r===n&&(n.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})}),Jo||(Jo=r=>{const a=e.activeEditor;a&&tp(r).each(i=>{const l=i;l.ownerDocument===document&&l!==document.body&&!el(a,l)&&e.focusedEditor===a&&(a.dispatch("blur",{focusedEditor:null}),e.focusedEditor=null)})},mf.bind(document,"focusin",Jo))},_1=(e,t)=>{e.focusedEditor===t.editor&&(e.focusedEditor=null),!e.activeEditor&&Jo&&(mf.unbind(document,"focusin",Jo),Jo=null)},A1=e=>{e.on("AddEditor",G(k1,e)),e.on("RemoveEditor",G(_1,e))},x1=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="true"),N1=(e,t)=>e.dom.getParent(t,n=>e.dom.getContentEditable(n)==="false")!==null,R1=e=>e.collapsed?m.from(ws(e.startContainer,e.startOffset)).map(C.fromDom):m.none(),T1=(e,t)=>R1(t).bind(n=>tT(n)?m.some(n):bn(e,n)?m.none():m.some(e)),kC=(e,t)=>{T1(C.fromDom(e.getBody()),t).bind(n=>mt(n.dom)).fold(()=>{e.selection.normalize()},n=>e.selection.setRng(n.toRange()))},tl=e=>{if(e.setActive)try{e.setActive()}catch{e.focus()}else e.focus()},D1=e=>op(e)||yx(e).isSome(),P1=e=>U(e.iframeElement)&&op(C.fromDom(e.iframeElement)),B1=e=>{const t=e.getBody();return t&&D1(C.fromDom(t))},O1=e=>{const t=ps(C.fromDom(e.getElement()));return Lc(t).filter(n=>!gf(n.dom)&&el(e,n.dom)).isSome()},er=e=>e.inline?B1(e):P1(e),hf=e=>er(e)||O1(e),I1=e=>{const t=e.selection,n=e.getBody();let s=t.getRng();e.quirks.refreshContentEditable();const o=a=>{df(a).each(i=>{a.selection.setRng(i),s=i})};!er(e)&&e.hasEditableRoot()&&o(e);const r=x1(e,t.getNode());if(r&&e.dom.isChildOf(r,n)){N1(e,r)||tl(n),tl(r),e.hasEditableRoot()||o(e),kC(e,s),bf(e);return}e.inline||(Ce.browser.isOpera()||tl(n),e.getWin().focus()),(Ce.browser.isFirefox()||e.inline)&&(tl(n),kC(e,s)),bf(e)},bf=e=>e.editorManager.setActive(e),F1=(e,t)=>{e.removed||(t?bf(e):I1(e))},j={BACKSPACE:8,DELETE:46,DOWN:40,ENTER:13,ESC:27,LEFT:37,RIGHT:39,SPACEBAR:32,TAB:9,UP:38,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,modifierPressed:e=>e.shiftKey||e.ctrlKey||e.altKey||j.metaKeyPressed(e),metaKeyPressed:e=>Ce.os.isMacOS()||Ce.os.isiOS()?e.metaKey:e.ctrlKey&&!e.altKey},ao="data-mce-selected",L1="table,img,figure.image,hr,video,span.mce-preview-object,details",_C=Math.abs,nl=Math.round,Cf={nw:[0,0,-1,-1],ne:[1,0,1,-1],se:[1,1,1,1],sw:[0,1,-1,1]},$1=e=>e.type==="longpress"||e.type.indexOf("touch")===0,AC=(e,t)=>{const n=t.dom,s=t.getDoc(),o=document,r=t.getBody();let a,i,l,c,u,f,d,g,h,p,b,y,v,E,w;const T=R=>U(R)&&(Bp(R)||n.is(R,"figure.image")),B=R=>$n(R)||n.hasClass(R,"mce-preview-object"),H=(R,O)=>{if($1(R)){const K=R.touches[0];return T(R.target)&&!bC(K.clientX,K.clientY,O)}else return T(R.target)&&!bC(R.clientX,R.clientY,O)},x=R=>{const O=R.target;H(R,t.selection.getRng())&&!R.isDefaultPrevented()&&t.selection.select(O)},_=R=>n.hasClass(R,"mce-preview-object")&&U(R.firstElementChild)?[R,R.firstElementChild]:n.is(R,"figure.image")?[R.querySelector("img")]:[R],P=R=>{const O=gb(t);return!O||t.mode.isReadOnly()||R.getAttribute("data-mce-resize")==="false"||R===t.getBody()?!1:n.hasClass(R,"mce-preview-object")&&U(R.firstElementChild)?hn(C.fromDom(R.firstElementChild),O):hn(C.fromDom(R),O)},z=(R,O)=>{if(B(O))return R.create("img",{src:Ce.transparentSrc});if(Ln(O)){const ie=Xe(c.name,"n")?_t:ds,le=O.cloneNode(!0);return ie(R.select("tr",le)).each(ye=>{const sn=R.select("td,th",ye);R.setStyle(ye,"height",null),D(sn,Kn=>R.setStyle(Kn,"height",null))}),le}else return O.cloneNode(!0)},X=(R,O,K)=>{if(U(K)){const ie=_(R);D(ie,le=>{le.style[O]||!t.schema.isValid(le.nodeName.toLowerCase(),O)?n.setStyle(le,O,K):n.setAttrib(le,O,""+K)})}},oe=(R,O,K)=>{X(R,"width",O),X(R,"height",K)},ae=R=>{let O,K,ie,le,ye;O=R.screenX-f,K=R.screenY-d,y=O*c[2]+g,v=K*c[3]+h,y=y<5?5:y,v=v<5?5:v,(T(a)||B(a))&&qD(t)!==!1?ie=!j.modifierPressed(R):ie=j.modifierPressed(R),ie&&(_C(O)>_C(K)?(v=nl(y*p),y=nl(v/p)):(y=nl(v/p),v=nl(y*p))),oe(i,y,v),le=c.startPos.x+O,ye=c.startPos.y+K,le=le>0?le:0,ye=ye>0?ye:0,n.setStyles(l,{left:le,top:ye,display:"block"}),l.innerHTML=y+" &times; "+v,O=r.scrollWidth-E,K=r.scrollHeight-w,O+K!==0&&n.setStyles(l,{left:le-O,top:ye-K}),b||(oD(t,a,g,h,"corner-"+c.name),b=!0)},ge=()=>{const R=b;b=!1,R&&(X(a,"width",y),X(a,"height",v)),n.unbind(s,"mousemove",ae),n.unbind(s,"mouseup",ge),o!==s&&(n.unbind(o,"mousemove",ae),n.unbind(o,"mouseup",ge)),n.remove(i),n.remove(l),n.remove(u),ve(a),R&&(rD(t,a,y,v,"corner-"+c.name),n.setAttrib(a,"style",n.getAttrib(a,"style"))),t.nodeChanged()},ve=R=>{Y();const O=n.getPos(R,r),K=O.x,ie=O.y,le=R.getBoundingClientRect(),ye=le.width||le.right-le.left,sn=le.height||le.bottom-le.top;a!==R&&(ze(),a=R,y=v=0);const Kn=t.dispatch("ObjectSelected",{target:R});P(R)&&!Kn.isDefaultPrevented()?Ae(Cf,(Et,fn)=>{const jt=St=>{const on=_(a)[0];f=St.screenX,d=St.screenY,g=on.clientWidth,h=on.clientHeight,p=h/g,c=Et,c.name=fn,c.startPos={x:ye*Et[0]+K,y:sn*Et[1]+ie},E=r.scrollWidth,w=r.scrollHeight,u=n.add(r,"div",{class:"mce-resize-backdrop","data-mce-bogus":"all"}),n.setStyles(u,{position:"fixed",left:"0",top:"0",width:"100%",height:"100%"}),i=z(n,a),n.addClass(i,"mce-clonedresizable"),n.setAttrib(i,"data-mce-bogus","all"),i.contentEditable="false",n.setStyles(i,{left:K,top:ie,margin:0}),oe(i,ye,sn),i.removeAttribute(ao),r.appendChild(i),n.bind(s,"mousemove",ae),n.bind(s,"mouseup",ge),o!==s&&(n.bind(o,"mousemove",ae),n.bind(o,"mouseup",ge)),l=n.add(r,"div",{class:"mce-resize-helper","data-mce-bogus":"all"},g+" &times; "+h)};let pt=n.get("mceResizeHandle"+fn);pt&&n.remove(pt),pt=n.add(r,"div",{id:"mceResizeHandle"+fn,"data-mce-bogus":"all",class:"mce-resizehandle",unselectable:!0,style:"cursor:"+fn+"-resize; margin:0; padding:0"}),n.bind(pt,"mousedown",St=>{St.stopImmediatePropagation(),St.preventDefault(),jt(St)}),Et.elm=pt,n.setStyles(pt,{left:ye*Et[0]+K-pt.offsetWidth/2,top:sn*Et[1]+ie-pt.offsetHeight/2})}):ze(!1)},$e=ci(ve,0),ze=(R=!0)=>{$e.cancel(),Y(),a&&R&&a.removeAttribute(ao),Ae(Cf,(O,K)=>{const ie=n.get("mceResizeHandle"+K);ie&&(n.unbind(ie),n.remove(ie))})},Ke=(R,O)=>n.isChildOf(R,O),M=R=>{if(b||t.removed||t.composing)return;const O=R.type==="mousedown"?R.target:e.getNode(),K=Po(C.fromDom(O),L1).map(le=>le.dom).filter(le=>n.isEditable(le.parentElement)||le.nodeName==="IMG"&&n.isEditable(le)).getOrUndefined(),ie=U(K)?n.getAttrib(K,ao,"1"):"1";if(D(n.select(`img[${ao}],hr[${ao}]`),le=>{le.removeAttribute(ao)}),U(K)&&Ke(K,r)&&hf(t)){me();const le=e.getStart(!0);if(Ke(le,K)&&Ke(e.getEnd(!0),K)){n.setAttrib(K,ao,ie),$e.throttle(K);return}}ze()},Y=()=>{Ae(Cf,R=>{R.elm&&(n.unbind(R.elm),delete R.elm)})},me=()=>{try{t.getDoc().execCommand("enableObjectResizing",!1,"false")}catch{}};return t.on("init",()=>{me(),t.on("NodeChange ResizeEditor ResizeWindow ResizeContent drop",M),t.on("keyup compositionend",R=>{a&&a.nodeName==="TABLE"&&M(R)}),t.on("hide blur",ze),t.on("contextmenu longpress",x,!0)}),t.on("remove",Y),{isResizable:P,showResizeRect:ve,hideResizeRect:ze,updateResizeRect:M,destroy:()=>{$e.cancel(),a=i=u=null}}},xC=(e,t,n)=>{const s=Lr(C.fromDom(n));return CN(s.dom,e,t).map(o=>{const r=n.createRange();return r.setStart(o.start.dom,o.soffset),r.setEnd(o.finish.dom,o.foffset),r}).getOrUndefined()},yf=(e,t)=>U(e)&&U(t)&&e.startContainer===t.startContainer&&e.startOffset===t.startOffset&&e.endContainer===t.endContainer&&e.endOffset===t.endOffset,M1=(e,t,n)=>{let s=e;for(;s&&s!==t;){if(n(s))return s;s=s.parentNode}return null},NC=(e,t,n)=>M1(e,t,n)!==null,U1=(e,t,n)=>NC(e,t,s=>s.nodeName===n),z1=(e,t)=>Gt(e)&&!NC(e,t,Xt),RC=(e,t,n)=>{const s=t.parentNode;if(s){const o=new tt(t,e.getParent(s,e.isBlock)||e.getRoot());let r;for(;r=o[n?"prev":"next"]();)if(Ie(r))return!0}return!1},H1=(e,t)=>{var n;return((n=e.previousSibling)===null||n===void 0?void 0:n.nodeName)===t},W1=(e,t)=>{let n=t;for(;n&&n!==e;){if(xe(n))return!0;n=n.parentNode}return!1},vf=(e,t,n,s,o)=>{const r=e.getRoot(),a=e.schema.getNonEmptyElements(),i=o.parentNode;let l,c;if(!i)return m.none();const u=e.getParent(i,e.isBlock)||r;if(s&&Ie(o)&&t&&e.isEmpty(u))return m.some(N(i,e.nodeIndex(o)));const f=new tt(o,u);for(;c=f[s?"prev":"next"]();){if(e.getContentEditableParent(c)==="false"||z1(c,r))return m.none();if(I(c)&&c.data.length>0)return U1(c,r,"A")?m.none():m.some(N(c,s?c.data.length:0));if(e.isBlock(c)||a[c.nodeName.toLowerCase()])return m.none();l=c}return ys(l)?m.none():n&&l?m.some(N(l,0)):m.none()},TC=(e,t,n,s)=>{const o=e.getRoot();let r,a=!1,i=n?s.startContainer:s.endContainer,l=n?s.startOffset:s.endOffset;const c=q(i)&&l===i.childNodes.length,u=e.schema.getNonEmptyElements();let f=n;if(Gt(i))return m.none();if(q(i)&&l>i.childNodes.length-1&&(f=!1),qr(i)&&(i=o,l=0),i===o){if(f&&(r=i.childNodes[l>0?l-1:0],r&&(Gt(r)||u[r.nodeName]||Ln(r))))return m.none();if(i.hasChildNodes()){if(l=Math.min(!f&&l>0?l-1:l,i.childNodes.length-1),i=i.childNodes[l],l=I(i)&&c?i.data.length:0,!t&&i===o.lastChild&&Ln(i)||W1(o,i)||Gt(i)||tu(i))return m.none();if(i.hasChildNodes()&&!Ln(i)){r=i;const d=new tt(i,o);do{if(xe(r)||Gt(r)){a=!1;break}if(I(r)&&r.data.length>0){l=f?0:r.data.length,i=r,a=!0;break}if(u[r.nodeName.toLowerCase()]&&!TN(r)){l=e.nodeIndex(r),i=r.parentNode,f||l++,a=!0;break}}while(r=f?d.next():d.prev())}}}return t&&(I(i)&&l===0&&vf(e,c,t,!0,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),q(i)&&(r=i.childNodes[l],r||(r=i.childNodes[l-1]),r&&Ie(r)&&!H1(r,"A")&&!RC(e,r,!1)&&!RC(e,r,!0)&&vf(e,c,t,!0,r).each(d=>{i=d.container(),l=d.offset(),a=!0}))),f&&!t&&I(i)&&l===i.data.length&&vf(e,c,t,!1,i).each(d=>{i=d.container(),l=d.offset(),a=!0}),a&&i?m.some(N(i,l)):m.none()},sl=(e,t)=>{const n=t.collapsed,s=t.cloneRange(),o=N.fromRangeStart(t);return TC(e,n,!0,s).each(r=>{(!n||!N.isAbove(o,r))&&s.setStart(r.container(),r.offset())}),n||TC(e,n,!1,s).each(r=>{s.setEnd(r.container(),r.offset())}),n&&s.collapse(!0),yf(t,s)?m.none():m.some(s)},ol=(e,t)=>e.splitText(t),rl=e=>{let t=e.startContainer,n=e.startOffset,s=e.endContainer,o=e.endOffset;if(t===s&&I(t)){if(n>0&&n<t.data.length)if(s=ol(t,n),t=s.previousSibling,o>n){o=o-n;const r=ol(s,o).previousSibling;t=s=r,o=r.data.length,n=0}else o=0}else if(I(t)&&n>0&&n<t.data.length&&(t=ol(t,n),n=0),I(s)&&o>0&&o<s.data.length){const r=ol(s,o).previousSibling;s=r,o=r.data.length}return{startContainer:t,startOffset:n,endContainer:s,endOffset:o}},io=e=>({walk:(r,a)=>ba(e,r,a),split:rl,expand:(r,a={type:"word"})=>{if(a.type==="word"){const i=ro(e,r,[{inline:"span"}],{includeTrailingSpace:!1,expandToBlock:!1}),l=e.createRng();return l.setStart(i.startContainer,i.startOffset),l.setEnd(i.endContainer,i.endOffset),l}return r},normalize:r=>sl(e,r).fold(Pe,a=>(r.setStart(a.startContainer,a.startOffset),r.setEnd(a.endContainer,a.endOffset),!0))});io.compareRanges=yf,io.getCaretRangeFromPoint=xC,io.getSelectedNode=Ii,io.getNode=ws;const Ef=e=>be(e)==="textarea",V1=(e,t)=>e.dispatch("ScrollIntoView",t).isDefaultPrevented(),j1=(e,t)=>{e.dispatch("AfterScrollIntoView",t)},q1=(e,t)=>{const n=ct(e);if(n.length===0||Ef(e))return{element:e,offset:t};if(t<n.length&&!Ef(n[t]))return{element:n[t],offset:0};{const s=n[n.length-1];return Ef(s)?{element:e,offset:t}:be(s)==="img"?{element:s,offset:1}:At(s)?{element:s,offset:Hr(s).length}:{element:s,offset:ct(s).length}}},DC=(e,t)=>{const n=Dx(e),s=Rx(e);return{element:e,bottom:n.top+s,height:s,pos:n,cleanup:t}},K1=(e,t)=>{const n=q1(e,t),s=C.fromHtml('<span data-mce-bogus="all" style="display: inline-block;">'+Qe+"</span>");return Dt(n.element,s),DC(s,()=>Ne(s))},G1=e=>DC(C.fromDom(e),ce),PC=(e,t,n,s)=>{X1(e,(o,r)=>Y1(e,t,n,s),n)},BC=(e,t,n,s,o)=>{const r={elm:s.element.dom,alignToTop:o};if(V1(e,r))return;const a=Hc(t).top;n(e,t,a,s,o),j1(e,r)},Y1=(e,t,n,s)=>{const o=C.fromDom(e.getBody()),r=C.fromDom(e.getDoc());xx(o);const a=K1(C.fromDom(n.startContainer),n.startOffset);BC(e,r,t,a,s),a.cleanup()},OC=(e,t,n,s)=>{const o=C.fromDom(e.getDoc());BC(e,o,n,G1(t),s)},X1=(e,t,n)=>{const s=n.startContainer,o=n.startOffset,r=n.endContainer,a=n.endOffset;t(C.fromDom(s),C.fromDom(r));const i=e.dom.createRng();i.setStart(s,o),i.setEnd(r,a),e.selection.setRng(n)},Sf=(e,t,n,s,o)=>{const r=t.pos,a=30;if(s)hp(r.left,Math.max(0,r.top-a),o);else{const i=r.top-n+t.height+a;hp(-e.getBody().getBoundingClientRect().left,i,o)}},IC=(e,t,n,s,o,r)=>{const a=s+n,i=o.pos.top,l=o.bottom,c=l-i>=s;i<n?Sf(e,o,s,r!==!1,t):i>a?Sf(e,o,s,c?r!==!1:r===!0,t):l>a&&!c&&Sf(e,o,s,r===!0,t)},FC=(e,t,n,s,o)=>{const r=Lr(t).dom.innerHeight;IC(e,t,n,r,s,o)},LC=(e,t,n,s,o)=>{const r=Lr(t).dom.innerHeight;IC(e,t,n,r,s,o);const a=wC(s.element),i=Zc(window);a.top<i.y?bp(s.element,o!==!1):a.top>i.bottom&&bp(s.element,o===!0)},Z1=(e,t,n)=>PC(e,FC,t,n),Q1=(e,t,n)=>OC(e,t,FC,n),J1=(e,t,n)=>PC(e,LC,t,n),eO=(e,t,n)=>OC(e,t,LC,n),tO=(e,t,n)=>{(e.inline?Q1:eO)(e,t,n)},ya=(e,t,n)=>{(e.inline?Z1:J1)(e,t,n)},$C=(e,t)=>t.collapsed?e.isEditable(t.startContainer):e.isEditable(t.startContainer)&&e.isEditable(t.endContainer),MC=(e,t,n,s,o)=>{const r=n?t.startContainer:t.endContainer,a=n?t.startOffset:t.endOffset;return m.from(r).map(C.fromDom).map(i=>!s||!t.collapsed?No(i,o(i,a)).getOr(i):i).bind(i=>Ut(i)?m.some(i):On(i).filter(Ut)).map(i=>i.dom).getOr(e)},UC=(e,t,n=!1)=>MC(e,t,!0,n,(s,o)=>Math.min(Oc(s),o)),zC=(e,t,n=!1)=>MC(e,t,!1,n,(s,o)=>o>0?o-1:o),HC=(e,t)=>{const n=e;for(;e&&I(e)&&e.length===0;)e=t?e.nextSibling:e.previousSibling;return e||n},nO=(e,t)=>{if(!t)return e;let n=t.startContainer,s=t.endContainer;const o=t.startOffset,r=t.endOffset;let a=t.commonAncestorContainer;t.collapsed||(n===s&&r-o<2&&n.hasChildNodes()&&(a=n.childNodes[o]),I(n)&&I(s)&&(n.length===o?n=HC(n.nextSibling,!0):n=n.parentNode,r===0?s=HC(s.previousSibling,!1):s=s.parentNode,n&&n===s&&(a=n)));const i=I(a)?a.parentNode:a;return Fn(i)?i:e},sO=(e,t,n,s)=>{const o=[],r=e.getRoot(),a=e.getParent(n||UC(r,t,t.collapsed),e.isBlock),i=e.getParent(s||zC(r,t,t.collapsed),e.isBlock);if(a&&a!==r&&o.push(a),a&&i&&a!==i){let l;const c=new tt(a,r);for(;(l=c.next())&&l!==i;)e.isBlock(l)&&o.push(l)}return i&&a!==i&&i!==r&&o.push(i),o},oO=(e,t,n)=>m.from(t).bind(s=>m.from(s.parentNode).map(o=>{const r=e.nodeIndex(s),a=e.createRng();return a.setStart(o,r),a.setEnd(o,r+1),n&&(tf(e,a,s,!0),tf(e,a,s,!1)),a})),wf=(e,t)=>he(t,n=>{const s=e.dispatch("GetSelectionRange",{range:n});return s.range!==n?s.range:n}),rO={"#text":3,"#comment":8,"#cdata":4,"#pi":7,"#doctype":10,"#document-fragment":11},al=(e,t,n)=>{const s=n?"lastChild":"firstChild",o=n?"prev":"next";if(e[s])return e[s];if(e!==t){let r=e[o];if(r)return r;for(let a=e.parent;a&&a!==t;a=a.parent)if(r=a[o],r)return r}},aO=e=>{var t;const n=(t=e.value)!==null&&t!==void 0?t:"";if(!Io(n))return!1;const s=e.parent;return!(s&&(s.name!=="span"||s.attr("style"))&&/^[ ]+$/.test(n))},WC=e=>{const t=e.name==="a"&&!e.attr("href")&&e.attr("id");return e.attr("name")||e.attr("id")&&!e.firstChild||e.attr("data-mce-bookmark")||t};class yt{static create(t,n){const s=new yt(t,rO[t]||1);return n&&Ae(n,(o,r)=>{s.attr(r,o)}),s}constructor(t,n){this.name=t,this.type=n,n===1&&(this.attributes=[],this.attributes.map={})}replace(t){const n=this;return t.parent&&t.remove(),n.insert(t,n),n.remove(),n}attr(t,n){const s=this;if(!J(t))return U(t)&&Ae(t,(r,a)=>{s.attr(a,r)}),s;const o=s.attributes;if(o){if(n!==void 0){if(n===null){if(t in o.map){delete o.map[t];let r=o.length;for(;r--;)if(o[r].name===t)return o.splice(r,1),s}return s}if(t in o.map){let r=o.length;for(;r--;)if(o[r].name===t){o[r].value=n;break}}else o.push({name:t,value:n});return o.map[t]=n,s}return o.map[t]}}clone(){const t=this,n=new yt(t.name,t.type),s=t.attributes;if(s){const o=[];o.map={};for(let r=0,a=s.length;r<a;r++){const i=s[r];i.name!=="id"&&(o[o.length]={name:i.name,value:i.value},o.map[i.name]=i.value)}n.attributes=o}return n.value=t.value,n}wrap(t){const n=this;return n.parent&&(n.parent.insert(t,n),t.append(n)),n}unwrap(){const t=this;for(let n=t.firstChild;n;){const s=n.next;t.insert(n,t,!0),n=s}t.remove()}remove(){const t=this,n=t.parent,s=t.next,o=t.prev;return n&&(n.firstChild===t?(n.firstChild=s,s&&(s.prev=null)):o&&(o.next=s),n.lastChild===t?(n.lastChild=o,o&&(o.next=null)):s&&(s.prev=o),t.parent=t.next=t.prev=null),t}append(t){const n=this;t.parent&&t.remove();const s=n.lastChild;return s?(s.next=t,t.prev=s,n.lastChild=t):n.lastChild=n.firstChild=t,t.parent=n,t}insert(t,n,s){t.parent&&t.remove();const o=n.parent||this;return s?(n===o.firstChild?o.firstChild=t:n.prev&&(n.prev.next=t),t.prev=n.prev,t.next=n,n.prev=t):(n===o.lastChild?o.lastChild=t:n.next&&(n.next.prev=t),t.next=n.next,t.prev=n,n.next=t),t.parent=o,t}getAll(t){const n=this,s=[];for(let o=n.firstChild;o;o=al(o,n))o.name===t&&s.push(o);return s}children(){const t=this,n=[];for(let s=t.firstChild;s;s=s.next)n.push(s);return n}empty(){const t=this;if(t.firstChild){const n=[];for(let o=t.firstChild;o;o=al(o,t))n.push(o);let s=n.length;for(;s--;){const o=n[s];o.parent=o.firstChild=o.lastChild=o.next=o.prev=null}}return t.firstChild=t.lastChild=null,t}isEmpty(t,n={},s){var o;const r=this;let a=r.firstChild;if(WC(r))return!1;if(a)do{if(a.type===1){if(a.attr("data-mce-bogus"))continue;if(t[a.name]||WC(a))return!1}if(a.type===8||a.type===3&&!aO(a)||a.type===3&&a.parent&&n[a.parent.name]&&Io((o=a.value)!==null&&o!==void 0?o:"")||s&&s(a))return!1}while(a=al(a,r));return!0}walk(t){return al(this,null,t)}}const iO=L.makeMap("NOSCRIPT STYLE SCRIPT XMP IFRAME NOEMBED NOFRAMES PLAINTEXT"," "),VC=e=>J(e.nodeValue)&&e.nodeValue.includes(Qe),jC=e=>`${e.length===0?"":`${he(e,t=>`[${t}]`).join(",")},`}[data-mce-bogus="all"]`,lO=(e,t)=>t.querySelectorAll(jC(e)),qC=e=>document.createTreeWalker(e,NodeFilter.SHOW_COMMENT,t=>VC(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP),KC=e=>document.createTreeWalker(e,NodeFilter.SHOW_TEXT,t=>{if(VC(t)){const n=t.parentNode;return n&&se(iO,n.nodeName)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}else return NodeFilter.FILTER_SKIP}),cO=e=>qC(e).nextNode()!==null,uO=e=>KC(e).nextNode()!==null,fO=(e,t)=>t.querySelector(jC(e))!==null,dO=(e,t)=>{D(lO(e,t),n=>{const s=C.fromDom(n);zt(s,"data-mce-bogus")==="all"?Ne(s):D(e,o=>{Ur(s,o)&&rt(s,o)})})},GC=e=>{let t=e.nextNode();for(;t!==null;)t.nodeValue=null,t=e.nextNode()},mO=Nn(GC,qC),gO=Nn(GC,KC),YC=(e,t)=>{const n=[{condition:G(fO,t),action:G(dO,t)},{condition:cO,action:mO},{condition:uO,action:gO}];let s=e,o=!1;return D(n,({condition:r,action:a})=>{r(s)&&(o||(s=e.cloneNode(!0),o=!0),a(s))}),s},XC=e=>{const t=ut(e,"[data-mce-bogus]");D(t,n=>{zt(n,"data-mce-bogus")==="all"?Ne(n):Qs(n)?(Dt(n,C.fromText(Rr)),Ne(n)):hs(n)})},ZC=e=>{const t=ut(e,"input");D(t,n=>{rt(n,"name")})},pO=(e,t)=>{const n=dt(e),s=new RegExp(`^(<${n}[^>]*>(&nbsp;|&#160;|\\s| |<br \\/>|)<\\/${n}>[\r
]*|<br \\/>[\r
]*)$`);return t.replace(s,"")},hO=(e,t)=>{const n=e.getDoc(),s=ps(C.fromDom(e.getBody())),o=C.fromTag("div",n);ot(o,"data-mce-bogus","all"),pi(o,{position:"fixed",left:"-9999999px",top:"0"}),gi(o,t.innerHTML),XC(o),ZC(o);const r=ix(s);je(r,o);const a=Ht(o.dom.innerText);return Ne(o),a},bO=(e,t,n)=>{let s;return t.format==="raw"?s=L.trim(Ht(YC(n,e.serializer.getTempAttrs()).innerHTML)):t.format==="text"?s=hO(e,n):t.format==="tree"?s=e.serializer.serialize(n,t):s=pO(e,e.serializer.serialize(n,t)),t.format!=="text"&&!Di(C.fromDom(n))&&J(s)?L.trim(s):s},CO=(e,t)=>m.from(e.getBody()).fold(W(t.format==="tree"?new yt("body",11):""),n=>bO(e,t,n)),QC=L.makeMap,JC=e=>{const t=[];e=e||{};const n=e.indent,s=QC(e.indent_before||""),o=QC(e.indent_after||""),r=Gs.getEncodeFunc(e.entity_encoding||"raw",e.entities),a=e.element_format!=="xhtml";return{start:(i,l,c)=>{if(n&&s[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}if(t.push("<",i),l)for(let u=0,f=l.length;u<f;u++){const d=l[u];t.push(" ",d.name,'="',r(d.value,!0),'"')}if(!c||a?t[t.length]=">":t[t.length]=" />",c&&n&&o[i]&&t.length>0){const u=t[t.length-1];u.length>0&&u!==`
`&&t.push(`
`)}},end:i=>{let l;t.push("</",i,">"),n&&o[i]&&t.length>0&&(l=t[t.length-1],l.length>0&&l!==`
`&&t.push(`
`))},text:(i,l)=>{i.length>0&&(t[t.length]=l?i:r(i))},cdata:i=>{t.push("<![CDATA[",i,"]]>")},comment:i=>{t.push("<!--",i,"-->")},pi:(i,l)=>{l?t.push("<?",i," ",r(l),"?>"):t.push("<?",i,"?>"),n&&t.push(`
`)},doctype:i=>{t.push("<!DOCTYPE",i,">",n?`
`:"")},reset:()=>{t.length=0},getContent:()=>t.join("").replace(/\n$/,"")}},xs=(e={},t=vs())=>{const n=JC(e);return e.validate="validate"in e?e.validate:!0,{serialize:o=>{const r=e.validate,a={3:l=>{var c;n.text((c=l.value)!==null&&c!==void 0?c:"",l.raw)},8:l=>{var c;n.comment((c=l.value)!==null&&c!==void 0?c:"")},7:l=>{n.pi(l.name,l.value)},10:l=>{var c;n.doctype((c=l.value)!==null&&c!==void 0?c:"")},4:l=>{var c;n.cdata((c=l.value)!==null&&c!==void 0?c:"")},11:l=>{let c=l;if(c=c.firstChild)do i(c);while(c=c.next)}};n.reset();const i=l=>{var c;const u=a[l.type];if(u)u(l);else{const f=l.name,d=f in t.getVoidElements();let g=l.attributes;if(r&&g&&g.length>1){const h=[];h.map={};const p=t.getElementRule(l.name);if(p){for(let b=0,y=p.attributesOrder.length;b<y;b++){const v=p.attributesOrder[b];if(v in g.map){const E=g.map[v];h.map[v]=E,h.push({name:v,value:E})}}for(let b=0,y=g.length;b<y;b++){const v=g[b].name;if(!(v in h.map)){const E=g.map[v];h.map[v]=E,h.push({name:v,value:E})}}g=h}}if(n.start(f,g,d),js(f))J(l.value)&&n.text(l.value,!0),n.end(f);else if(!d){let h=l.firstChild;if(h){(f==="pre"||f==="textarea")&&h.type===3&&((c=h.value)===null||c===void 0?void 0:c[0])===`
`&&n.text(`
`,!0);do i(h);while(h=h.next)}n.end(f)}}};return o.type===1&&!e.inner?i(o):o.type===3?a[3](o):a[11](o),n.getContent()}}},ey=new Set;D(["margin","margin-left","margin-right","margin-top","margin-bottom","padding","padding-left","padding-right","padding-top","padding-bottom","border","border-width","border-style","border-color","background","background-attachment","background-clip","background-image","background-origin","background-position","background-repeat","background-size","float","position","left","right","top","bottom","z-index","display","transform","width","max-width","min-width","height","max-height","min-height","overflow","overflow-x","overflow-y","text-overflow","vertical-align","transition","transition-delay","transition-duration","transition-property","transition-timing-function"],t=>{ey.add(t)});const ty=new Set;D(["background-color"],t=>{ty.add(t)});const ny=["font","text-decoration","text-emphasis"],yO=(e,t)=>e.parseStyle(e.getAttrib(t,"style")),tr=(e,t)=>$t(yO(e,t)),vO=e=>ey.has(e),EO=e=>ty.has(e),sy=(e,t)=>Be(tr(e,t),n=>vO(n)),SO=(e,t)=>sy(e,t)&&Be(tr(e,t),n=>EO(n)),wO=e=>ne(e,t=>Be(ny,n=>Xe(t,n))),kO=(e,t,n)=>{const s=tr(e,t),o=tr(e,n),r=a=>{var i,l;const c=(i=e.getStyle(t,a))!==null&&i!==void 0?i:"",u=(l=e.getStyle(n,a))!==null&&l!==void 0?l:"";return Tn(c)&&Tn(u)&&c!==u};return Be(s,a=>{const i=l=>Be(l,c=>c===a);if(!i(o)&&i(ny)){const l=wO(o);return Be(l,r)}else return r(a)})},oy=(e,t,n)=>m.from(n.container()).filter(I).exists(s=>{const o=e?0:-1;return t(s.data.charAt(n.offset()+o))}),kf=G(oy,!0,oo),_f=G(oy,!1,oo),_O=e=>{const t=e.container();return I(t)&&(t.data.length===0||Pi(t.data)&&Ca.isBookmarkNode(t.parentNode))},Ns=(e,t)=>n=>Vu(e?0:-1,n).filter(t).isSome(),ry=e=>Bp(e)&&In(C.fromDom(e),"display")==="block",ay=e=>xe(e)&&!AN(e),AO=Ns(!0,ry),xO=Ns(!1,ry),va=Ns(!0,$n),Ea=Ns(!1,$n),iy=Ns(!0,Ln),Af=Ns(!1,Ln),Rs=Ns(!0,ay),Ts=Ns(!1,ay),NO=e=>e.slice(0,-1),RO=(e,t,n)=>bn(t,e)?NO(Qg(e,s=>n(s)||Ee(s,t))):[],ly=(e,t)=>RO(e,t,Pe),is=(e,t)=>[e].concat(ly(e,t)),xf=(e,t,n)=>Vb(e,t,n,_O),TO=e=>t=>e.isBlock(be(t)),cy=(e,t,n)=>Ye(is(C.fromDom(t.container()),e),TO(n)),uy=(e,t,n,s)=>xf(e,t.dom,n).forall(o=>cy(t,n,s).fold(()=>!Mn(o,n,t.dom),r=>!Mn(o,n,t.dom)&&bn(r,C.fromDom(o.container())))),fy=(e,t,n,s)=>cy(t,n,s).fold(()=>xf(e,t.dom,n).forall(o=>!Mn(o,n,t.dom)),o=>xf(e,o.dom,n).isNone()),Nf=G(fy,!1),dy=G(fy,!0),DO=G(uy,!1),PO=G(uy,!0),BO=e=>Vi(e).exists(Qs),il=(e,t,n,s)=>{const o=ne(is(C.fromDom(n.container()),t),a=>s.isBlock(be(a))),r=_t(o).getOr(t);return Yt(e,r.dom,n).filter(BO)},Rf=(e,t,n)=>Vi(t).exists(Qs)||il(!0,e,t,n).isSome(),ll=(e,t,n)=>dB(t).exists(Qs)||il(!1,e,t,n).isSome(),my=G(il,!1),OO=G(il,!0),gy=e=>N.isTextPosition(e)&&!e.isAtStart()&&!e.isAtEnd(),py=(e,t,n)=>{const s=ne(is(C.fromDom(t.container()),e),o=>n.isBlock(be(o)));return _t(s).getOr(e)},hy=(e,t,n)=>gy(t)?_f(t):_f(t)||Pt(py(e,t,n).dom,t).exists(_f),by=(e,t,n)=>gy(t)?kf(t):kf(t)||xt(py(e,t,n).dom,t).exists(kf),IO=e=>Se(["pre","pre-wrap"],e),Tf=e=>Vi(e).bind(t=>bs(t,Ut)).exists(t=>IO(In(t,"white-space"))),FO=(e,t)=>Pt(e.dom,t).isNone(),LO=(e,t)=>xt(e.dom,t).isNone(),$O=(e,t,n)=>FO(e,t)||LO(e,t)||Nf(e,t,n)||dy(e,t,n)||ll(e,t,n)||Rf(e,t,n),MO=e=>U(e)&&xe(e)&&Db(e),Cy=(e,t)=>n=>MO(new tt(n,e)[t]()),UO=(e,t)=>{const n=xt(e.dom,t).getOr(t),s=Cy(e.dom,"next");return t.isAtEnd()&&(s(t.container())||s(n.container()))},zO=(e,t)=>{const n=Pt(e.dom,t).getOr(t),s=Cy(e.dom,"prev");return t.isAtStart()&&(s(t.container())||s(n.container()))},yy=(e,t,n)=>Tf(t)?!1:$O(e,t,n)||hy(e,t,n)||by(e,t,n),Sa=(e,t,n)=>Tf(t)?!1:Nf(e,t,n)||DO(e,t,n)||ll(e,t,n)||hy(e,t,n)||zO(e,t),HO=e=>{const t=e.container(),n=e.offset();return I(t)&&n<t.data.length?N(t,n+1):e},wa=(e,t,n)=>Tf(t)?!1:dy(e,t,n)||PO(e,t,n)||Rf(e,t,n)||by(e,t,n)||UO(e,t),Df=(e,t,n)=>Sa(e,t,n)||wa(e,HO(t),n),vy=(e,t)=>Gi(e.charAt(t)),Ey=(e,t)=>oo(e.charAt(t)),WO=e=>{const t=e.container();return I(t)&&lt(t.data,Ze)},VO=e=>{const t=e.split("");return he(t,(n,s)=>Gi(n)&&s>0&&s<t.length-1&&Zu(t[s-1])&&Zu(t[s+1])?" ":n).join("")},Sy=(e,t,n,s)=>{const o=t.data,r=N(t,0);return!n&&vy(o,0)&&!Df(e,r,s)?(t.data=" "+o.slice(1),!0):n&&Ey(o,0)&&Sa(e,r,s)?(t.data=Ze+o.slice(1),!0):!1},jO=e=>{const t=e.data,n=VO(t);return n!==t?(e.data=n,!0):!1},wy=(e,t,n,s)=>{const o=t.data,r=N(t,o.length-1);return!n&&vy(o,o.length-1)&&!Df(e,r,s)?(t.data=o.slice(0,-1)+" ",!0):n&&Ey(o,o.length-1)&&wa(e,r,s)?(t.data=o.slice(0,-1)+Ze,!0):!1},qO=(e,t,n)=>{const s=t.container();if(!I(s))return m.none();if(WO(t)){const o=Sy(e,s,!1,n)||jO(s)||wy(e,s,!1,n);return Ao(o,t)}else if(Df(e,t,n)){const o=Sy(e,s,!0,n)||wy(e,s,!0,n);return Ao(o,t)}else return m.none()},KO=e=>{const t=C.fromDom(e.getBody());e.selection.isCollapsed()&&qO(t,N.fromRangeStart(e.selection.getRng()),e.schema).each(n=>{e.selection.setRng(n.toRange())})},ky=(e,t,n,s)=>{if(n===0)return;const o=C.fromDom(e),r=ss(o,c=>s.isBlock(be(c))).getOr(o),a=e.data.slice(t,t+n),i=t+n>=e.data.length&&wa(r,N(e,e.data.length),s),l=t===0&&Sa(r,N(e,0),s);e.replaceData(t,n,Dp(a,4,l,i))},cl=(e,t,n)=>{const s=e.data.slice(t),o=s.length-gA(s).length;ky(e,t,o,n)},Pf=(e,t,n)=>{const s=e.data.slice(0,t),o=s.length-hg(s).length;ky(e,t-o,o,n)},Bf=(e,t,n,s,o=!0)=>{const r=hg(e.data).length,a=o?e:t,i=o?t:e;return o?a.appendData(i.data):a.insertData(0,i.data),Ne(C.fromDom(i)),s&&cl(a,r,n),a},GO=(e,t)=>{const n=e.container(),s=e.offset();return!N.isTextPosition(e)&&n===t.parentNode&&s>N.before(t).offset()},YO=(e,t)=>GO(t,e)?N(t.container(),t.offset()-1):t,XO=e=>I(e)?N(e,0):N.before(e),ZO=e=>I(e)?N(e,e.data.length):N.after(e),_y=e=>En(e.previousSibling)?m.some(ZO(e.previousSibling)):e.previousSibling?ln(e.previousSibling):m.none(),Ay=e=>En(e.nextSibling)?m.some(XO(e.nextSibling)):e.nextSibling?mt(e.nextSibling):m.none(),QO=(e,t)=>m.from(t.previousSibling?t.previousSibling:t.parentNode).bind(n=>Pt(e,N.before(n))).orThunk(()=>xt(e,N.after(t))),JO=(e,t)=>xt(e,N.after(t)).orThunk(()=>Pt(e,N.before(t))),eI=(e,t)=>_y(t).orThunk(()=>Ay(t)).orThunk(()=>QO(e,t)),tI=(e,t)=>Ay(t).orThunk(()=>_y(t)).orThunk(()=>JO(e,t)),nI=(e,t,n)=>e?tI(t,n):eI(t,n),sI=(e,t,n)=>nI(e,t,n).map(G(YO,n)),xy=(e,t,n)=>{n.fold(()=>{e.focus()},s=>{e.selection.setRng(s.toRange(),t)})},oI=e=>t=>t.dom===e,rI=(e,t)=>t&&se(e.schema.getBlockElements(),be(t)),aI=(e,t,n)=>{if(ft(e,t)){const s=C.fromHtml('<br data-mce-bogus="1">');return n?D(ct(t),o=>{ff(o)||Ne(o)}):Ro(t),je(t,s),m.some(N.before(s.dom))}else return m.none()},iI=(e,t,n,s)=>{const o=gs(e).filter(At),r=Mr(e).filter(At);return Ne(e),lA(o,r,t,(a,i,l)=>{const c=a.dom,u=i.dom,f=c.data.length;return Bf(c,u,n,s),l.container()===u?N(c,f):l}).orThunk(()=>(s&&(o.each(a=>Pf(a.dom,a.dom.length,n)),r.each(a=>cl(a.dom,0,n))),t))},lI=(e,t)=>se(e.schema.getTextInlineElements(),be(t)),lo=(e,t,n,s=!0,o=!1)=>{const r=sI(t,e.getBody(),n.dom),a=ss(n,G(rI,e),oI(e.getBody())),i=iI(n,r,e.schema,lI(e,n));e.dom.isEmpty(e.getBody())?(e.setContent(""),e.selection.setCursorLocation()):a.bind(l=>aI(e.schema,l,o)).fold(()=>{s&&xy(e,t,i)},l=>{s&&xy(e,t,m.some(l))})},cI=/[\u0591-\u07FF\uFB1D-\uFDFF\uFE70-\uFEFC]/,uI=e=>cI.test(e),co=(e,t)=>hn(C.fromDom(t),jD(e))&&!qs(e.schema,t)&&e.dom.isEditable(t),Ny=e=>{var t;return _e.DOM.getStyle(e,"direction",!0)==="rtl"||uI((t=e.textContent)!==null&&t!==void 0?t:"")},fI=(e,t,n)=>ne(_e.DOM.getParents(n.container(),"*",t),e),Ds=(e,t,n)=>{const s=fI(e,t,n);return m.from(s[s.length-1])},dI=(e,t,n)=>{const s=_s(t,e),o=_s(n,e);return U(s)&&s===o},mI=e=>ku(e)||_u(e),en=(e,t)=>{const n=t.container(),s=t.offset();return e?Ss(n)?I(n.nextSibling)?N(n.nextSibling,0):N.after(n):ku(t)?N(n,s+1):t:Ss(n)?I(n.previousSibling)?N(n.previousSibling,n.previousSibling.data.length):N.before(n):_u(t)?N(n,s-1):t},Ry=G(en,!0),Ty=G(en,!1),Dy=(e,t)=>{const n=s=>s.stopImmediatePropagation();e.on("beforeinput input",n,!0),e.getDoc().execCommand(t),e.off("beforeinput input",n)},gI=e=>{e.execCommand("delete")},ul=e=>Dy(e,"Delete"),Py=e=>Dy(e,"ForwardDelete"),pI=e=>t=>_o(On(t),e,Ee),hI=e=>vh(e)||Uo(e),fl=(e,t)=>bn(e,t)?bs(t,hI,pI(e)):m.none(),Of=(e,t=!0)=>{e.dom.isEmpty(e.getBody())&&e.setContent("",{no_selection:!t})},By=(e,t,n)=>at(mt(n),ln(n),(s,o)=>{const r=en(!0,s),a=en(!1,o),i=en(!1,t);return e?xt(n,i).exists(l=>l.isEqual(a)&&t.isEqual(r)):Pt(n,i).exists(l=>l.isEqual(r)&&t.isEqual(a))}).getOr(!0),Oy=e=>(tx(e)?gs(e):Bc(e)).bind(Oy).orThunk(()=>m.some(e)),Iy=(e,t,n,s=!0)=>{var o;t.deleteContents();const r=Oy(n).getOr(n),a=C.fromDom((o=e.dom.getParent(r.dom,e.dom.isBlock))!==null&&o!==void 0?o:n.dom);if(a.dom===e.getBody()?Of(e,s):ft(e.schema,a,{checkRootAsContent:!1})&&(Es(a),s&&e.selection.setCursorLocation(a.dom,0)),!Ee(n,a)){const i=_o(On(a),n)?[]:rx(a);D(i.concat(ct(n)),l=>{!Ee(l,a)&&!bn(l,a)&&ft(e.schema,l)&&Ne(l)})}},bI=e=>t=>Ee(e,t),If=e=>ut(e,"td,th"),Fy=(e,t)=>pa(C.fromDom(e),t),CI=e=>at(e.startTable,e.endTable,(t,n)=>{const s=Gc(t,r=>Ee(r,n)),o=Gc(n,r=>Ee(r,t));return!s&&!o?e:{...e,startTable:s?m.none():e.startTable,endTable:o?m.none():e.endTable,isSameTable:!1,isMultiTable:!1}}).getOr(e),yI=e=>CI(e),vI=(e,t)=>{const n=Fy(e.startContainer,t),s=Fy(e.endContainer,t),o=n.isSome(),r=s.isSome(),a=at(n,s,Ee).getOr(!1);return yI({startTable:n,endTable:s,isStartInTable:o,isEndInTable:r,isSameTable:a,isMultiTable:!a&&o&&r})},Ff=(e,t)=>({start:e,end:t}),EI=(e,t,n)=>({rng:e,table:t,cells:n}),ka=Rn.generate([{singleCellTable:["rng","cell"]},{fullTable:["table"]},{partialTable:["cells","outsideDetails"]},{multiTable:["startTableCells","endTableCells","betweenRng"]}]),dl=(e,t)=>Po(C.fromDom(e),"td,th",t),Ly=e=>!Ee(e.start,e.end),$y=(e,t)=>pa(e.start,t).bind(n=>pa(e.end,t).bind(s=>Ao(Ee(n,s),n))),SI=(e,t)=>!Ly(e)&&$y(e,t).exists(n=>{const s=n.dom.rows;return s.length===1&&s[0].cells.length===1}),wI=(e,t)=>{const n=dl(e.startContainer,t),s=dl(e.endContainer,t);return at(n,s,Ff)},kI=e=>t=>pa(t,e).bind(n=>ds(If(n)).map(s=>Ff(t,s))),_I=e=>t=>pa(t,e).bind(n=>_t(If(n)).map(s=>Ff(s,t))),Lf=e=>t=>$y(t,e).map(n=>EI(t,n,If(n))),My=(e,t,n,s)=>{if(n.collapsed||!e.forall(Ly))return m.none();if(t.isSameTable){const o=e.bind(Lf(s));return m.some({start:o,end:o})}else{const o=dl(n.startContainer,s),r=dl(n.endContainer,s),a=o.bind(kI(s)).bind(Lf(s)),i=r.bind(_I(s)).bind(Lf(s));return m.some({start:a,end:i})}},Uy=(e,t)=>wr(e,n=>Ee(n,t)),$f=e=>at(Uy(e.cells,e.rng.start),Uy(e.cells,e.rng.end),(t,n)=>e.cells.slice(t,n+1)),AI=(e,t,n)=>e.exists(s=>SI(s,n)&&ef(s.start,t)),zy=(e,t)=>{const{startTable:n,endTable:s}=t,o=e.cloneRange();return n.each(r=>o.setStartAfter(r.dom)),s.each(r=>o.setEndBefore(r.dom)),o},xI=(e,t,n,s)=>My(e,t,n,s).bind(({start:o,end:r})=>o.or(r)).bind(o=>{const{isSameTable:r}=t,a=$f(o).getOr([]);if(r&&o.cells.length===a.length)return m.some(ka.fullTable(o.table));if(a.length>0){if(r)return m.some(ka.partialTable(a,m.none()));{const i=zy(n,t);return m.some(ka.partialTable(a,m.some({...t,rng:i})))}}else return m.none()}),NI=(e,t,n,s)=>My(e,t,n,s).bind(({start:o,end:r})=>{const a=o.bind($f).getOr([]),i=r.bind($f).getOr([]);if(a.length>0&&i.length>0){const l=zy(n,t);return m.some(ka.multiTable(a,i,l))}else return m.none()}),RI=(e,t)=>{const n=bI(e),s=wI(t,n),o=vI(t,n);return AI(s,t,n)?s.map(r=>ka.singleCellTable(t,r.start)):o.isMultiTable?NI(s,o,t,n):xI(s,o,t,n)},Hy=e=>D(e,t=>{rt(t,"contenteditable"),Es(t)}),TI=(e,t)=>m.from(e.dom.getParent(t,e.dom.isBlock)).map(C.fromDom),DI=(e,t,n)=>{n.each(s=>{t?Ne(s):(Es(s),e.selection.setCursorLocation(s.dom,0))})},Mf=(e,t,n,s)=>{const o=n.cloneRange();s?(o.setStart(n.startContainer,n.startOffset),o.setEndAfter(t.dom.lastChild)):(o.setStartBefore(t.dom.firstChild),o.setEnd(n.endContainer,n.endOffset)),Uf(e,o,t,!1).each(r=>r())},Wy=e=>{const t=Xo(e),n=C.fromDom(e.selection.getNode());ki(n.dom)&&ft(e.schema,n)?e.selection.setCursorLocation(n.dom,0):e.selection.collapse(!0),t.length>1&&Be(t,s=>Ee(s,n))&&ot(n,"data-mce-selected","1")},Vy=(e,t,n)=>m.some(()=>{const s=e.selection.getRng(),o=n.bind(({rng:r,isStartInTable:a})=>{const i=TI(e,a?r.endContainer:r.startContainer);r.deleteContents(),DI(e,a,i.filter(G(ft,e.schema)));const l=a?t[0]:t[t.length-1];return Mf(e,l,s,a),ft(e.schema,l)?m.none():m.some(a?t.slice(1):t.slice(0,-1))}).getOr(t);Hy(o),Wy(e)}),PI=(e,t,n,s)=>m.some(()=>{const o=e.selection.getRng(),r=t[0],a=n[n.length-1];Mf(e,r,o,!0),Mf(e,a,o,!1);const i=ft(e.schema,r)?t:t.slice(1),l=ft(e.schema,a)?n:n.slice(0,-1);Hy(i.concat(l)),s.deleteContents(),Wy(e)}),Uf=(e,t,n,s=!0)=>m.some(()=>{Iy(e,t,n,s)}),BI=(e,t)=>m.some(()=>lo(e,!1,t)),OI=(e,t,n)=>RI(t,n).bind(s=>s.fold(G(Uf,e),G(BI,e),G(Vy,e),G(PI,e))),II=(e,t)=>ml(e,t),FI=(e,t,n,s)=>zf(t,s).fold(()=>OI(e,t,n),o=>II(e,o)),LI=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.selection.getRng();return n.length!==0?Vy(e,n,m.none()):FI(e,s,o,t)},jy=(e,t)=>Ye(is(t,e),na),zf=(e,t)=>Ye(is(t,e),Fr("caption")),$I=(e,t,n,s,o)=>Go(n,e.getBody(),o).bind(r=>jy(t,C.fromDom(r.getNode())).bind(a=>Ee(a,s)?m.none():m.some(ce))),ml=(e,t)=>m.some(()=>{Es(t),e.selection.setCursorLocation(t.dom,0)}),MI=(e,t,n,s)=>mt(e.dom).bind(o=>ln(e.dom).map(r=>t?n.isEqual(o)&&s.isEqual(r):n.isEqual(r)&&s.isEqual(o))).getOr(!0),UI=(e,t)=>ml(e,t),zI=(e,t,n)=>zf(e,C.fromDom(n.getNode())).fold(()=>m.some(ce),s=>Ao(!Ee(s,t),ce)),HI=(e,t,n,s,o)=>Go(n,e.getBody(),o).fold(()=>m.some(ce),r=>MI(s,n,o,r)?UI(e,s):zI(t,s,r)),WI=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return jy(n,s).bind(r=>ft(e.schema,r,{checkRootAsContent:!1})?ml(e,r):$I(e,n,t,r,o))},VI=(e,t,n,s)=>{const o=N.fromRangeStart(e.selection.getRng());return ft(e.schema,s)?ml(e,s):HI(e,n,t,s,o)},qy=(e,t)=>e?iy(t):Af(t),jI=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return qy(t,n)||Yt(t,e.getBody(),n).exists(s=>qy(t,s))},qI=(e,t,n)=>{const s=C.fromDom(e.getBody());return zf(s,n).fold(()=>WI(e,t,s,n).orThunk(()=>Ao(jI(e,t),ce)),o=>VI(e,t,s,o))},Hf=(e,t)=>{const n=C.fromDom(e.selection.getStart(!0)),s=Xo(e);return e.selection.isCollapsed()&&s.length===0?qI(e,t,n):LI(e,n,s)},uo=(e,t)=>{let n=t;for(;n&&n!==e;){if(an(n)||xe(n))return n;n=n.parentNode}return null},KI=["data-ephox-","data-mce-","data-alloy-","data-snooker-","_"],GI=L.each,Wf=e=>{const t=e.dom,n=new Set(e.serializer.getTempAttrs()),s=(r,a)=>{if(r.nodeName!==a.nodeName||r.nodeType!==a.nodeType)return!1;const i=c=>{const u={};return GI(t.getAttribs(c),f=>{const d=f.nodeName.toLowerCase();d!=="style"&&!o(d)&&(u[d]=t.getAttrib(c,d))}),u},l=(c,u)=>{for(const f in c)if(se(c,f)){const d=u[f];if(st(d)||c[f]!==d)return!1;delete u[f]}for(const f in u)if(se(u,f))return!1;return!0};return q(r)&&q(a)&&(!l(i(r),i(a))||!l(t.parseStyle(t.getAttrib(r,"style")),t.parseStyle(t.getAttrib(a,"style"))))?!1:!Zt(r)&&!Zt(a)},o=r=>Be(KI,a=>Xe(r,a))||n.has(r);return{compare:s,isAttributeInternal:o}},Ky=e=>["h1","h2","h3","h4","h5","h6"].includes(e.name),YI=e=>e.name==="summary",XI=(e,t)=>{let n=e;for(;n=n.walk();)t(n)},Gy=(e,t,n,s)=>{const o=n.name;for(let r=0,a=e.length;r<a;r++){const i=e[r];if(i.name===o){const l=s.nodes[o];l?l.nodes.push(n):s.nodes[o]={filter:i,nodes:[n]}}}if(n.attributes)for(let r=0,a=t.length;r<a;r++){const i=t[r],l=i.name;if(l in n.attributes.map){const c=s.attributes[l];c?c.nodes.push(n):s.attributes[l]={filter:i,nodes:[n]}}}},ZI=(e,t,n)=>{const s={nodes:{},attributes:{}};return n.firstChild&&XI(n,o=>{Gy(e,t,o,s)}),s},Yy=(e,t)=>{const n=(s,o)=>{Ae(s,r=>{const a=Lt(r.nodes);D(r.filter.callbacks,i=>{for(let l=a.length-1;l>=0;l--){const c=a[l];(!(o?c.attr(r.filter.name)!==void 0:c.name===r.filter.name)||Ve(c.parent))&&a.splice(l,1)}a.length>0&&i(a,r.filter.name,t)})})};n(e.nodes,!1),n(e.attributes,!0)},Xy=(e,t,n,s={})=>{const o=ZI(e,t,n);Yy(o,s)},Vf=(e,t,n,s)=>{if((e.pad_empty_with_br||t.insert)&&n(s)){const r=new yt("br",1);t.insert&&r.attr("data-mce-bogus","1"),s.empty().append(r)}else s.empty().append(new yt("#text",3)).value=Ze},QI=e=>{var t;return Zy(e,"#text")&&((t=e==null?void 0:e.firstChild)===null||t===void 0?void 0:t.value)===Ze},Zy=(e,t)=>{const n=e==null?void 0:e.firstChild;return U(n)&&n===e.lastChild&&n.name===t},JI=(e,t)=>{const n=e.getElementRule(t.name);return(n==null?void 0:n.paddEmpty)===!0},_a=(e,t,n,s)=>s.isEmpty(t,n,o=>JI(e,o)),eF=(e,t)=>U(e)&&(t(e)||e.name==="br"),tF=e=>{let t;for(let n=e;n;n=n.parent){const s=n.attr("contenteditable");if(s==="false")break;s==="true"&&(t=n)}return m.from(t)},jf=(e,t,n=e.parent)=>{if(t.getSpecialElements()[e.name])e.empty().remove();else{const s=e.children();for(const o of s)n&&!t.isValidChild(n.name,o.name)&&jf(o,t,n);e.unwrap()}},qf=(e,t,n,s=ce)=>{const o=t.getTextBlockElements(),r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=L.makeMap("tr,td,th,tbody,thead,tfoot,table,summary"),l=new Set,c=u=>u!==n&&!i[u.name];for(let u=0;u<e.length;u++){const f=e[u];let d,g,h;if(!f.parent||l.has(f))continue;if(o[f.name]&&f.parent.name==="li"){let b=f.next;for(;b&&o[b.name];){b.name="li",l.add(b),f.parent.insert(b,f.parent);b=b.next}f.unwrap();continue}const p=[f];for(d=f.parent;d&&!t.isValidChild(d.name,f.name)&&c(d);d=d.parent)p.push(d);if(d&&p.length>1)if(Kf(t,f,d))jf(f,t);else{p.reverse(),g=p[0].clone(),s(g);let b=g;for(let y=0;y<p.length-1;y++){t.isValidChild(b.name,p[y].name)&&y>0?(h=p[y].clone(),s(h),b.append(h)):h=b;for(let v=p[y].firstChild;v&&v!==p[y+1];){const E=v.next;h.append(v),v=E}b=h}_a(t,r,a,g)?d.insert(f,p[0],!0):(d.insert(g,p[0],!0),d.insert(f,g)),d=p[0],(_a(t,r,a,d)||Zy(d,"br"))&&d.empty().remove()}else if(f.parent){if(f.name==="li"){let b=f.prev;if(b&&(b.name==="ul"||b.name==="ol")){b.append(f);continue}if(b=f.next,b&&(b.name==="ul"||b.name==="ol")&&b.firstChild){b.insert(f,b.firstChild,!0);continue}const y=new yt("ul",1);s(y),f.wrap(y);continue}if(t.isValidChild(f.parent.name,"div")&&t.isValidChild("div",f.name)){const b=new yt("div",1);s(b),f.wrap(b)}else jf(f,t)}}},nF=(e,t)=>{let n=e;for(;n;){if(n.name===t)return!0;n=n.parent}return!1},Kf=(e,t,n=t.parent)=>n?e.children[t.name]&&!e.isValidChild(n.name,t.name)||t.name==="a"&&nF(n,"a")?!0:YI(n)&&Ky(t)?!((n==null?void 0:n.firstChild)===t&&(n==null?void 0:n.lastChild)===t):!1:!1,sF=(e,t,n,s)=>{const o=document.createRange();return o.setStart(e,t),o.setEnd(n,s),o},oF=e=>{const t=N.fromRangeStart(e),n=N.fromRangeEnd(e),s=e.commonAncestorContainer;return Yt(!1,s,n).map(o=>!Mn(t,n,s)&&Mn(t,o,s)?sF(t.container(),t.offset(),o.container(),o.offset()):e).getOr(e)},Gf=e=>e.collapsed?e:oF(e),rF=e=>U(e.firstChild)&&e.firstChild===e.lastChild,aF=e=>e.name==="br"||e.value===Ze,iF=(e,t)=>e.getBlockElements()[t.name]&&rF(t)&&aF(t.firstChild),lF=(e,t)=>{const n=e.getNonEmptyElements();return U(t)&&(t.isEmpty(n)||iF(e,t))},cF=(e,t)=>{let n=t.firstChild,s=t.lastChild;return n&&n.name==="meta"&&(n=n.next),s&&s.attr("id")==="mce_marker"&&(s=s.prev),lF(e,s)&&(s=s==null?void 0:s.prev),!n||n!==s?!1:n.name==="ul"||n.name==="ol"},uF=e=>{var t,n;const s=e.firstChild,o=e.lastChild;return s&&s.nodeName==="META"&&((t=s.parentNode)===null||t===void 0||t.removeChild(s)),o&&o.id==="mce_marker"&&((n=o.parentNode)===null||n===void 0||n.removeChild(o)),e},fF=(e,t,n)=>{const s=t.serialize(n),o=e.createFragment(s);return uF(o)},dF=e=>{var t;return ne((t=e==null?void 0:e.childNodes)!==null&&t!==void 0?t:[],n=>n.nodeName==="LI")},mF=e=>e.data===Ze||Ie(e),gF=e=>U(e==null?void 0:e.firstChild)&&e.firstChild===e.lastChild&&mF(e.firstChild),pF=e=>!e.firstChild||gF(e),hF=e=>e.length>0&&pF(e[e.length-1])?e.slice(0,-1):e,Yf=(e,t)=>{const n=e.getParent(t,e.isBlock);return n&&n.nodeName==="LI"?n:null},bF=(e,t)=>!!Yf(e,t),CF=(e,t)=>{const n=t.cloneRange(),s=t.cloneRange();return n.setStartBefore(e),s.setEndAfter(e),[n.cloneContents(),s.cloneContents()]},yF=(e,t)=>{const n=N.before(e),o=zn(t).next(n);return o?o.toRange():null},Qy=(e,t)=>{const n=N.after(e),o=zn(t).prev(n);return o?o.toRange():null},vF=(e,t,n,s)=>{const o=CF(e,s),r=e.parentNode;return r&&(r.insertBefore(o[0],e),L.each(t,a=>{r.insertBefore(a,e)}),r.insertBefore(o[1],e),r.removeChild(e)),Qy(t[t.length-1],n)},EF=(e,t,n)=>{const s=e.parentNode;return s&&L.each(t,o=>{s.insertBefore(o,e)}),yF(e,n)},SF=(e,t,n,s)=>(s.insertAfter(t.reverse(),e),Qy(t[0],n)),wF=(e,t,n,s)=>{const o=fF(t,e,s),r=Yf(t,n.startContainer),a=hF(dF(o.firstChild)),i=1,l=2,c=t.getRoot(),u=f=>{const d=N.fromRangeStart(n),g=zn(t.getRoot()),h=f===i?g.prev(d):g.next(d),p=h==null?void 0:h.getNode();return p?Yf(t,p)!==r:!0};return r?u(i)?EF(r,a,c):u(l)?SF(r,a,c,t):vF(r,a,c,n):null},kF=["pre"],_F=(e,t,n,s)=>{var o;const r=t.firstChild,a=t.lastChild,i=a.attr("data-mce-type")==="bookmark"?a.prev:a,l=r===i,c=Se(kF,r.name);if(l&&c){const u=r.attr("contenteditable")!=="false",f=((o=e.getParent(n,e.isBlock))===null||o===void 0?void 0:o.nodeName.toLowerCase())===r.name,d=m.from(uo(s,n)).forall(an);return u&&f&&d}else return!1},Xf=ki,AF=(e,t,n)=>{if(U(n)){const s=e.getParent(t.endContainer,Xf);return n===s&&ef(C.fromDom(n),t)}else return!1},xF=(e,t)=>{if(e.isBlock(t)&&e.isEditable(t)){const n=t.childNodes;return n.length===1&&Ie(n[0])||n.length===0}else return!1},NF=(e,t,n)=>{var s;n.getAttribute("data-mce-bogus")==="all"?(s=n.parentNode)===null||s===void 0||s.insertBefore(e.dom.createFragment(t),n):xF(e.dom,n)?e.dom.setHTML(n,t):e.selection.setContent(t,{no_events:!0})},RF=(e,t,n)=>{m.from(e.getParent(t,"td,th")).map(C.fromDom).each(s=>oT(s,n))},TF=(e,t)=>{const n=e.schema.getTextInlineElements(),s=e.dom;if(t){const o=e.getBody(),r=Wf(e),a="*[data-mce-fragment]",i=s.select(a);L.each(i,l=>{const c=d=>U(n[d.nodeName.toLowerCase()]),u=d=>d.childNodes.length===1;if((d=>!(sy(s,d)||SO(s,d)))(l)&&c(l)&&u(l)){const d=tr(s,l),g=(y,v)=>Zn(y,E=>Se(v,E)),h=y=>u(l)&&s.is(y,a)&&c(y)&&(y.nodeName===l.nodeName&&g(d,tr(s,y))||h(y.children[0])),p=y=>U(y)&&y!==o&&(r.compare(l,y)||p(y.parentElement)),b=y=>U(y)&&y!==o&&s.is(y,a)&&(kO(s,l,y)||b(y.parentElement));(h(l.children[0])||p(l.parentElement)&&!b(l.parentElement))&&s.remove(l,!0)}})}},DF=e=>{let t=e;for(;t=t.walk();)t.type===1&&t.attr("data-mce-fragment","1")},PF=e=>{L.each(e.getElementsByTagName("*"),t=>{t.removeAttribute("data-mce-fragment")})},BF=e=>!!e.getAttribute("data-mce-fragment"),OF=(e,t)=>U(t)&&!e.schema.getVoidElements()[t.nodeName],IF=(e,t)=>{var n,s,o;let r;const a=e.dom,i=e.selection;if(!t)return;i.scrollIntoView(t);const l=uo(e.getBody(),t);if(l&&a.getContentEditable(l)==="false"){a.remove(t),i.select(l);return}let c=a.createRng();const u=t.previousSibling;if(I(u)){c.setStart(u,(s=(n=u.nodeValue)===null||n===void 0?void 0:n.length)!==null&&s!==void 0?s:0);const g=t.nextSibling;I(g)&&(u.appendData(g.data),(o=g.parentNode)===null||o===void 0||o.removeChild(g))}else c.setStartBefore(t),c.setEndBefore(t);const f=g=>{let h=N.fromRangeStart(g);return h=zn(e.getBody()).next(h),h==null?void 0:h.toRange()},d=a.getParent(t,a.isBlock);if(a.remove(t),d&&a.isEmpty(d)){const g=Xf(d);Ro(C.fromDom(d)),c.setStart(d,0),c.setEnd(d,0),!g&&!BF(d)&&(r=f(c))?(c=r,a.remove(d)):a.add(d,a.create("br",g?{}:{"data-mce-bogus":"1"}))}i.setRng(c)},FF=e=>{const t=e.dom,n=Gf(e.selection.getRng());e.selection.setRng(n);const s=t.getParent(n.startContainer,Xf);AF(t,n,s)?Uf(e,n,C.fromDom(s)):$F(n)||LF(n)?n.deleteContents():e.getDoc().execCommand("Delete",!1)},LF=e=>Jy(e,I),$F=e=>Jy(e,RN),Jy=(e,t)=>e.startContainer===e.endContainer&&e.endOffset-e.startOffset===1&&t(e.startContainer.childNodes[e.startOffset]),MF=e=>{for(let t=e;t;t=t.walk())if(t.attr("id")==="mce_marker")return m.some(t);return m.none()},UF=(e,t,n)=>{var s;return Be(n.children(),Ky)&&((s=e.getParent(t,e.isBlock))===null||s===void 0?void 0:s.nodeName)==="SUMMARY"},zF=(e,t,n)=>{var s,o;const r=e.selection,a=e.dom,i=e.parser,l=n.merge,c=xs({validate:!0},e.schema),u='<span id="mce_marker" data-mce-type="bookmark">&#xFEFF;</span>';n.preserve_zwsp||(t=Ht(t)),t.indexOf("{$caret}")===-1&&(t+="{$caret}"),t=t.replace(/\{\$caret\}/,u);let f=r.getRng();const d=f.startContainer,g=e.getBody();d===g&&r.isCollapsed()&&a.isBlock(g.firstChild)&&OF(e,g.firstChild)&&a.isEmpty(g.firstChild)&&(f=a.createRng(),f.setStart(g.firstChild,0),f.setEnd(g.firstChild,0),r.setRng(f)),r.isCollapsed()||FF(e);const h=r.getNode(),p={context:h.nodeName.toLowerCase(),data:n.data,insert:!0},b=i.parse(t,p);if(n.paste===!0&&cF(e.schema,b)&&bF(a,h))return f=wF(c,a,r.getRng(),b),f&&r.setRng(f),t;n.paste===!0&&_F(a,b,h,e.getBody())&&((s=b.firstChild)===null||s===void 0||s.unwrap()),DF(b);let y=b.lastChild;if(y&&y.attr("id")==="mce_marker"){const v=y;for(y=y.prev;y&&y.name!=="table";y=y.walk(!0))if(y.type===3||!a.isBlock(y.name)){y.parent&&e.schema.isValidChild(y.parent.name,"span")&&y.parent.insert(v,y,y.name==="br");break}}if(e._selectionOverrides.showBlockCaretContainer(h),!p.invalid&&!UF(a,h,b))t=c.serialize(b),NF(e,t,h);else{e.selection.setContent(u);let v=r.getNode(),E;const w=e.getBody();for(qr(v)?v=E=w:E=v;E&&E!==w;)v=E,E=E.parentNode;t=v===w?w.innerHTML:a.getOuterHTML(v);const T=i.parse(t),B=MF(T),H=B.bind(tF).getOr(T);B.each(z=>z.replace(b));const x=b.children(),_=(o=b.parent)!==null&&o!==void 0?o:T;b.unwrap();const P=ne(x,z=>Kf(e.schema,z,_));qf(P,e.schema,H),Xy(i.getNodeFilters(),i.getAttributeFilters(),T),t=c.serialize(T),v===w?a.setHTML(w,t):a.setOuterHTML(v,t)}return TF(e,l),IF(e,a.get("mce_marker")),PF(e.getBody()),RF(a,r.getStart(),e.schema),KN(e.schema,e.getBody(),r.getStart()),t},gl=e=>e instanceof yt,HF=e=>{er(e)&&mt(e.getBody()).each(t=>{const n=t.getNode(),s=Ln(n)?mt(n).getOr(t):t;e.selection.setRng(s.toRange())})},Zf=(e,t,n)=>{e.dom.setHTML(e.getBody(),t),n!==!0&&HF(e)},WF=(e,t,n,s)=>{if(n=Ht(n),n.length===0||/^\s+$/.test(n)){const o='<br data-mce-bogus="1">';t.nodeName==="TABLE"?n="<tr><td>"+o+"</td></tr>":/^(UL|OL)$/.test(t.nodeName)&&(n="<li>"+o+"</li>");const r=dt(e);return e.schema.isValidChild(t.nodeName.toLowerCase(),r.toLowerCase())?(n=o,n=e.dom.createHTML(r,ia(e),n)):n||(n=o),Zf(e,n,s.no_selection),{content:n,html:n}}else{s.format!=="raw"&&(n=xs({validate:!1},e.schema).serialize(e.parser.parse(n,{isRootContent:!0,insert:!0})));const o=Di(C.fromDom(t))?n:L.trim(n);return Zf(e,o,s.no_selection),{content:o,html:o}}},VF=(e,t,n,s)=>{Xy(e.parser.getNodeFilters(),e.parser.getAttributeFilters(),n);const o=xs({validate:!1},e.schema).serialize(n),r=Ht(Di(C.fromDom(t))?o:L.trim(o));return Zf(e,r,s.no_selection),{content:n,html:r}},jF=(e,t,n)=>m.from(e.getBody()).map(s=>gl(t)?VF(e,s,t,n):WF(e,s,t,n)).getOr({content:t,html:gl(n.content)?"":n.content}),Qf=af,ev=(e,t,n)=>{const s=e.formatter.get(n);if(s)for(let o=0;o<s.length;o++){const r=s[o];if(Qt(r)&&r.inherit===!1&&e.dom.is(t,r.selector))return!0}return!1},Jf=(e,t,n,s,o)=>{const r=e.dom.getRoot();if(t===r)return!1;const a=e.dom.getParent(t,i=>ev(e,i,n)?!0:i.parentNode===r||!!Wn(e,i,n,s,!0));return!!Wn(e,a,n,s,o)},pl=(e,t,n)=>Je(n)&&Qf(t,n.inline)||Hn(n)&&Qf(t,n.block)?!0:Qt(n)?q(t)&&e.is(t,n.selector):!1,tv=(e,t,n,s,o,r)=>{const a=n[s],i=s==="attributes";if(we(n.onmatch))return n.onmatch(t,n,s);if(a){if(Cg(a)){for(let l=0;l<a.length;l++)if(i?e.getAttrib(t,a[l]):Xi(e,t,a[l]))return!0}else for(const l in a)if(se(a,l)){const c=i?e.getAttrib(t,l):Xi(e,t,l),u=As(a[l],r),f=Ve(c)||Nr(c);if(f&&Ve(u))continue;if(o&&f&&!n.exact||(!o||n.exact)&&!Qf(c,lf(u,l)))return!1}}return!0},Wn=(e,t,n,s,o)=>{const r=e.formatter.get(n),a=e.dom;if(r&&q(t))for(let i=0;i<r.length;i++){const l=r[i];if(pl(e.dom,t,l)&&tv(a,t,l,"attributes",o,s)&&tv(a,t,l,"styles",o,s)){const c=l.classes;if(c){for(let u=0;u<c.length;u++)if(!e.dom.hasClass(t,As(c[u],s)))return}return l}}},ed=(e,t,n,s,o)=>{if(s)return Jf(e,s,t,n,o);if(s=e.selection.getNode(),Jf(e,s,t,n,o))return!0;const r=e.selection.getStart();return!!(r!==s&&Jf(e,r,t,n,o))},qF=(e,t,n)=>{const s=[],o={},r=e.selection.getStart();return e.dom.getParent(r,a=>{for(let i=0;i<t.length;i++){const l=t[i];!o[l]&&Wn(e,a,l,n)&&(o[l]=!0,s.push(l))}},e.dom.getRoot()),s},KF=(e,t)=>{const n=o=>Ee(o,C.fromDom(e.getBody())),s=(o,r)=>Wn(e,o.dom,r)?m.some(r):m.none();return m.from(e.selection.getStart(!0)).bind(o=>Yc(C.fromDom(o),r=>wo(t,a=>s(r,a)),n)).getOrNull()},GF=(e,t)=>{const n=e.formatter.get(t),s=e.dom;if(n&&e.selection.isEditable()){const o=e.selection.getStart(),r=Zi(s,o);for(let a=n.length-1;a>=0;a--){const i=n[a];if(!Qt(i))return!0;for(let l=r.length-1;l>=0;l--)if(s.is(r[l],i.selector))return!0}}return!1},YF=(e,t,n)=>Tt(n,(s,o)=>{const r=WB(e,o);return e.formatter.matchNode(t,o,{},r)?s.concat([o]):s},[]),Aa=Qe,XF=(e,t)=>e.importNode(t,!0),nv=e=>{if(e){const t=new tt(e,e);for(let n=t.current();n;n=t.next())if(I(n))return n}return null},td=e=>{const t=C.fromTag("span");return ts(t,{id:Yu,"data-mce-bogus":"1","data-mce-type":"format-caret"}),e&&je(t,C.fromText(Aa)),t},ZF=e=>{const t=nv(e);return t&&t.data.charAt(0)===Aa&&t.deleteData(0,1),t},nd=(e,t,n)=>{const s=e.dom,o=e.selection;if(oC(t))lo(e,!1,C.fromDom(t),n,!0);else{const r=o.getRng(),a=s.getParent(t,s.isBlock),i=r.startContainer,l=r.startOffset,c=r.endContainer,u=r.endOffset,f=ZF(t);s.remove(t,!0),i===f&&l>0&&r.setStart(f,l-1),c===f&&u>0&&r.setEnd(f,u-1),a&&s.isEmpty(a)&&Es(C.fromDom(a)),o.setRng(r)}},sd=(e,t,n)=>{const s=e.dom,o=e.selection;if(t)nd(e,t,n);else if(t=so(e.getBody(),o.getStart()),!t)for(;t=s.get(Yu);)nd(e,t,n)},QF=(e,t,n)=>{var s,o;const r=e.dom,a=r.getParent(n,G(of,e.schema));a&&r.isEmpty(a)?(s=n.parentNode)===null||s===void 0||s.replaceChild(t,n):(sT(C.fromDom(n)),r.isEmpty(n)?(o=n.parentNode)===null||o===void 0||o.replaceChild(t,n):r.insertAfter(t,n))},sv=(e,t)=>(e.appendChild(t),t),ov=(e,t)=>{var n;const s=Sr(e,(r,a)=>sv(r,a.cloneNode(!1)),t),o=(n=s.ownerDocument)!==null&&n!==void 0?n:document;return sv(s,o.createTextNode(Aa))},JF=(e,t,n,s,o,r)=>{const a=e.formatter,i=e.dom,l=ne($t(a.get()),f=>f!==s&&!lt(f,"removeformat")),c=YF(e,n,l);if(ne(c,f=>!VB(e,f,s)).length>0){const f=n.cloneNode(!1);return i.add(t,f),a.remove(s,o,f,r),i.remove(f),m.some(f)}else return m.none()},rv=e=>Cp(e,Hr(e).replace(new RegExp(`${Ze}$`)," ")),av=(e,t)=>{const n=()=>{t!==null&&!e.dom.isEmpty(t)&&gs(C.fromDom(t)).each(s=>{At(s)?rv(s):qc(s,o=>At(o)).each(o=>{At(o)&&rv(o)})})};e.once("input",s=>{s.data&&!oo(s.data)&&(s.isComposing?e.once("compositionend",()=>{n()}):n())})},eL=(e,t,n)=>{let s;const o=e.selection,r=e.formatter.get(t);if(!r)return;const a=o.getRng();let i=a.startOffset;const c=a.startContainer.nodeValue;s=so(e.getBody(),o.getStart());const u=/[^\s\u00a0\u00ad\u200b\ufeff]/;if(c&&i>0&&i<c.length&&u.test(c.charAt(i))&&u.test(c.charAt(i-1))){const f=o.getBookmark();a.collapse(!0);let d=ro(e.dom,a,r);d=rl(d),e.formatter.apply(t,n,d),o.moveToBookmark(f)}else{let f=s?nv(s):null;(!s||(f==null?void 0:f.data)!==Aa)&&(s=XF(e.getDoc(),td(!0).dom),f=s.firstChild,a.insertNode(s),i=1,av(e,s)),e.formatter.apply(t,n,s),o.setCursorLocation(f,i)}},tL=(e,t,n,s)=>{const o=e.dom,r=e.selection;let a=!1;const i=e.formatter.get(t);if(!i)return;const l=r.getRng(),c=l.startContainer,u=l.startOffset;let f=c;I(c)&&(u!==c.data.length&&(a=!0),f=f.parentNode);const d=[];let g;for(;f;){if(Wn(e,f,t,n,s)){g=f;break}f.nextSibling&&(a=!0),d.push(f),f=f.parentNode}if(g)if(a){const h=r.getBookmark();l.collapse(!0);let p=ro(o,l,i,{includeTrailingSpace:!0});p=rl(p),e.formatter.remove(t,n,p,s),r.moveToBookmark(h)}else{const h=so(e.getBody(),g),p=U(h)?o.getParents(g.parentNode,Ue,h):[],b=td(!1).dom;QF(e,b,h??g);const y=JF(e,b,g,t,n,s),v=ov([...d,...y.toArray(),...p],b);h&&nd(e,h,U(h)),r.setCursorLocation(v,1),av(e,b),o.isEmpty(g)&&o.remove(g)}},nL=(e,t,n)=>{const s=e.selection,o=e.getBody();sd(e,null,n),(t===8||t===46)&&s.isCollapsed()&&s.getStart().innerHTML===Aa&&sd(e,so(o,s.getStart()),!0),(t===37||t===39)&&sd(e,so(o,s.getStart()),!0)},sL=e=>I(e)&&Sc(e.data,Ze),oL=e=>{e.on("mouseup keydown",t=>{nL(e,t.keyCode,sL(e.selection.getRng().endContainer))})},iv=e=>{const t=td(!1),n=ov(e,t.dom);return{caretContainer:t,caretPosition:N(n,0)}},lv=(e,t)=>{const{caretContainer:n,caretPosition:s}=iv(t);return Dt(C.fromDom(e),n),Ne(C.fromDom(e)),s},rL=(e,t)=>{const{caretContainer:n,caretPosition:s}=iv(t);return e.insertNode(n.dom),s},cv=(e,t)=>{if(Xt(t.dom))return!1;const n=e.schema.getTextInlineElements();return se(n,be(t))&&!Xt(t.dom)&&!Vs(t.dom)},xa={},uv=Cn(["pre"]),aL=(e,t)=>{xa[e]||(xa[e]=[]),xa[e].push(t)},iL=(e,t)=>{se(xa,e)&&D(xa[e],n=>{n(t)})};aL("pre",e=>{const t=e.selection.getRng(),n=o=>r=>{const a=r.previousSibling;return uv(a)&&Se(o,a)},s=(o,r)=>{const a=C.fromDom(r),i=ms(a).dom;Ne(a),zs(C.fromDom(o),[C.fromTag("br",i),C.fromTag("br",i),...ct(a)])};if(!t.collapsed){const o=e.selection.getSelectedBlocks(),r=ne(ne(o,uv),n(o));D(r,a=>{s(a.previousSibling,a)})}});const fv=["fontWeight","fontStyle","color","fontSize","fontFamily"],lL=e=>nt(e.styles)&&Be($t(e.styles),t=>Se(fv,t)),cL=e=>Ye(e,t=>Je(t)&&t.inline==="span"&&lL(t)),dv=(e,t)=>{const n=e.get(t);return De(n)?cL(n):m.none()},mv=(e,t)=>Pt(t,N.fromRangeStart(e)).isNone(),gv=(e,t)=>xt(t,N.fromRangeEnd(e)).exists(n=>!Ie(n.getNode())||xt(t,n).isSome())===!1,pv=e=>t=>DN(t)&&e.isEditable(t),uL=e=>{const t=e.getSelectedBlocks(),n=e.getRng();if(e.isCollapsed())return[];if(t.length===1)return mv(n,t[0])&&gv(n,t[0])?t:[];{const s=_t(t).filter(a=>mv(n,a)).toArray(),o=ds(t).filter(a=>gv(n,a)).toArray(),r=t.slice(1,-1);return s.concat(r).concat(o)}},fL=e=>ne(uL(e),pv(e.dom)),hv=e=>ne(e.getSelectedBlocks(),pv(e.dom)),od=L.each,rd=e=>q(e)&&!Zt(e)&&!Xt(e)&&!Vs(e),bv=(e,t)=>{for(let n=e;n;n=n[t]){if(I(n)&&Tn(n.data))return e;if(q(n)&&!Zt(n))return n}return e},Cv=(e,t,n)=>{const s=Wf(e),o=Fn(t)&&e.dom.isEditable(t),r=Fn(n)&&e.dom.isEditable(n);if(o&&r){const a=bv(t,"previousSibling"),i=bv(n,"nextSibling");if(s.compare(a,i)){for(let l=a.nextSibling;l&&l!==i;){const c=l;l=l.nextSibling,a.appendChild(c)}return e.dom.remove(i),L.each(L.grep(i.childNodes),l=>{a.appendChild(l)}),a}}return n},yv=(e,t,n,s)=>{var o;if(s&&t.merge_siblings!==!1){const r=(o=Cv(e,tC(s),s))!==null&&o!==void 0?o:s;Cv(e,r,tC(r,!0))}},dL=(e,t,n)=>{if(t.clear_child_styles){const s=t.links?"*:not(a)":"*";od(e.select(s,n),o=>{rd(o)&&e.isEditable(o)&&od(t.styles,(r,a)=>{e.setStyle(o,a,"")})})}},ad=(e,t,n)=>{od(e.childNodes,s=>{rd(s)&&(t(s)&&n(s),s.hasChildNodes()&&ad(s,t,n))})},mL=(e,t)=>{t.nodeName==="SPAN"&&e.getAttribs(t).length===0&&e.remove(t,!0)},vv=(e,t)=>n=>!!(n&&Xi(e,n,t)),Ev=(e,t,n)=>s=>{e.setStyle(s,t,n),s.getAttribute("style")===""&&s.removeAttribute("style"),mL(e,s)},fo=Rn.generate([{keep:[]},{rename:["name"]},{removed:[]}]),gL=/^(src|href|style)$/,id=L.each,hl=af,pL=e=>/^(TR|TH|TD)$/.test(e.nodeName),Sv=(e,t,n)=>e.isChildOf(t,n)&&t!==n&&!e.isBlock(n),wv=(e,t,n)=>{let s=t[n?"startContainer":"endContainer"],o=t[n?"startOffset":"endOffset"];if(q(s)){const r=s.childNodes.length-1;!n&&o&&o--,s=s.childNodes[o>r?r:o]}return I(s)&&n&&o>=s.data.length&&(s=new tt(s,e.getBody()).next()||s),I(s)&&!n&&o===0&&(s=new tt(s,e.getBody()).prev()||s),s},kv=(e,t)=>{const n=t?"firstChild":"lastChild",s=e[n];return pL(e)&&s?e.nodeName==="TR"&&s[n]||s:e},ld=(e,t,n,s)=>{var o;const r=e.create(n,s);return(o=t.parentNode)===null||o===void 0||o.insertBefore(r,t),r.appendChild(t),r},_v=(e,t,n,s,o)=>{const r=C.fromDom(t),a=C.fromDom(e.create(s,o)),i=n?ep(r):Jg(r);return zs(a,i),n?(Dt(r,a),$c(a,r)):(es(r,a),je(a,r)),a.dom},hL=(e,t)=>t.links&&e.nodeName==="A",Av=(e,t,n)=>{const s=t.parentNode;let o;const r=e.dom,a=dt(e);Hn(n)&&s===r.getRoot()&&(!n.list_block||!hl(t,n.list_block))&&D(Lt(t.childNodes),i=>{Zo(e,a,i.nodeName.toLowerCase())?o?o.appendChild(i):(o=ld(r,i,a),r.setAttribs(o,ia(e))):o=null}),!(KB(n)&&!hl(n.inline,t))&&r.remove(t,!0)},xv=(e,t,n)=>rn(e)?{name:t,value:null}:{name:e,value:As(t,n)},Nv=(e,t)=>{e.getAttrib(t,"style")===""&&(t.removeAttribute("style"),t.removeAttribute("data-mce-style"))},Rv=(e,t,n,s,o)=>{let r=!1;id(n.styles,(a,i)=>{const{name:l,value:c}=xv(i,a,s),u=lf(c,l);(n.remove_similar||bt(c)||!q(o)||hl(Xi(e,o,l),u))&&e.setStyle(t,l,""),r=!0}),r&&Nv(e,t)},bL=(e,t,n)=>{t==="removeformat"?D(hv(e.selection),s=>{D(fv,o=>e.dom.setStyle(s,o,"")),Nv(e.dom,s)}):dv(e.formatter,t).each(s=>{D(hv(e.selection),o=>Rv(e.dom,o,s,n,null))})},Tv=(e,t,n,s,o)=>{const r=e.dom,a=Wf(e),i=e.schema;if(Je(t)&&iu(i,t.inline)&&qs(i,s)&&s.parentElement===e.getBody())return Av(e,s,t),fo.removed();if(!t.ceFalseOverride&&s&&r.getContentEditableParent(s)==="false"||s&&!pl(r,s,t)&&!hL(s,t))return fo.keep();const l=s,c=t.preserve_attributes;if(Je(t)&&t.remove==="all"&&De(c)){const u=ne(r.getAttribs(l),f=>Se(c,f.name.toLowerCase()));if(r.removeAllAttribs(l),D(u,f=>r.setAttrib(l,f.name,f.value)),u.length>0)return fo.rename("span")}if(t.remove!=="all"){Rv(r,l,t,n,o),id(t.attributes,(f,d)=>{const{name:g,value:h}=xv(d,f,n);if(t.remove_similar||bt(h)||!q(o)||hl(r.getAttrib(o,g),h)){if(g==="class"){const p=r.getAttrib(l,g);if(p){let b="";if(D(p.split(/\s+/),y=>{/mce\-\w+/.test(y)&&(b+=(b?" ":"")+y)}),b){r.setAttrib(l,g,b);return}}}if(gL.test(g)&&l.removeAttribute("data-mce-"+g),g==="style"&&Cn(["li"])(l)&&r.getStyle(l,"list-style-type")==="none"){l.removeAttribute(g),r.setStyle(l,"list-style-type","none");return}g==="class"&&l.removeAttribute("className"),l.removeAttribute(g)}}),id(t.classes,f=>{f=As(f,n),(!q(o)||r.hasClass(o,f))&&r.removeClass(l,f)});const u=r.getAttribs(l);for(let f=0;f<u.length;f++){const d=u[f].nodeName;if(!a.isAttributeInternal(d))return fo.keep()}}return t.remove!=="none"?(Av(e,l,t),fo.removed()):fo.keep()},CL=(e,t,n,s,o)=>{let r;return t.parentNode&&D(Zi(e.dom,t.parentNode).reverse(),a=>{if(!r&&q(a)&&a.id!=="_start"&&a.id!=="_end"){const i=Wn(e,a,n,s,o);i&&i.split!==!1&&(r=a)}}),r},yL=(e,t,n,s)=>Tv(e,t,n,s,s).fold(W(s),o=>(e.dom.createFragment().appendChild(s),e.dom.rename(s,o)),W(null)),vL=(e,t,n,s,o,r,a,i)=>{var l,c;let u,f;const d=e.dom;if(n){const g=n.parentNode;for(let h=s.parentNode;h&&h!==g;h=h.parentNode){let p=d.clone(h,!1);for(let b=0;b<t.length&&(p=yL(e,t[b],i,p),p!==null);b++);p&&(u&&p.appendChild(u),f||(f=p),u=p)}r&&(!a.mixed||!d.isBlock(n))&&(s=(l=d.split(n,s))!==null&&l!==void 0?l:s),u&&f&&((c=o.parentNode)===null||c===void 0||c.insertBefore(u,o),f.appendChild(o),Je(a)&&yv(e,a,i,u))}return s},EL=(e,t,n,s,o)=>{const r=e.formatter.get(t),a=r[0],i=e.dom,l=e.selection,c=p=>{const b=CL(e,p,t,n,o);return vL(e,r,b,p,p,!0,a,n)},u=p=>Zt(p)&&q(p)&&(p.id==="_start"||p.id==="_end"),f=p=>Be(r,b=>Na(e,b,n,p,p)),d=p=>{const b=Lt(p.childNodes),v=f(p)||Be(r,T=>pl(i,p,T)),E=p.parentNode;if(!v&&U(E)&&uf(a)&&f(E),a.deep&&b.length)for(let T=0;T<b.length;T++)d(b[T]);D(["underline","line-through","overline"],T=>{q(p)&&e.dom.getStyle(p,"text-decoration")===T&&p.parentNode&&sC(i,p.parentNode)===T&&Na(e,{deep:!1,exact:!0,inline:"span",styles:{textDecoration:T}},void 0,p)})},g=p=>{const b=i.get(p?"_start":"_end");if(b){let y=b[p?"firstChild":"lastChild"];return u(y)&&(y=y[p?"firstChild":"lastChild"]),I(y)&&y.data.length===0&&(y=p?b.previousSibling||b.nextSibling:b.nextSibling||b.previousSibling),i.remove(b,!0),y}else return null},h=p=>{let b,y,v=ro(i,p,r,{includeTrailingSpace:p.collapsed});if(a.split){if(v=rl(v),b=wv(e,v,!0),y=wv(e,v),b!==y){if(b=kv(b,!0),y=kv(y,!1),Sv(i,b,y)){const w=m.from(b.firstChild).getOr(b);c(_v(i,w,!0,"span",{id:"_start","data-mce-type":"bookmark"})),g(!0);return}if(Sv(i,y,b)){const w=m.from(y.lastChild).getOr(y);c(_v(i,w,!1,"span",{id:"_end","data-mce-type":"bookmark"})),g(!1);return}b=ld(i,b,"span",{id:"_start","data-mce-type":"bookmark"}),y=ld(i,y,"span",{id:"_end","data-mce-type":"bookmark"});const E=i.createRng();E.setStartAfter(b),E.setEndBefore(y),ba(i,E,w=>{D(w,T=>{!Zt(T)&&!Zt(T.parentNode)&&c(T)})}),c(b),c(y),b=g(!0),y=g()}else b=y=c(b);v.startContainer=b.parentNode?b.parentNode:b,v.startOffset=i.nodeIndex(b),v.endContainer=y.parentNode?y.parentNode:y,v.endOffset=i.nodeIndex(y)+1}ba(i,v,E=>{D(E,d)})};if(s){if(ha(s)){const p=i.createRng();p.setStartBefore(s),p.setEndAfter(s),h(p)}else h(s);eb(e,t,s,n);return}!l.isCollapsed()||!Je(a)||Xo(e).length?(eC(e,()=>nf(e,h),p=>Je(a)&&ed(e,t,n,p)),e.nodeChanged()):tL(e,t,n,o),bL(e,t,n),eb(e,t,s,n)},Dv=(e,t,n,s,o)=>{(s||e.selection.isEditable())&&EL(e,t,n,s,o)},Na=(e,t,n,s,o)=>Tv(e,t,n,s,o).fold(Pe,r=>(e.dom.rename(s,r),!0),Ue),Pv=L.each,SL=(e,t,n,s)=>{const o=r=>{if(Fn(r)&&q(r.parentNode)&&e.isEditable(r)){const a=sC(e,r.parentNode);e.getStyle(r,"color")&&a?e.setStyle(r,"text-decoration",a):e.getStyle(r,"text-decoration")===a&&e.setStyle(r,"text-decoration",null)}};t.styles&&(t.styles.color||t.styles.textDecoration)&&(L.walk(s,o,"childNodes"),o(s))},wL=(e,t,n,s)=>{if(t.styles&&t.styles.backgroundColor){const o=vv(e,"fontSize");ad(s,r=>o(r)&&e.isEditable(r),Ev(e,"backgroundColor",As(t.styles.backgroundColor,n)))}},kL=(e,t,n,s)=>{if(Je(t)&&(t.inline==="sub"||t.inline==="sup")){const o=vv(e,"fontSize");ad(s,a=>o(a)&&e.isEditable(a),Ev(e,"fontSize",""));const r=ne(e.select(t.inline==="sup"?"sub":"sup",s),e.isEditable);e.remove(r,!0)}},_L=(e,t,n,s)=>{Pv(t,o=>{Je(o)&&Pv(e.dom.select(o.inline,s),r=>{rd(r)&&Na(e,o,n,r,o.exact?r:null)}),dL(e.dom,o,s)})},AL=(e,t,n,s,o)=>{const r=o.parentNode;Wn(e,r,n,s)&&Na(e,t,s,o)||t.merge_with_parents&&r&&e.dom.getParent(r,a=>Wn(e,a,n,s)?(Na(e,t,s,o),!0):!1)},bl=L.each,xL=(e,t,n,s)=>{if(JD(e)&&Je(t)&&n.parentNode){const o=sh(e.schema),r=jx(C.fromDom(n),a=>Xt(a.dom));return ko(o,s)&&rs(e.schema,n.parentNode,{skipBogus:!1,includeZwsp:!0})&&!r}else return!1},Bv=(e,t,n,s)=>{if(bl(n.styles,(o,r)=>{e.setStyle(t,r,As(o,s))}),n.styles){const o=e.getAttrib(t,"style");o&&e.setAttrib(t,"data-mce-style",o)}},NL=(e,t,n,s)=>{const o=e.formatter.get(t),r=o[0],a=!s&&e.selection.isCollapsed(),i=e.dom,l=e.selection,c=(h,p=r)=>{we(p.onformat)&&p.onformat(h,p,n,s),Bv(i,h,p,n),bl(p.attributes,(b,y)=>{i.setAttrib(h,y,As(b,n))}),bl(p.classes,b=>{const y=As(b,n);i.hasClass(h,y)||i.addClass(h,y)})},u=(h,p)=>{let b=!1;return bl(h,y=>Qt(y)?i.getContentEditable(p)==="false"&&!y.ceFalseOverride||U(y.collapsed)&&y.collapsed!==a?!0:i.is(p,y.selector)&&!Xt(p)?(c(p,y),b=!0,!1):!0:!1),b},f=h=>{if(J(h)){const p=i.create(h);return c(p),p}else return null},d=(h,p,b)=>{const y=[];let v=!0;const E=r.inline||r.block,w=f(E),T=x=>jB(r)&&Wn(e,x,t,n),B=(x,_,P)=>{const z=qB(r)&&of(e.schema,x)&&Zo(e,_,E);return P&&z},H=(x,_,P,z)=>{const X=x.nodeName.toLowerCase(),oe=Zo(e,E,X)&&Zo(e,_,E),ae=!b&&I(x)&&Pi(x.data),ge=Xt(x),ve=!Je(r)||!h.isBlock(x);return(P||z)&&oe&&!ae&&!ge&&ve};ba(h,p,x=>{let _;const P=z=>{let X=!1,oe=v,ae=!1;const ge=z.parentNode,ve=ge.nodeName.toLowerCase(),$e=h.getContentEditable(z);U($e)&&(oe=v,v=$e==="true",X=!0,ae=nC(e,z));const ze=v&&!X;if(Ie(z)&&!xL(e,r,z,ve)){_=null,Hn(r)&&h.remove(z);return}if(T(z)){_=null;return}if(B(z,ve,ze)){const Ke=h.rename(z,E);c(Ke),y.push(Ke),_=null;return}if(Qt(r)){let Ke=u(o,z);if(!Ke&&U(ge)&&uf(r)&&(Ke=u(o,ge)),!Je(r)||Ke){_=null;return}}U(w)&&H(z,ve,ze,ae)?(_||(_=h.clone(w,!1),ge.insertBefore(_,z),y.push(_)),ae&&X&&(v=oe),_.appendChild(z)):(_=null,D(Lt(z.childNodes),P),X&&(v=oe),_=null)};D(x,P)}),r.links===!0&&D(y,x=>{const _=P=>{P.nodeName==="A"&&c(P,r),D(Lt(P.childNodes),_)};_(x)}),D(y,x=>{const _=X=>{let oe=0;return D(X.childNodes,ae=>{!zB(ae)&&!Zt(ae)&&oe++}),oe},P=X=>Ye(X.childNodes,sf).filter(ae=>h.getContentEditable(ae)!=="false"&&pl(h,ae,r)).map(ae=>{const ge=h.clone(ae,!1);return c(ge),h.replace(ge,X,!0),h.remove(ae,!0),ge}).getOr(X),z=_(x);if((y.length>1||!h.isBlock(x))&&z===0){h.remove(x,!0);return}(Je(r)||Hn(r)&&r.wrapper)&&(!r.exact&&z===1&&(x=P(x)),_L(e,o,n,x),AL(e,r,t,n,x),wL(h,r,n,x),SL(h,r,n,x),kL(h,r,n,x),yv(e,r,n,x))})},g=ha(s)?s:l.getNode();if(i.getContentEditable(g)==="false"&&!nC(e,g)){s=g,u(o,s),Jh(e,t,s,n);return}if(r){if(s)if(ha(s)){if(!u(o,s)){const h=i.createRng();h.setStartBefore(s),h.setEndAfter(s),d(i,ro(i,h,o),!0)}}else d(i,s,!0);else!a||!Je(r)||Xo(e).length?(l.setRng(Gf(l.getRng())),eC(e,()=>{nf(e,(h,p)=>{const b=p?h:ro(i,h,o);d(i,b,!1)})},Ue),e.nodeChanged()):eL(e,t,n),dv(e.formatter,t).each(h=>{D(fL(e.selection),p=>Bv(i,p,h,n))});iL(t,e)}Jh(e,t,s,n)},Ov=(e,t,n,s)=>{(s||e.selection.isEditable())&&NL(e,t,n,s)},Iv=e=>se(e,"vars"),RL=(e,t)=>{e.set({}),t.on("NodeChange",n=>{Mv(t,n.element,e.get())}),t.on("FormatApply FormatRemove",n=>{const s=m.from(n.node).map(o=>ha(o)?o:o.startContainer).bind(o=>q(o)?m.some(o):m.from(o.parentElement)).getOrThunk(()=>Fv(t));Mv(t,s,e.get())})},Fv=e=>e.selection.getStart(),Lv=(e,t,n,s,o)=>ng(t,i=>{const l=e.formatter.matchNode(i,n,o??{},s);return!st(l)},i=>ev(e,i,n)?!0:s?!1:U(e.formatter.matchNode(i,n,o,!0))),$v=(e,t)=>{const n=t??Fv(e);return ne(Zi(e.dom,n),s=>q(s)&&!Vs(s))},Mv=(e,t,n)=>{const s=$v(e,t);Ae(n,(o,r)=>{const a=i=>{const l=Lv(e,s,r,i.similar,Iv(i)?i.vars:void 0),c=l.isSome();if(i.state.get()!==c){i.state.set(c);const u=l.getOr(t);Iv(i)?i.callback(c,{node:u,format:r,parents:s}):D(i.callbacks,f=>f(c,{node:u,format:r,parents:s}))}};D([o.withSimilar,o.withoutSimilar],a),D(o.withVars,a)})},TL=(e,t,n,s,o,r)=>{const a=t.get();D(n.split(","),i=>{const l=Oe(a,i).getOrThunk(()=>{const u={withSimilar:{state:et(!1),similar:!0,callbacks:[]},withoutSimilar:{state:et(!1),similar:!1,callbacks:[]},withVars:[]};return a[i]=u,u}),c=()=>{const u=$v(e);return Lv(e,u,i,o,r).isSome()};if(st(r)){const u=o?l.withSimilar:l.withoutSimilar;u.callbacks.push(s),u.callbacks.length===1&&u.state.set(c())}else l.withVars.push({state:et(c()),similar:o,vars:r,callback:s})}),t.set(a)},DL=(e,t,n)=>{const s=e.get();D(t.split(","),o=>Oe(s,o).each(r=>{s[o]={withSimilar:{...r.withSimilar,callbacks:ne(r.withSimilar.callbacks,a=>a!==n)},withoutSimilar:{...r.withoutSimilar,callbacks:ne(r.withoutSimilar.callbacks,a=>a!==n)},withVars:ne(r.withVars,a=>a.callback!==n)}})),e.set(s)},PL=(e,t,n,s,o,r)=>(TL(e,t,n,s,o,r),{unbind:()=>DL(t,n,s)}),BL=(e,t,n,s)=>{const o=e.formatter.get(t);o&&(ed(e,t,n,s)&&(!("toggle"in o[0])||o[0].toggle)?Dv(e,t,n,s):Ov(e,t,n,s))},Uv=L.explode,zv=()=>{const e={};return{addFilter:(o,r)=>{D(Uv(o),a=>{se(e,a)||(e[a]={name:a,callbacks:[]}),e[a].callbacks.push(r)})},getFilters:()=>Ec(e),removeFilter:(o,r)=>{D(Uv(o),a=>{if(se(e,a))if(U(r)){const i=e[a],l=ne(i.callbacks,c=>c!==r);l.length>0?i.callbacks=l:delete e[a]}else delete e[a]})}}},OL=(e,t)=>{D(t,n=>{e.attr(n,null)})},IL=(e,t,n)=>{e.addNodeFilter("font",s=>{D(s,o=>{const r=t.parse(o.attr("style")),a=o.attr("color"),i=o.attr("face"),l=o.attr("size");a&&(r.color=a),i&&(r["font-family"]=i),l&&li(l).each(c=>{r["font-size"]=n[c-1]}),o.name="span",o.attr("style",t.serialize(r)),OL(o,["color","face","size"])})})},FL=(e,t,n)=>{e.addNodeFilter("strike",s=>{const o=t.type!=="html4";D(s,r=>{if(o)r.name="s";else{const a=n.parse(r.attr("style"));a["text-decoration"]="line-through",r.name="span",r.attr("style",n.serialize(a))}})})},LL=(e,t,n)=>{var s;const o=bu();t.convert_fonts_to_spans&&IL(e,o,L.explode((s=t.font_size_legacy_values)!==null&&s!==void 0?s:"")),FL(e,n,o)},$L=(e,t,n)=>{t.inline_styles&&LL(e,t,n)},ML=e=>fetch(e).then(t=>t.ok?t.blob():Promise.reject()).catch(()=>Promise.reject({message:`Cannot convert ${e} to Blob. Resource might not exist or is inaccessible.`,uriType:"blob"})),UL=e=>{const t=/([a-z0-9+\/=\s]+)/i.exec(e);return t?t[1]:""},zL=e=>{try{return decodeURIComponent(e)}catch{return e}},cd=e=>{const[t,...n]=e.split(","),s=n.join(","),o=/data:([^/]+\/[^;]+)(;.+)?/.exec(t);if(o){const r=o[2]===";base64",a=zL(s),i=r?UL(a):a;return m.some({type:o[1],data:i,base64Encoded:r})}else return m.none()},Hv=(e,t,n=!0)=>{let s=t;if(n)try{s=atob(t)}catch{return m.none()}const o=new Uint8Array(s.length);for(let r=0;r<o.length;r++)o[r]=s.charCodeAt(r);return m.some(new Blob([o],{type:e}))},HL=e=>new Promise((t,n)=>{cd(e).bind(({type:s,data:o,base64Encoded:r})=>Hv(s,o,r)).fold(()=>n("Invalid data URI"),t)}),WL=e=>Xe(e,"blob:")?ML(e):Xe(e,"data:")?HL(e):Promise.reject("Unknown URI format"),Wv=e=>new Promise((t,n)=>{const s=new FileReader;s.onloadend=()=>{t(s.result)},s.onerror=()=>{var o;n((o=s.error)===null||o===void 0?void 0:o.message)},s.readAsDataURL(e)});let VL=0;const jL=e=>(e||"blobid")+VL++,Vv=(e,t,n)=>cd(e).bind(({data:s,type:o,base64Encoded:r})=>{if(t&&!r)return m.none();{const a=r?s:btoa(s);return n(a,o)}}),jv=(e,t,n)=>{const s=e.create(jL(),t,n);return e.add(s),s},qv=(e,t,n=!1)=>Vv(t,n,(s,o)=>m.from(e.getByData(s,o)).orThunk(()=>Hv(o,s).map(r=>jv(e,r,s)))),qL=(e,t)=>{const n=()=>Promise.reject("Invalid data URI");if(Xe(t,"blob:")){const s=e.getByUri(t);return U(s)?Promise.resolve(s):WL(t).then(o=>Wv(o).then(r=>Vv(r,!1,a=>m.some(jv(e,o,a))).getOrThunk(n)))}else return Xe(t,"data:")?qv(e,t).fold(n,s=>Promise.resolve(s)):Promise.reject("Unknown image data format")},KL=/^(?:(?:(?:[A-Za-z][A-Za-z\d.+-]{0,14}:\/\/(?:[-.~*+=!&;:'%@?^${}(),\w]+@)?|www\.|[-;:&=+$,.\w]+@)([A-Za-z\d-]+(?:\.[A-Za-z\d-]+)*))(?::\d+)?(?:\/(?:[-.~*+=!;:'%@$(),\/\w]*[-~*+=%@$()\/\w])?)?(?:\?(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?(?:#(?:[-.~*+=!&;:'%@?^${}(),\/\w]+)?)?)$/,GL=e=>m.from(e.match(KL)).bind(t=>_r(t,1)).map(t=>Xe(t,"www.")?t.substring(4):t),Kv=(e,t)=>{m.from(e.attr("src")).bind(GL).forall(n=>!Se(t,n))&&e.attr("sandbox","")},ud=(e,t)=>Xe(e,`${t}/`),YL=e=>st(e)?"iframe":ud(e,"image")?"img":ud(e,"video")?"video":ud(e,"audio")?"audio":"iframe",XL=({type:e,src:t,width:n,height:s}={},o,r)=>{const a=YL(e),i=new yt(a,1);return i.attr(a==="audio"?{src:t}:{src:t,width:n,height:s}),(a==="audio"||a==="video")&&i.attr("controls",""),a==="iframe"&&o&&Kv(i,r),i},ZL=e=>U(e.attr("data-mce-bogus")),QL=e=>e.attr("src")===Ce.transparentSrc||U(e.attr("data-mce-placeholder")),JL=(e,t)=>{const{blob_cache:n}=t;if(n){const s=o=>{const r=o.attr("src");QL(o)||ZL(o)||Ve(r)||qv(n,r,!0).each(a=>{o.attr("src",a.blobUri())})};e.addAttributeFilter("src",o=>D(o,s))}},e$=(e,t)=>{var n,s;const o=e.schema;e.addAttributeFilter("href",l=>{let c=l.length;const u=d=>d.split(" ").filter(h=>h.length>0).concat(["noopener"]).sort().join(" "),f=d=>{const g=d?L.trim(d):"";return/\b(noopener)\b/g.test(g)?g:u(g)};if(!t.allow_unsafe_link_target)for(;c--;){const d=l[c];d.name==="a"&&d.attr("target")==="_blank"&&d.attr("rel",f(d.attr("rel")))}}),t.allow_html_in_named_anchor||e.addAttributeFilter("id,name",l=>{let c=l.length,u,f,d,g;for(;c--;)if(g=l[c],g.name==="a"&&g.firstChild&&!g.attr("href"))for(d=g.parent,u=g.lastChild;u&&d;)f=u.prev,d.insert(u,g),u=f}),t.fix_list_elements&&e.addNodeFilter("ul,ol",l=>{let c=l.length,u,f;for(;c--;)if(u=l[c],f=u.parent,f&&(f.name==="ul"||f.name==="ol"))if(u.prev&&u.prev.name==="li")u.prev.append(u);else{const d=new yt("li",1);d.attr("style","list-style-type: none"),u.wrap(d)}});const r=o.getValidClasses();t.validate&&r&&e.addAttributeFilter("class",l=>{var c;let u=l.length;for(;u--;){const f=l[u],d=(c=f.attr("class"))!==null&&c!==void 0?c:"",g=L.explode(d," ");let h="";for(let p=0;p<g.length;p++){const b=g[p];let y=!1,v=r["*"];v&&v[b]&&(y=!0),v=r[f.name],!y&&v&&v[b]&&(y=!0),y&&(h&&(h+=" "),h+=b)}h.length||(h=null),f.attr("class",h)}}),JL(e,t);const a=(n=t.sandbox_iframes)!==null&&n!==void 0?n:!1,i=og((s=t.sandbox_iframes_exclusions)!==null&&s!==void 0?s:[]);t.convert_unsafe_embeds&&e.addNodeFilter("object,embed",l=>D(l,c=>{c.replace(XL({type:c.attr("type"),src:c.name==="object"?c.attr("data"):c.attr("src"),width:c.attr("width"),height:c.attr("height")},a,i))})),a&&e.addNodeFilter("iframe",l=>D(l,c=>Kv(c,i)))};/*! @license DOMPurify 3.2.4 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.4/LICENSE */const{entries:Gv,setPrototypeOf:Yv,isFrozen:t$,getPrototypeOf:n$,getOwnPropertyDescriptor:s$}=Object;let{freeze:Bt,seal:cn,create:Xv}=Object,{apply:fd,construct:dd}=typeof Reflect<"u"&&Reflect;Bt||(Bt=function(t){return t}),cn||(cn=function(t){return t}),fd||(fd=function(t,n,s){return t.apply(n,s)}),dd||(dd=function(t,n){return new t(...n)});const Cl=It(Array.prototype.forEach),o$=It(Array.prototype.lastIndexOf),Zv=It(Array.prototype.pop),Ra=It(Array.prototype.push),r$=It(Array.prototype.splice),yl=It(String.prototype.toLowerCase),md=It(String.prototype.toString),Qv=It(String.prototype.match),Ta=It(String.prototype.replace),a$=It(String.prototype.indexOf),i$=It(String.prototype.trim),wn=It(Object.prototype.hasOwnProperty),Ot=It(RegExp.prototype.test),Da=l$(TypeError);function It(e){return function(t){for(var n=arguments.length,s=new Array(n>1?n-1:0),o=1;o<n;o++)s[o-1]=arguments[o];return fd(e,t,s)}}function l$(e){return function(){for(var t=arguments.length,n=new Array(t),s=0;s<t;s++)n[s]=arguments[s];return dd(e,n)}}function ke(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:yl;Yv&&Yv(e,null);let s=t.length;for(;s--;){let o=t[s];if(typeof o=="string"){const r=n(o);r!==o&&(t$(t)||(t[s]=r),o=r)}e[o]=!0}return e}function c$(e){for(let t=0;t<e.length;t++)wn(e,t)||(e[t]=null);return e}function mo(e){const t=Xv(null);for(const[n,s]of Gv(e))wn(e,n)&&(Array.isArray(s)?t[n]=c$(s):s&&typeof s=="object"&&s.constructor===Object?t[n]=mo(s):t[n]=s);return t}function Pa(e,t){for(;e!==null;){const s=s$(e,t);if(s){if(s.get)return It(s.get);if(typeof s.value=="function")return It(s.value)}e=n$(e)}function n(){return null}return n}const Jv=Bt(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),gd=Bt(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),pd=Bt(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),u$=Bt(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),hd=Bt(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),f$=Bt(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),eE=Bt(["#text"]),tE=Bt(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),bd=Bt(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),nE=Bt(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),vl=Bt(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),d$=cn(/\{\{[\w\W]*|[\w\W]*\}\}/gm),m$=cn(/<%[\w\W]*|[\w\W]*%>/gm),g$=cn(/\$\{[\w\W]*/gm),p$=cn(/^data-[\-\w.\u00B7-\uFFFF]+$/),h$=cn(/^aria-[\-\w]+$/),sE=cn(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),b$=cn(/^(?:\w+script|data):/i),C$=cn(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),oE=cn(/^html$/i),y$=cn(/^[a-z][.\w]*(-[.\w]+)+$/i);var rE=Object.freeze({__proto__:null,ARIA_ATTR:h$,ATTR_WHITESPACE:C$,CUSTOM_ELEMENT:y$,DATA_ATTR:p$,DOCTYPE_NAME:oE,ERB_EXPR:m$,IS_ALLOWED_URI:sE,IS_SCRIPT_OR_DATA:b$,MUSTACHE_EXPR:d$,TMPLIT_EXPR:g$});const Ba={element:1,attribute:2,text:3,cdataSection:4,entityReference:5,entityNode:6,progressingInstruction:7,comment:8,document:9,documentType:10,documentFragment:11,notation:12},v$=function(){return typeof window>"u"?null:window},E$=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let s=null;const o="data-tt-policy-suffix";n&&n.hasAttribute(o)&&(s=n.getAttribute(o));const r="dompurify"+(s?"#"+s:"");try{return t.createPolicy(r,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+r+" could not be created."),null}},aE=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function iE(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:v$();const t=ue=>iE(ue);if(t.version="3.2.4",t.removed=[],!e||!e.document||e.document.nodeType!==Ba.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const s=n,o=s.currentScript,{DocumentFragment:r,HTMLTemplateElement:a,Node:i,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:f,DOMParser:d,trustedTypes:g}=e,h=l.prototype,p=Pa(h,"cloneNode"),b=Pa(h,"remove"),y=Pa(h,"nextSibling"),v=Pa(h,"childNodes"),E=Pa(h,"parentNode");if(typeof a=="function"){const ue=n.createElement("template");ue.content&&ue.content.ownerDocument&&(n=ue.content.ownerDocument)}let w,T="";const{implementation:B,createNodeIterator:H,createDocumentFragment:x,getElementsByTagName:_}=n,{importNode:P}=s;let z=aE();t.isSupported=typeof Gv=="function"&&typeof E=="function"&&B&&B.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:X,ERB_EXPR:oe,TMPLIT_EXPR:ae,DATA_ATTR:ge,ARIA_ATTR:ve,IS_SCRIPT_OR_DATA:$e,ATTR_WHITESPACE:ze,CUSTOM_ELEMENT:Ke}=rE;let{IS_ALLOWED_URI:M}=rE,Y=null;const me=ke({},[...Jv,...gd,...pd,...hd,...eE]);let pe=null;const R=ke({},[...tE,...bd,...nE,...vl]);let O=Object.seal(Xv(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),K=null,ie=null,le=!0,ye=!0,sn=!1,Kn=!0,Et=!1,fn=!0,jt=!1,pt=!1,St=!1,on=!1,Os=!1,Q=!1,fe=!0,Fe=!1;const He="user-content-";let Ge=!0,Me=!1,Re={},Te=null;const wt=ke({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let dn=null;const Gn=ke({},["audio","video","img","source","image","track"]);let An=null;const pr=ke({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),hr="http://www.w3.org/1998/Math/MathML",Eo="http://www.w3.org/2000/svg",mn="http://www.w3.org/1999/xhtml";let Is=mn,Za=!1,br=null;const T_=ke({},[hr,Eo,mn],md);let Qa=ke({},["mi","mo","mn","ms","mtext"]),Ja=ke({},["annotation-xml"]);const D_=ke({},["title","style","font","a","script"]);let Cr=null;const Fs=["application/xhtml+xml","text/html"],mc="text/html";let S=null,k=null;const $=n.createElement("form"),F=function(A){return A instanceof RegExp||A instanceof Function},ee=function(){let A=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(k&&k===A)){if((!A||typeof A!="object")&&(A={}),A=mo(A),Cr=Fs.indexOf(A.PARSER_MEDIA_TYPE)===-1?mc:A.PARSER_MEDIA_TYPE,S=Cr==="application/xhtml+xml"?md:yl,Y=wn(A,"ALLOWED_TAGS")?ke({},A.ALLOWED_TAGS,S):me,pe=wn(A,"ALLOWED_ATTR")?ke({},A.ALLOWED_ATTR,S):R,br=wn(A,"ALLOWED_NAMESPACES")?ke({},A.ALLOWED_NAMESPACES,md):T_,An=wn(A,"ADD_URI_SAFE_ATTR")?ke(mo(pr),A.ADD_URI_SAFE_ATTR,S):pr,dn=wn(A,"ADD_DATA_URI_TAGS")?ke(mo(Gn),A.ADD_DATA_URI_TAGS,S):Gn,Te=wn(A,"FORBID_CONTENTS")?ke({},A.FORBID_CONTENTS,S):wt,K=wn(A,"FORBID_TAGS")?ke({},A.FORBID_TAGS,S):{},ie=wn(A,"FORBID_ATTR")?ke({},A.FORBID_ATTR,S):{},Re=wn(A,"USE_PROFILES")?A.USE_PROFILES:!1,le=A.ALLOW_ARIA_ATTR!==!1,ye=A.ALLOW_DATA_ATTR!==!1,sn=A.ALLOW_UNKNOWN_PROTOCOLS||!1,Kn=A.ALLOW_SELF_CLOSE_IN_ATTR!==!1,Et=A.SAFE_FOR_TEMPLATES||!1,fn=A.SAFE_FOR_XML!==!1,jt=A.WHOLE_DOCUMENT||!1,on=A.RETURN_DOM||!1,Os=A.RETURN_DOM_FRAGMENT||!1,Q=A.RETURN_TRUSTED_TYPE||!1,St=A.FORCE_BODY||!1,fe=A.SANITIZE_DOM!==!1,Fe=A.SANITIZE_NAMED_PROPS||!1,Ge=A.KEEP_CONTENT!==!1,Me=A.IN_PLACE||!1,M=A.ALLOWED_URI_REGEXP||sE,Is=A.NAMESPACE||mn,Qa=A.MATHML_TEXT_INTEGRATION_POINTS||Qa,Ja=A.HTML_INTEGRATION_POINTS||Ja,O=A.CUSTOM_ELEMENT_HANDLING||{},A.CUSTOM_ELEMENT_HANDLING&&F(A.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(O.tagNameCheck=A.CUSTOM_ELEMENT_HANDLING.tagNameCheck),A.CUSTOM_ELEMENT_HANDLING&&F(A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(O.attributeNameCheck=A.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),A.CUSTOM_ELEMENT_HANDLING&&typeof A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(O.allowCustomizedBuiltInElements=A.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),Et&&(ye=!1),Os&&(on=!0),Re&&(Y=ke({},eE),pe=[],Re.html===!0&&(ke(Y,Jv),ke(pe,tE)),Re.svg===!0&&(ke(Y,gd),ke(pe,bd),ke(pe,vl)),Re.svgFilters===!0&&(ke(Y,pd),ke(pe,bd),ke(pe,vl)),Re.mathMl===!0&&(ke(Y,hd),ke(pe,nE),ke(pe,vl))),A.ADD_TAGS&&(Y===me&&(Y=mo(Y)),ke(Y,A.ADD_TAGS,S)),A.ADD_ATTR&&(pe===R&&(pe=mo(pe)),ke(pe,A.ADD_ATTR,S)),A.ADD_URI_SAFE_ATTR&&ke(An,A.ADD_URI_SAFE_ATTR,S),A.FORBID_CONTENTS&&(Te===wt&&(Te=mo(Te)),ke(Te,A.FORBID_CONTENTS,S)),Ge&&(Y["#text"]=!0),jt&&ke(Y,["html","head","body"]),Y.table&&(ke(Y,["tbody"]),delete K.tbody),A.TRUSTED_TYPES_POLICY){if(typeof A.TRUSTED_TYPES_POLICY.createHTML!="function")throw Da('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof A.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Da('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');w=A.TRUSTED_TYPES_POLICY,T=w.createHTML("")}else w===void 0&&(w=E$(g,o)),w!==null&&typeof T=="string"&&(T=w.createHTML(""));Bt&&Bt(A),k=A}},de=ke({},[...gd,...pd,...u$]),Le=ke({},[...hd,...f$]),xn=function(A){let Z=E(A);(!Z||!Z.tagName)&&(Z={namespaceURI:Is,tagName:"template"});const re=yl(A.tagName),We=yl(Z.tagName);return br[A.namespaceURI]?A.namespaceURI===Eo?Z.namespaceURI===mn?re==="svg":Z.namespaceURI===hr?re==="svg"&&(We==="annotation-xml"||Qa[We]):!!de[re]:A.namespaceURI===hr?Z.namespaceURI===mn?re==="math":Z.namespaceURI===Eo?re==="math"&&Ja[We]:!!Le[re]:A.namespaceURI===mn?Z.namespaceURI===Eo&&!Ja[We]||Z.namespaceURI===hr&&!Qa[We]?!1:!Le[re]&&(D_[re]||!de[re]):!!(Cr==="application/xhtml+xml"&&br[A.namespaceURI]):!1},gn=function(A){Ra(t.removed,{element:A});try{E(A).removeChild(A)}catch{b(A)}},ei=function(A,Z){try{Ra(t.removed,{attribute:Z.getAttributeNode(A),from:Z})}catch{Ra(t.removed,{attribute:null,from:Z})}if(Z.removeAttribute(A),A==="is")if(on||Os)try{gn(Z)}catch{}else try{Z.setAttribute(A,"")}catch{}},P_=function(A){let Z=null,re=null;if(St)A="<remove></remove>"+A;else{const ht=Qv(A,/^[\r\n\t ]+/);re=ht&&ht[0]}Cr==="application/xhtml+xml"&&Is===mn&&(A='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+A+"</body></html>");const We=w?w.createHTML(A):A;if(Is===mn)try{Z=new d().parseFromString(We,Cr)}catch{}if(!Z||!Z.documentElement){Z=B.createDocument(Is,"template",null);try{Z.documentElement.innerHTML=Za?T:We}catch{}}const Rt=Z.body||Z.documentElement;return A&&re&&Rt.insertBefore(n.createTextNode(re),Rt.childNodes[0]||null),Is===mn?_.call(Z,jt?"html":"body")[0]:jt?Z.documentElement:Rt},B_=function(A){return H.call(A.ownerDocument||A,A,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},jm=function(A){return A instanceof f&&(typeof A.nodeName!="string"||typeof A.textContent!="string"||typeof A.removeChild!="function"||!(A.attributes instanceof u)||typeof A.removeAttribute!="function"||typeof A.setAttribute!="function"||typeof A.namespaceURI!="string"||typeof A.insertBefore!="function"||typeof A.hasChildNodes!="function")},O_=function(A){return typeof i=="function"&&A instanceof i};function fs(ue,A,Z){Cl(ue,re=>{re.call(t,A,Z,k)})}const I_=function(A){let Z=null;if(fs(z.beforeSanitizeElements,A,null),jm(A))return gn(A),!0;const re=S(A.nodeName);if(fs(z.uponSanitizeElement,A,{tagName:re,allowedTags:Y}),A.hasChildNodes()&&!O_(A.firstElementChild)&&Ot(/<[/\w]/g,A.innerHTML)&&Ot(/<[/\w]/g,A.textContent)||A.nodeType===Ba.progressingInstruction||fn&&A.nodeType===Ba.comment&&Ot(/<[/\w]/g,A.data))return gn(A),!0;if(!Y[re]||K[re]){if(!K[re]&&L_(re)&&(O.tagNameCheck instanceof RegExp&&Ot(O.tagNameCheck,re)||O.tagNameCheck instanceof Function&&O.tagNameCheck(re)))return!1;if(Ge&&!Te[re]){const We=E(A)||A.parentNode,Rt=v(A)||A.childNodes;if(Rt&&We){const ht=Rt.length;for(let qt=ht-1;qt>=0;--qt){const Yn=p(Rt[qt],!0);Yn.__removalCount=(A.__removalCount||0)+1,We.insertBefore(Yn,y(A))}}}return gn(A),!0}return A instanceof l&&!xn(A)||(re==="noscript"||re==="noembed"||re==="noframes")&&Ot(/<\/no(script|embed|frames)/i,A.innerHTML)?(gn(A),!0):(Et&&A.nodeType===Ba.text&&(Z=A.textContent,Cl([X,oe,ae],We=>{Z=Ta(Z,We," ")}),A.textContent!==Z&&(Ra(t.removed,{element:A.cloneNode()}),A.textContent=Z)),fs(z.afterSanitizeElements,A,null),!1)},F_=function(A,Z,re){if(fe&&(Z==="id"||Z==="name")&&(re in n||re in $))return!1;if(!(ye&&!ie[Z]&&Ot(ge,Z))){if(!(le&&Ot(ve,Z))){if(!pe[Z]||ie[Z]){if(!(L_(A)&&(O.tagNameCheck instanceof RegExp&&Ot(O.tagNameCheck,A)||O.tagNameCheck instanceof Function&&O.tagNameCheck(A))&&(O.attributeNameCheck instanceof RegExp&&Ot(O.attributeNameCheck,Z)||O.attributeNameCheck instanceof Function&&O.attributeNameCheck(Z))||Z==="is"&&O.allowCustomizedBuiltInElements&&(O.tagNameCheck instanceof RegExp&&Ot(O.tagNameCheck,re)||O.tagNameCheck instanceof Function&&O.tagNameCheck(re))))return!1}else if(!An[Z]){if(!Ot(M,Ta(re,ze,""))){if(!((Z==="src"||Z==="xlink:href"||Z==="href")&&A!=="script"&&a$(re,"data:")===0&&dn[A])){if(!(sn&&!Ot($e,Ta(re,ze,"")))){if(re)return!1}}}}}}return!0},L_=function(A){return A!=="annotation-xml"&&Qv(A,Ke)},$_=function(A){fs(z.beforeSanitizeAttributes,A,null);const{attributes:Z}=A;if(!Z||jm(A))return;const re={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:pe,forceKeepAttr:void 0};let We=Z.length;for(;We--;){const Rt=Z[We],{name:ht,namespaceURI:qt,value:Yn}=Rt,ti=S(ht);let kt=ht==="value"?Yn:i$(Yn);const w5=kt;if(re.attrName=ti,re.attrValue=kt,re.keepAttr=!0,re.forceKeepAttr=void 0,fs(z.uponSanitizeAttribute,A,re),kt=re.attrValue,Fe&&(ti==="id"||ti==="name")&&(ei(ht,A),kt=He+kt),fn&&Ot(/((--!?|])>)|<\/(style|title)/i,kt)){ei(ht,A);continue}if(re.forceKeepAttr)continue;if(!re.keepAttr){ei(ht,A);continue}if(!Kn&&Ot(/\/>/i,kt)){ei(ht,A);continue}Et&&Cl([X,oe,ae],U_=>{kt=Ta(kt,U_," ")});const M_=S(A.nodeName);if(!F_(M_,ti,kt)){ei(ht,A);continue}if(w&&typeof g=="object"&&typeof g.getAttributeType=="function"&&!qt)switch(g.getAttributeType(M_,ti)){case"TrustedHTML":{kt=w.createHTML(kt);break}case"TrustedScriptURL":{kt=w.createScriptURL(kt);break}}if(kt!==w5)try{qt?A.setAttributeNS(qt,ht,kt):A.setAttribute(ht,kt),jm(A)?gn(A):Zv(t.removed)}catch{}}fs(z.afterSanitizeAttributes,A,null)},S5=function ue(A){let Z=null;const re=B_(A);for(fs(z.beforeSanitizeShadowDOM,A,null);Z=re.nextNode();)fs(z.uponSanitizeShadowNode,Z,null),I_(Z),$_(Z),Z.content instanceof r&&ue(Z.content);fs(z.afterSanitizeShadowDOM,A,null)};return t.sanitize=function(ue){let A=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Z=null,re=null,We=null,Rt=null;if(Za=!ue,Za&&(ue="<!-->"),typeof ue!="string"&&!O_(ue))if(typeof ue.toString=="function"){if(ue=ue.toString(),typeof ue!="string")throw Da("dirty is not a string, aborting")}else throw Da("toString is not a function");if(!t.isSupported)return ue;if(pt||ee(A),t.removed=[],typeof ue=="string"&&(Me=!1),Me){if(ue.nodeName){const Yn=S(ue.nodeName);if(!Y[Yn]||K[Yn])throw Da("root node is forbidden and cannot be sanitized in-place")}}else if(ue instanceof i)Z=P_("<!---->"),re=Z.ownerDocument.importNode(ue,!0),re.nodeType===Ba.element&&re.nodeName==="BODY"||re.nodeName==="HTML"?Z=re:Z.appendChild(re);else{if(!on&&!Et&&!jt&&ue.indexOf("<")===-1)return w&&Q?w.createHTML(ue):ue;if(Z=P_(ue),!Z)return on?null:Q?T:""}Z&&St&&gn(Z.firstChild);const ht=B_(Me?ue:Z);for(;We=ht.nextNode();)I_(We),$_(We),We.content instanceof r&&S5(We.content);if(Me)return ue;if(on){if(Os)for(Rt=x.call(Z.ownerDocument);Z.firstChild;)Rt.appendChild(Z.firstChild);else Rt=Z;return(pe.shadowroot||pe.shadowrootmode)&&(Rt=P.call(s,Rt,!0)),Rt}let qt=jt?Z.outerHTML:Z.innerHTML;return jt&&Y["!doctype"]&&Z.ownerDocument&&Z.ownerDocument.doctype&&Z.ownerDocument.doctype.name&&Ot(oE,Z.ownerDocument.doctype.name)&&(qt="<!DOCTYPE "+Z.ownerDocument.doctype.name+`>
`+qt),Et&&Cl([X,oe,ae],Yn=>{qt=Ta(qt,Yn," ")}),w&&Q?w.createHTML(qt):qt},t.setConfig=function(){let ue=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};ee(ue),pt=!0},t.clearConfig=function(){k=null,pt=!1},t.isValidAttribute=function(ue,A,Z){k||ee({});const re=S(ue),We=S(A);return F_(re,We,Z)},t.addHook=function(ue,A){typeof A=="function"&&Ra(z[ue],A)},t.removeHook=function(ue,A){if(A!==void 0){const Z=o$(z[ue],A);return Z===-1?void 0:r$(z[ue],Z,1)[0]}return Zv(z[ue])},t.removeHooks=function(ue){z[ue]=[]},t.removeAllHooks=function(){z=aE()},t}var Cd=iE();const lE=L.each,S$=L.trim,w$=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],k$={ftp:21,http:80,https:443,mailto:25},_$=["img","video"],A$=(e,t)=>U(e)?!e:U(t)?!Se(_$,t):!0,x$=e=>{try{return decodeURIComponent(e)}catch{return unescape(e)}},cE=(e,t,n)=>{const s=x$(t).replace(/\s/g,"");return e.allow_script_urls?!1:/((java|vb)script|mhtml):/i.test(s)?!0:e.allow_html_data_urls?!1:/^data:image\//i.test(s)?A$(e.allow_svg_data_urls,n)&&/^data:image\/svg\+xml/i.test(s):/^data:/i.test(s)};class un{static parseDataUri(t){let n;const s=decodeURIComponent(t).split(","),o=/data:([^;]+)/.exec(s[0]);return o&&(n=o[1]),{type:n,data:s[1]}}static isDomSafe(t,n,s={}){if(s.allow_script_urls)return!0;{const o=Gs.decode(t).replace(/[\s\u0000-\u001F]+/g,"");return!cE(s,o,n)}}static getDocumentBaseUrl(t){var n;let s;return t.protocol.indexOf("http")!==0&&t.protocol!=="file:"?s=(n=t.href)!==null&&n!==void 0?n:"":s=t.protocol+"//"+t.host+t.pathname,/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/")),s}constructor(t,n={}){this.path="",this.directory="",t=S$(t),this.settings=n;const s=n.base_uri,o=this;if(/^([\w\-]+):([^\/]{2})/i.test(t)||/^\s*#/.test(t)){o.source=t;return}const r=t.indexOf("//")===0;if(t.indexOf("/")===0&&!r&&(t=(s&&s.protocol||"http")+"://mce_host"+t),!/^[\w\-]*:?\/\//.test(t)){const i=s?s.path:new un(document.location.href).directory;if((s==null?void 0:s.protocol)==="")t="//mce_host"+o.toAbsPath(i,t);else{const l=/([^#?]*)([#?]?.*)/.exec(t);l&&(t=(s&&s.protocol||"http")+"://mce_host"+o.toAbsPath(i,l[1])+l[2])}}t=t.replace(/@@/g,"(mce_at)");const a=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@\/]*):?([^:@\/]*))?@)?(\[[a-zA-Z0-9:.%]+\]|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/.exec(t);a&&lE(w$,(i,l)=>{let c=a[l];c&&(c=c.replace(/\(mce_at\)/g,"@@")),o[i]=c}),s&&(o.protocol||(o.protocol=s.protocol),o.userInfo||(o.userInfo=s.userInfo),!o.port&&o.host==="mce_host"&&(o.port=s.port),(!o.host||o.host==="mce_host")&&(o.host=s.host),o.source=""),r&&(o.protocol="")}setPath(t){const n=/^(.*?)\/?(\w+)?$/.exec(t);n&&(this.path=n[0],this.directory=n[1],this.file=n[2]),this.source="",this.getURI()}toRelative(t){if(t==="./")return t;const n=new un(t,{base_uri:this});if(n.host!=="mce_host"&&this.host!==n.host&&n.host||this.port!==n.port||this.protocol!==n.protocol&&n.protocol!=="")return n.getURI();const s=this.getURI(),o=n.getURI();if(s===o||s.charAt(s.length-1)==="/"&&s.substr(0,s.length-1)===o)return s;let r=this.toRelPath(this.path,n.path);return n.query&&(r+="?"+n.query),n.anchor&&(r+="#"+n.anchor),r}toAbsolute(t,n){const s=new un(t,{base_uri:this});return s.getURI(n&&this.isSameOrigin(s))}isSameOrigin(t){if(this.host==t.host&&this.protocol==t.protocol){if(this.port==t.port)return!0;const n=this.protocol?k$[this.protocol]:null;if(n&&(this.port||n)==(t.port||n))return!0}return!1}toRelPath(t,n){let s=0,o="",r,a;const i=t.substring(0,t.lastIndexOf("/")).split("/"),l=n.split("/");if(i.length>=l.length){for(r=0,a=i.length;r<a;r++)if(r>=l.length||i[r]!==l[r]){s=r+1;break}}if(i.length<l.length){for(r=0,a=l.length;r<a;r++)if(r>=i.length||i[r]!==l[r]){s=r+1;break}}if(s===1)return n;for(r=0,a=i.length-(s-1);r<a;r++)o+="../";for(r=s-1,a=l.length;r<a;r++)r!==s-1?o+="/"+l[r]:o+=l[r];return o}toAbsPath(t,n){let s=0;const o=/\/$/.test(n)?"/":"",r=t.split("/"),a=n.split("/"),i=[];lE(r,f=>{f&&i.push(f)});const l=[];for(let f=a.length-1;f>=0;f--)if(!(a[f].length===0||a[f]===".")){if(a[f]===".."){s++;continue}if(s>0){s--;continue}l.push(a[f])}const c=i.length-s;let u;return c<=0?u=kr(l).join("/"):u=i.slice(0,c).join("/")+"/"+kr(l).join("/"),u.indexOf("/")!==0&&(u="/"+u),o&&u.lastIndexOf("/")!==u.length-1&&(u+=o),u}getURI(t=!1){let n;return(!this.source||t)&&(n="",t||(this.protocol?n+=this.protocol+"://":n+="//",this.userInfo&&(n+=this.userInfo+"@"),this.host&&(n+=this.host),this.port&&(n+=":"+this.port)),this.path&&(n+=this.path),this.query&&(n+="?"+this.query),this.anchor&&(n+="#"+this.anchor),this.source=n),this.source}}const N$=L.makeMap("src,href,data,background,action,formaction,poster,xlink:href"),yd="data-mce-type";let uE=0;const fE=(e,t,n,s,o)=>{var r,a,i,l;const c=t.validate,u=n.getSpecialElements();e.nodeType===di&&!t.allow_conditional_comments&&/^\[if/i.test((r=e.nodeValue)!==null&&r!==void 0?r:"")&&(e.nodeValue=" "+e.nodeValue);const f=(a=o==null?void 0:o.tagName)!==null&&a!==void 0?a:e.nodeName.toLowerCase();if(s!=="html"&&n.isValid(s)){U(o)&&(o.allowedTags[f]=!0);return}if(e.nodeType!==Or||f==="body")return;const d=C.fromDom(e),g=Ur(d,yd),h=zt(d,"data-mce-bogus");if(!g&&J(h)){h==="all"?Ne(d):hs(d);return}const p=n.getElementRule(f);if(c&&!p){se(u,f)?Ne(d):hs(d);return}else U(o)&&(o.allowedTags[f]=!0);if(c&&p&&!g){if(D((i=p.attributesForced)!==null&&i!==void 0?i:[],b=>{ot(d,b.name,b.value==="{$uid}"?`mce_${uE++}`:b.value)}),D((l=p.attributesDefault)!==null&&l!==void 0?l:[],b=>{Ur(d,b.name)||ot(d,b.name,b.value==="{$uid}"?`mce_${uE++}`:b.value)}),p.attributesRequired&&!Be(p.attributesRequired,b=>Ur(d,b))){hs(d);return}if(p.removeEmptyAttrs&&Ex(d)){hs(d);return}p.outputName&&p.outputName!==f&&wx(d,p.outputName)}},R$=(e,t,n,s,o)=>{const r=e.tagName.toLowerCase(),{attrName:a,attrValue:i}=o;o.keepAttr=dE(t,n,s,r,a,i),o.keepAttr?(o.allowedAttributes[a]=!0,gE(a,n)&&(o.attrValue=a),t.allow_svg_data_urls&&Xe(i,"data:image/svg+xml")&&(o.forceKeepAttr=!0)):mE(e,a)&&(o.forceKeepAttr=!0)},dE=(e,t,n,s,o,r)=>n!=="html"&&!js(s)?!0:!(o in N$&&cE(e,r,s))&&(!e.validate||t.isValid(s,o)||Xe(o,"data-")||Xe(o,"aria-")),mE=(e,t)=>e.hasAttribute(yd)&&(t==="id"||t==="class"||t==="style"),gE=(e,t)=>e in t.getBoolAttrs(),T$=(e,t,n,s)=>{const{attributes:o}=e;for(let r=o.length-1;r>=0;r--){const a=o[r],i=a.name,l=a.value;!dE(t,n,s,e.tagName.toLowerCase(),i,l)&&!mE(e,i)?e.removeAttribute(i):gE(i,n)&&e.setAttribute(i,i)}},D$=(e,t,n)=>{const s=Cd();return s.addHook("uponSanitizeElement",(o,r)=>{fE(o,e,t,n.track(o),r)}),s.addHook("uponSanitizeAttribute",(o,r)=>{R$(o,e,t,n.current(),r)}),s},P$=(e,t)=>{const s={...{IN_PLACE:!0,ALLOW_UNKNOWN_PROTOCOLS:!0,ALLOWED_TAGS:["#comment","#cdata-section","body"],ALLOWED_ATTR:[],SAFE_FOR_XML:!1}};return s.PARSER_MEDIA_TYPE=t,e.allow_script_urls?s.ALLOWED_URI_REGEXP=/.*/:e.allow_html_data_urls&&(s.ALLOWED_URI_REGEXP=/^(?!(\w+script|mhtml):)/i),s},B$=e=>{const t=["type","href","role","arcrole","title","show","actuate","label","from","to"].map(s=>`xlink:${s}`),n={IN_PLACE:!0,USE_PROFILES:{html:!0,svg:!0,svgFilters:!0},ALLOWED_ATTR:t};Cd().sanitize(e,n)},O$=(e,t)=>{const n={IN_PLACE:!0,USE_PROFILES:{mathMl:!0}},s=Cd(),o=t.allow_mathml_annotation_encodings,r=De(o)&&o.length>0,a=l=>{const c=l.getAttribute("encoding");return r&&J(c)&&Se(o,c)},i=(l,c)=>r&&c==="semantics"?m.some(!0):c==="annotation"?m.some(q(l)&&a(l)):De(t.extended_mathml_elements)&&t.extended_mathml_elements.includes(c)?m.from(!0):m.none();s.addHook("uponSanitizeElement",(l,c)=>{var u;const f=(u=c.tagName)!==null&&u!==void 0?u:l.nodeName.toLowerCase();i(l,f).each(g=>{c.allowedTags[f]=g,!g&&t.sanitize&&q(l)&&l.remove()})}),s.addHook("uponSanitizeAttribute",(l,c)=>{De(t.extended_mathml_attributes)&&t.extended_mathml_attributes.includes(c.attrName)&&(c.forceKeepAttr=!0)}),s.sanitize(e,n)},I$=e=>t=>{const n=Lp(t);if(n==="svg")B$(t);else if(n==="math")O$(t,e);else throw new Error("Not a namespace element")},F$=(e,t)=>{const n=zN();if(e.sanitize){const s=D$(e,t,n);return{sanitizeHtmlElement:(r,a)=>{s.sanitize(r,P$(e,a)),s.removed=[],n.reset()},sanitizeNamespaceElement:I$(e)}}else return{sanitizeHtmlElement:(r,a)=>{const i=document.createNodeIterator(r,NodeFilter.SHOW_ELEMENT|NodeFilter.SHOW_COMMENT|NodeFilter.SHOW_TEXT);let l;for(;l=i.nextNode();){const c=n.track(l);fE(l,e,t,c),q(l)&&T$(l,e,t,c)}n.reset()},sanitizeNamespaceElement:ce}},pE=L.makeMap,hE=L.extend,bE=(e,t,n,s)=>{const o=e.name,r=o in n&&o!=="title"&&o!=="textarea"&&o!=="noscript",a=t.childNodes;for(let i=0,l=a.length;i<l;i++){const c=a[i],u=new yt(c.nodeName.toLowerCase(),c.nodeType);if(q(c)){const f=c.attributes;for(let d=0,g=f.length;d<g;d++){const h=f[d];u.attr(h.name,h.value)}js(u.name)&&(s(c),u.value=c.innerHTML)}else I(c)?(u.value=c.data,r&&(u.raw=!0)):(ys(c)||xN(c)||NN(c))&&(u.value=c.data);js(u.name)||bE(u,c,n,s),e.append(u)}},L$=(e,t,n)=>{const s=[];for(let o=e,r=o;o;r=o,o=o.walk()){const a=o;D(t,i=>i(a)),Ve(a.parent)&&a!==e?o=r:s.push(a)}for(let o=s.length-1;o>=0;o--){const r=s[o];D(n,a=>a(r))}},$$=(e,t,n,s)=>{const o=n.validate,r=t.getNonEmptyElements(),a=t.getWhitespaceElements(),i=hE(pE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),l=sh(t),c=/[ \t\r\n]+/g,u=/^[ \t\r\n]+/,f=/[ \t\r\n]+$/,d=v=>{let E=v.parent;for(;U(E);){if(E.name in a)return!0;E=E.parent}return!1},g=v=>{let E=v;for(;U(E);){if(E.name in l)return _a(t,r,a,E);E=E.parent}return!1},h=v=>v.name in i||cu(t,v)||js(v.name)&&v.parent===e,p=(v,E)=>{const w=E?v.prev:v.next;return U(w)||Ve(v.parent)?!1:h(v.parent)&&(v.parent!==e||s.isRootContent===!0)};return[v=>{var E;if(v.type===3&&!d(v)){let w=(E=v.value)!==null&&E!==void 0?E:"";w=w.replace(c," "),(eF(v.prev,h)||p(v,!0))&&(w=w.replace(u,"")),w.length===0||w===" "&&v.prev&&v.prev.type===di&&v.next&&v.next.type===di?v.remove():v.value=w}},v=>{var E;if(v.type===1){const w=t.getElementRule(v.name);if(o&&w){const T=_a(t,r,a,v);w.paddInEmptyBlock&&T&&g(v)?Vf(n,s,h,v):w.removeEmpty&&T?h(v)?v.remove():v.unwrap():w.paddEmpty&&(T||QI(v))&&Vf(n,s,h,v)}}else if(v.type===3&&!d(v)){let w=(E=v.value)!==null&&E!==void 0?E:"";(v.next&&h(v.next)||p(v,!1))&&(w=w.replace(f,"")),w.length===0?v.remove():v.value=w}}]},M$=(e,t)=>{var n;const s=(n=t.forced_root_block)!==null&&n!==void 0?n:e.forced_root_block;return s===!1?"":s===!0?"p":s},nr=(e={},t=vs())=>{const n=zv(),s=zv(),o={validate:!0,root_name:"body",sanitize:!0,...e},r=new DOMParser,a=F$(o,t),i=(E,w,T="html")=>{const B=T==="xhtml"?"application/xhtml+xml":"text/html",H=se(t.getSpecialElements(),w.toLowerCase()),x=H?`<${w}>${E}</${w}>`:E,_=()=>T==="xhtml"?`<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>${x}</body></html>`:/^[\s]*<head/i.test(E)||/^[\s]*<html/i.test(E)||/^[\s]*<!DOCTYPE/i.test(E)?`<html>${x}</html>`:`<body>${x}</body>`,P=r.parseFromString(_(),B).body;return a.sanitizeHtmlElement(P,B),H?P.firstChild:P},l=n.addFilter,c=n.getFilters,u=n.removeFilter,f=s.addFilter,d=s.getFilters,g=s.removeFilter,h=(E,w)=>{Kf(t,E)&&w.push(E)},p=(E,w)=>{const T=J(w.attr(yd)),B=w.type===1&&!se(E,w.name)&&!cu(t,w)&&!js(w.name);return w.type===3||B&&!T},b=(E,w)=>{const T=hE(pE("script,style,head,html,body,title,meta,param"),t.getBlockElements()),B=/^[ \t\r\n]+/,H=/[ \t\r\n]+$/;let x=E.firstChild,_=null;const P=z=>{var X,oe;z&&(x=z.firstChild,x&&x.type===3&&(x.value=(X=x.value)===null||X===void 0?void 0:X.replace(B,"")),x=z.lastChild,x&&x.type===3&&(x.value=(oe=x.value)===null||oe===void 0?void 0:oe.replace(H,"")))};if(t.isValidChild(E.name,w.toLowerCase())){for(;x;){const z=x.next;p(T,x)?(_||(_=new yt(w,1),_.attr(o.forced_root_block_attrs),E.insert(_,x)),_.append(x)):(P(_),_=null),x=z}P(_)}},v={schema:t,addAttributeFilter:f,getAttributeFilters:d,removeAttributeFilter:g,addNodeFilter:l,getNodeFilters:c,removeNodeFilter:u,parse:(E,w={})=>{var T;const B=o.validate,H=(T=w.context)!==null&&T!==void 0?T:o.root_name,x=i(E,H,w.format);ru(t,x);const _=new yt(H,11);bE(_,x,t.getSpecialElements(),a.sanitizeNamespaceElement),x.innerHTML="";const[P,z]=$$(_,t,o,w),X=[],oe=B?$e=>h($e,X):ce,ae={nodes:{},attributes:{}},ge=$e=>Gy(c(),d(),$e,ae);if(L$(_,[P,ge],[z,oe]),X.reverse(),B&&X.length>0)if(w.context){const{pass:$e,fail:ze}=So(X,Ke=>Ke.parent===_);qf(ze,t,_,ge),w.invalid=$e.length>0}else qf(X,t,_,ge);const ve=M$(o,w);return ve&&(_.name==="body"||w.isRootContent)&&b(_,ve),w.invalid||Yy(ae,w),_}};return e$(v,o),$L(v,o,t),v},U$=e=>gl(e)?xs({validate:!1}).serialize(e):e,CE=(e,t,n)=>{const s=U$(e),o=t(s);if(o.isDefaultPrevented())return o;if(gl(e))if(o.content!==s){const r=nr({validate:!1,forced_root_block:!1,...n}).parse(o.content,{context:e.name});return{...o,content:r}}else return{...o,content:e};else return o},yE=e=>({sanitize:Eb(e),sandbox_iframes:wb(e),sandbox_iframes_exclusions:Hu(e)}),vE=(e,t)=>{if(t.no_events)return Mt.value(t);{const n=fD(e,t);return n.isDefaultPrevented()?Mt.error(nb(e,{content:"",...n}).content):Mt.value(n)}},EE=(e,t,n)=>n.no_events?t:CE(t,o=>nb(e,{...n,content:o}),yE(e)).content,vd=(e,t)=>{if(t.no_events)return Mt.value(t);{const n=CE(t.content,s=>uD(e,{...t,content:s}),yE(e));return n.isDefaultPrevented()?(tb(e,n),Mt.error(void 0)):Mt.value(n)}},Ed=(e,t,n)=>{n.no_events||tb(e,{...n,content:t})},Sd=(e,t,n)=>({element:e,width:t,rows:n}),SE=(e,t)=>({element:e,cells:t}),z$=(e,t)=>({x:e,y:t}),wE=(e,t)=>ns(e,t).bind(li).getOr(1),H$=(e,t,n,s,o)=>{const r=wE(o,"rowspan"),a=wE(o,"colspan"),i=e.rows;for(let l=n;l<n+r;l++){i[l]||(i[l]=SE(cp(s),[]));for(let c=t;c<t+a;c++){const u=i[l].cells;u[c]=l===n&&c===t?o:Hs(o)}}},W$=(e,t,n)=>{const s=e.rows;return!!(s[n]?s[n].cells:[])[t]},V$=(e,t,n)=>{for(;W$(e,t,n);)t++;return t},kE=e=>Tt(e,(t,n)=>n.cells.length>t?n.cells.length:t,0),_E=(e,t)=>{const n=e.rows;for(let s=0;s<n.length;s++){const o=n[s].cells;for(let r=0;r<o.length;r++)if(Ee(o[r],t))return m.some(z$(r,s))}return m.none()},AE=(e,t,n,s,o)=>{const r=[],a=e.rows;for(let i=n;i<=o;i++){const l=a[i].cells,c=t<s?l.slice(t,s+1):l.slice(s,t+1);r.push(SE(a[i].element,c))}return r},j$=(e,t,n)=>{const s=t.x,o=t.y,r=n.x,a=n.y,i=o<a?AE(e,s,o,r,a):AE(e,s,a,r,o);return Sd(e.element,kE(i),i)},q$=(e,t)=>{const n=Hs(e.element),s=C.fromTag("tbody");return zs(s,t),je(n,s),n},K$=e=>he(e.rows,t=>{const n=he(t.cells,o=>{const r=cp(o);return rt(r,"colspan"),rt(r,"rowspan"),r}),s=Hs(t.element);return zs(s,n),s}),G$=e=>{const t=Sd(Hs(e),0,[]);return D(ut(e,"tr"),(n,s)=>{D(ut(n,"td,th"),(o,r)=>{H$(t,V$(t,r,s),s,n,o)})}),Sd(t.element,kE(t.rows),t.rows)},Y$=e=>q$(e,K$(e)),X$=(e,t,n)=>_E(e,t).bind(s=>_E(e,n).map(o=>j$(e,s,o))),Z$=e=>Ye(e,t=>be(t)==="ul"||be(t)==="ol"),Q$=(e,t)=>Ye(e,n=>be(n)==="li"&&ef(n,t)).fold(W([]),n=>Z$(e).map(s=>{const o=C.fromTag(be(s)),r=Ar(Uc(s),(a,i)=>Xe(i,"list-style"));return pi(o,r),[C.fromTag("li"),o]}).getOr([])),J$=(e,t)=>{const n=Tt(t,(s,o)=>(je(o,s),o),e);return t.length>0?Wc([n]):n},eM=e=>Uo(e)?On(e).filter(wu).fold(W([]),t=>[e,t]):wu(e)?[e]:[],tM=(e,t,n)=>{const s=C.fromDom(t.commonAncestorContainer),o=is(s,e),r=ne(o,l=>n.isWrapper(be(l))),a=Q$(o,t),i=r.concat(a.length?a:eM(s));return he(i,Hs)},xE=()=>Wc([]),nM=(e,t,n)=>J$(C.fromDom(t.cloneContents()),tM(e,t,n)),sM=(e,t)=>Wr(t,"table",G(Ee,e)),oM=(e,t)=>sM(e,t[0]).bind(n=>{const s=t[0],o=t[t.length-1],r=G$(n);return X$(r,s,o).map(a=>Wc([Y$(a)]))}).getOrThunk(xE),rM=(e,t,n)=>t.length>0&&t[0].collapsed?xE():nM(e,t[0],n),aM=(e,t,n)=>{const s=Zb(t,e);return s.length>0?oM(e,s):rM(e,t,n)},El=(e,t)=>t>=0&&t<e.length&&oo(e.charAt(t)),NE=e=>Ht(e.innerText),iM=e=>e.map(t=>t.nodeName).getOr("div").toLowerCase(),lM=e=>m.from(e.selection.getRng()).map(t=>{var n;const s=m.from(e.dom.getParent(t.commonAncestorContainer,e.dom.isBlock)),o=e.getBody(),r=iM(s),a=C.fromDom(t.cloneContents());XC(a),ZC(a);const i=e.dom.add(o,r,{"data-mce-bogus":"all",style:"overflow: hidden; opacity: 0;"},a.dom),l=NE(i),c=Ht((n=i.textContent)!==null&&n!==void 0?n:"");if(e.dom.remove(i),El(c,0)||El(c,c.length-1)){const u=s.getOr(o),f=NE(u),d=f.indexOf(l);if(d===-1)return l;{const g=El(f,d-1),h=El(f,d+l.length);return(g?" ":"")+l+(h?" ":"")}}else return l}).getOr(""),cM=(e,t)=>{const n=e.selection.getRng(),s=e.dom.create("body"),o=e.selection.getSel(),r=wf(e,Qu(o)),a=t.contextual?aM(C.fromDom(e.getBody()),r,e.schema).dom:n.cloneContents();return a&&s.appendChild(a),e.selection.serializer.serialize(s,t)},uM=(e,t)=>{if(t.format==="text")return lM(e);{const n=cM(e,t);return t.format==="tree"?n:e.selection.isCollapsed()?"":n}},fM=(e,t)=>({...e,format:t,get:!0,selection:!0,getInner:!0}),dM=(e,t,n={})=>{const s=fM(n,t);return vE(e,s).fold(Ft,o=>{const r=uM(e,o);return EE(e,r,o)})},wd=0,RE=1,TE=2,mM=(e,t)=>{const n=e.length+t.length+2,s=new Array(n),o=new Array(n),r=(u,f,d)=>({start:u,end:f,diag:d}),a=(u,f,d,g,h)=>{const p=l(u,f,d,g);if(p===null||p.start===f&&p.diag===f-g||p.end===u&&p.diag===u-d){let b=u,y=d;for(;b<f||y<g;)b<f&&y<g&&e[b]===t[y]?(h.push([wd,e[b]]),++b,++y):f-u>g-d?(h.push([TE,e[b]]),++b):(h.push([RE,t[y]]),++y)}else{a(u,p.start,d,p.start-p.diag,h);for(let b=p.start;b<p.end;++b)h.push([wd,e[b]]);a(p.end,f,p.end-p.diag,g,h)}},i=(u,f,d,g)=>{let h=u;for(;h-f<g&&h<d&&e[h]===t[h-f];)++h;return r(u,h,f)},l=(u,f,d,g)=>{const h=f-u,p=g-d;if(h===0||p===0)return null;const b=h-p,y=p+h,v=(y%2===0?y:y+1)/2;s[1+v]=u,o[1+v]=f+1;let E,w,T,B,H;for(E=0;E<=v;++E){for(w=-E;w<=E;w+=2){for(T=w+v,w===-E||w!==E&&s[T-1]<s[T+1]?s[T]=s[T+1]:s[T]=s[T-1]+1,B=s[T],H=B-u+d-w;B<f&&H<g&&e[B]===t[H];)s[T]=++B,++H;if(b%2!==0&&b-E<=w&&w<=b+E&&o[T-b]<=s[T])return i(o[T-b],w+u-d,f,g)}for(w=b-E;w<=b+E;w+=2){for(T=w+v-b,w===b-E||w!==b+E&&o[T+1]<=o[T-1]?o[T]=o[T+1]-1:o[T]=o[T-1],B=o[T]-1,H=B-u+d-w;B>=u&&H>=d&&e[B]===t[H];)o[T]=B--,H--;if(b%2===0&&-E<=w&&w<=E&&o[T]<=s[T+b])return i(o[T],w+u-d,f,g)}}return null},c=[];return a(0,e.length,0,t.length,c),c},kd=e=>q(e)?e.outerHTML:I(e)?Gs.encodeRaw(e.data,!1):ys(e)?"<!--"+e.data+"-->":"",gM=e=>{let t;const n=document.createElement("div"),s=document.createDocumentFragment();for(e&&(n.innerHTML=e);t=n.firstChild;)s.appendChild(t);return s},pM=(e,t,n)=>{const s=gM(t);if(e.hasChildNodes()&&n<e.childNodes.length){const o=e.childNodes[n];e.insertBefore(s,o)}else e.appendChild(s)},hM=(e,t)=>{if(e.hasChildNodes()&&t<e.childNodes.length){const n=e.childNodes[t];e.removeChild(n)}},bM=(e,t)=>{let n=0;D(e,s=>{s[0]===wd?n++:s[0]===RE?(pM(t,s[1],n),n++):s[0]===TE&&hM(t,n)})},CM=(e,t)=>ne(he(Lt(e.childNodes),t?Nn(Ht,kd):kd),n=>n.length>0),yM=(e,t)=>{const n=he(Lt(t.childNodes),kd);return bM(mM(n,e),t),t},vM=Dn(()=>document.implementation.createHTMLDocument("undo")),EM=e=>e.querySelector("iframe")!==null,SM=e=>({type:"fragmented",fragments:e,content:"",bookmark:null,beforeBookmark:null}),wM=e=>({type:"complete",fragments:null,content:e,bookmark:null,beforeBookmark:null}),Sl=e=>{const t=e.serializer.getTempAttrs(),n=YC(e.getBody(),t);return EM(n)?SM(CM(n,!0)):wM(Ht(n.innerHTML))},_d=(e,t,n)=>{const s=n?t.beforeBookmark:t.bookmark;t.type==="fragmented"?yM(t.fragments,e.getBody()):e.setContent(t.content,{format:"raw",no_selection:U(s)&&qb(s)?!s.isFakeCaret:!0}),s&&(e.selection.moveToBookmark(s),e.selection.scrollIntoView())},Ad=e=>e.type==="fragmented"?e.fragments.join(""):e.content,DE=e=>{const t=C.fromTag("body",vM());return gi(t,Ad(e)),D(ut(t,"*[data-mce-bogus]"),hs),up(t)},kM=(e,t)=>Ad(e)===Ad(t),_M=(e,t)=>DE(e)===DE(t),xd=(e,t)=>!e||!t?!1:kM(e,t)?!0:_M(e,t),Nd=e=>e.get()===0,wl=(e,t,n)=>{Nd(n)&&(e.typing=t)},PE=(e,t)=>{e.typing&&(wl(e,!1,t),e.add())},AM=e=>{e.typing&&(e.typing=!1,e.add())},xM=(e,t,n)=>{Nd(t)&&n.set(Iu(e.selection))},NM=(e,t,n,s,o,r,a)=>{const i=Sl(e),l=L.extend(r||{},i);if(!Nd(s)||e.removed)return null;const c=t.data[n.get()];if(e.dispatch("BeforeAddUndo",{level:l,lastLevel:c,originalEvent:a}).isDefaultPrevented()||c&&xd(c,l))return null;t.data[n.get()]&&o.get().each(d=>{t.data[n.get()].beforeBookmark=d});const u=aP(e);if(u&&t.data.length>u){for(let d=0;d<t.data.length-1;d++)t.data[d]=t.data[d+1];t.data.length--,n.set(t.data.length)}l.bookmark=Iu(e.selection),n.get()<t.data.length-1&&(t.data.length=n.get()+1),t.data.push(l),n.set(t.data.length-1);const f={level:l,lastLevel:c,originalEvent:a};return n.get()>0?(e.setDirty(!0),e.dispatch("AddUndo",f),e.dispatch("change",f)):e.dispatch("AddUndo",f),l},RM=(e,t,n)=>{t.data=[],n.set(0),t.typing=!1,e.dispatch("ClearUndos")},TM=(e,t,n,s,o)=>{if(t.transact(s)){const r=t.data[n.get()].bookmark,a=t.data[n.get()-1];_d(e,a,!0),t.transact(o)&&(t.data[n.get()-1].beforeBookmark=r)}},DM=(e,t,n)=>{let s;return t.get()<n.length-1&&(t.set(t.get()+1),s=n[t.get()],_d(e,s,!1),e.setDirty(!0),e.dispatch("Redo",{level:s})),s},PM=(e,t,n,s)=>{let o;return t.typing&&(t.add(),t.typing=!1,wl(t,!1,n)),s.get()>0&&(s.set(s.get()-1),o=t.data[s.get()],_d(e,o,!0),e.setDirty(!0),e.dispatch("Undo",{level:o})),o},BM=e=>{e.clear(),e.add()},OM=(e,t,n)=>n.get()>0||t.typing&&t.data[0]&&!xd(Sl(e),t.data[0]),IM=(e,t)=>t.get()<e.data.length-1&&!e.typing,FM=(e,t,n)=>(PE(e,t),e.beforeChange(),e.ignore(n),e.add()),LM=(e,t)=>{try{e.set(e.get()+1),t()}finally{e.set(e.get()-1)}},$M=(e,t)=>{const n=e.dom,s=U(t)?t:e.getBody();D(n.select("table,a",s),o=>{switch(o.nodeName){case"TABLE":const r=dP(e),a=n.getAttrib(o,"border");(!a||a==="0")&&e.hasVisual?n.addClass(o,r):n.removeClass(o,r);break;case"A":if(!n.getAttrib(o,"href")){const i=n.getAttrib(o,"name")||o.id,l=Cb(e);i&&e.hasVisual?n.addClass(o,l):n.removeClass(o,l)}break}}),e.dispatch("VisualAid",{element:t,hasVisual:e.hasVisual})},BE=e=>({init:{bindEvents:ce},undoManager:{beforeChange:(t,n)=>xM(e,t,n),add:(t,n,s,o,r,a)=>NM(e,t,n,s,o,r,a),undo:(t,n,s)=>PM(e,t,n,s),redo:(t,n)=>DM(e,t,n),clear:(t,n)=>RM(e,t,n),reset:t=>BM(t),hasUndo:(t,n)=>OM(e,t,n),hasRedo:(t,n)=>IM(t,n),transact:(t,n,s)=>FM(t,n,s),ignore:(t,n)=>LM(t,n),extra:(t,n,s,o)=>TM(e,t,n,s,o)},formatter:{match:(t,n,s,o)=>ed(e,t,n,s,o),matchAll:(t,n)=>qF(e,t,n),matchNode:(t,n,s,o)=>Wn(e,t,n,s,o),canApply:t=>GF(e,t),closest:t=>KF(e,t),apply:(t,n,s)=>Ov(e,t,n,s),remove:(t,n,s,o)=>Dv(e,t,n,s,o),toggle:(t,n,s)=>BL(e,t,n,s),formatChanged:(t,n,s,o,r)=>PL(e,t,n,s,o,r)},editor:{getContent:t=>CO(e,t),setContent:(t,n)=>jF(e,t,n),insertContent:(t,n)=>zF(e,t,n),addVisual:t=>$M(e,t)},selection:{getContent:(t,n)=>dM(e,t,n)},autocompleter:{addDecoration:ce,removeDecoration:ce},raw:{getModel:()=>m.none()}}),MM=e=>{const t=c=>nt(c)?c:{},{init:n,undoManager:s,formatter:o,editor:r,selection:a,autocompleter:i,raw:l}=e;return{init:{bindEvents:n.bindEvents},undoManager:{beforeChange:s.beforeChange,add:s.add,undo:s.undo,redo:s.redo,clear:s.clear,reset:s.reset,hasUndo:s.hasUndo,hasRedo:s.hasRedo,transact:(c,u,f)=>s.transact(f),ignore:(c,u)=>s.ignore(u),extra:(c,u,f,d)=>s.extra(f,d)},formatter:{match:(c,u,f,d)=>o.match(c,t(u),d),matchAll:o.matchAll,matchNode:o.matchNode,canApply:c=>o.canApply(c),closest:c=>o.closest(c),apply:(c,u,f)=>o.apply(c,t(u)),remove:(c,u,f,d)=>o.remove(c,t(u)),toggle:(c,u,f)=>o.toggle(c,t(u)),formatChanged:(c,u,f,d,g)=>o.formatChanged(u,f,d,g)},editor:{getContent:c=>r.getContent(c),setContent:(c,u)=>({content:r.setContent(c,u),html:""}),insertContent:(c,u)=>(r.insertContent(c),""),addVisual:r.addVisual},selection:{getContent:(c,u)=>a.getContent(u)},autocompleter:{addDecoration:i.addDecoration,removeDecoration:i.removeDecoration},raw:{getModel:()=>m.some(l.getRawModel())}}},UM=()=>{const e=W(null),t=W("");return{init:{bindEvents:ce},undoManager:{beforeChange:ce,add:e,undo:e,redo:e,clear:ce,reset:ce,hasUndo:Pe,hasRedo:Pe,transact:e,ignore:ce,extra:ce},formatter:{match:Pe,matchAll:W([]),matchNode:W(void 0),canApply:Pe,closest:t,apply:ce,remove:ce,toggle:ce,formatChanged:W({unbind:ce})},editor:{getContent:t,setContent:W({content:"",html:""}),insertContent:W(""),addVisual:ce},selection:{getContent:t},autocompleter:{addDecoration:ce,removeDecoration:ce},raw:{getModel:W(m.none())}}},Vn=e=>se(e.plugins,"rtc"),zM=e=>Oe(e.plugins,"rtc").bind(t=>m.from(t.setup)),HM=e=>{const t=e;return zM(e).fold(()=>(t.rtcInstance=BE(e),m.none()),n=>(t.rtcInstance=UM(),m.some(()=>n().then(s=>(t.rtcInstance=MM(s),s.rtc.isRemote)))))},Rd=e=>e.rtcInstance?e.rtcInstance:BE(e),qe=e=>{const t=e.rtcInstance;if(t)return t;throw new Error("Failed to get RTC instance not yet initialized.")},WM=(e,t,n)=>{qe(e).undoManager.beforeChange(t,n)},VM=(e,t,n,s,o,r,a)=>qe(e).undoManager.add(t,n,s,o,r,a),jM=(e,t,n,s)=>qe(e).undoManager.undo(t,n,s),qM=(e,t,n)=>qe(e).undoManager.redo(t,n),KM=(e,t,n)=>{qe(e).undoManager.clear(t,n)},GM=(e,t)=>{qe(e).undoManager.reset(t)},YM=(e,t,n)=>qe(e).undoManager.hasUndo(t,n),XM=(e,t,n)=>qe(e).undoManager.hasRedo(t,n),ZM=(e,t,n,s)=>qe(e).undoManager.transact(t,n,s),QM=(e,t,n)=>{qe(e).undoManager.ignore(t,n)},JM=(e,t,n,s,o)=>{qe(e).undoManager.extra(t,n,s,o)},eU=(e,t,n,s,o)=>qe(e).formatter.match(t,n,s,o),tU=(e,t,n)=>qe(e).formatter.matchAll(t,n),nU=(e,t,n,s,o)=>qe(e).formatter.matchNode(t,n,s,o),sU=(e,t)=>qe(e).formatter.canApply(t),oU=(e,t)=>qe(e).formatter.closest(t),rU=(e,t,n,s)=>{qe(e).formatter.apply(t,n,s)},aU=(e,t,n,s,o)=>{qe(e).formatter.remove(t,n,s,o)},iU=(e,t,n,s)=>{qe(e).formatter.toggle(t,n,s)},lU=(e,t,n,s,o,r)=>qe(e).formatter.formatChanged(t,n,s,o,r),cU=(e,t)=>Rd(e).editor.getContent(t),uU=(e,t,n)=>Rd(e).editor.setContent(t,n),fU=(e,t,n)=>Rd(e).editor.insertContent(t,n),dU=(e,t,n)=>qe(e).selection.getContent(t,n),mU=(e,t)=>qe(e).editor.addVisual(t),OE=e=>qe(e).init.bindEvents(),gU=(e,t={})=>{const n=t.format?t.format:"html";return dU(e,n,t)},IE=e=>e.dom.length===0?(Ne(e),m.none()):m.some(e),pU=(e,t)=>e.filter(n=>Ca.isBookmarkNode(n.dom)).bind(t?Mr:gs),hU=(e,t,n,s,o)=>{const r=e.dom,a=t.dom,i=s?r.length:a.length;s?(Bf(r,a,o,!1,!s),n.setStart(a,i)):(Bf(a,r,o,!1,!s),n.setEnd(a,i))},bU=(e,t,n)=>{On(e).each(s=>{const o=e.dom;t&&Sa(s,N(o,0),n)?cl(o,0,n):!t&&wa(s,N(o,o.length),n)&&Pf(o,o.length,n)})},FE=(e,t,n,s,o)=>{e.bind(r=>((s?Pf:cl)(r.dom,s?r.dom.length:0,o),t.filter(At).map(i=>hU(r,i,n,s,o)))).orThunk(()=>pU(t,s).or(t).filter(At).map(a=>bU(a,s,o)))},CU=(e,t,n)=>{const s=m.from(t.firstChild).map(C.fromDom),o=m.from(t.lastChild).map(C.fromDom);e.deleteContents(),e.insertNode(t);const r=s.bind(gs).filter(At).bind(IE),a=o.bind(Mr).filter(At).bind(IE);FE(r,s,e,!0,n),FE(a,o,e,!1,n),e.collapse(!1)},yU=(e,t)=>({format:"html",...e,set:!0,selection:!0,content:t}),vU=(e,t)=>{if(t.format!=="raw"){const n=e.selection.getRng(),s=e.dom.getParent(n.commonAncestorContainer,e.dom.isBlock),o=s?{context:s.nodeName.toLowerCase()}:{},r=e.parser.parse(t.content,{forced_root_block:!1,...o,...t});return xs({validate:!1},e.schema).serialize(r)}else return t.content},EU=(e,t,n={})=>{const s=yU(n,t);vd(e,s).each(o=>{const r=vU(e,o),a=e.selection.getRng();CU(a,a.createContextualFragment(r),e.schema),e.selection.setRng(a),ya(e,a),Ed(e,r,o)})},LE=(e,t,n)=>{if(se(e,t)){const s=ne(e[t],o=>o!==n);s.length===0?delete e[t]:e[t]=s}};var SU=(e,t)=>{let n,s;const o=(i,l)=>Ye(l,c=>e.is(c,i)),r=i=>e.getParents(i,void 0,e.getRoot()),a=()=>{n={},s={},t.on("NodeChange",i=>{const l=i.element,c=r(l),u={};Ae(n,(f,d)=>{o(d,c).each(g=>{s[d]||(D(f,h=>{h(!0,{node:g,selector:d,parents:c})}),s[d]=f),u[d]=f})}),Ae(s,(f,d)=>{u[d]||(delete s[d],D(f,g=>{g(!1,{node:l,selector:d,parents:c})}))})})};return{selectorChangedWithUnbind:(i,l)=>(n||a(),n[i]||(n[i]=[]),n[i].push(l),o(i,r(t.selection.getStart())).each(()=>{s[i]=n[i]}),{unbind:()=>{LE(n,i,l),LE(s,i,l)}})}};const $E=e=>!!(e&&e.ownerDocument)&&bn(C.fromDom(e.ownerDocument),C.fromDom(e)),wU=e=>e?$E(e.startContainer)&&$E(e.endContainer):!1,ME=(e,t,n,s)=>{let o,r;const{selectorChangedWithUnbind:a}=SU(e,s),i=(M,Y)=>{const me=e.createRng();U(M)&&U(Y)?(me.setStart(M,Y),me.setEnd(M,Y),w(me),y(!1)):(tf(e,me,s.getBody(),!0),w(me))},l=M=>gU(s,M),c=(M,Y)=>EU(s,M,Y),u=M=>UC(s.getBody(),E(),M),f=M=>zC(s.getBody(),E(),M),d=(M,Y)=>ze.getBookmark(M,Y),g=M=>ze.moveToBookmark(M),h=(M,Y)=>(oO(e,M,Y).each(w),M),p=()=>{const M=E(),Y=v();return!M||M.item?!1:M.compareEndPoints?M.compareEndPoints("StartToEnd",M)===0:!Y||M.collapsed},b=()=>{if(s.mode.isReadOnly())return!1;const M=E(),Y=s.getBody().querySelectorAll('[data-mce-selected="1"]');return Y.length>0?Zn(Y,me=>e.isEditable(me.parentElement)):$C(e,M)},y=M=>{const Y=E();Y.collapse(!!M),w(Y)},v=()=>t.getSelection?t.getSelection():t.document.selection,E=()=>{let M;const Y=(pe,R,O)=>{try{return R.compareBoundaryPoints(pe,O)}catch{return-1}},me=t.document;if(U(s.bookmark)&&!er(s)){const pe=df(s);if(pe.isSome())return pe.map(R=>wf(s,[R])[0]).getOr(me.createRange())}try{const pe=v();pe&&!Si(pe.anchorNode)&&(pe.rangeCount>0?M=pe.getRangeAt(0):M=me.createRange(),M=wf(s,[M])[0])}catch{}if(M||(M=me.createRange()),qr(M.startContainer)&&M.collapsed){const pe=e.getRoot();M.setStart(pe,0),M.setEnd(pe,0)}return o&&r&&(Y(M.START_TO_START,M,o)===0&&Y(M.END_TO_END,M,o)===0?M=r:(o=null,r=null)),M},w=(M,Y)=>{if(!wU(M))return;const me=v();if(M=s.dispatch("SetSelectionRange",{range:M,forward:Y}).range,me){r=M;try{me.removeAllRanges(),me.addRange(M)}catch{}Y===!1&&me.extend&&(me.collapse(M.endContainer,M.endOffset),me.extend(M.startContainer,M.startOffset)),o=me.rangeCount>0?me.getRangeAt(0):null}if(!M.collapsed&&M.startContainer===M.endContainer&&(me!=null&&me.setBaseAndExtent)&&M.endOffset-M.startOffset<2&&M.startContainer.hasChildNodes()){const R=M.startContainer.childNodes[M.startOffset];R&&R.nodeName==="IMG"&&(me.setBaseAndExtent(M.startContainer,M.startOffset,M.endContainer,M.endOffset),(me.anchorNode!==M.startContainer||me.focusNode!==M.endContainer)&&me.setBaseAndExtent(R,0,R,1))}s.dispatch("AfterSetSelectionRange",{range:M,forward:Y})},T=M=>(c(e.getOuterHTML(M)),M),B=()=>nO(s.getBody(),E()),H=(M,Y)=>sO(e,E(),M,Y),x=()=>{const M=v(),Y=M==null?void 0:M.anchorNode,me=M==null?void 0:M.focusNode;if(!M||!Y||!me||Si(Y)||Si(me))return!0;const pe=e.createRng(),R=e.createRng();try{pe.setStart(Y,M.anchorOffset),pe.collapse(!0),R.setStart(me,M.focusOffset),R.collapse(!0)}catch{return!0}return pe.compareBoundaryPoints(pe.START_TO_START,R)<=0},$e={dom:e,win:t,serializer:n,editor:s,expand:(M={type:"word"})=>w(io(e).expand(E(),M)),collapse:y,setCursorLocation:i,getContent:l,setContent:c,getBookmark:d,moveToBookmark:g,select:h,isCollapsed:p,isEditable:b,isForward:x,setNode:T,getNode:B,getSel:v,setRng:w,getRng:E,getStart:u,getEnd:f,getSelectedBlocks:H,normalize:()=>{const M=E(),Y=v();if(!OB(Y)&&Yi(s)){const me=sl(e,M);return me.each(pe=>{w(pe,x())}),me.getOr(M)}return M},selectorChanged:(M,Y)=>(a(M,Y),$e),selectorChangedWithUnbind:a,getScrollContainer:()=>{let M,Y=e.getRoot();for(;Y&&Y.nodeName!=="BODY";){if(Y.scrollHeight>Y.clientHeight){M=Y;break}Y=Y.parentNode}return M},scrollIntoView:(M,Y)=>{U(M)?tO(s,M,Y):ya(s,E(),Y)},placeCaretAt:(M,Y)=>w(xC(M,Y,s.getDoc())),getBoundingClientRect:()=>{const M=E();return M.collapsed?N.fromRangeStart(M).getClientRects()[0]:M.getBoundingClientRect()},destroy:()=>{t=o=r=null,Ke.destroy()}},ze=Ca($e),Ke=AC($e,s);return $e.bookmarkManager=ze,$e.controlSelection=Ke,$e},kU=(e,t,n)=>{t.addNodeFilter("br",(s,o,r)=>{const a=L.extend({},n.getBlockElements()),i=n.getNonEmptyElements(),l=n.getWhitespaceElements();a.body=1;const c=u=>u.name in a||cu(n,u);for(let u=0,f=s.length;u<f;u++){let d=s[u],g=d.parent;if(g&&c(g)&&d===g.lastChild){let h=d.prev;for(;h;){const p=h.name;if(p!=="span"||h.attr("data-mce-type")!=="bookmark"){p==="br"&&(d=null);break}h=h.prev}if(d&&(d.remove(),_a(n,i,l,g))){const p=n.getElementRule(g.name);p&&(p.removeEmpty?g.remove():p.paddEmpty&&Vf(e,r,c,g))}}else{let h=d;for(;g&&g.firstChild===h&&g.lastChild===h&&(h=g,!a[g.name]);)g=g.parent;if(h===g){const p=new yt("#text",3);p.value=Ze,d.replace(p)}}}})},_U=(e,t,n)=>{e.addAttributeFilter("data-mce-tabindex",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.attr("tabindex",a.attr("data-mce-tabindex")),a.attr(o,null)}}),e.addAttributeFilter("src,href,style",(s,o)=>{const r="data-mce-"+o,a=t.url_converter,i=t.url_converter_scope;let l=s.length;for(;l--;){const c=s[l];let u=c.attr(r);u!==void 0?(c.attr(o,u.length>0?u:null),c.attr(r,null)):(u=c.attr(o),o==="style"?u=n.serializeStyle(n.parseStyle(u),c.name):a&&(u=a.call(i,u,o,c.name)),c.attr(o,u.length>0?u:null))}}),e.addAttributeFilter("class",s=>{let o=s.length;for(;o--;){const r=s[o];let a=r.attr("class");a&&(a=a.replace(/(?:^|\s)mce-item-\w+(?!\S)/g,""),r.attr("class",a.length>0?a:null))}}),e.addAttributeFilter("data-mce-type",(s,o,r)=>{let a=s.length;for(;a--;){const i=s[a];i.attr("data-mce-type")==="bookmark"&&!r.cleanup&&(m.from(i.firstChild).exists(c=>{var u;return!Pi((u=c.value)!==null&&u!==void 0?u:"")})?i.unwrap():i.remove())}}),e.addNodeFilter("script,style",(s,o)=>{var r;const a=l=>l.replace(/(<!--\[CDATA\[|\]\]-->)/g,`
`).replace(/^[\r\n]*|[\r\n]*$/g,"").replace(/^\s*((<!--)?(\s*\/\/)?\s*<!\[CDATA\[|(<!--\s*)?\/\*\s*<!\[CDATA\[\s*\*\/|(\/\/)?\s*<!--|\/\*\s*<!--\s*\*\/)\s*[\r\n]*/gi,"").replace(/\s*(\/\*\s*\]\]>\s*\*\/(-->)?|\s*\/\/\s*\]\]>(-->)?|\/\/\s*(-->)?|\]\]>|\/\*\s*-->\s*\*\/|\s*-->\s*)\s*$/g,"");let i=s.length;for(;i--;){const l=s[i],c=l.firstChild,u=(r=c==null?void 0:c.value)!==null&&r!==void 0?r:"";if(o==="script"){const f=l.attr("type");f&&l.attr("type",f==="mce-no/type"?null:f.replace(/^mce\-/,"")),t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`// <![CDATA[
`+a(u)+`
// ]]>`)}else t.element_format==="xhtml"&&c&&u.length>0&&(c.value=`<!--
`+a(u)+`
-->`)}}),e.addNodeFilter("#comment",s=>{let o=s.length;for(;o--;){const r=s[o],a=r.value;t.preserve_cdata&&(a==null?void 0:a.indexOf("[CDATA["))===0?(r.name="#cdata",r.type=4,r.value=n.decode(a.replace(/^\[CDATA\[|\]\]$/g,""))):(a==null?void 0:a.indexOf("mce:protected "))===0&&(r.name="#text",r.type=3,r.raw=!0,r.value=unescape(a).substr(14))}}),e.addNodeFilter("xml:namespace,input",(s,o)=>{let r=s.length;for(;r--;){const a=s[r];a.type===7?a.remove():a.type===1&&o==="input"&&!a.attr("type")&&a.attr("type","text")}}),e.addAttributeFilter("data-mce-type",s=>{D(s,o=>{o.attr("data-mce-type")==="format-caret"&&(o.isEmpty(e.schema.getNonEmptyElements())?o.remove():o.unwrap())})}),e.addAttributeFilter("data-mce-src,data-mce-href,data-mce-style,data-mce-selected,data-mce-expando,data-mce-block,data-mce-type,data-mce-resize,data-mce-placeholder",(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.remove_trailing_brs&&kU(t,e,e.schema)},AU=e=>{const t=s=>(s==null?void 0:s.name)==="br",n=e.lastChild;if(t(n)){const s=n.prev;t(s)&&(n.remove(),s.remove())}},xU=(e,t,n)=>{let s;const o=e.dom;let r=t.cloneNode(!0);const a=document.implementation;if(a.createHTMLDocument){const i=a.createHTMLDocument("");L.each(r.nodeName==="BODY"?r.childNodes:[r],l=>{i.body.appendChild(i.importNode(l,!0))}),r.nodeName!=="BODY"?r=i.body.firstChild:r=i.body,s=o.doc,o.doc=i}return JT(e,{...n,node:r}),s&&(o.doc=s),r},NU=(e,t)=>U(e)&&e.hasEventListeners("PreProcess")&&!t.no_events,RU=(e,t,n)=>NU(e,n)?xU(e,t,n):t,TU=(e,t,n)=>{L.inArray(t,n)===-1&&(e.addAttributeFilter(n,(s,o)=>{let r=s.length;for(;r--;)s[r].attr(o,null)}),t.push(n))},DU=(e,t,n)=>!t.no_events&&e?eD(e,{...t,content:n}).content:n,PU=(e,t,n)=>{const s=Ht(n.getInner?t.innerHTML:e.getOuterHTML(t));return n.selection||Di(C.fromDom(t))?s:L.trim(s)},BU=(e,t,n)=>{const s=n.selection?{forced_root_block:!1,...n}:n,o=e.parse(t,s);return AU(o),o},OU=(e,t,n)=>xs(e,t).serialize(n),IU=(e,t,n,s,o)=>{const r=OU(t,n,s);return DU(e,o,r)},FU=(e,t)=>{const n=["data-mce-selected"],s={entity_encoding:"named",remove_trailing_brs:!0,pad_empty_with_br:!1,...e},o=t&&t.dom?t.dom:_e.DOM,r=t&&t.schema?t.schema:vs(s),a=nr(s,r);_U(a,s,o);const i=(l,c={})=>{const u={format:"html",...c},f=RU(t,l,u),d=PU(o,f,u),g=BU(a,d,u);return u.format==="tree"?g:IU(t,s,r,g,u)};return{schema:r,addNodeFilter:a.addNodeFilter,addAttributeFilter:a.addAttributeFilter,serialize:i,addRules:r.addValidElements,setRules:r.setValidElements,addTempAttr:G(TU,a,n),getTempAttrs:W(n),getNodeFilters:a.getNodeFilters,getAttributeFilters:a.getAttributeFilters,removeNodeFilter:a.removeNodeFilter,removeAttributeFilter:a.removeAttributeFilter}},UE=(e,t)=>{const n=FU(e,t);return{schema:n.schema,addNodeFilter:n.addNodeFilter,addAttributeFilter:n.addAttributeFilter,serialize:n.serialize,addRules:n.addRules,setRules:n.setRules,addTempAttr:n.addTempAttr,getTempAttrs:n.getTempAttrs,getNodeFilters:n.getNodeFilters,getAttributeFilters:n.getAttributeFilters,removeNodeFilter:n.removeNodeFilter,removeAttributeFilter:n.removeAttributeFilter}},LU="html",$U=(e,t)=>({...e,format:t,get:!0,getInner:!0}),MU=(e,t={})=>{const n=t.format?t.format:LU,s=$U(t,n);return vE(e,s).fold(Ft,o=>{const r=cU(e,o);return EE(e,r,o)})},UU="html",zU=(e,t)=>({format:UU,...e,set:!0,content:t}),Td=(e,t,n={})=>{const s=zU(n,t);return vd(e,s).map(o=>{const r=uU(e,o.content,o);return Ed(e,r.html,o),r.content}).getOr(t)},HU="autoresize_on_init,content_editable_state,padd_empty_with_br,block_elements,boolean_attributes,editor_deselector,editor_selector,elements,file_browser_callback_types,filepicker_validator_handler,force_hex_style_colors,force_p_newlines,gecko_spellcheck,images_dataimg_filter,media_scripts,mode,move_caret_before_on_enter_elements,non_empty_elements,self_closing_elements,short_ended_elements,special,spellchecker_select_languages,spellchecker_whitelist,tab_focus,tabfocus_elements,table_responsive_width,text_block_elements,text_inline_elements,toolbar_drawer,types,validate,whitespace_elements,paste_enable_default_filters,paste_filter_drop,paste_word_valid_elements,paste_retain_style_properties,paste_convert_word_fake_lists,template_cdate_classes,template_mdate_classes,template_selected_content_classes,template_preview_replace_values,template_replace_values,templates,template_cdate_format,template_mdate_format".split(","),WU=[],VU="bbcode,colorpicker,contextmenu,fullpage,legacyoutput,spellchecker,template,textcolor,rtc".split(","),zE=[{name:"export",replacedWith:"Export to PDF"}],HE=(e,t)=>{const n=ne(t,s=>se(e,s));return $s(n)},jU=e=>{const t=HE(e,HU),n=e.forced_root_block;return(n===!1||n==="")&&t.push("forced_root_block (false only)"),$s(t)},qU=e=>HE(e,WU),WE=(e,t)=>{const n=L.makeMap(e.plugins," "),o=ne(t,r=>se(n,r));return $s(o)},KU=e=>WE(e,VU),GU=e=>WE(e,zE.map(t=>t.name)),YU=(e,t)=>{const n=jU(e),s=KU(t),o=s.length>0,r=n.length>0,a=t.theme==="mobile";if(o||r||a){const i=`
- `,l=a?`

Themes:${i}mobile`:"",c=o?`

Plugins:${i}${s.join(i)}`:"",u=r?`

Options:${i}${n.join(i)}`:"";console.warn("The following deprecated features are currently enabled and have been removed in TinyMCE 7.0. These features will no longer work and should be removed from the TinyMCE configuration. See https://www.tiny.cloud/docs/tinymce/7/migration-from-6x/ for more information."+l+c+u)}},XU=e=>Ye(zE,t=>t.name===e).fold(()=>e,t=>t.replacedWith?`${e}, replaced by ${t.replacedWith}`:e),ZU=(e,t)=>{const n=qU(e),s=GU(t),o=s.length>0,r=n.length>0;if(o||r){const a=`
- `,i=o?`

Plugins:${a}${s.map(XU).join(a)}`:"",l=r?`

Options:${a}${n.join(a)}`:"";console.warn("The following deprecated features are currently enabled but will be removed soon."+i+l)}},QU=(e,t)=>{YU(e,t),ZU(e,t)},kl=_e.DOM,JU=e=>{kl.setStyle(e.id,"display",e.orgDisplay)},_l=e=>m.from(e).each(t=>t.destroy()),ez=e=>{const t=e;t.contentAreaContainer=t.formElement=t.container=t.editorContainer=null,t.bodyElement=t.contentDocument=t.contentWindow=null,t.iframeElement=t.targetElm=null;const n=e.selection;if(n){const s=n.dom;t.selection=n.win=n.dom=s.doc=null}},tz=e=>{const t=e.formElement;t&&(t._mceOldSubmit&&(t.submit=t._mceOldSubmit,delete t._mceOldSubmit),kl.unbind(t,"submit reset",e.formEventDelegate))},nz=e=>{if(!e.removed){const{_selectionOverrides:t,editorUpload:n}=e,s=e.getBody(),o=e.getElement();s&&e.save({is_removing:!0}),e.removed=!0,e.unbindAllNativeEvents(),e.hasHiddenInput&&U(o==null?void 0:o.nextSibling)&&kl.remove(o.nextSibling),tD(e),e.editorManager.remove(e),!e.inline&&s&&JU(e),nD(e),kl.remove(e.getContainer()),_l(t),_l(n),e.destroy()}},sz=(e,t)=>{const{selection:n,dom:s}=e;if(!e.destroyed){if(!t&&!e.removed){e.remove();return}t||(e.editorManager.off("beforeunload",e._beforeUnload),e.theme&&e.theme.destroy&&e.theme.destroy(),_l(n),_l(s)),tz(e),ez(e),e.destroyed=!0}},Al=(()=>{const e={};return{add:(o,r)=>{e[o]=r},get:o=>e[o]?e[o]:{icons:{}},has:o=>se(e,o)}})(),sr=Ct.ModelManager,VE=(e,t)=>t.dom[e],jE=(e,t)=>parseInt(In(t,e),10),oz=G(VE,"clientWidth"),rz=G(VE,"clientHeight"),az=G(jE,"margin-top"),iz=G(jE,"margin-left"),lz=e=>e.dom.getBoundingClientRect(),cz=(e,t,n)=>{const s=oz(e),o=rz(e);return t>=0&&n>=0&&t<=s&&n<=o},uz=(e,t,n,s)=>{const o=lz(t),r=e?o.left+t.dom.clientLeft+iz(t):0,a=e?o.top+t.dom.clientTop+az(t):0,i=n-r,l=s-a;return{x:i,y:l}},fz=(e,t,n)=>{const s=C.fromDom(e.getBody()),o=e.inline?s:ox(s),r=uz(e.inline,o,t,n);return cz(o,r.x,r.y)},dz=e=>m.from(e).map(C.fromDom),mz=e=>{const t=e.inline?e.getBody():e.getContentAreaContainer();return dz(t).map(To).getOr(!1)};var gz=()=>{const e=()=>{throw new Error("Theme did not provide a NotificationManager implementation.")};return{open:e,close:e,getArgs:e}};const qE=e=>{const t=[],n=()=>{const d=e.theme;return d&&d.getNotificationManagerImpl?d.getNotificationManagerImpl():gz()},s=()=>m.from(t[0]),o=(d,g)=>d.type===g.type&&d.text===g.text&&!d.progressBar&&!d.timeout&&!g.progressBar&&!g.timeout,r=()=>{s().each(d=>{d.reposition()})},a=d=>{t.push(d)},i=d=>{wr(t,g=>g===d).each(g=>{t.splice(g,1)})},l=(d,g=!0)=>e.removed||!mz(e)?{}:(g&&e.dispatch("BeforeOpenNotification",{notification:d}),Ye(t,h=>o(n().getArgs(h),d)).getOrThunk(()=>{e.editorManager.setActive(e);const h=n().open(d,()=>{i(h)},()=>hf(e));return a(h),r(),e.dispatch("OpenNotification",{notification:{...h}}),h})),c=()=>{s().each(d=>{n().close(d),i(d),r()})},u=W(t);return(d=>{d.on("SkinLoaded",()=>{const g=GD(d);g&&l({text:g,type:"warning",timeout:0},!1),r()}),d.on("show ResizeEditor ResizeWindow NodeChange ToggleView FullscreenStateChanged",()=>{requestAnimationFrame(r)}),d.on("remove",()=>{D(t.slice(),g=>{n().close(g)})}),d.on("keydown",g=>{var h;const p=((h=g.key)===null||h===void 0?void 0:h.toLowerCase())==="f12"||g.keyCode===123;g.altKey&&p&&(g.preventDefault(),s().map(b=>C.fromDom(b.getEl())).each(b=>sp(b)))})})(e),{open:l,close:c,getNotifications:u}},or=Ct.PluginManager,go=Ct.ThemeManager;var pz=()=>{const e=()=>{throw new Error("Theme did not provide a WindowManager implementation.")};return{open:e,openUrl:e,alert:e,confirm:e,close:e}};const KE=e=>{let t=[];const n=()=>{const p=e.theme;return p&&p.getWindowManagerImpl?p.getWindowManagerImpl():pz()},s=(p,b)=>(...y)=>b?b.apply(p,y):void 0,o=p=>{e.dispatch("OpenWindow",{dialog:p})},r=p=>{e.dispatch("CloseWindow",{dialog:p})},a=p=>{t.push(p),o(p)},i=p=>{r(p),t=ne(t,b=>b!==p),t.length===0&&e.focus()},l=()=>m.from(t[t.length-1]),c=p=>{e.editorManager.setActive(e),Ji(e),e.ui.show();const b=p();return a(b),b},u=(p,b)=>c(()=>n().open(p,b,i)),f=p=>c(()=>n().openUrl(p,i)),d=(p,b,y)=>{const v=n();v.alert(p,s(y||v,b))},g=(p,b,y)=>{const v=n();v.confirm(p,s(y||v,b))},h=()=>{l().each(p=>{n().close(p),i(p)})};return e.on("remove",()=>{D(t,p=>{n().close(p)})}),{open:u,openUrl:f,alert:d,confirm:g,close:h}},GE=(e,t)=>{e.notificationManager.open({type:"error",text:t})},xl=(e,t)=>{e._skinLoaded?GE(e,t):e.on("SkinLoaded",()=>{GE(e,t)})},hz=(e,t)=>{xl(e,vn.translate(["Failed to upload image: {0}",t]))},Oa=(e,t,n)=>{Qh(e,t,{message:n}),console.error(n)},Ia=(e,t,n)=>n?`Failed to load ${e}: ${n} from url ${t}`:`Failed to load ${e} url: ${t}`,bz=(e,t,n)=>{Oa(e,"PluginLoadError",Ia("plugin",t,n))},Cz=(e,t,n)=>{Oa(e,"IconsLoadError",Ia("icons",t,n))},yz=(e,t,n)=>{Oa(e,"LanguageLoadError",Ia("language",t,n))},vz=(e,t,n)=>{Oa(e,"ThemeLoadError",Ia("theme",t,n))},Ez=(e,t,n)=>{Oa(e,"ModelLoadError",Ia("model",t,n))},Sz=(e,t,n)=>{const s=vn.translate(["Failed to initialize plugin: {0}",t]);Qh(e,"PluginLoadError",{message:s}),Nl(s,n),xl(e,s)},Nl=(e,...t)=>{const n=window.console;n&&(n.error?n.error(e,...t):n.log(e,...t))},wz=e=>{m.from(e.selection.getNode()).each(t=>{t.removeAttribute("data-mce-selected")})},Dd=(e,t,n)=>{try{e.getDoc().execCommand(t,!1,String(n))}catch{}},kz=(e,t)=>{Dd(e,"StyleWithCSS",t),Dd(e,"enableInlineTableEditing",t),Dd(e,"enableObjectResizing",t)},_z=e=>{e.selection.setRng(e.selection.getRng())},YE=(e,t,n)=>{Kc(e,t)&&!n?jr(e,t):n&&Bo(e,t)},XE=e=>{const t=C.fromDom(e.getBody());YE(t,"mce-content-readonly",!0),e.selection.controlSelection.hideResizeRect(),e._selectionOverrides.hideFakeCaret(),wz(e)},ZE=e=>{const t=C.fromDom(e.getBody());YE(t,"mce-content-readonly",!1),e.hasEditableRoot()&&yi(t,!0),kz(e,!1),hf(e)&&e.focus(),_z(e),e.nodeChanged()},ls=e=>Hi(e),po="data-mce-contenteditable",Az=e=>{D(ut(e,'*[contenteditable="true"]'),t=>{ot(t,po,"true"),yi(t,!1)})},xz=e=>{D(ut(e,`*[${po}="true"]`),t=>{rt(t,po),yi(t,!0)})},QE=(e,t)=>{const n=C.fromDom(e.getBody());t?(XE(e),yi(n,!1),Az(n)):(xz(n),ZE(e))},Nz=e=>{e.serializer?JE(e):e.on("PreInit",()=>{JE(e)})},JE=e=>{e.parser.addAttributeFilter("contenteditable",t=>{ls(e)&&D(t,n=>{n.attr(po,n.attr("contenteditable")),n.attr("contenteditable","false")})}),e.serializer.addAttributeFilter(po,t=>{ls(e)&&D(t,n=>{n.attr("contenteditable",n.attr(po))})}),e.serializer.addTempAttr(po)},Rz=e=>e.type==="click",Tz=["copy"],Dz=e=>Se(Tz,e.type),Pz=(e,t)=>Po(t,"a",s=>Ee(s,C.fromDom(e.getBody()))).bind(s=>ns(s,"href")),Bz=(e,t)=>{if(Rz(t)&&!j.metaKeyPressed(t)){const n=C.fromDom(t.target);Pz(e,n).each(s=>{if(t.preventDefault(),/^#/.test(s)){const o=e.dom.select(`${s},[name="${pg(s,"#")}"]`);o.length&&e.selection.scrollIntoView(o[0],!0)}else window.open(s,"_blank","rel=noopener noreferrer,menubar=yes,toolbar=yes,location=yes,status=yes,resizable=yes,scrollbars=yes")})}else Dz(t)&&e.dispatch(t.type,t)},Oz=e=>{e.on("ShowCaret ObjectSelected",t=>{ls(e)&&t.preventDefault()}),e.on("DisabledStateChange",t=>{t.isDefaultPrevented()||QE(e,t.state)})},Iz=e=>{Nz(e),Oz(e)},Fz=e=>/^[a-z0-9\-]+$/i.test(e),Pd=e=>"content/"+e+"/content.css",Lz=e=>tinymce.Resource.has(Pd(e)),$z=e=>eS(e,HD(e)),Mz=e=>eS(e,mb(e)),eS=(e,t)=>{const n=e.editorManager.baseURL+"/skins/content",o=`content${e.editorManager.suffix}.css`;return he(t,r=>Lz(r)?r:Fz(r)&&!e.inline?`${n}/${r}/${o}`:e.documentBaseURI.toAbsolute(r))},Uz=e=>{e.contentCSS=e.contentCSS.concat($z(e),Mz(e))},zz=e=>e?Lt(e.getElementsByTagName("img")):[],Hz=(e,t)=>{const n={};return{findAll:(o,r=Ue)=>{const a=ne(zz(o),l=>{const c=l.src;return l.hasAttribute("data-mce-bogus")||l.hasAttribute("data-mce-placeholder")||!c||c===Ce.transparentSrc?!1:Xe(c,"blob:")?!e.isUploaded(c)&&r(l):Xe(c,"data:")?r(l):!1}),i=he(a,l=>{const c=l.src;if(se(n,c))return n[c].then(u=>J(u)?u:{image:l,blobInfo:u.blobInfo});{const u=qL(t,c).then(f=>(delete n[c],{image:l,blobInfo:f})).catch(f=>(delete n[c],f));return n[c]=u,u}});return Promise.all(i)}}},tS=()=>{let n={};const s=(d,g)=>({status:d,resultUri:g}),o=d=>d in n;return{hasBlobUri:o,getResultUri:d=>{const g=n[d];return g?g.resultUri:null},isPending:d=>o(d)?n[d].status===1:!1,isUploaded:d=>o(d)?n[d].status===2:!1,markPending:d=>{n[d]=s(1,null)},markUploaded:(d,g)=>{n[d]=s(2,g)},removeFailed:d=>{delete n[d]},destroy:()=>{n={}}}};let Wz=0;const Vz=()=>{const e=()=>Math.round(lg()*4294967295).toString(36);return"s"+new Date().getTime().toString(36)+e()+e()+e()},jz=e=>e+Wz+++Vz(),qz=()=>{let e=[];const t=f=>({"image/jpeg":"jpg","image/jpg":"jpg","image/gif":"gif","image/png":"png","image/apng":"apng","image/avif":"avif","image/svg+xml":"svg","image/webp":"webp","image/bmp":"bmp","image/tiff":"tiff"})[f.toLowerCase()]||"dat",n=(f,d,g,h,p)=>{if(J(f))return s({id:f,name:h,filename:p,blob:d,base64:g});if(nt(f))return s(f);throw new Error("Unknown input type")},s=f=>{if(!f.blob||!f.base64)throw new Error("blob and base64 representations of the image are required for BlobInfo to be created");const d=f.id||jz("blobid"),g=f.name||d,h=f.blob;return{id:W(d),name:W(g),filename:W(f.filename||g+"."+t(h.type)),blob:W(h),base64:W(f.base64),blobUri:W(f.blobUri||URL.createObjectURL(h)),uri:W(f.uri)}},o=f=>{a(f.id())||e.push(f)},r=f=>Ye(e,f).getOrUndefined(),a=f=>r(d=>d.id()===f);return{create:n,add:o,get:a,getByUri:f=>r(d=>d.blobUri()===f),getByData:(f,d)=>r(g=>g.base64()===f&&g.blob().type===d),findFirst:r,removeByUri:f=>{e=ne(e,d=>d.blobUri()===f?(URL.revokeObjectURL(d.blobUri()),!1):!0)},destroy:()=>{D(e,f=>{URL.revokeObjectURL(f.blobUri())}),e=[]}}},Kz=(e,t)=>{const n={},s=(p,b)=>p?p.replace(/\/$/,"")+"/"+b.replace(/^\//,""):b,o=(p,b)=>new Promise((y,v)=>{const E=new XMLHttpRequest;E.open("POST",t.url),E.withCredentials=t.credentials,E.upload.onprogress=T=>{b(T.loaded/T.total*100)},E.onerror=()=>{v("Image upload failed due to a XHR Transport error. Code: "+E.status)},E.onload=()=>{if(E.status<200||E.status>=300){v("HTTP Error: "+E.status);return}const T=JSON.parse(E.responseText);if(!T||!J(T.location)){v("Invalid JSON: "+E.responseText);return}y(s(t.basePath,T.location))};const w=new FormData;w.append("file",p.blob(),p.filename()),E.send(w)}),r=we(t.handler)?t.handler:o,a=()=>new Promise(p=>{p([])}),i=(p,b)=>({url:b,blobInfo:p,status:!0}),l=(p,b)=>({url:"",blobInfo:p,status:!1,error:b}),c=(p,b)=>{L.each(n[p],y=>{y(b)}),delete n[p]},u=(p,b,y)=>(e.markPending(p.blobUri()),new Promise(v=>{let E,w;try{const T=()=>{E&&(E.close(),w=ce)},B=x=>{T(),e.markUploaded(p.blobUri(),x),c(p.blobUri(),i(p,x)),v(i(p,x))},H=x=>{T(),e.removeFailed(p.blobUri()),c(p.blobUri(),l(p,x)),v(l(p,x))};w=x=>{x<0||x>100||m.from(E).orThunk(()=>m.from(y).map(bc)).each(_=>{E=_,_.progressBar.value(x)})},b(p,w).then(B,x=>{H(J(x)?{message:x}:x)})}catch(T){v(l(p,T))}})),f=p=>p===o,d=p=>{const b=p.blobUri();return new Promise(y=>{n[b]=n[b]||[],n[b].push(y)})},g=(p,b)=>(p=L.grep(p,y=>!e.isUploaded(y.blobUri())),Promise.all(L.map(p,y=>e.isPending(y.blobUri())?d(y):u(y,r,b))));return{upload:(p,b)=>!t.url&&f(r)?a():g(p,b)}},nS=e=>()=>e.notificationManager.open({text:e.translate("Image uploading..."),type:"info",timeout:-1,progressBar:!0}),sS=(e,t)=>Kz(t,{url:ID(e),basePath:FD(e),credentials:LD(e),handler:$D(e)}),Gz=e=>{const t=tS(),n=sS(e,t);return{upload:(s,o=!0)=>n.upload(s,o?nS(e):void 0)}},Yz=(e,t)=>e.dom.isEmpty(t.dom)&&U(e.schema.getTextBlockElements()[be(t)]),Xz=e=>t=>{Yz(e,t)&&je(t,C.fromHtml('<br data-mce-bogus="1" />'))},Zz=e=>{const t=qz();let n,s;const o=tS(),r=[],a=E=>w=>e.selection?E(w):[],i=E=>E+(E.indexOf("?")===-1?"?":"&")+new Date().getTime(),l=(E,w,T)=>{let B=0;do B=E.indexOf(w,B),B!==-1&&(E=E.substring(0,B)+T+E.substr(B+w.length),B+=T.length-w.length+1);while(B!==-1);return E},c=(E,w,T)=>{const B=`src="${T}"${T===Ce.transparentSrc?' data-mce-placeholder="1"':""}`;return E=l(E,`src="${w}"`,B),E=l(E,'data-mce-src="'+w+'"','data-mce-src="'+T+'"'),E},u=(E,w)=>{D(e.undoManager.data,T=>{T.type==="fragmented"?T.fragments=he(T.fragments,B=>c(B,E,w)):T.content=c(T.content,E,w)})},f=(E,w)=>{const T=e.convertURL(w,"src");u(E.src,w),ts(C.fromDom(E),{src:cb(e)?i(w):w,"data-mce-src":T})},d=()=>(n||(n=sS(e,o)),b().then(a(E=>{const w=he(E,T=>T.blobInfo);return n.upload(w,nS(e)).then(a(T=>{const B=[];let H=!1;const x=he(T,(_,P)=>{const{blobInfo:z,image:X}=E[P];let oe=!1;return _.status&&BD(e)?(_.url&&!lt(X.src,_.url)&&(H=!0),t.removeByUri(X.src),Vn(e)||f(X,_.url)):_.error&&(_.error.remove&&(u(X.src,Ce.transparentSrc),B.push(X),oe=!0),hz(e,_.error.message)),{element:X,status:_.status,uploadUri:_.url,blobInfo:z,removed:oe}});return B.length>0&&!Vn(e)?e.undoManager.transact(()=>{D(Mc(B),_=>{const P=On(_);Ne(_),P.each(Xz(e)),t.removeByUri(_.dom.src)})}):H&&e.undoManager.dispatchChange(),x}))}))),g=()=>lb(e)?d():Promise.resolve([]),h=E=>Zn(r,w=>w(E)),p=E=>{r.push(E)},b=()=>(s||(s=Hz(o,t)),s.findAll(e.getBody(),h).then(a(E=>{const w=ne(E,T=>J(T)?(xl(e,T),!1):T.uriType!=="blob");return Vn(e)||D(w,T=>{u(T.image.src,T.blobInfo.blobUri()),T.image.src=T.blobInfo.blobUri(),T.image.removeAttribute("data-mce-src")}),w}))),y=()=>{t.destroy(),o.destroy(),s=n=null},v=E=>E.replace(/src="(blob:[^"]+)"/g,(w,T)=>{const B=o.getResultUri(T);if(B)return'src="'+B+'"';let H=t.getByUri(T);return H||(H=Tt(e.editorManager.get(),(x,_)=>x||_.editorUpload&&_.editorUpload.blobCache.getByUri(T),void 0)),H?'src="data:'+H.blob().type+";base64,"+H.base64()+'"':w});return e.on("SetContent",()=>{lb(e)?g():b()}),e.on("RawSaveContent",E=>{E.content=v(E.content)}),e.on("GetContent",E=>{E.source_view||E.format==="raw"||E.format==="tree"||(E.content=v(E.content))}),e.on("PostRender",()=>{e.parser.addNodeFilter("img",E=>{D(E,w=>{const T=w.attr("src");if(!T||t.getByUri(T))return;const B=o.getResultUri(T);B&&w.attr("src",B)})})}),{blobCache:t,addFilter:p,uploadImages:d,uploadImagesAuto:g,scanForImages:b,destroy:y}},Qz=e=>{const t=e.dom,n=e.schema.type,s={valigntop:[{selector:"td,th",styles:{verticalAlign:"top"}}],valignmiddle:[{selector:"td,th",styles:{verticalAlign:"middle"}}],valignbottom:[{selector:"td,th",styles:{verticalAlign:"bottom"}}],alignleft:[{selector:"figure.image",collapsed:!1,classes:"align-left",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"left"},inherit:!1,preview:!1},{selector:"img,audio,video",collapsed:!1,styles:{float:"left"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"left"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"0px",marginRight:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"left"}}],aligncenter:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"center"},inherit:!1,preview:"font-family font-size"},{selector:"figure.image",collapsed:!1,classes:"align-center",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{display:"block",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:".mce-placeholder",styles:{display:"block",marginLeft:"auto",marginRight:"auto"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginLeft:"auto",marginRight:"auto"},preview:"font-family font-size"},{selector:".mce-preview-object",ceFalseOverride:!0,styles:{display:"table",marginLeft:"auto",marginRight:"auto"},preview:!1},{selector:"[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{marginLeft:"auto",marginRight:"auto"},preview:!1}],alignright:[{selector:"figure.image",collapsed:!1,classes:"align-right",ceFalseOverride:!0,preview:"font-family font-size"},{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"right"},inherit:!1,preview:"font-family font-size"},{selector:"img,audio,video",collapsed:!1,styles:{float:"right"},preview:"font-family font-size"},{selector:".mce-placeholder",styles:{float:"right"},ceFalseOverride:!0},{selector:"table",collapsed:!1,styles:{marginRight:"0px",marginLeft:"auto"},onformat:o=>{t.setStyle(o,"float",null)},preview:"font-family font-size"},{selector:".mce-preview-object,[data-ephox-embed-iri]",ceFalseOverride:!0,styles:{float:"right"},preview:!1}],alignjustify:[{selector:"figure,p,h1,h2,h3,h4,h5,h6,td,th,tr,div,ul,ol,li,pre",styles:{textAlign:"justify"},inherit:!1,preview:"font-family font-size"}],bold:[{inline:"strong",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontWeight:"bold"}},{inline:"b",remove:"all",preserve_attributes:["class","style"]}],italic:[{inline:"em",remove:"all",preserve_attributes:["class","style"]},{inline:"span",styles:{fontStyle:"italic"}},{inline:"i",remove:"all",preserve_attributes:["class","style"]}],underline:[{inline:"span",styles:{textDecoration:"underline"},exact:!0},{inline:"u",remove:"all",preserve_attributes:["class","style"]}],strikethrough:(()=>{const o={inline:"span",styles:{textDecoration:"line-through"},exact:!0},r={inline:"strike",remove:"all",preserve_attributes:["class","style"]},a={inline:"s",remove:"all",preserve_attributes:["class","style"]};return n!=="html4"?[a,o,r]:[o,a,r]})(),forecolor:{inline:"span",styles:{color:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},hilitecolor:{inline:"span",styles:{backgroundColor:"%value"},links:!0,remove_similar:!0,clear_child_styles:!0},fontname:{inline:"span",toggle:!1,styles:{fontFamily:"%value"},clear_child_styles:!0},fontsize:{inline:"span",toggle:!1,styles:{fontSize:"%value"},clear_child_styles:!0},lineheight:{selector:"h1,h2,h3,h4,h5,h6,p,li,td,th,div",styles:{lineHeight:"%value"}},fontsize_class:{inline:"span",attributes:{class:"%value"}},blockquote:{block:"blockquote",wrapper:!0,remove:"all"},subscript:{inline:"sub"},superscript:{inline:"sup"},code:{inline:"code"},samp:{inline:"samp"},link:{inline:"a",selector:"a",remove:"all",split:!0,deep:!0,onmatch:(o,r,a)=>q(o)&&o.hasAttribute("href"),onformat:(o,r,a)=>{L.each(a,(i,l)=>{t.setAttrib(o,l,i)})}},lang:{inline:"span",clear_child_styles:!0,remove_similar:!0,attributes:{lang:"%value","data-mce-lang":o=>{var r;return(r=o==null?void 0:o.customValue)!==null&&r!==void 0?r:null}}},removeformat:[{selector:"b,strong,em,i,font,u,strike,s,sub,sup,dfn,code,samp,kbd,var,cite,mark,q,del,ins,small",remove:"all",split:!0,expand:!1,block_expand:!0,deep:!0},{selector:"span",attributes:["style","class"],remove:"empty",split:!0,expand:!1,deep:!0},{selector:"*",attributes:["style","class"],split:!1,expand:!1,deep:!0}]};return L.each("p h1 h2 h3 h4 h5 h6 div address pre dt dd".split(/\s/),o=>{s[o]={block:o,remove:"all"}}),s},oS={remove_similar:!0,inherit:!1},rr={selector:"td,th",...oS},Jz={tablecellbackgroundcolor:{styles:{backgroundColor:"%value"},...rr},tablecellverticalalign:{styles:{"vertical-align":"%value"},...rr},tablecellbordercolor:{styles:{borderColor:"%value"},...rr},tablecellclass:{classes:["%value"],...rr},tableclass:{selector:"table",classes:["%value"],...oS},tablecellborderstyle:{styles:{borderStyle:"%value"},...rr},tablecellborderwidth:{styles:{borderWidth:"%value"},...rr}},eH=W(Jz),tH=e=>{const t={},n=a=>U(a)?t[a]:t,s=a=>se(t,a),o=(a,i)=>{a&&(J(a)?(De(i)||(i=[i]),D(i,l=>{st(l.deep)&&(l.deep=!Qt(l)),st(l.split)&&(l.split=!Qt(l)||Je(l)),st(l.remove)&&Qt(l)&&!Je(l)&&(l.remove="none"),Qt(l)&&Je(l)&&(l.mixed=!0,l.block_expand=!0),J(l.classes)&&(l.classes=l.classes.split(/\s+/))}),t[a]=i):Ae(a,(l,c)=>{o(c,l)}))},r=a=>(a&&t[a]&&delete t[a],t);return o(Qz(e)),o(eH()),o(ZD(e)),{get:n,has:s,register:o,unregister:r}},Rl=L.each,tn=_e.DOM,Bd=e=>U(e)&&nt(e),rS=(e,t)=>{const n=t&&t.schema||vs({}),s=(l,c)=>{c.classes.length>0&&tn.addClass(l,c.classes.join(" ")),tn.setAttribs(l,c.attrs)},o=l=>{const c=J(l)?{name:l,classes:[],attrs:{}}:l,u=tn.create(c.name);return s(u,c),u},r=(l,c)=>{const u=n.getElementRule(l.nodeName.toLowerCase()),f=u==null?void 0:u.parentsRequired;return f&&f.length?c&&Se(f,c)?c:f[0]:!1},a=(l,c,u)=>{let f;const d=c[0],g=Bd(d)?d.name:void 0,h=r(l,g);if(h)g===h?(f=d,c=c.slice(1)):f=h;else if(d)f=d,c=c.slice(1);else if(!u)return l;const p=f?o(f):tn.create("div");p.appendChild(l),u&&L.each(u,y=>{const v=o(y);p.insertBefore(v,l)});const b=Bd(f)?f.siblings:void 0;return a(p,c,b)},i=tn.create("div");if(e.length>0){const l=e[0],c=o(l),u=Bd(l)?l.siblings:void 0;i.appendChild(a(c,e.slice(1),u))}return i},nH=e=>{e=L.trim(e);let t="div";const n={name:t,classes:[],attrs:{},selector:e};return e!=="*"&&(t=e.replace(/(?:([#\.]|::?)([\w\-]+)|(\[)([^\]]+)\]?)/g,(s,o,r,a,i)=>{switch(o){case"#":n.attrs.id=r;break;case".":n.classes.push(r);break;case":":L.inArray("checked disabled enabled read-only required".split(" "),r)!==-1&&(n.attrs[r]=r);break}if(a==="["){const l=i.match(/([\w\-]+)(?:\=\"([^\"]+))?/);l&&(n.attrs[l[1]]=l[2])}return""})),n.name=t||"div",n},sH=e=>J(e)?(e=e.split(/\s*,\s*/)[0],e=e.replace(/\s*(~\+|~|\+|>)\s*/g,"$1"),L.map(e.split(/(?:>|\s+(?![^\[\]]+\]))/),t=>{const n=L.map(t.split(/(?:~\+|~|\+)/),nH),s=n.pop();return n.length&&(s.siblings=n),s}).reverse()):[],oH=(e,t)=>{let n="",s=QD(e);if(s==="")return"";const o=d=>J(d)?d.replace(/%(\w+)/g,""):"",r=(d,g)=>tn.getStyle(g??e.getBody(),d,!0);if(J(t)){const d=e.formatter.get(t);if(!d)return"";t=d[0]}if("preview"in t){const d=t.preview;if(d===!1)return"";s=d||s}let a=t.block||t.inline||"span",i;const l=sH(t.selector);l.length>0?(l[0].name||(l[0].name=a),a=t.selector,i=rS(l,e)):i=rS([a],e);const c=tn.select(a,i)[0]||i.firstChild;Rl(t.styles,(d,g)=>{const h=o(d);h&&tn.setStyle(c,g,h)}),Rl(t.attributes,(d,g)=>{const h=o(d);h&&tn.setAttrib(c,g,h)}),Rl(t.classes,d=>{const g=o(d);tn.hasClass(c,g)||tn.addClass(c,g)}),e.dispatch("PreviewFormats"),tn.setStyles(i,{position:"absolute",left:-65535}),e.getBody().appendChild(i);const u=r("fontSize"),f=/px$/.test(u)?parseInt(u,10):0;return Rl(s.split(" "),d=>{let g=r(d,c);if(!(d==="background-color"&&/transparent|rgba\s*\([^)]+,\s*0\)/.test(g)&&(g=r(d),Gr(g).toLowerCase()==="#ffffff"))&&!(d==="color"&&Gr(g).toLowerCase()==="#000000")){if(d==="font-size"&&/em|%$/.test(g)){if(f===0)return;g=parseFloat(g)/(/%$/.test(g)?100:1)*f+"px"}d==="border"&&g&&(n+="padding:0 2px;"),n+=d+":"+g+";"}}),e.dispatch("AfterPreviewFormats"),tn.remove(i),n},rH=e=>{e.addShortcut("meta+b","","Bold"),e.addShortcut("meta+i","","Italic"),e.addShortcut("meta+u","","Underline");for(let t=1;t<=6;t++)e.addShortcut("access+"+t,"",["FormatBlock",!1,"h"+t]);e.addShortcut("access+7","",["FormatBlock",!1,"p"]),e.addShortcut("access+8","",["FormatBlock",!1,"div"]),e.addShortcut("access+9","",["FormatBlock",!1,"address"])},aS=e=>{const t=tH(e),n=et({});return rH(e),oL(e),Vn(e)||RL(n,e),{get:t.get,has:t.has,register:t.register,unregister:t.unregister,apply:(s,o,r)=>{rU(e,s,o,r)},remove:(s,o,r,a)=>{aU(e,s,o,r,a)},toggle:(s,o,r)=>{iU(e,s,o,r)},match:(s,o,r,a)=>eU(e,s,o,r,a),closest:s=>oU(e,s),matchAll:(s,o)=>tU(e,s,o),matchNode:(s,o,r,a)=>nU(e,s,o,r,a),canApply:s=>sU(e,s),formatChanged:(s,o,r,a)=>lU(e,n,s,o,r,a),getCssText:G(oH,e)}},iS=e=>{switch(e.toLowerCase()){case"undo":case"redo":case"mcefocus":return!0;default:return!1}},aH=(e,t,n)=>{const s=et(!1),o=l=>{wl(t,!1,n),t.add({},l)};e.on("init",()=>{t.add()}),e.on("BeforeExecCommand",l=>{const c=l.command;iS(c)||(PE(t,n),t.beforeChange())}),e.on("ExecCommand",l=>{const c=l.command;iS(c)||o(l)}),e.on("ObjectResizeStart cut",()=>{t.beforeChange()}),e.on("SaveContent ObjectResized blur",o),e.on("dragend",o),e.on("keyup",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;const u=Ce.os.isMacOS()&&l.key==="Meta";(c>=33&&c<=36||c>=37&&c<=40||c===45||l.ctrlKey||u)&&(o(),e.nodeChanged()),(c===46||c===8)&&e.nodeChanged(),s.get()&&t.typing&&!xd(Sl(e),t.data[0])&&(e.isDirty()||e.setDirty(!0),e.dispatch("TypingUndo"),s.set(!1),e.nodeChanged())}),e.on("keydown",l=>{const c=l.keyCode;if(l.isDefaultPrevented())return;if(c>=33&&c<=36||c>=37&&c<=40||c===45){t.typing&&o(l);return}const u=l.ctrlKey&&!l.altKey||l.metaKey;if((c<16||c>20)&&c!==224&&c!==91&&!t.typing&&!u){t.beforeChange(),wl(t,!0,n),t.add({},l),s.set(!0);return}(Ce.os.isMacOS()?l.metaKey:l.ctrlKey&&!l.altKey)&&t.beforeChange()}),e.on("mousedown",l=>{t.typing&&o(l)});const r=l=>l.inputType==="insertReplacementText",a=l=>l.inputType==="insertText"&&l.data===null,i=l=>l.inputType==="insertFromPaste"||l.inputType==="insertFromDrop";e.on("input",l=>{l.inputType&&(r(l)||a(l)||i(l))&&o(l)}),e.on("AddUndo Undo Redo ClearUndos",l=>{l.isDefaultPrevented()||e.nodeChanged()})},iH=e=>{e.addShortcut("meta+z","","Undo"),e.addShortcut("meta+y,meta+shift+z","","Redo")},lS=e=>{const t=Qn(),n=et(0),s=et(0),o={data:[],typing:!1,beforeChange:()=>{WM(e,n,t)},add:(r,a)=>VM(e,o,s,n,t,r,a),dispatchChange:()=>{e.setDirty(!0);const r=Sl(e);r.bookmark=Iu(e.selection),e.dispatch("change",{level:r,lastLevel:_r(o.data,s.get()).getOrUndefined()})},undo:()=>jM(e,o,n,s),redo:()=>qM(e,s,o.data),clear:()=>{KM(e,o,s)},reset:()=>{GM(e,o)},hasUndo:()=>YM(e,o,s),hasRedo:()=>XM(e,o,s),transact:r=>ZM(e,o,n,r),ignore:r=>{QM(e,n,r)},extra:(r,a)=>{JM(e,o,s,r,a)}};return Vn(e)||aH(e,o,n),iH(e),o},lH=[9,27,j.HOME,j.END,19,20,44,144,145,33,34,45,16,17,18,91,92,93,j.DOWN,j.UP,j.LEFT,j.RIGHT].concat(Ce.browser.isFirefox()?[224]:[]),cS="data-mce-placeholder",uS=e=>e.type==="keydown"||e.type==="keyup",fS=e=>{const t=e.keyCode;return t===j.BACKSPACE||t===j.DELETE},cH=e=>{if(uS(e)){const t=e.keyCode;return!fS(e)&&(j.metaKeyPressed(e)||e.altKey||t>=112&&t<=123||Se(lH,t))}else return!1},uH=e=>uS(e)&&!(fS(e)||e.type==="keyup"&&e.keyCode===229),fH=(e,t,n)=>{if(e.isEmpty(t,void 0,{skipBogus:!1,includeZwsp:!0})){const s=t.firstElementChild;return s?e.getStyle(t.firstElementChild,"padding-left")||e.getStyle(t.firstElementChild,"padding-right")?!1:n===s.nodeName.toLowerCase():!0}else return!1},dH=e=>{var t;const n=e.dom,s=dt(e),o=(t=KD(e))!==null&&t!==void 0?t:"",r=(a,i)=>{if(cH(a))return;const l=e.getBody(),c=uH(a)?!1:fH(n,l,s);(n.getAttrib(l,cS)!==""!==c||i)&&(n.setAttrib(l,cS,c?o:null),cD(e,c),e.on(c?"keydown":"keyup",r),e.off(c?"keyup":"keydown",r))};Tn(o)&&e.on("init",a=>{r(a,!0),e.on("change SetContent ExecCommand",r),e.on("paste",i=>Jt.setEditorTimeout(e,()=>r(i)))})},mH=(e,t)=>({block:e,position:t}),gH=(e,t)=>({from:e,to:t}),Od=(e,t)=>{const n=C.fromDom(e),s=C.fromDom(t.container());return fl(n,s).map(o=>mH(o,t))},pH=e=>!(bn(e.to.block,e.from.block)||bn(e.from.block,e.to.block)),hH=e=>!Ee(e.from.block,e.to.block),dS=(e,t)=>bs(t,o=>na(o)||an(o.dom),o=>Ee(o,e)).filter(Ut).getOr(e),bH=(e,t)=>{const n=C.fromDom(e);return Ee(dS(n,t.from.block),dS(n,t.to.block))},CH=e=>xe(e.from.block.dom)===!1&&xe(e.to.block.dom)===!1,yH=e=>{const t=n=>vh(n)||au(n.dom)||Uo(n);return t(e.from.block)&&t(e.to.block)},vH=(e,t,n,s)=>Ie(s.position.getNode())&&!ft(e,s.block)?Yo(!1,s.block.dom).bind(o=>o.isEqual(s.position)?Yt(n,t,o).bind(r=>Od(t,r)):m.some(s)).getOr(s):s,EH=(e,t,n,s)=>{const o=Od(t,N.fromRangeStart(s)),r=o.bind(a=>Yt(n,t,a.position).bind(i=>Od(t,i).map(l=>vH(e,t,n,l))));return at(o,r,gH).filter(a=>hH(a)&&bH(t,a)&&CH(a)&&yH(a)&&pH(a))},SH=(e,t,n,s)=>s.collapsed?EH(e,t,n,s):m.none(),wH=(e,t)=>{const n=ct(e);return wr(n,s=>t.isBlock(be(s))).fold(W(n),s=>n.slice(0,s))},mS=(e,t)=>{const n=wH(e,t);return D(n,Ne),n},gS=(e,t,n)=>{const s=is(n,t);return Ye(s.reverse(),o=>ft(e,o)).each(Ne)},kH=(e,t)=>ne(Jg(t),n=>!ft(e,n)).length===0,_H=(e,t,n,s,o)=>{if(ft(s,n))return Es(n),mt(n.dom);kH(s,o)&&ft(s,t)&&Dt(o,C.fromTag("br"));const r=Pt(n.dom,N.before(o.dom));return D(mS(t,s),a=>{Dt(o,a)}),gS(s,e,t),r},AH=(e,t)=>e.isInline(be(t)),xH=(e,t,n,s)=>{if(ft(s,n)){if(ft(s,t)){const a=Sr((i=>{const l=(c,u)=>Pc(c).fold(()=>u,f=>AH(s,f)?l(f,u.concat(Hs(f))):u);return l(i,[])})(n),(i,l)=>(rp(i,l),l),zo());Ro(t),je(t,a)}return Ne(n),mt(t.dom)}const o=ln(n.dom);return D(mS(t,s),r=>{je(n,r)}),gS(s,e,t),o},NH=(e,t)=>{const n=is(t,e);return m.from(n[n.length-1])},RH=(e,t)=>bn(t,e)?NH(t,e):m.none(),pS=(e,t)=>{Yo(e,t.dom).bind(n=>m.from(n.getNode())).map(C.fromDom).filter(Qs).each(Ne)},hS=(e,t,n,s)=>(pS(!0,t),pS(!1,n),RH(t,n).fold(G(xH,e,t,n,s),G(_H,e,t,n,s))),bS=(e,t,n,s,o)=>t?hS(e,s,n,o):hS(e,n,s,o),Id=(e,t)=>{const n=C.fromDom(e.getBody());return SH(e.schema,n.dom,t,e.selection.getRng()).map(o=>()=>{bS(n,t,o.from.block,o.to.block,e.schema).each(r=>{e.selection.setRng(r.toRange())})})},TH=(e,t,n)=>{const s=t.getRng();return at(fl(e,C.fromDom(s.startContainer)),fl(e,C.fromDom(s.endContainer)),(o,r)=>Ee(o,r)?m.none():m.some(()=>{s.deleteContents(),bS(e,!0,o,r,n).each(a=>{t.setRng(a.toRange())})})).getOr(m.none())},CS=(e,t)=>{const n=C.fromDom(t),s=G(Ee,e);return ss(n,na,s).isSome()},DH=(e,t)=>CS(e,t.startContainer)||CS(e,t.endContainer),PH=(e,t)=>{const n=Pt(e.dom,N.fromRangeStart(t)).isNone(),s=xt(e.dom,N.fromRangeEnd(t)).isNone();return!DH(e,t)&&n&&s},BH=e=>m.some(()=>{e.setContent(""),e.selection.setCursorLocation()}),OH=e=>{const t=C.fromDom(e.getBody()),n=e.selection.getRng();return PH(t,n)?BH(e):TH(t,e.selection,e.schema)},Fd=(e,t)=>e.selection.isCollapsed()?m.none():OH(e),cs=(e,t,n,s,o)=>m.from(t._selectionOverrides.showCaret(e,n,s,o)),IH=e=>{const t=e.ownerDocument.createRange();return t.selectNode(e),t},Fa=(e,t)=>e.dispatch("BeforeObjectSelected",{target:t}).isDefaultPrevented()?m.none():m.some(IH(t)),FH=(e,t,n)=>{const s=ju(1,e.getBody(),t),o=N.fromRangeStart(s),r=o.getNode();if(ca(r))return cs(1,e,r,!o.isAtEnd(),!1);const a=o.getNode(!0);if(ca(a))return cs(1,e,a,!1,!1);const i=uo(e.dom.getRoot(),o.getNode());return ca(i)?cs(1,e,i,!1,n):m.none()},Ld=(e,t,n)=>t.collapsed?FH(e,t,n).getOr(t):t,LH=e=>Rs(e)||va(e),$H=e=>Ts(e)||Ea(e),MH=(e,t)=>{I(t)&&t.data.length===0&&e.remove(t)},yS=(e,t,n,s,o,r)=>{cs(s,e,r.getNode(!o),o,!0).each(a=>{if(t.collapsed){const i=t.cloneRange();o?i.setEnd(a.startContainer,a.startOffset):i.setStart(a.endContainer,a.endOffset),i.deleteContents()}else t.deleteContents();e.selection.setRng(a)}),MH(e.dom,n)},UH=(e,t)=>{const n=e.selection.getRng();if(!I(n.commonAncestorContainer))return m.none();const s=t?1:-1,o=zn(e.getBody()),r=G(qu,t?o.next:o.prev),a=t?LH:$H,i=ga(s,e.getBody(),n),l=r(i),c=l&&en(t,l);if(!c||!ji(i,c))return m.none();if(a(c))return m.some(()=>yS(e,n,i.getNode(),s,t,c));const u=r(c);return u&&a(u)&&ji(c,u)?m.some(()=>yS(e,n,i.getNode(),s,t,u)):m.none()},$d=(e,t)=>UH(e,t),Md=(e,t)=>{const n=e.getBody();return t?mt(n).filter(Rs):ln(n).filter(Ts)},Ud=e=>{const t=e.selection.getRng();return!t.collapsed&&(Md(e,!0).exists(n=>n.isEqual(N.fromRangeStart(t)))||Md(e,!1).exists(n=>n.isEqual(N.fromRangeEnd(t))))},zH=e=>U(e)&&(na(C.fromDom(e))||Uo(C.fromDom(e))),Wt=Rn.generate([{remove:["element"]},{moveToElement:["element"]},{moveToPosition:["position"]}]),HH=(e,t)=>{const n=t.getNode(!e),s=e?"after":"before";return q(n)&&n.getAttribute("data-mce-caret")===s},WH=(e,t,n,s,o)=>{const r=a=>o.isInline(a.nodeName.toLowerCase())&&!Mn(n,s,e);return Fb(!t,n).fold(()=>Fb(t,s).fold(Pe,r),r)},vS=(e,t,n,s,o)=>{const r=o.getNode(!n);return fl(C.fromDom(t),C.fromDom(s.getNode())).map(a=>ft(e,a)?Wt.remove(a.dom):Wt.moveToElement(r)).orThunk(()=>m.some(Wt.moveToElement(r)))},ES=(e,t,n,s)=>Yt(t,e,n).bind(o=>zH(o.getNode())||WH(e,t,n,o,s)?m.none():t&&xe(o.getNode())||!t&&xe(o.getNode(!0))?vS(s,e,t,n,o):t&&Ts(n)||!t&&Rs(n)?m.some(Wt.moveToPosition(o)):m.none()),VH=(e,t)=>Ve(t)?m.none():e&&xe(t.nextSibling)?m.some(Wt.moveToElement(t.nextSibling)):!e&&xe(t.previousSibling)?m.some(Wt.moveToElement(t.previousSibling)):m.none(),jH=(e,t,n)=>n.fold(s=>m.some(Wt.remove(s)),s=>m.some(Wt.moveToElement(s)),s=>Mn(t,s,e)?m.none():m.some(Wt.moveToPosition(s))),qH=(e,t,n,s)=>HH(t,n)?VH(t,n.getNode(!t)).orThunk(()=>ES(e,t,n,s)):ES(e,t,n,s).bind(o=>jH(e,n,o)),KH=(e,t,n,s)=>{const o=ju(t?1:-1,e,n),r=N.fromRangeStart(o),a=C.fromDom(e);return!t&&Ts(r)?m.some(Wt.remove(r.getNode(!0))):t&&Rs(r)?m.some(Wt.remove(r.getNode())):!t&&Rs(r)&&ll(a,r,s)?my(a,r,s).map(i=>Wt.remove(i.getNode())):t&&Ts(r)&&Rf(a,r,s)?OO(a,r,s).map(i=>Wt.remove(i.getNode())):qH(e,t,r,s)},GH=(e,t)=>n=>(e._selectionOverrides.hideFakeCaret(),lo(e,t,C.fromDom(n)),!0),YH=(e,t)=>n=>{const s=t?N.before(n):N.after(n);return e.selection.setRng(s.toRange()),!0},XH=e=>t=>(e.selection.setRng(t.toRange()),!0),SS=(e,t)=>m.from(uo(e.getBody(),t)),ZH=(e,t)=>{const n=e.selection.getNode();return SS(e,n).filter(xe).fold(()=>KH(e.getBody(),t,e.selection.getRng(),e.schema).map(s=>()=>s.fold(GH(e,t),YH(e,t),XH(e))),()=>m.some(ce))},QH=e=>{D(ut(e,".mce-offscreen-selection"),Ne)},JH=(e,t)=>{const n=e.selection.getNode();return xe(n)&&!ki(n)?SS(e,n.parentNode).filter(xe).fold(()=>m.some(()=>{QH(C.fromDom(e.getBody())),lo(e,t,C.fromDom(e.selection.getNode())),Of(e)}),()=>m.some(ce)):Ud(e)?m.some(()=>{Iy(e,e.selection.getRng(),C.fromDom(e.getBody()))}):m.none()},wS=e=>{const t=e.dom,n=e.selection,s=uo(e.getBody(),n.getNode());if(an(s)&&t.isBlock(s)&&t.isEmpty(s)){const o=t.create("br",{"data-mce-bogus":"1"});t.setHTML(s,""),s.appendChild(o),n.setRng(N.before(o).toRange())}return!0},zd=(e,t)=>e.selection.isCollapsed()?ZH(e,t):JH(e,t),kS=e=>e.hasOwnProperty("text"),_S=e=>e.hasOwnProperty("marker"),AS=(e,t)=>{const n=(r,a)=>{if(I(r))return{text:r,offset:a};{const i=t(),l=r.childNodes;return a<l.length?(r.insertBefore(i,l[a]),{marker:i,before:!0}):(r.appendChild(i),{marker:i,before:!1})}},s=n(e.endContainer,e.endOffset);return{start:n(e.startContainer,e.startOffset),end:s}},xS=e=>{var t,n;const{start:s,end:o}=e,r=new window.Range;return kS(s)?r.setStart(s.text,s.offset):_S(s)&&(s.before?r.setStartBefore(s.marker):r.setStartAfter(s.marker),(t=s.marker.parentNode)===null||t===void 0||t.removeChild(s.marker)),kS(o)?r.setEnd(o.text,o.offset):_S(o)&&(o.before?r.setEndBefore(o.marker):r.setEndAfter(o.marker),(n=o.marker.parentNode)===null||n===void 0||n.removeChild(o.marker)),r},Hd=(e,t)=>{var n;const s=e.dom,o=s.getParent(e.selection.getStart(),s.isBlock),r=s.getParent(e.selection.getEnd(),s.isBlock),a=e.getBody();if(((n=o==null?void 0:o.nodeName)===null||n===void 0?void 0:n.toLowerCase())==="div"&&o&&r&&o===a.firstChild&&r===a.lastChild&&!s.isEmpty(a)){const l=o.cloneNode(!1),c=()=>{if(t?Py(e):ul(e),a.firstChild!==o){const u=AS(e.selection.getRng(),()=>document.createElement("span"));Array.from(a.childNodes).forEach(f=>l.appendChild(f)),a.appendChild(l),e.selection.setRng(xS(u))}};return m.some(c)}return m.none()},e2=(e,t)=>{const n=N.fromRangeStart(e.selection.getRng());return Yt(t,e.getBody(),n).filter(s=>t?AO(s):xO(s)).bind(s=>Vu(t?0:-1,s)).map(s=>()=>e.selection.select(s))},Wd=(e,t)=>e.selection.isCollapsed()?e2(e,t):m.none(),ar=I,NS=e=>ar(e)&&e.data[0]===Qe,RS=e=>ar(e)&&e.data[e.data.length-1]===Qe,TS=e=>{var t;return((t=e.ownerDocument)!==null&&t!==void 0?t:document).createTextNode(Qe)},t2=e=>{var t;if(ar(e.previousSibling))return RS(e.previousSibling)||e.previousSibling.appendData(Qe),e.previousSibling;if(ar(e))return NS(e)||e.insertData(0,Qe),e;{const n=TS(e);return(t=e.parentNode)===null||t===void 0||t.insertBefore(n,e),n}},n2=e=>{var t,n;if(ar(e.nextSibling))return NS(e.nextSibling)||e.nextSibling.insertData(0,Qe),e.nextSibling;if(ar(e))return RS(e)||e.appendData(Qe),e;{const s=TS(e);return e.nextSibling?(t=e.parentNode)===null||t===void 0||t.insertBefore(s,e.nextSibling):(n=e.parentNode)===null||n===void 0||n.appendChild(s),s}},Tl=(e,t)=>e?t2(t):n2(t),s2=G(Tl,!0),o2=G(Tl,!1),DS=(e,t)=>I(e.container())?Tl(t,e.container()):Tl(t,e.getNode()),PS=(e,t)=>{const n=t.get();return n&&e.container()===n&&Ss(n)},Vd=(e,t)=>t.fold(n=>{to(e.get());const s=s2(n);return e.set(s),m.some(N(s,s.length-1))},n=>mt(n).map(s=>{if(PS(s,e)){const o=e.get();return N(o,1)}else{to(e.get());const o=DS(s,!0);return e.set(o),N(o,1)}}),n=>ln(n).map(s=>{if(PS(s,e)){const o=e.get();return N(o,o.length-1)}else{to(e.get());const o=DS(s,!1);return e.set(o),N(o,o.length-1)}}),n=>{to(e.get());const s=o2(n);return e.set(s),m.some(N(s,1))}),BS=(e,t)=>{for(let n=0;n<e.length;n++){const s=e[n].apply(null,t);if(s.isSome())return s}return m.none()},vt=Rn.generate([{before:["element"]},{start:["element"]},{end:["element"]},{after:["element"]}]),OS=(e,t)=>{const n=_s(t,e);return n||e},r2=(e,t,n)=>{const s=Ry(n),o=OS(t,s.container());return Ds(e,o,s).fold(()=>xt(o,s).bind(G(Ds,e,o)).map(r=>vt.before(r)),m.none)},a2=(e,t)=>so(e,t)===null,IS=(e,t,n)=>Ds(e,t,n).filter(G(a2,t)),i2=(e,t,n)=>{const s=Ty(n);return IS(e,t,s).bind(o=>Pt(o,s).isNone()?m.some(vt.start(o)):m.none())},l2=(e,t,n)=>{const s=Ry(n);return IS(e,t,s).bind(o=>xt(o,s).isNone()?m.some(vt.end(o)):m.none())},c2=(e,t,n)=>{const s=Ty(n),o=OS(t,s.container());return Ds(e,o,s).fold(()=>Pt(o,s).bind(G(Ds,e,o)).map(r=>vt.after(r)),m.none)},FS=e=>!Ny(jd(e)),jn=(e,t,n)=>BS([r2,i2,l2,c2],[e,t,n]).filter(FS),jd=e=>e.fold(Ft,Ft,Ft,Ft),LS=e=>e.fold(W("before"),W("start"),W("end"),W("after")),Dl=e=>e.fold(vt.before,vt.before,vt.after,vt.after),qd=e=>e.fold(vt.start,vt.start,vt.end,vt.end),u2=(e,t)=>LS(e)===LS(t)&&jd(e)===jd(t),f2=(e,t,n,s,o,r)=>at(Ds(t,n,s),Ds(t,n,o),(a,i)=>a!==i&&dI(n,a,i)?vt.after(e?a:i):r).getOr(r),d2=(e,t)=>e.fold(Ue,n=>!u2(n,t)),m2=(e,t,n,s,o)=>{const r=en(e,o);return Yt(e,n,r).map(G(en,e)).fold(()=>s.map(Dl),l=>jn(t,n,l).map(G(f2,e,t,n,r,l)).filter(G(d2,s))).filter(FS)},g2=(e,t)=>e?t.fold(Nn(m.some,vt.start),m.none,Nn(m.some,vt.after),m.none):t.fold(m.none,Nn(m.some,vt.before),m.none,Nn(m.some,vt.end)),p2=(e,t,n,s)=>{const o=en(e,s),r=jn(t,n,o);return jn(t,n,o).bind(G(g2,e)).orThunk(()=>m2(e,t,n,r,s))},h2=e=>we(e.selection.getSel().modify),$S=(e,t,n)=>{const s=e?1:-1;return t.setRng(N(n.container(),n.offset()+s).toRange()),t.getSel().modify("move",e?"forward":"backward","word"),!0},b2=(e,t)=>{const n=t.selection.getRng(),s=e?N.fromRangeEnd(n):N.fromRangeStart(n);return h2(t)?e&&ku(s)?$S(!0,t.selection,s):!e&&_u(s)?$S(!1,t.selection,s):!1:!1};var qn;(function(e){e[e.Br=0]="Br",e[e.Block=1]="Block",e[e.Wrap=2]="Wrap",e[e.Eol=3]="Eol"})(qn||(qn={}));const Pl=(e,t)=>e===-1?kr(t):t,C2=(e,t,n)=>e===1?t.next(n):t.prev(n),y2=(e,t,n,s)=>Ie(s.getNode(t===1))?qn.Br:Mn(n,s)===!1?qn.Block:qn.Wrap,MS=(e,t,n,s)=>{const o=zn(n);let r=s;const a=[];for(;r;){const i=C2(t,o,r);if(!i)break;if(Ie(i.getNode(!1)))return t===1?{positions:Pl(t,a).concat([i]),breakType:qn.Br,breakAt:m.some(i)}:{positions:Pl(t,a),breakType:qn.Br,breakAt:m.some(i)};if(!i.isVisible()){r=i;continue}if(e(r,i)){const l=y2(n,t,r,i);return{positions:Pl(t,a),breakType:l,breakAt:m.some(i)}}a.push(i),r=i}return{positions:Pl(t,a),breakType:qn.Eol,breakAt:m.none()}},US=(e,t,n,s)=>t(n,s).breakAt.map(o=>{const r=t(n,o).positions;return e===-1?r.concat(o):[o].concat(r)}).getOr([]),Kd=(e,t)=>Tt(e,(n,s)=>n.fold(()=>m.some(s),o=>at(_t(o.getClientRects()),_t(s.getClientRects()),(r,a)=>{const i=Math.abs(t-r.left);return Math.abs(t-a.left)<=i?s:o}).or(n)),m.none()),Bl=(e,t)=>_t(t.getClientRects()).bind(n=>Kd(e,n.left)),La=G(MS,N.isAbove,-1),$a=G(MS,N.isBelow,1),zS=G(US,-1,La),HS=G(US,1,$a),WS=(e,t)=>La(e,t).breakAt.isNone(),VS=(e,t)=>$a(e,t).breakAt.isNone(),v2=e=>mt(e).map(t=>[t].concat($a(e,t).positions)).getOr([]),E2=e=>ln(e).map(t=>La(e,t).positions.concat(t)).getOr([]),S2=(e,t)=>Bl(zS(e,t),t),w2=(e,t)=>Bl(HS(e,t),t),k2=xe,jS=(e,t)=>Math.abs(e.left-t),qS=(e,t)=>Math.abs(e.right-t),_2=e=>ko(e,"node"),KS=(e,t)=>fi(e,(n,s)=>{const o=Math.min(jS(n,t),qS(n,t)),r=Math.min(jS(s,t),qS(s,t));return r===o&&_2(s)&&k2(s.node)||r<o?s:n}),A2=e=>{const t=n=>he(n,s=>{const o=Js(s);return o.node=e,o});if(q(e))return t(e.getClientRects());if(I(e)){const n=e.ownerDocument.createRange();return n.setStart(e,0),n.setEnd(e,e.data.length),t(n.getClientRects())}else return[]},GS=e=>Kt(e,A2);var ho;(function(e){e[e.Up=-1]="Up",e[e.Down=1]="Down"})(ho||(ho={}));const x2=(e,t,n,s)=>{let o=s;for(;o=fa(o,e,Rh,t);)if(n(o))return},YS=(e,t,n,s,o,r)=>{let a=0;const i=[],l=f=>{let d=GS([f]);e===ho.Up&&(d=d.reverse());for(let g=0;g<d.length;g++){const h=d[g];if(!n(h,c)){if(i.length>0&&t(h,Ms(i))&&a++,h.line=a,o(h))return!0;i.push(h)}}return!1},c=Ms(r.getClientRects());if(!c)return i;const u=r.getNode();return u&&(l(u),x2(e,s,l,u)),i},N2=(e,t)=>t.line>e,R2=(e,t)=>t.line===e,T2=G(YS,ho.Up,sa,oa),D2=G(YS,ho.Down,oa,sa),XS=e=>Ms(e.getClientRects()),P2=(e,t,n,s)=>{const o=zn(t);let r,a,i,l;const c=[];let u=0;e===ho.Down?(r=o.next,a=oa,i=sa,l=N.after(s)):(r=o.prev,a=sa,i=oa,l=N.before(s));const f=XS(l);do{if(!l.isVisible())continue;const d=XS(l);if(i(d,f))continue;c.length>0&&a(d,Ms(c))&&u++;const g=Js(d);if(g.position=l,g.line=u,n(g))return c;c.push(g)}while(l=r(l));return c},ZS=e=>t=>N2(e,t),Gd=e=>t=>R2(e,t),us=(e,t)=>{e.selection.setRng(t),ya(e,e.selection.getRng())},Yd=(e,t,n)=>m.some(Ld(e,t,n)),QS=(e,t,n,s,o,r)=>{const a=t===1,i=zn(e.getBody()),l=G(qu,a?i.next:i.prev),c=a?s:o;if(!n.collapsed){const h=Ii(n);if(r(h))return cs(t,e,h,t===-1,!1);if(Ud(e)){const p=n.cloneRange();return p.collapse(t===-1),m.from(p)}}const u=ga(t,e.getBody(),n);if(c(u))return Fa(e,u.getNode(!a));let f=l(u);const d=Sh(n);if(f)f=en(a,f);else return d?m.some(n):m.none();if(c(f))return cs(t,e,f.getNode(!a),a,!1);const g=l(f);return g&&c(g)&&ji(f,g)?cs(t,e,g.getNode(!a),a,!1):d?Yd(e,f.toRange(),!1):m.none()},JS=(e,t,n,s,o,r)=>{const a=ga(t,e.getBody(),n),i=Ms(a.getClientRects()),l=t===ho.Down,c=e.getBody();if(!i)return m.none();if(Ud(e)){const b=l?N.fromRangeEnd(n):N.fromRangeStart(n);return(l?w2:S2)(c,b).orThunk(()=>m.from(b)).map(v=>v.toRange())}const f=(l?D2:T2)(c,ZS(1),a),d=ne(f,Gd(1)),g=i.left,h=KS(d,g);if(h&&r(h.node)){const b=Math.abs(g-h.left),y=Math.abs(g-h.right);return cs(t,e,h.node,b<y,!1)}let p;if(s(a)?p=a.getNode():o(a)?p=a.getNode(!0):p=Ii(n),p){const b=P2(t,c,ZS(1),p);let y=KS(ne(b,Gd(1)),g);if(y||(y=Ms(ne(b,Gd(0))),y))return Yd(e,y.position.toRange(),!1)}return d.length===0?Xd(e,l).filter(l?o:s).map(b=>Ld(e,b.toRange(),!1)):m.none()},Xd=(e,t)=>{const n=e.selection.getRng(),s=t?N.fromRangeEnd(n):N.fromRangeStart(n),o=uB(s.container(),e.getBody());if(t){const r=$a(o,s);return ds(r.positions)}else{const r=La(o,s);return _t(r.positions)}},e0=(e,t,n)=>Xd(e,t).filter(n).exists(s=>(e.selection.setRng(s.toRange()),!0)),Ol=(e,t)=>{const n=e.dom.createRng();n.setStart(t.container(),t.offset()),n.setEnd(t.container(),t.offset()),e.selection.setRng(n)},t0=(e,t)=>{e?t.setAttribute("data-mce-selected","inline-boundary"):t.removeAttribute("data-mce-selected")},n0=(e,t,n)=>Vd(t,n).map(s=>(Ol(e,s),n)),B2=(e,t,n)=>{const s=N.fromRangeStart(e);if(e.collapsed)return s;{const o=N.fromRangeEnd(e);return n?Pt(t,o).getOr(o):xt(t,s).getOr(s)}},O2=(e,t,n)=>{const s=e.getBody(),o=B2(e.selection.getRng(),s,n),r=G(co,e);return p2(n,r,s,o).bind(i=>n0(e,t,i))},I2=(e,t,n)=>{const s=he(ut(C.fromDom(t.getRoot()),'*[data-mce-selected="inline-boundary"]'),a=>a.dom),o=ne(s,e),r=ne(n,e);D(oi(o,r),G(t0,!1)),D(oi(r,o),G(t0,!0))},F2=(e,t)=>{const n=t.get();if(e.selection.isCollapsed()&&!e.composing&&n){const s=N.fromRangeStart(e.selection.getRng());N.isTextPosition(s)&&!mI(s)&&(Ol(e,QP(n,s)),t.set(null))}},L2=(e,t,n,s)=>{if(t.selection.isCollapsed()){const o=ne(s,e);D(o,r=>{const a=N.fromRangeStart(t.selection.getRng());jn(e,t.getBody(),a).bind(i=>n0(t,n,i))})}},s0=(e,t,n)=>la(e)?O2(e,t,n).isSome():!1,o0=(e,t,n)=>la(t)?b2(e,t):!1,$2=e=>{const t=et(null),n=G(co,e);return e.on("NodeChange",s=>{la(e)&&(I2(n,e.dom,s.parents),F2(e,t),L2(n,e,t,s.parents))}),t},M2=G(o0,!0),U2=G(o0,!1),Il=(e,t,n)=>{if(la(e)){const s=Xd(e,t).getOrThunk(()=>{const o=e.selection.getRng();return t?N.fromRangeEnd(o):N.fromRangeStart(o)});return jn(G(co,e),e.getBody(),s).exists(o=>{const r=Dl(o);return Vd(n,r).exists(a=>(Ol(e,a),!0))})}else return!1},z2=(e,t)=>{const n=document.createRange();return n.setStart(e.container(),e.offset()),n.setEnd(t.container(),t.offset()),n},H2=e=>at(mt(e),ln(e),(t,n)=>{const s=en(!0,t),o=en(!1,n);return xt(e,s).forall(r=>r.isEqual(o))}).getOr(!0),r0=(e,t)=>n=>Vd(t,n).map(s=>()=>Ol(e,s)),a0=(e,t,n,s)=>{const o=e.getBody(),r=G(co,e);e.undoManager.ignore(()=>{e.selection.setRng(z2(n,s)),ul(e),jn(r,o,N.fromRangeStart(e.selection.getRng())).map(qd).bind(r0(e,t)).each(Er)}),e.nodeChanged()},W2=(e,t)=>{const n=_s(t,e);return n||e},V2=(e,t,n,s)=>{const o=W2(e.getBody(),s.container()),r=G(co,e),a=jn(r,o,s);return a.bind(l=>n?l.fold(W(m.some(qd(l))),m.none,W(m.some(Dl(l))),m.none):l.fold(m.none,W(m.some(Dl(l))),m.none,W(m.some(qd(l))))).map(r0(e,t)).getOrThunk(()=>{const l=Go(n,o,s),c=l.bind(u=>jn(r,o,u));return at(a,c,()=>Ds(r,o,s).bind(u=>H2(u)?m.some(()=>{lo(e,n,C.fromDom(u))}):m.none())).getOrThunk(()=>c.bind(()=>l.map(u=>()=>{n?a0(e,t,s,u):a0(e,t,u,s)})))})},Zd=(e,t,n)=>{if(e.selection.isCollapsed()&&la(e)){const s=N.fromRangeStart(e.selection.getRng());return V2(e,t,n,s)}return m.none()},j2=e=>Oc(e)>1,i0=(e,t)=>{const n=C.fromDom(e.getBody()),s=C.fromDom(e.selection.getStart()),o=is(s,n);return wr(o,t).fold(W(o),r=>o.slice(0,r))},q2=e=>Oc(e)===1,K2=e=>i0(e,t=>e.schema.isBlock(be(t))||j2(t)),G2=e=>i0(e,t=>e.schema.isBlock(be(t))),l0=(e,t)=>{const n=G(cv,e);return Kt(t,s=>n(s)?[s.dom]:[])},c0=e=>{const t=G2(e);return l0(e,t)},Y2=(e,t,n,s)=>{const o=l0(t,s);if(o.length===0)lo(t,e,n);else{const r=lv(n.dom,o);t.selection.setRng(r.toRange())}},X2=(e,t)=>{const n=ne(K2(e),q2);return ds(n).bind(s=>{const o=N.fromRangeStart(e.selection.getRng());return By(t,o,s.dom)&&!ff(s)?m.some(()=>Y2(t,e,s,n)):m.none()})},Z2=(e,t)=>{const n=t.parentElement;return Ie(t)&&!bt(n)&&e.dom.isEmpty(n)},Q2=e=>ff(C.fromDom(e)),u0=(e,t)=>{const n=e.selection.getStart(),s=Z2(e,n)||Q2(n)?lv(n,t):rL(e.selection.getRng(),t);e.selection.setRng(s.toRange())},J2=(e,t)=>{const n=oi(t,c0(e));n.length>0&&u0(e,n)},f0=e=>I(e.startContainer),eW=e=>e.startOffset===0&&f0(e),tW=(e,t)=>{const n=t.startContainer.parentElement;return!bt(n)&&cv(e,C.fromDom(n))},nW=e=>{const t=e.startContainer.parentNode,n=e.endContainer.parentNode;return!bt(t)&&!bt(n)&&t.isEqualNode(n)},sW=e=>{const t=e.endContainer;return e.endOffset===(I(t)?t.length:t.childNodes.length)},oW=e=>nW(e)&&sW(e),rW=e=>!e.endContainer.isEqualNode(e.commonAncestorContainer),aW=e=>oW(e)||rW(e),iW=e=>{const t=e.selection.getRng();return eW(t)&&tW(e,t)&&aW(t)},lW=e=>{if(iW(e)){const t=c0(e);return m.some(()=>{ul(e),J2(e,t)})}else return m.none()},Qd=(e,t)=>e.selection.isCollapsed()?X2(e,t):lW(e),cW=(e,t)=>_p(e,n=>Xt(n.dom),n=>t.isBlock(be(n))),uW=e=>cW(C.fromDom(e.selection.getStart()),e.schema),fW=e=>{const t=e.selection.getRng();return t.collapsed&&(f0(t)||e.dom.isEmpty(t.startContainer))&&!uW(e)},Ma=e=>(fW(e)&&u0(e,[]),!0),Jd=(e,t,n)=>U(n)?m.some(()=>{e._selectionOverrides.hideFakeCaret(),lo(e,t,C.fromDom(n))}):m.none(),dW=(e,t)=>{const n=t?va:Ea,o=ga(t?1:-1,e.getBody(),e.selection.getRng());return n(o)?Jd(e,t,o.getNode(!t)):m.from(en(t,o)).filter(r=>n(r)&&ji(o,r)).bind(r=>Jd(e,t,r.getNode(!t)))},mW=(e,t)=>{const n=e.selection.getNode();return $n(n)?Jd(e,t,n):m.none()},em=(e,t)=>e.selection.isCollapsed()?dW(e,t):mW(e,t),gW=e=>bs(e,t=>an(t.dom)||xe(t.dom)).exists(t=>an(t.dom)),tm=e=>li(e??"").getOr(0),d0=(e,t)=>{const n=e||eT(t)?"margin":"padding",s=In(t,"direction")==="rtl"?"-right":"-left";return n+s},pW=(e,t,n,s,o,r)=>{const a=d0(n,C.fromDom(r)),i=tm(e.getStyle(r,a));if(t==="outdent"){const l=Math.max(0,i-s);e.setStyle(r,a,l?l+o:"")}else{const l=i+s+o;e.setStyle(r,a,l)}},hW=(e,t)=>Zn(t,n=>{const s=d0(db(e),n),o=hi(n,s).map(tm).getOr(0);return e.dom.getContentEditable(n.dom)!=="false"&&o>0}),m0=e=>{const t=p0(e);return!e.mode.isReadOnly()&&(t.length>1||hW(e,t))},g0=e=>wu(e)||Uo(e),bW=e=>On(e).exists(g0),p0=e=>ne(Mc(e.selection.getSelectedBlocks()),t=>!g0(t)&&!bW(t)&&gW(t)),h0=(e,t)=>{var n,s;if(e.mode.isReadOnly())return;const{dom:o}=e,r=zD(e),a=(s=(n=/[a-z%]+$/i.exec(r))===null||n===void 0?void 0:n[0])!==null&&s!==void 0?s:"px",i=tm(r),l=db(e);D(p0(e),c=>{pW(o,t,l,i,a,c.dom)})},CW=e=>h0(e,"indent"),b0=e=>h0(e,"outdent"),C0=e=>{if(e.selection.isCollapsed()&&m0(e)){const t=e.dom,n=e.selection.getRng(),s=N.fromRangeStart(n),o=t.getParent(n.startContainer,t.isBlock);if(o!==null&&Nf(C.fromDom(o),s,e.schema))return m.some(()=>b0(e))}return m.none()},y0=(e,t,n)=>wo([C0,zd,$d,(s,o)=>Zd(s,t,o),Id,Hf,Wd,em,Fd,Qd,Hd],s=>s(e,n)).filter(s=>e.selection.isEditable()),yW=(e,t)=>{y0(e,t,!1).fold(()=>{e.selection.isEditable()&&(ul(e),Of(e))},Er)},vW=(e,t)=>{y0(e,t,!0).fold(()=>{e.selection.isEditable()&&Py(e)},Er)},EW=(e,t)=>{e.addCommand("delete",()=>{yW(e,t)}),e.addCommand("forwardDelete",()=>{vW(e,t)})},v0=5,SW=400,E0=e=>e.touches===void 0||e.touches.length!==1?m.none():m.some(e.touches[0]),wW=(e,t)=>{const n=Math.abs(e.clientX-t.x),s=Math.abs(e.clientY-t.y);return n>v0||s>v0},kW=e=>{const t=Qn(),n=et(!1),s=kc(o=>{e.dispatch("longpress",{...o,type:"longpress"}),n.set(!0)},SW);e.on("touchstart",o=>{E0(o).each(r=>{s.cancel();const a={x:r.clientX,y:r.clientY,target:o.target};s.throttle(o),n.set(!1),t.set(a)})},!0),e.on("touchmove",o=>{s.cancel(),E0(o).each(r=>{t.on(a=>{wW(r,a)&&(t.clear(),n.set(!1),e.dispatch("longpresscancel"))})})},!0),e.on("touchend touchcancel",o=>{s.cancel(),o.type!=="touchcancel"&&t.get().filter(r=>r.target.isEqualNode(o.target)).each(()=>{n.get()?o.preventDefault():e.dispatch("tap",{...o,type:"tap"})})},!0)},nm=(e,t)=>se(e,t.nodeName),_W=(e,t)=>I(t)?!0:q(t)?!nm(e.getBlockElements(),t)&&!Zt(t)&&!qs(e,t)&&!su(t):!1,AW=(e,t,n)=>Be(ly(C.fromDom(n),C.fromDom(t)),s=>nm(e,s.dom)),xW=(e,t)=>{if(I(t)){if(t.data.length===0)return!0;if(/^\s+$/.test(t.data))return!t.nextSibling||nm(e,t.nextSibling)||su(t.nextSibling)}return!1},sm=e=>e.dom.create(dt(e),ia(e)),NW=e=>{const t=e.dom,n=e.selection,s=e.schema,o=s.getBlockElements(),r=n.getStart(),a=e.getBody();let i,l,c=null;const u=dt(e);if(!r||!q(r))return;const f=a.nodeName.toLowerCase();if(!s.isValidChild(f,u.toLowerCase())||AW(o,a,r))return;if(a.firstChild===a.lastChild&&Ie(a.firstChild)){i=sm(e),i.appendChild(zo().dom),a.replaceChild(i,a.firstChild),e.selection.setCursorLocation(i,0),e.nodeChanged();return}let d=a.firstChild;for(;d;)if(q(d)&&qN(s,d),_W(s,d)){if(xW(o,d)){l=d,d=d.nextSibling,t.remove(l);continue}if(!i){if(!c&&e.hasFocus()&&(c=AS(e.selection.getRng(),()=>document.createElement("span"))),!d.parentNode){d=null;break}i=sm(e),a.insertBefore(i,d)}l=d,d=d.nextSibling,i.appendChild(l)}else i=null,d=d.nextSibling;c&&(e.selection.setRng(xS(c)),e.nodeChanged())},S0=(e,t,n)=>{const s=C.fromDom(sm(e)),o=zo();je(s,o),n(t,s);const r=document.createRange();return r.setStartBefore(o.dom),r.setEndBefore(o.dom),r},RW=e=>{e.on("NodeChange",()=>NW(e))},w0=e=>t=>(" "+t.attr("class")+" ").indexOf(e)!==-1,TW=(e,t,n)=>function(s){const o=arguments,r=o[o.length-2],a=r>0?t.charAt(r-1):"";if(a==='"')return s;if(a===">"){const i=t.lastIndexOf("<",r);if(i!==-1&&t.substring(i,r).indexOf('contenteditable="false"')!==-1)return s}return'<span class="'+n+'" data-mce-content="'+e.dom.encode(o[0])+'">'+e.dom.encode(typeof o[1]=="string"?o[1]:o[0])+"</span>"},DW=(e,t,n)=>{let s=t.length,o=n.content;if(n.format!=="raw"){for(;s--;)o=o.replace(t[s],TW(e,o,vb(e)));n.content=o}},PW=(e,t)=>Zn(e,n=>{const s=t.match(n);return s!==null&&s[0].length===t.length}),BW=e=>{const t="contenteditable",n=" "+L.trim(PP(e))+" ",s=" "+L.trim(vb(e))+" ",o=w0(n),r=w0(s),a=BP(e);a.length>0&&e.on("BeforeSetContent",i=>{DW(e,a,i)}),e.parser.addAttributeFilter("class",i=>{let l=i.length;for(;l--;){const c=i[l];o(c)?c.attr(t,"true"):r(c)&&c.attr(t,"false")}}),e.serializer.addAttributeFilter(t,i=>{let l=i.length;for(;l--;){const c=i[l];if(!o(c)&&!r(c))continue;const u=c.attr("data-mce-content");a.length>0&&u?PW(a,u)?(c.name="#text",c.type=3,c.raw=!0,c.value=u):c.remove():c.attr(t,null)}})},OW=e=>Ci(C.fromDom(e.getBody()),"*[data-mce-caret]").map(t=>t.dom).getOrNull(),k0=(e,t)=>{t.hasAttribute("data-mce-caret")&&(Au(t),e.selection.setRng(e.selection.getRng()),e.selection.scrollIntoView(t))},IW=(e,t)=>{const n=OW(e);if(n){if(t.type==="compositionstart"){t.preventDefault(),t.stopPropagation(),k0(e,n);return}Eh(n)&&(k0(e,n),e.undoManager.add())}},FW=e=>{e.on("keyup compositionstart",G(IW,e))},_0=xe,LW=(e,t,n)=>QS(t,e,n,Rs,Ts,_0),$W=(e,t,n)=>JS(t,e,n,r=>Rs(r)||iy(r),r=>Ts(r)||Af(r),_0),MW=e=>{const t=e.dom.create(dt(e));return t.innerHTML='<br data-mce-bogus="1">',t},A0=(e,t,n)=>{const s=zn(e.getBody()),o=G(qu,t===1?s.next:s.prev);if(n.collapsed){const r=e.dom.getParent(n.startContainer,"PRE");if(!r)return;if(!o(N.fromRangeStart(n))){const i=C.fromDom(MW(e));t===1?es(C.fromDom(r),i):Dt(C.fromDom(r),i),e.selection.select(i.dom,!0),e.selection.collapse()}}},UW=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return LW(n,e,s).orThunk(()=>(A0(e,n,s),m.none()))},zW=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return $W(n,e,s).orThunk(()=>(A0(e,n,s),m.none()))},HW=(e,t)=>{const n=t?e.getEnd(!0):e.getStart(!0);return Ny(n)?!t:t},x0=(e,t)=>UW(e,HW(e.selection,t)).exists(n=>(us(e,n),!0)),N0=(e,t)=>zW(e,t).exists(n=>(us(e,n),!0)),R0=(e,t)=>e0(e,t,t?Ts:Rs),Fl=(e,t)=>Md(e,!t).map(n=>{const s=n.toRange(),o=e.selection.getRng();return t?s.setStart(o.startContainer,o.startOffset):s.setEnd(o.endContainer,o.endOffset),s}).exists(n=>(us(e,n),!0)),WW=e=>Se(["figcaption"],be(e)),VW=(e,t,n)=>{const s=G(Ee,t);return bs(C.fromDom(e.container()),o=>n.isBlock(be(o)),s).filter(WW)},jW=(e,t,n)=>t?VS(e.dom,n):WS(e.dom,n),qW=(e,t)=>{const n=C.fromDom(e.getBody()),s=N.fromRangeStart(e.selection.getRng());return VW(s,n,e.schema).exists(()=>{if(jW(n,t,s)){const r=S0(e,n,t?je:$c);return e.selection.setRng(r),!0}else return!1})},T0=(e,t)=>e.selection.isCollapsed()?qW(e,t):!1,KW=(e,t,n)=>{const s=e.selection.getRng(),o=N.fromRangeStart(s);return e.getBody().firstChild===t&&WS(n,o)?(e.execCommand("InsertNewBlockBefore"),!0):!1},GW=(e,t)=>{const n=e.selection.getRng(),s=N.fromRangeStart(n);return e.getBody().lastChild===t&&VS(t,s)?(e.execCommand("InsertNewBlockAfter"),!0):!1},YW=(e,t)=>t?m.from(e.dom.getParent(e.selection.getNode(),"details")).map(n=>GW(e,n)).getOr(!1):m.from(e.dom.getParent(e.selection.getNode(),"summary")).bind(n=>m.from(e.dom.getParent(n,"details")).map(s=>KW(e,s,n))).getOr(!1),D0=(e,t)=>YW(e,t),P0={shiftKey:!1,altKey:!1,ctrlKey:!1,metaKey:!1,keyCode:0},XW=e=>he(e,t=>({...P0,...t})),ZW=e=>he(e,t=>({...P0,...t})),B0=(e,t)=>t.keyCode===e.keyCode&&t.shiftKey===e.shiftKey&&t.altKey===e.altKey&&t.ctrlKey===e.ctrlKey&&t.metaKey===e.metaKey,QW=(e,t)=>Kt(XW(e),n=>B0(n,t)?[n]:[]),JW=(e,t)=>Kt(ZW(e),n=>B0(n,t)?[n]:[]),te=(e,...t)=>()=>e.apply(null,t),Ua=(e,t)=>Ye(QW(e,t),n=>n.action()),O0=(e,t)=>wo(JW(e,t),n=>n.action()),I0=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return QS(e,n,s,va,Ea,$n).exists(o=>(us(e,o),!0))},F0=(e,t)=>{const n=t?1:-1,s=e.selection.getRng();return JS(e,n,s,va,Ea,$n).exists(o=>(us(e,o),!0))},L0=(e,t)=>e0(e,t,t?Ea:va),eV=(e,t)=>$0(e,t,Ue),$0=(e,t,n)=>Kt(ct(e),s=>hn(s,t)?n(s)?[s]:[]:$0(s,t,n)),tV=(e,t,n=Pe)=>{if(n(t))return m.none();if(Se(e,be(t)))return m.some(t);const s=o=>hn(o,"table")||n(o);return Wr(t,e.join(","),s)},nV=(e,t)=>tV(["td","th"],e,t),sV=e=>eV(e,"th,td"),M0=(e,t)=>Po(e,"table",t),U0=Rn.generate([{none:["current"]},{first:["current"]},{middle:["current","target"]},{last:["current"]}]),za={...U0,none:e=>U0.none(e)},om=(e,t,n,s,o=Ue)=>{const r=s===1;if(!r&&n<=0)return za.first(e[0]);if(r&&n>=e.length-1)return za.last(e[e.length-1]);{const a=n+s,i=e[a];return o(i)?za.middle(t,i):om(e,t,a,s,o)}},z0=(e,t)=>M0(e,t).bind(n=>{const s=sV(n);return wr(s,r=>Ee(e,r)).map(r=>({index:r,all:s}))}),oV=(e,t,n)=>z0(e,n).fold(()=>za.none(e),o=>om(o.all,e,o.index,1,t)),rV=(e,t,n)=>z0(e,n).fold(()=>za.none(),o=>om(o.all,e,o.index,-1,t)),H0=xr("image"),aV=e=>{const t=e;return m.from(t[H0])},iV=(e,t)=>{const n=e;n[H0]=t},rm=xr("event"),lV=e=>{const t=e;return m.from(t[rm])},Ll=e=>t=>{const n=t;n[rm]=e},cV=(e,t)=>Ll(t)(e),W0=Ll(0),uV=Ll(2),fV=Ll(1),dV=(e=>t=>{const n=t;return m.from(n[rm]).exists(s=>s===e)})(0),mV=()=>Object.freeze({length:0,item:e=>null}),am=xr("mode"),gV=e=>{const t=e;return m.from(t[am])},$l=e=>t=>{const n=t;n[am]=e},V0=(e,t)=>$l(t)(e),j0=$l(0),im=$l(2),pV=$l(1),q0=e=>t=>{const n=t;return m.from(n[am]).exists(s=>s===e)},ir=q0(0),K0=q0(1),hV=(e,t)=>({...t,get length(){return t.length},add:(n,s)=>{if(ir(e))if(J(n)){if(!st(s))return t.add(n,s)}else return t.add(n);return null},remove:n=>{ir(e)&&t.remove(n)},clear:()=>{ir(e)&&t.clear()}}),bV=["none","copy","link","move"],CV=["none","copy","copyLink","copyMove","link","linkMove","move","all","uninitialized"],lm=()=>{const e=new window.DataTransfer;let t="move",n="all";const s={get dropEffect(){return t},set dropEffect(o){Se(bV,o)&&(t=o)},get effectAllowed(){return n},set effectAllowed(o){dV(s)&&Se(CV,o)&&(n=o)},get items(){return hV(s,e.items)},get files(){return K0(s)?mV():e.files},get types(){return e.types},setDragImage:(o,r,a)=>{ir(s)&&(iV(s,{image:o,x:r,y:a}),e.setDragImage(o,r,a))},getData:o=>K0(s)?"":e.getData(o),setData:(o,r)=>{ir(s)&&e.setData(o,r)},clearData:o=>{ir(s)&&e.clearData(o)}};return j0(s),s},yV=e=>{const t=lm(),n=gV(e);return im(e),W0(t),t.dropEffect=e.dropEffect,t.effectAllowed=e.effectAllowed,aV(e).each(s=>t.setDragImage(s.image,s.x,s.y)),D(e.types,s=>{s!=="Files"&&t.setData(s,e.getData(s))}),D(e.files,s=>t.items.add(s)),lV(e).each(s=>{cV(t,s)}),n.each(s=>{V0(e,s),V0(t,s)}),t},vV=e=>{const t=e.getData("text/html");return t===""?m.none():m.some(t)},G0=(e,t)=>e.setData("text/html",t),EV=(e,t)=>({left:e.left-t,top:e.top-t,right:e.right+t*2,bottom:e.bottom+t*2,width:e.width+t,height:e.height+t}),SV=(e,t)=>Kt(t,n=>{const s=EV(Js(n.getBoundingClientRect()),-1);return[{x:s.left,y:e(s),cell:n},{x:s.right,y:e(s),cell:n}]}),wV=(e,t,n)=>Tt(e,(s,o)=>s.fold(()=>m.some(o),r=>{const a=Math.sqrt(Math.abs(r.x-t)+Math.abs(r.y-n)),i=Math.sqrt(Math.abs(o.x-t)+Math.abs(o.y-n));return m.some(i<a?o:r)}),m.none()),Y0=(e,t,n,s,o)=>{const r=ut(C.fromDom(n),"td,th,caption").map(i=>i.dom),a=ne(SV(e,r),i=>t(i,o));return wV(a,s,o).map(i=>i.cell)},kV=e=>e.bottom,_V=e=>e.top,AV=(e,t)=>e.y<t,xV=(e,t)=>e.y>t,NV=G(Y0,kV,AV),RV=G(Y0,_V,xV),TV=(e,t)=>_t(t.getClientRects()).bind(n=>NV(e,n.left,n.top)).bind(n=>Bl(E2(n),t)),DV=(e,t)=>ds(t.getClientRects()).bind(n=>RV(e,n.left,n.top)).bind(n=>Bl(v2(n),t)),PV=(e,t,n)=>n.breakAt.exists(s=>e(t,s).breakAt.isSome()),BV=e=>e.breakType===qn.Wrap&&e.positions.length===0,OV=e=>e.breakType===qn.Br&&e.positions.length===1,X0=(e,t,n)=>{const s=e(t,n);return BV(s)||!Ie(n.getNode())&&OV(s)?!PV(e,t,s):s.breakAt.isNone()},IV=G(X0,La),FV=G(X0,$a),LV=(e,t,n)=>{const s=N.fromRangeStart(t);return Yo(!e,n).exists(o=>o.isEqual(s))},$V=(e,t,n,s)=>{const o=e.selection.getRng(),r=t?1:-1;return Tb()&&LV(t,o,n)?(cs(r,e,n,!t,!1).each(a=>{us(e,a)}),!0):!1},MV=(e,t,n)=>TV(t,n).orThunk(()=>_t(n.getClientRects()).bind(s=>Kd(zS(e,N.before(t)),s.left))).getOr(N.before(t)),UV=(e,t,n)=>DV(t,n).orThunk(()=>_t(n.getClientRects()).bind(s=>Kd(HS(e,N.after(t)),s.left))).getOr(N.after(t)),Z0=(e,t)=>{const n=t.getNode(e);return Ln(n)?m.some(n):m.none()},zV=(e,t,n)=>{t.undoManager.transact(()=>{const s=e?es:Dt,o=S0(t,C.fromDom(n),s);us(t,o)})},Q0=(e,t,n)=>{const s=Z0(!!t,n),o=t===!1;s.fold(()=>us(e,n.toRange()),r=>Yo(o,e.getBody()).filter(a=>a.isEqual(n)).fold(()=>us(e,n.toRange()),a=>zV(t,e,r)))},HV=(e,t,n,s)=>{const o=e.selection.getRng(),r=N.fromRangeStart(o),a=e.getBody();if(!t&&IV(s,r)){const i=MV(a,n,r);return Q0(e,t,i),!0}else if(t&&FV(s,r)){const i=UV(a,n,r);return Q0(e,t,i),!0}else return!1},J0=(e,t,n)=>m.from(e.dom.getParent(e.selection.getNode(),"td,th")).bind(s=>m.from(e.dom.getParent(s,"table")).map(o=>n(e,t,o,s))).getOr(!1),ew=(e,t)=>J0(e,t,$V),cm=(e,t)=>J0(e,t,HV),WV=e=>{const t=Oo.exact(e,0,e,0);return bN(t)},tw=(e,t,n)=>n.fold(m.none,m.none,(s,o)=>Qx(o).map(r=>WV(r)),s=>e.mode.isReadOnly()||!VV(s)?m.none():(e.execCommand("mceTableInsertRowAfter"),nw(e,t,s))),VV=e=>bs(e,Fr("table")).exists(Cs),nw=(e,t,n)=>tw(e,t,oV(n,sw)),jV=(e,t,n)=>tw(e,t,rV(n,sw)),sw=e=>Cs(e)||Gc(e,qV),qV=e=>Ir(e)&&Cs(e),ow=(e,t)=>{const n=["table","li","dl"],s=C.fromDom(e.getBody()),o=i=>{const l=be(i);return Ee(i,s)||Se(n,l)},r=e.selection.getRng(),a=C.fromDom(t?r.endContainer:r.startContainer);return nV(a,o).map(i=>(M0(i,o).each(u=>{e.model.table.clearSelectedCells(u.dom)}),e.selection.collapse(!t),(t?nw:jV)(e,o,i).each(u=>{e.selection.setRng(u)}),!0)).getOr(!1)},KV=(e,t,n)=>{const s=Ce.os.isMacOS()||Ce.os.isiOS();Ua([{keyCode:j.RIGHT,action:te(x0,e,!0)},{keyCode:j.LEFT,action:te(x0,e,!1)},{keyCode:j.UP,action:te(N0,e,!1)},{keyCode:j.DOWN,action:te(N0,e,!0)},...s?[{keyCode:j.UP,action:te(Fl,e,!1),metaKey:!0,shiftKey:!0},{keyCode:j.DOWN,action:te(Fl,e,!0),metaKey:!0,shiftKey:!0}]:[],{keyCode:j.RIGHT,action:te(ew,e,!0)},{keyCode:j.LEFT,action:te(ew,e,!1)},{keyCode:j.UP,action:te(cm,e,!1)},{keyCode:j.DOWN,action:te(cm,e,!0)},{keyCode:j.UP,action:te(cm,e,!1)},{keyCode:j.UP,action:te(D0,e,!1)},{keyCode:j.DOWN,action:te(D0,e,!0)},{keyCode:j.RIGHT,action:te(I0,e,!0)},{keyCode:j.LEFT,action:te(I0,e,!1)},{keyCode:j.UP,action:te(F0,e,!1)},{keyCode:j.DOWN,action:te(F0,e,!0)},{keyCode:j.RIGHT,action:te(s0,e,t,!0)},{keyCode:j.LEFT,action:te(s0,e,t,!1)},{keyCode:j.RIGHT,ctrlKey:!s,altKey:s,action:te(M2,e,t)},{keyCode:j.LEFT,ctrlKey:!s,altKey:s,action:te(U2,e,t)},{keyCode:j.UP,action:te(T0,e,!1)},{keyCode:j.DOWN,action:te(T0,e,!0)}],n).each(o=>{n.preventDefault()})},GV=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||KV(e,t,n)})},kn=(e,t)=>({container:e,offset:t}),Ml=_e.DOM,Ul=e=>t=>e===t?-1:0,YV=e=>t=>e.isBlock(t)||Se(["BR","IMG","HR","INPUT"],t.nodeName)||e.getContentEditable(t)==="false",um=(e,t,n)=>{if(I(e)&&t>=0)return m.some(kn(e,t));{const s=Zs(Ml);return m.from(s.backwards(e,t,Ul(e),n)).map(o=>kn(o.container,o.container.data.length))}},XV=(e,t,n)=>{if(I(e)&&t>=e.length)return m.some(kn(e,t));{const s=Zs(Ml);return m.from(s.forwards(e,t,Ul(e),n)).map(o=>kn(o.container,0))}},fm=(e,t,n)=>{if(!I(e))return m.none();const s=e.data;if(t>=0&&t<=s.length)return m.some(kn(e,t));{const o=Zs(Ml);return m.from(o.backwards(e,t,Ul(e),n)).bind(r=>{const a=r.container.data;return fm(r.container,t+a.length,n)})}},rw=(e,t,n)=>{if(!I(e))return m.none();const s=e.data;if(t<=s.length)return m.some(kn(e,t));{const o=Zs(Ml);return m.from(o.forwards(e,t,Ul(e),n)).bind(r=>rw(r.container,t-s.length,n))}},dm=(e,t,n,s,o)=>{const r=Zs(e,YV(e));return m.from(r.backwards(t,n,s,o))},ZV=e=>e.collapsed&&I(e.startContainer),QV=e=>Ht(e.toString().replace(/\u00A0/g," ")),aw=e=>e!==""&&`  \uFEFF\f
\r	\v`.indexOf(e)!==-1,JV=(e,t)=>e.substring(t.length),e3=(e,t,n,s=!1)=>{let o;const r=n.charAt(0);for(o=t-1;o>=0;o--){const a=e.charAt(o);if(!s&&aw(a))return m.none();if(r===a&&lt(e,n,o,t))break}return m.some(o)},mm=(e,t,n,s=!1)=>{if(!ZV(t))return m.none();const o={text:"",offset:0},r=(i,l,c)=>(o.text=c+o.text,o.offset+=l,e3(o.text,o.offset,n,s).getOr(l)),a=e.getParent(t.startContainer,e.isBlock)||e.getRoot();return dm(e,t.startContainer,t.startOffset,r,a).bind(i=>{const l=t.cloneRange();if(l.setStart(i.container,i.offset),l.setEnd(t.endContainer,t.endOffset),l.collapsed)return m.none();const c=QV(l);return c.lastIndexOf(n)!==0?m.none():m.some({text:JV(c,n),range:l,trigger:n})})},t3=e=>e.nodeType===Kg,n3=e=>e.nodeType===Or,iw=e=>{if(t3(e))return kn(e,e.data.length);{const t=e.childNodes;return t.length>0?iw(t[t.length-1]):kn(e,t.length)}},lw=(e,t)=>{const n=e.childNodes;return n.length>0&&t<n.length?lw(n[t],0):n.length>0&&n3(e)&&n.length===t?iw(n[n.length-1]):kn(e,t)},s3=(e,t)=>{var n;const s=(n=e.getParent(t.container,e.isBlock))!==null&&n!==void 0?n:e.getRoot();return dm(e,t.container,t.offset,(o,r)=>r===0?-1:r,s).filter(o=>{const r=o.container.data.charAt(o.offset-1);return!aw(r)}).isSome()},o3=e=>t=>{const n=lw(t.startContainer,t.startOffset);return!s3(e,n)},r3=(e,t,n)=>wo(n.triggers,s=>mm(e,t,s)),a3=(e,t)=>{const n=t(),s=e.selection.getRng();return r3(e.dom,s,n).bind(o=>cw(e,t,o))},cw=(e,t,n,s={})=>{var o;const r=t(),i=(o=e.selection.getRng().startContainer.nodeValue)!==null&&o!==void 0?o:"",l=ne(r.lookupByTrigger(n.trigger),u=>n.text.length>=u.minChars&&u.matches.getOrThunk(()=>o3(e.dom))(n.range,i,n.text));if(l.length===0)return m.none();const c=Promise.all(he(l,u=>u.fetch(n.text,u.maxResults,s).then(d=>({matchText:n.text,items:d,columns:u.columns,onAction:u.onAction,highlightOn:u.highlightOn}))));return m.some({lookupData:c,context:n})};var _n;(function(e){e[e.Error=0]="Error",e[e.Value=1]="Value"})(_n||(_n={}));const gm=(e,t,n)=>e.stype===_n.Error?t(e.serror):n(e.svalue),i3=e=>{const t=[],n=[];return D(e,s=>{gm(s,o=>n.push(o),o=>t.push(o))}),{values:t,errors:n}},l3=(e,t)=>e.stype===_n.Error?{stype:_n.Error,serror:t(e.serror)}:e,c3=(e,t)=>e.stype===_n.Value?{stype:_n.Value,svalue:t(e.svalue)}:e,u3=(e,t)=>e.stype===_n.Value?t(e.svalue):e,f3=(e,t)=>e.stype===_n.Error?t(e.serror):e,uw=e=>({stype:_n.Value,svalue:e}),fw=e=>({stype:_n.Error,serror:e}),gt={fromResult:e=>e.fold(fw,uw),toResult:e=>gm(e,Mt.error,Mt.value),svalue:uw,partition:i3,serror:fw,bind:u3,bindError:f3,map:c3,mapError:l3,fold:gm},dw=e=>nt(e)&&$t(e).length>100?" removed due to size":JSON.stringify(e,null,2),d3=e=>{const t=e.length>10?e.slice(0,10).concat([{path:[],getErrorInfo:W("... (only showing first ten failures)")}]):e;return he(t,n=>"Failed path: ("+n.path.join(" > ")+`)
`+n.getErrorInfo())},mw=(e,t)=>gt.serror([{path:e,getErrorInfo:t}]),m3=(e,t,n)=>mw(e,()=>'Could not find valid *required* value for "'+t+'" in '+dw(n)),g3=(e,t)=>mw(e,W(t)),gw=e=>{const t=(s,o)=>gt.bindError(e(o),r=>g3(s,r)),n=W("val");return{extract:t,toString:n}},p3=gw(gt.svalue),h3=W(p3),pm=(e,t)=>gw(n=>{const s=typeof n;return e(n)?gt.svalue(n):gt.serror(`Expected type: ${t} but got: ${s}`)}),b3=pm(rn,"number"),pw=pm(J,"string"),hw=pm(we,"function"),C3=()=>({tag:"required",process:{}}),y3=e=>({tag:"defaultedThunk",process:e}),bw=e=>y3(W(e)),v3=()=>({tag:"option",process:{}}),E3=(e,t,n,s)=>({tag:"field",key:e,newKey:t,presence:n,prop:s}),Cw=(e,t,n)=>{switch(e.tag){case"field":return t(e.key,e.newKey,e.presence,e.prop);case"custom":return n(e.newKey,e.instantiator)}},S3=(e,t)=>e.length>0?gt.svalue(ii(t,fg.apply(void 0,e))):gt.svalue(t),yw=e=>Nn(gt.serror,sg)(e),w3={consolidateObj:(e,t)=>{const n=gt.partition(e);return n.errors.length>0?yw(n.errors):S3(n.values,t)},consolidateArr:e=>{const t=gt.partition(e);return t.errors.length>0?yw(t.errors):gt.svalue(t.values)}},k3=(e,t,n,s)=>Oe(t,n).fold(()=>m3(e,n,t),s),vw=(e,t,n,s)=>{const o=Oe(e,t).getOrThunk(()=>n(e));return s(o)},_3=(e,t,n)=>n(Oe(e,t)),A3=(e,t,n,s)=>{const o=Oe(e,t).map(r=>r===!0?n(e):r);return s(o)},x3=(e,t,n,s,o)=>{const r=i=>o.extract(t.concat([s]),i),a=i=>i.fold(()=>gt.svalue(m.none()),l=>{const c=o.extract(t.concat([s]),l);return gt.map(c,m.some)});switch(e.tag){case"required":return k3(t,n,s,r);case"defaultedThunk":return vw(n,s,e.process,r);case"option":return _3(n,s,a);case"defaultedOptionThunk":return A3(n,s,e.process,a);case"mergeWithThunk":return vw(n,s,W({}),i=>{const l=ii(e.process(n),i);return r(l)})}},N3=(e,t,n)=>{const s={},o=[];for(const r of n)Cw(r,(a,i,l,c)=>{const u=x3(l,e,t,a,c);gt.fold(u,f=>{o.push(...f)},f=>{s[i]=f})},(a,i)=>{s[a]=i(t)});return o.length>0?gt.serror(o):gt.svalue(s)},R3=e=>({extract:(s,o)=>N3(s,o,e),toString:()=>`obj{
`+he(e,o=>Cw(o,(r,a,i,l)=>r+" -> "+l.toString(),(r,a)=>"state("+r+")")).join(`
`)+"}"}),T3=e=>({extract:(s,o)=>{const r=he(o,(a,i)=>e.extract(s.concat(["["+i+"]"]),a));return w3.consolidateArr(r)},toString:()=>"array("+e.toString()+")"}),D3=(e,t,n)=>{const s=t.extract([e],n);return gt.mapError(s,o=>({input:n,errors:o}))},P3=(e,t,n)=>gt.toResult(D3(e,t,n)),B3=e=>`Errors: 
`+d3(e.errors).join(`
`)+`

Input object: `+dw(e.input),zl=E3,Ew=(e,t)=>zl(e,e,C3(),t),Sw=e=>Ew(e,pw),ww=e=>Ew(e,hw),O3=(e,t)=>zl(e,e,v3(),t),I3=e=>O3(e,hw),F3=(e,t)=>zl(e,e,bw(t),h3()),kw=(e,t,n)=>zl(e,e,bw(t),n),_w=(e,t)=>kw(e,t,b3),L3=(e,t,n)=>kw(e,t,T3(n)),$3=Sw("type"),M3=ww("fetch"),U3=ww("onAction"),z3=e=>F3("columns",e),H3=R3([$3,Sw("trigger"),_w("minChars",1),z3(1),_w("maxResults",10),I3("matches"),M3,U3,L3("highlightOn",[],pw)]),W3=e=>P3("Autocompleter",H3,e),V3=()=>{const e={},t={},n={},s={},o={},r={},a={},i={},l={},c=(g,h)=>(p,b)=>{g[p.toLowerCase()]={...b,type:h}},u=(g,h)=>(p,b)=>{g[p.toLowerCase()]={type:h,...b}},f=(g,h)=>s[g.toLowerCase()]=h,d=(g,h)=>a[g.toLowerCase()]=h;return{addButton:c(e,"button"),addGroupToolbarButton:c(e,"grouptoolbarbutton"),addToggleButton:c(e,"togglebutton"),addMenuButton:c(e,"menubutton"),addSplitButton:c(e,"splitbutton"),addMenuItem:c(t,"menuitem"),addNestedMenuItem:c(t,"nestedmenuitem"),addToggleMenuItem:c(t,"togglemenuitem"),addAutocompleter:c(n,"autocompleter"),addContextMenu:c(o,"contextmenu"),addContextToolbar:c(r,"contexttoolbar"),addContextForm:u(r,"contextform"),addSidebar:c(i,"sidebar"),addView:c(l,"views"),addIcon:f,addContext:d,getAll:()=>({buttons:e,menuItems:t,icons:s,popups:n,contextMenus:o,contextToolbars:r,sidebars:i,views:l,contexts:a})}},j3=e=>{const t=e.ui.registry.getAll().popups,n=ri(t,a=>W3(a).fold(i=>{throw new Error(B3(i))},Ft)),s=bg(ai(n,a=>a.trigger)),o=Ec(n);return{dataset:n,triggers:s,lookupByTrigger:a=>ne(o,i=>i.trigger===a)}},q3=(e,t)=>{const n=kc(t.load,50);e.on("input",s=>{s.inputType==="insertCompositionText"&&!e.composing||n.throttle()}),e.on("keydown",s=>{const o=s.which;o===8?n.throttle():o===27?(n.cancel(),t.cancelIfNecessary()):(o===38||o===40)&&n.cancel()},!0),e.on("remove",n.cancel)},K3=e=>{const t=Qn(),n=et(!1),s=t.isSet,o=()=>{s()&&(gD(e),n.set(!1),t.clear())},r=f=>{s()||t.set({trigger:f.trigger,matchLength:f.text.length})},a=Dn(()=>j3(e)),i=f=>t.get().map(d=>mm(e.dom,e.selection.getRng(),d.trigger,!0).bind(g=>cw(e,a,g,f))).getOrThunk(()=>a3(e,a)),l=f=>{i(f).fold(o,d=>{r(d.context),d.lookupData.then(g=>{t.get().map(h=>{const p=d.context;h.trigger===p.trigger&&(t.set({...h,matchLength:p.text.length}),n.get()?(Lu(e,{range:p.range}),mD(e,{lookupData:g})):(n.set(!0),Lu(e,{range:p.range}),dD(e,{lookupData:g})))})})})},c=(f,d)=>{const g=f.compareBoundaryPoints(window.Range.START_TO_START,d),h=f.compareBoundaryPoints(window.Range.END_TO_END,d);return g>=0&&h<=0},u=()=>t.get().bind(({trigger:f})=>{const d=e.selection.getRng();return mm(e.dom,d,f,n.get()).filter(({range:g})=>c(d,g)).map(({range:g})=>g)});e.addCommand("mceAutocompleterReload",(f,d)=>{const g=nt(d)?d.fetchOptions:{};l(g)}),e.addCommand("mceAutocompleterClose",o),e.addCommand("mceAutocompleterRefreshActiveRange",()=>{u().each(f=>{Lu(e,{range:f})})}),e.editorCommands.addQueryStateHandler("mceAutoCompleterInRange",()=>u().isSome()),q3(e,{cancelIfNecessary:o,load:l})},G3=pn().browser.isSafari(),Aw=e=>Es(C.fromDom(e)),xw=(e,t)=>{var n;return e.startOffset===0&&e.endOffset===((n=t.textContent)===null||n===void 0?void 0:n.length)},Hl=(e,t)=>m.from(e.getParent(t.container(),"details")),Nw=(e,t)=>Hl(e,t).isSome(),Y3=(e,t)=>{const n=m.from(e.getParent(t.startContainer,"details")),s=m.from(e.getParent(t.endContainer,"details"));if(n.isSome()||s.isSome()){const o=n.bind(r=>m.from(e.select("summary",r)[0]));return m.some({startSummary:o,startDetails:n,endDetails:s})}else return m.none()},X3=(e,t)=>mt(t).exists(n=>n.isEqual(e)),Z3=(e,t)=>ln(t).exists(n=>Ie(n.getNode())&&Pt(t,n).exists(s=>s.isEqual(e))||n.isEqual(e)),Q3=(e,t)=>t.startSummary.exists(n=>X3(e,n)),J3=(e,t)=>t.startSummary.exists(n=>Z3(e,n)),e8=(e,t)=>t.startDetails.exists(n=>Pt(n,e).forall(s=>t.startSummary.exists(o=>!o.contains(e.container())&&o.contains(s.container())))),t8=(e,t,n)=>n.startDetails.exists(s=>xt(e,t).forall(o=>!s.contains(o.container()))),Rw=(e,t)=>{const n=t.getNode();st(n)||e.selection.setCursorLocation(n,t.offset())},Tw=(e,t,n)=>{const s=e.dom.getParent(t.container(),"details");if(s&&!s.open){const o=e.dom.select("summary",s)[0];o&&(n?mt(o):ln(o)).each(a=>Rw(e,a))}else Rw(e,t)},n8=(e,t)=>{const n=l=>l.contains(e.startContainer),s=l=>l.contains(e.endContainer),o=t.startSummary.exists(n),r=t.startSummary.exists(s),a=t.startDetails.forall(l=>t.endDetails.forall(c=>l!==c));return(o||r)&&!(o&&r)||a},Dw=(e,t,n)=>{const{dom:s,selection:o}=e,r=e.getBody();if(n==="character"){const a=N.fromRangeStart(o.getRng()),i=s.getParent(a.container(),s.isBlock),l=Hl(s,a),c=i&&s.isEmpty(i),u=bt(i==null?void 0:i.previousSibling),f=bt(i==null?void 0:i.nextSibling);return c&&(t?f:u)&&Go(!t,r,a).exists(h=>Nw(s,h)&&!dg(l,Hl(s,h)))?!0:Go(t,r,a).fold(Pe,d=>{const g=Hl(s,d);if(Nw(s,d)&&!dg(l,g)){if(t||Tw(e,d,!1),i&&c){if(t&&u)return!0;if(!t&&f)return!0;Tw(e,d,t),e.dom.remove(i)}return!0}else return!1})}else return!1},s8=(e,t,n,s)=>{const r=e.selection.getRng(),a=N.fromRangeStart(r),i=e.getBody();return s==="selection"?n8(r,t):n?J3(a,t)||t8(i,a,t):Q3(a,t)||e8(a,t)},o8=(e,t,n)=>Y3(e.dom,e.selection.getRng()).fold(()=>Dw(e,t,n),s=>s8(e,s,t,n)||Dw(e,t,n)),r8=(e,t,n)=>{const s=e.selection,o=s.getNode(),r=s.getRng(),a=N.fromRangeStart(r);return PN(o)?(n==="selection"&&xw(r,o)||By(t,a,o)?Aw(o):e.undoManager.transact(()=>{const i=s.getSel();let{anchorNode:l,anchorOffset:c,focusNode:u,focusOffset:f}=i??{};const d=()=>{U(l)&&U(c)&&U(u)&&U(f)&&(i==null||i.setBaseAndExtent(l,c,u,f))},g=()=>{l=i==null?void 0:i.anchorNode,c=i==null?void 0:i.anchorOffset,u=i==null?void 0:i.focusNode,f=i==null?void 0:i.focusOffset},h=(b,y)=>{D(b.childNodes,v=>{ha(v)&&y.appendChild(v)})},p=e.dom.create("span",{"data-mce-bogus":"1"});h(o,p),o.appendChild(p),d(),(n==="word"||n==="line")&&(i==null||i.modify("extend",t?"right":"left",n)),!s.isCollapsed()&&xw(s.getRng(),p)?Aw(o):(e.execCommand(t?"ForwardDelete":"Delete"),g(),h(p,o),d()),e.dom.remove(p)}),!0):!1},bo=(e,t,n)=>o8(e,t,n)||G3&&r8(e,t,n)?m.some(ce):m.none(),Pw=e=>(t,n,s={})=>{const o=t.getBody(),r={bubbles:!0,composed:!0,data:null,isComposing:!1,detail:0,view:null,target:o,currentTarget:o,eventPhase:Event.AT_TARGET,originalTarget:o,explicitOriginalTarget:o,isTrusted:!1,srcElement:o,cancelable:!1,preventDefault:ce,inputType:n},a=lh(new InputEvent(e));return t.dispatch(e,{...a,...r,...s})},Ha=Pw("input"),Wl=Pw("beforeinput"),Bw=pn(),Ow=Bw.os,Iw=Ow.isMacOS()||Ow.isiOS(),a8=Bw.browser.isFirefox(),i8=(e,t,n)=>{const s=n.keyCode===j.BACKSPACE?"deleteContentBackward":"deleteContentForward",o=e.selection.isCollapsed(),r=o?"character":"selection",a=i=>o?i?"word":"line":"selection";O0([{keyCode:j.BACKSPACE,action:te(C0,e)},{keyCode:j.BACKSPACE,action:te(zd,e,!1)},{keyCode:j.DELETE,action:te(zd,e,!0)},{keyCode:j.BACKSPACE,action:te($d,e,!1)},{keyCode:j.DELETE,action:te($d,e,!0)},{keyCode:j.BACKSPACE,action:te(Zd,e,t,!1)},{keyCode:j.DELETE,action:te(Zd,e,t,!0)},{keyCode:j.BACKSPACE,action:te(Hf,e,!1)},{keyCode:j.DELETE,action:te(Hf,e,!0)},{keyCode:j.BACKSPACE,action:te(bo,e,!1,r)},{keyCode:j.DELETE,action:te(bo,e,!0,r)},...Iw?[{keyCode:j.BACKSPACE,altKey:!0,action:te(bo,e,!1,a(!0))},{keyCode:j.DELETE,altKey:!0,action:te(bo,e,!0,a(!0))},{keyCode:j.BACKSPACE,metaKey:!0,action:te(bo,e,!1,a(!1))}]:[{keyCode:j.BACKSPACE,ctrlKey:!0,action:te(bo,e,!1,a(!0))},{keyCode:j.DELETE,ctrlKey:!0,action:te(bo,e,!0,a(!0))}],{keyCode:j.BACKSPACE,action:te(Wd,e,!1)},{keyCode:j.DELETE,action:te(Wd,e,!0)},{keyCode:j.BACKSPACE,action:te(em,e,!1)},{keyCode:j.DELETE,action:te(em,e,!0)},{keyCode:j.BACKSPACE,action:te(Fd,e,!1)},{keyCode:j.DELETE,action:te(Fd,e,!0)},{keyCode:j.BACKSPACE,action:te(Id,e,!1)},{keyCode:j.DELETE,action:te(Id,e,!0)},{keyCode:j.BACKSPACE,action:te(Qd,e,!1)},{keyCode:j.DELETE,action:te(Qd,e,!0)},{keyCode:j.BACKSPACE,action:te(Hd,e,!1)},{keyCode:j.DELETE,action:te(Hd,e,!0)}],n).filter(i=>e.selection.isEditable()).each(i=>{n.preventDefault(),Wl(e,s).isDefaultPrevented()||(i(),Ha(e,s))})},l8=(e,t,n)=>Ua([{keyCode:j.BACKSPACE,action:te(wS,e)},{keyCode:j.DELETE,action:te(wS,e)},...Iw?[{keyCode:j.BACKSPACE,altKey:!0,action:te(Ma,e)},{keyCode:j.DELETE,altKey:!0,action:te(Ma,e)},...n?[{keyCode:a8?224:91,action:te(Ma,e)}]:[]]:[{keyCode:j.BACKSPACE,ctrlKey:!0,action:te(Ma,e)},{keyCode:j.DELETE,ctrlKey:!0,action:te(Ma,e)}]],t),c8=(e,t)=>{let n=!1;e.on("keydown",s=>{n=s.keyCode===j.BACKSPACE,s.isDefaultPrevented()||i8(e,t,s)}),e.on("keyup",s=>{s.isDefaultPrevented()||l8(e,s,n),n=!1})},u8=e=>{for(;e;){if(q(e)||I(e)&&e.data&&/[\r\n\s]/.test(e.data))return e;e=e.nextSibling}return null},lr=(e,t)=>{const n=e.dom,s=e.schema.getMoveCaretBeforeOnEnterElements();if(!t)return;if(/^(LI|DT|DD)$/.test(t.nodeName)){const r=u8(t.firstChild);r&&/^(UL|OL|DL)$/.test(r.nodeName)&&t.insertBefore(n.doc.createTextNode(Ze),t.firstChild)}const o=n.createRng();if(t.normalize(),t.hasChildNodes()){const r=new tt(t,t);let a=t,i;for(;i=r.current();){if(I(i)){o.setStart(i,0),o.setEnd(i,0);break}if(s[i.nodeName.toLowerCase()]){o.setStartBefore(i),o.setEndBefore(i);break}a=i,i=r.next()}i||(o.setStart(a,0),o.setEnd(a,0))}else Ie(t)?t.nextSibling&&n.isBlock(t.nextSibling)?(o.setStartBefore(t),o.setEndBefore(t)):(o.setStartAfter(t),o.setEndAfter(t)):(o.setStart(t,0),o.setEnd(t,0));e.selection.setRng(o),ya(e,o)},Wa=(e,t)=>{const n=e.getRoot();let s,o=t;for(;o!==n&&o&&e.getContentEditable(o)!=="false";){if(e.getContentEditable(o)==="true"){s=o;break}o=o.parentNode}return o!==n?s:n},hm=e=>m.from(e.dom.getParent(e.selection.getStart(!0),e.dom.isBlock)),f8=e=>hm(e).fold(W(""),t=>t.nodeName.toUpperCase()),d8=e=>hm(e).filter(t=>Uo(C.fromDom(t))).isSome(),bm=e=>{e.innerHTML='<br data-mce-bogus="1">'},m8=(e,t,n)=>{const s=e.dom;m.from(n.style).map(s.parseStyle).each(l=>{const u={...Uc(C.fromDom(t)),...l};s.setStyles(t,u)});const o=m.from(n.class).map(l=>l.split(/\s+/)),r=m.from(t.className).map(l=>ne(l.split(/\s+/),c=>c!==""));at(o,r,(l,c)=>{const u=ne(c,d=>!Se(l,d)),f=[...l,...u];s.setAttrib(t,"class",f.join(" "))});const a=["style","class"],i=Ar(n,(l,c)=>!Se(a,c));s.setAttribs(t,i)},Va=(e,t)=>{if(dt(e).toLowerCase()===t.tagName.toLowerCase()){const s=ia(e);m8(e,t,s)}},Fw=(e,t,n,s,o=!0,r,a)=>{const i=e.dom,l=e.schema,c=dt(e),u=n?n.nodeName.toUpperCase():"";let f=t;const d=l.getTextInlineElements();let g;r||u==="TABLE"||u==="HR"?g=i.create(r||c,a||{}):g=n.cloneNode(!1);let h=g;if(!o)i.setAttrib(g,"style",null),i.setAttrib(g,"class",null);else do if(d[f.nodeName]){if(Xt(f)||Zt(f))continue;const p=f.cloneNode(!1);i.setAttrib(p,"id",""),g.hasChildNodes()?(p.appendChild(g.firstChild),g.appendChild(p)):(h=p,g.appendChild(p))}while((f=f.parentNode)&&f!==s);return Va(e,g),bm(h),g},g8=(e,t)=>e.dom.getParent(t,tu),p8=(e,t,n)=>{let s=t;for(;s&&s!==e&&bt(s.nextSibling);){const o=s.parentElement;if(!o||!n(o))return tu(o);s=o}return!1},h8=(e,t,n)=>!t&&n.nodeName.toLowerCase()===dt(e)&&e.dom.isEmpty(n)&&p8(e.getBody(),n,s=>se(e.schema.getTextBlockElements(),s.nodeName.toLowerCase())),b8=(e,t,n)=>{var s,o,r;const a=t(dt(e)),i=g8(e,n);i&&(e.dom.insertAfter(a,i),lr(e,a),((r=(o=(s=n.parentElement)===null||s===void 0?void 0:s.childNodes)===null||o===void 0?void 0:o.length)!==null&&r!==void 0?r:0)>1&&e.dom.remove(n))},C8=(e,t)=>e.firstChild&&e.firstChild.nodeName===t,y8=e=>{var t;return((t=e.parentNode)===null||t===void 0?void 0:t.firstChild)===e},Lw=(e,t)=>{const n=e==null?void 0:e.parentNode;return U(n)&&n.nodeName===t},$w=e=>U(e)&&/^(OL|UL|LI)$/.test(e.nodeName),Cm=e=>U(e)&&/^(LI|DT|DD)$/.test(e.nodeName),v8=e=>$w(e)&&$w(e.parentNode),Vl=e=>{const t=e.parentNode;return Cm(t)?t:e},jl=(e,t,n)=>{let s=e[n?"firstChild":"lastChild"];for(;s&&!q(s);)s=s[n?"nextSibling":"previousSibling"];return s===t},Mw=e=>Tt(ai(Uc(C.fromDom(e)),(t,n)=>`${n}: ${t};`),(t,n)=>t+n,""),E8=(e,t,n,s,o)=>{const r=e.dom,a=e.selection.getRng(),i=n.parentNode;if(n===e.getBody()||!i)return;v8(n)&&(o="LI");const l=Cm(s)?Mw(s):void 0;let c=Cm(s)&&l?t(o,{style:Mw(s)}):t(o);if(jl(n,s,!0)&&jl(n,s,!1))if(Lw(n,"LI")){const u=Vl(n);r.insertAfter(c,u),y8(n)?r.remove(u):r.remove(n)}else r.replace(c,n);else if(jl(n,s,!0))Lw(n,"LI")?(r.insertAfter(c,Vl(n)),c.appendChild(r.doc.createTextNode(" ")),c.appendChild(n)):i.insertBefore(c,n),r.remove(s);else if(jl(n,s,!1))r.insertAfter(c,Vl(n)),r.remove(s);else{n=Vl(n);const u=a.cloneRange();u.setStartAfter(s),u.setEndAfter(n);const f=u.extractContents();if(o==="LI"&&C8(f,"LI")){const d=ne(he(c.children,C.fromDom),vr(Fr("br")));c=f.firstChild,r.insertAfter(f,n),D(d,g=>$c(C.fromDom(c),g)),l&&c.setAttribute("style",l)}else r.insertAfter(f,n),r.insertAfter(c,n);r.remove(s)}lr(e,c)},S8=e=>{D(kp(C.fromDom(e),At),t=>{const n=t.dom;n.nodeValue=Ht(n.data)})},w8=(e,t)=>{const n=e.dom.getParent(t,"ol,ul,dl");return n!==null&&e.dom.getContentEditableParent(n)==="false"},k8=(e,t)=>t&&t.nodeName==="A"&&e.isEmpty(t),ym=(e,t)=>e.nodeName===t||e.previousSibling&&e.previousSibling.nodeName===t,_8=(e,t)=>e.nodeName===t||e.nextSibling&&e.nextSibling.nodeName===t,vm=(e,t)=>U(t)&&e.isBlock(t)&&!/^(TD|TH|CAPTION|FORM)$/.test(t.nodeName)&&!/^(fixed|absolute)/i.test(t.style.position)&&e.isEditable(t.parentNode)&&e.getContentEditable(t)!=="false",A8=(e,t,n)=>{var s;const o=[];if(!n)return;let r=n;for(;r=r.firstChild;){if(e.isBlock(r))return;q(r)&&!t[r.nodeName.toLowerCase()]&&o.push(r)}let a=o.length;for(;a--;)r=o[a],(!r.hasChildNodes()||r.firstChild===r.lastChild&&((s=r.firstChild)===null||s===void 0?void 0:s.nodeValue)===""||k8(e,r))&&e.remove(r)},Em=(e,t,n)=>I(t)?e?n===1&&t.data.charAt(n-1)===Qe?0:n:n===t.data.length-1&&t.data.charAt(n)===Qe?t.data.length:n:n,x8=e=>{const t=e.cloneRange();return t.setStart(e.startContainer,Em(!0,e.startContainer,e.startOffset)),t.setEnd(e.endContainer,Em(!1,e.endContainer,e.endOffset)),t},N8=e=>{let t=e;do I(t)&&(t.data=t.data.replace(/^[\r\n]+/,"")),t=t.firstChild;while(t)},R8=(e,t,n,s,o)=>{var r,a;const i=e.dom,l=(r=Wa(i,s))!==null&&r!==void 0?r:i.getRoot();let c=i.getParent(s,i.isBlock);if(!c||!vm(i,c)){if(c=c||l,!c.hasChildNodes()){const g=i.create(t);return Va(e,g),c.appendChild(g),n.setStart(g,0),n.setEnd(g,0),g}let u=s;for(;u&&u.parentNode!==c;)u=u.parentNode;let f;for(;u&&!i.isBlock(u);)f=u,u=u.previousSibling;const d=(a=f==null?void 0:f.parentElement)===null||a===void 0?void 0:a.nodeName;if(f&&d&&e.schema.isValidChild(d,t.toLowerCase())){const g=f.parentNode,h=i.create(t);for(Va(e,h),g.insertBefore(h,f),u=f;u&&!i.isBlock(u);){const p=u.nextSibling;h.appendChild(u),u=p}n.setStart(s,o),n.setEnd(s,o)}}return s},T8=(e,t)=>{t.normalize();const n=t.lastChild;(!n||q(n)&&/^(left|right)$/gi.test(e.getStyle(n,"float",!0)))&&e.add(t,"br")},D8=(e,t)=>{const n=PD(e);return Ve(t)?!1:J(n)?Se(L.explode(n),t.nodeName.toLowerCase()):n},Uw={insert:(e,t)=>{let n,s,o,r,a=!1;const i=e.dom,l=e.schema,c=l.getNonEmptyElements(),u=e.selection.getRng(),f=dt(e),d=C.fromDom(u.startContainer),g=No(d,u.startOffset),h=g.exists(P=>Ir(P)&&!Cs(P)),p=u.collapsed&&h,b=(P,z)=>Fw(e,n,B,T,DD(e),P,z),y=P=>{const z=Em(P,n,s);if(I(n)&&(P?z>0:z<n.data.length))return!1;if((n.parentNode===B||n===B)&&a&&!P||P&&q(n)&&n===B.firstChild)return!0;if(ym(n,"TABLE")||ym(n,"HR"))return _8(n,"BR")?!P:a&&!P||!a&&P;const X=new tt(n,B);I(n)&&(P&&z===0?X.prev():!P&&z===n.data.length&&X.next());let oe;for(;oe=X.current();){if(q(oe)){if(!oe.getAttribute("data-mce-bogus")){const ae=oe.nodeName.toLowerCase();if(c[ae]&&ae!=="br")return!1}}else if(I(oe)&&!Io(oe.data))return!1;P?X.prev():X.next()}return!0},v=()=>{let P;return/^(H[1-6]|PRE|FIGURE)$/.test(o)&&H!=="HGROUP"?P=b(f):P=b(),D8(e,r)&&vm(i,r)&&i.isEmpty(B,void 0,{includeZwsp:!0})?P=i.split(r,B):i.insertAfter(P,B),lr(e,P),P};sl(i,u).each(P=>{u.setStart(P.startContainer,P.startOffset),u.setEnd(P.endContainer,P.endOffset)}),n=u.startContainer,s=u.startOffset;const E=!!(t&&t.shiftKey),w=!!(t&&t.ctrlKey);q(n)&&n.hasChildNodes()&&!p&&(a=s>n.childNodes.length-1,n=n.childNodes[Math.min(s,n.childNodes.length-1)]||n,a&&I(n)?s=n.data.length:s=0);const T=Wa(i,n);if(!T||w8(e,n))return;E||(n=R8(e,f,u,n,s));let B=i.getParent(n,i.isBlock)||i.getRoot();r=U(B==null?void 0:B.parentNode)?i.getParent(B.parentNode,i.isBlock):null,o=B?B.nodeName.toUpperCase():"";const H=r?r.nodeName.toUpperCase():"";if(H==="LI"&&!w){const P=r;B=P,r=P.parentNode,o=H}if(q(r)&&h8(e,E,B))return b8(e,b,B);if(/^(LI|DT|DD)$/.test(o)&&q(r)&&i.isEmpty(B)){E8(e,b,r,B,f);return}if(!p&&(B===e.getBody()||!vm(i,B)))return;const x=B.parentNode;let _;if(p)_=b(f),g.fold(()=>{je(d,C.fromDom(_))},P=>{Dt(P,C.fromDom(_))}),e.selection.setCursorLocation(_,0);else if(Wo(B))_=Au(B),i.isEmpty(B)&&bm(B),Va(e,_),lr(e,_);else if(y(!1))_=v();else if(y(!0)&&x){const P=N.fromRangeStart(u),z=Af(P),X=C.fromDom(B),ae=ll(X,P,e.schema)?my(X,P,e.schema).bind(ve=>m.from(ve.getNode())):m.none();_=x.insertBefore(b(),B);const ge=ym(B,"HR")||z?_:ae.getOr(B);lr(e,ge)}else{const P=x8(u).cloneRange();P.setEndAfter(B);const z=P.extractContents();S8(z),N8(z),_=z.firstChild,i.insertAfter(z,B),A8(i,c,_),T8(i,B),i.isEmpty(B)&&bm(B),_.normalize(),i.isEmpty(_)?(i.remove(_),v()):(Va(e,_),lr(e,_))}i.setAttrib(_,"id",""),e.dispatch("NewBlock",{newBlock:_})},fakeEventName:"insertParagraph"},P8=(e,t,n)=>{const s=new tt(t,n);let o;const r=e.getNonEmptyElements();for(;o=s.next();)if(r[o.nodeName.toLowerCase()]||I(o)&&o.length>0)return!0;return!1},zw=(e,t,n)=>{const s=e.dom.createRng();n?(s.setStartBefore(t),s.setEndBefore(t)):(s.setStartAfter(t),s.setEndAfter(t)),e.selection.setRng(s),ya(e,s)},B8=(e,t)=>{const n=e.selection,s=e.dom,o=n.getRng();let r,a=!1;sl(s,o).each(g=>{o.setStart(g.startContainer,g.startOffset),o.setEnd(g.endContainer,g.endOffset)});let i=o.startOffset,l=o.startContainer;if(q(l)&&l.hasChildNodes()){const g=i>l.childNodes.length-1;l=l.childNodes[Math.min(i,l.childNodes.length-1)]||l,g&&I(l)?i=l.data.length:i=0}let c=s.getParent(l,s.isBlock);const u=c&&c.parentNode?s.getParent(c.parentNode,s.isBlock):null,f=u?u.nodeName.toUpperCase():"",d=!!(t&&t.ctrlKey);f==="LI"&&!d&&(c=u),I(l)&&i>=l.data.length&&(P8(e.schema,l,c||s.getRoot())||(r=s.create("br"),o.insertNode(r),o.setStartAfter(r),o.setEndAfter(r),a=!0)),r=s.create("br"),Pu(s,o,r),zw(e,r,a),e.undoManager.add()},O8=(e,t)=>{const n=C.fromTag("br");Dt(C.fromDom(t),n),e.undoManager.add()},I8=(e,t)=>{L8(e.getBody(),t)||es(C.fromDom(t),C.fromTag("br"));const n=C.fromTag("br");es(C.fromDom(t),n),zw(e,n.dom,!1),e.undoManager.add()},F8=e=>Ie(e.getNode()),L8=(e,t)=>F8(N.after(t))?!0:xt(e,N.after(t)).map(n=>Ie(n.getNode())).getOr(!1),Hw=e=>e&&e.nodeName==="A"&&"href"in e,$8=e=>e.fold(Pe,Hw,Hw,Pe),M8=e=>{const t=G(co,e),n=N.fromRangeStart(e.selection.getRng());return jn(t,e.getBody(),n).filter($8)},U8=(e,t)=>{t.fold(ce,G(O8,e),G(I8,e),ce)},Ww={insert:(e,t)=>{const n=M8(e);n.isSome()?n.each(G(U8,e)):B8(e,t)},fakeEventName:"insertLineBreak"},Vw=(e,t)=>hm(e).filter(n=>t.length>0&&hn(C.fromDom(n),t)).isSome(),z8=e=>Vw(e,RD(e)),H8=e=>Vw(e,TD(e)),Vt=Rn.generate([{br:[]},{block:[]},{none:[]}]),W8=(e,t)=>H8(e),jw=e=>(t,n)=>d8(t)===e,qw=(e,t)=>(n,s)=>f8(n)===e.toUpperCase()===t,V8=e=>{const t=Wa(e.dom,e.selection.getStart());return Ve(t)},ja=e=>qw("pre",e),j8=()=>qw("summary",!0),ql=e=>(t,n)=>xD(t)===e,q8=(e,t)=>z8(e),Kl=(e,t)=>t,K8=e=>{const t=dt(e),n=Wa(e.dom,e.selection.getStart());return U(n)&&e.schema.isValidChild(n.nodeName,t)},G8=e=>{const t=e.selection.getRng(),n=C.fromDom(t.startContainer),o=No(n,t.startOffset).map(r=>Ir(r)&&!Cs(r));return t.collapsed&&o.getOr(!0)},nn=(e,t)=>(n,s)=>Tt(e,(r,a)=>r&&a(n,s),!0)?m.some(t):m.none(),Y8=(e,t)=>BS([nn([W8],Vt.none()),nn([ja(!0),V8],Vt.none()),nn([j8()],Vt.br()),nn([ja(!0),ql(!1),Kl],Vt.br()),nn([ja(!0),ql(!1)],Vt.block()),nn([ja(!0),ql(!0),Kl],Vt.block()),nn([ja(!0),ql(!0)],Vt.br()),nn([jw(!0),Kl],Vt.br()),nn([jw(!0)],Vt.block()),nn([q8],Vt.br()),nn([Kl],Vt.br()),nn([K8],Vt.block()),nn([G8],Vt.block())],[e,!!(t&&t.shiftKey)]).getOr(Vt.none()),Gl=(e,t,n)=>{t.mode.isReadOnly()||(t.selection.isCollapsed()||gI(t),!(U(n)&&Wl(t,e.fakeEventName).isDefaultPrevented())&&(e.insert(t,n),U(n)&&Ha(t,e.fakeEventName)))},Kw=(e,t)=>{if(e.mode.isReadOnly())return;const n=()=>Gl(Ww,e,t),s=()=>Gl(Uw,e,t),o=Y8(e,t);switch(ND(e)){case"linebreak":o.fold(n,n,ce);break;case"block":o.fold(s,s,ce);break;case"invert":o.fold(s,n,ce);break;default:o.fold(n,s,ce);break}},Gw=pn(),X8=Gw.os.isiOS()&&Gw.browser.isSafari(),Yw=(e,t)=>{t.isDefaultPrevented()||(t.preventDefault(),AM(e.undoManager),e.undoManager.transact(()=>{Kw(e,t)}))},Z8=e=>{if(!e.collapsed)return!1;const t=e.startContainer;if(I(t)){const n=/^[\uAC00-\uD7AF\u1100-\u11FF\u3130-\u318F\uA960-\uA97F\uD7B0-\uD7FF]$/,s=t.data.charAt(e.startOffset-1);return n.test(s)}else return!1},Q8=e=>{let t=m.none();const n=o=>{t=m.some(o.selection.getBookmark()),o.undoManager.add()},s=(o,r)=>{o.undoManager.undo(),t.fold(ce,a=>o.selection.moveToBookmark(a)),Yw(o,r),t=m.none()};e.on("keydown",o=>{o.keyCode===j.ENTER&&(X8&&Z8(e.selection.getRng())?n(e):Yw(e,o))}),e.on("keyup",o=>{o.keyCode===j.ENTER&&t.each(()=>s(e,o))})},J8=(e,t,n)=>{const s=Ce.os.isMacOS()||Ce.os.isiOS();Ua([{keyCode:j.END,action:te(R0,e,!0)},{keyCode:j.HOME,action:te(R0,e,!1)},...s?[]:[{keyCode:j.HOME,action:te(Fl,e,!1),ctrlKey:!0,shiftKey:!0},{keyCode:j.END,action:te(Fl,e,!0),ctrlKey:!0,shiftKey:!0}],{keyCode:j.END,action:te(L0,e,!0)},{keyCode:j.HOME,action:te(L0,e,!1)},{keyCode:j.END,action:te(Il,e,!0,t)},{keyCode:j.HOME,action:te(Il,e,!1,t)}],n).each(o=>{n.preventDefault()})},ej=(e,t)=>{e.on("keydown",n=>{n.isDefaultPrevented()||J8(e,t,n)})},tj=e=>{e.on("input",t=>{t.isComposing||KO(e)})},nj=pn(),sj=(e,t,n)=>{Ua([{keyCode:j.PAGE_UP,action:te(Il,e,!1,t)},{keyCode:j.PAGE_DOWN,action:te(Il,e,!0,t)}],n)},Xw=e=>e.stopImmediatePropagation(),Zw=e=>e.keyCode===j.PAGE_UP||e.keyCode===j.PAGE_DOWN,Qw=(e,t,n)=>{n&&!e.get()?t.on("NodeChange",Xw,!0):!n&&e.get()&&t.off("NodeChange",Xw),e.set(n)},oj=(e,t)=>{if(nj.os.isMacOS())return;const n=et(!1);e.on("keydown",s=>{Zw(s)&&Qw(n,e,!0)}),e.on("keyup",s=>{s.isDefaultPrevented()||sj(e,t,s),Zw(s)&&n.get()&&(Qw(n,e,!1),e.nodeChanged())})},Jw=(e,t)=>e===t||e.contains(t),rj=(e,t)=>!Jw(e.getBody(),t.startContainer)||!Jw(e.getBody(),t.endContainer)?!0:$C(e.dom,t),aj=e=>{e.on("beforeinput",t=>{(!e.selection.isEditable()||Be(t.getTargetRanges(),n=>!rj(e,n)))&&t.preventDefault()})},ek=(e,t)=>{const n=t.container(),s=t.offset();return I(n)?(n.insertData(s,e),m.some(N(n,s+e.length))):Vi(t).map(o=>{const r=C.fromText(e);return t.isAtEnd()?es(o,r):Dt(o,r),N(r.dom,e.length)})},tk=G(ek,Ze),nk=G(ek," "),ij=(e,t,n)=>yy(e,t,n)?tk(t):nk(t),lj=e=>t=>t.fold(n=>Pt(e.dom,N.before(n)),n=>mt(n),n=>ln(n),n=>xt(e.dom,N.after(n))),cj=(e,t,n)=>s=>yy(e,s,n)?tk(t):nk(t),sk=e=>t=>{e.selection.setRng(t.toRange()),e.nodeChanged()},uj=(e,t)=>e.isEditable(e.getParent(t,"summary")),fj=e=>{const t=N.fromRangeStart(e.selection.getRng()),n=C.fromDom(e.getBody());if(e.selection.isCollapsed()){const s=G(co,e),o=N.fromRangeStart(e.selection.getRng());return jn(s,e.getBody(),o).bind(lj(n)).map(r=>()=>cj(n,t,e.schema)(r).each(sk(e)))}else return m.none()},dj=e=>{const t=()=>{const n=C.fromDom(e.getBody());e.selection.isCollapsed()||e.getDoc().execCommand("Delete");const s=N.fromRangeStart(e.selection.getRng());ij(n,s,e.schema).each(sk(e))};return Ao(Ce.browser.isFirefox()&&e.selection.isEditable()&&uj(e.dom,e.selection.getRng().startContainer),t)},mj=(e,t)=>{O0([{keyCode:j.SPACEBAR,action:te(fj,e)},{keyCode:j.SPACEBAR,action:te(dj,e)}],t).each(n=>{t.preventDefault(),Wl(e,"insertText",{data:" "}).isDefaultPrevented()||(n(),Ha(e,"insertText",{data:" "}))})},gj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||mj(e,t)})},pj=e=>zP(e)?[{keyCode:j.TAB,action:te(ow,e,!0)},{keyCode:j.TAB,shiftKey:!0,action:te(ow,e,!1)}]:[],hj=(e,t)=>{Ua([...pj(e)],t).each(n=>{t.preventDefault()})},bj=e=>{e.on("keydown",t=>{t.isDefaultPrevented()||hj(e,t)})},Cj=e=>{if(e.addShortcut("Meta+P","","mcePrint"),K3(e),Vn(e))return et(null);{const t=$2(e);return aj(e),FW(e),GV(e,t),c8(e,t),Q8(e),gj(e),tj(e),bj(e),ej(e,t),oj(e,t),t}};class yj{constructor(t){this.lastPath=[],this.editor=t;let n;const s=this;"onselectionchange"in t.getDoc()||t.on("NodeChange click mouseup keyup focus",o=>{const r=t.selection.getRng(),a={startContainer:r.startContainer,startOffset:r.startOffset,endContainer:r.endContainer,endOffset:r.endOffset};(o.type==="nodechange"||!yf(a,n))&&t.dispatch("SelectionChange"),n=a}),t.on("contextmenu",()=>{Ji(t),t.dispatch("SelectionChange")}),t.on("SelectionChange",()=>{const o=t.selection.getStart(!0);o&&Yi(t)&&!s.isSameElementPath(o)&&t.dom.isChildOf(o,t.getBody())&&t.nodeChanged({selectionChange:!0})}),t.on("mouseup",o=>{!o.isDefaultPrevented()&&Yi(t)&&(t.selection.getNode().nodeName==="IMG"?Jt.setEditorTimeout(t,()=>{t.nodeChanged()}):t.nodeChanged())})}nodeChanged(t={}){const n=this.editor,s=n.selection;let o;if(n.initialized&&s&&!iP(n)&&!Hi(n)){const r=n.getBody();o=s.getStart(!0)||r,(o.ownerDocument!==n.getDoc()||!n.dom.isChildOf(o,r))&&(o=r);const a=[];n.dom.getParent(o,i=>i===r?!0:(a.push(i),!1)),n.dispatch("NodeChange",{...t,element:o,parents:a})}}isSameElementPath(t){let n;const s=this.editor,o=kr(s.dom.getParents(t,Ue,s.getBody()));if(o.length===this.lastPath.length){for(n=o.length;n>=0&&o[n]===this.lastPath[n];n--);if(n===-1)return this.lastPath=o,!0}return this.lastPath=o,!1}}const ok="x-tinymce/html",Yl=W(ok),Sm="<!-- "+ok+" -->",vj=e=>Sm+e,Ej=e=>e.replace(Sm,""),rk=e=>e.indexOf(Sm)!==-1,Sj=e=>!/<(?:\/?(?!(?:div|p|br|span)>)\w+|(?:(?!(?:span style="white-space:\s?pre;?">)|br\s?\/>))\w+\s[^>]+)>/i.test(e),wj=(e,t)=>{let n="<"+e;const s=ai(t,(o,r)=>r+'="'+Gs.encodeAllRaw(o)+'"');return s.length&&(n+=" "+s.join(" ")),n+">"},kj=(e,t,n)=>{const s=e.split(/\n\n/),o=wj(t,n),r="</"+t+">",a=he(s,l=>l.split(/\n/).join("<br />")),i=l=>o+l+r;return a.length===1?a[0]:he(a,i).join("")},ak="%MCEPASTEBIN%",_j=(e,t)=>{const{dom:n,selection:s}=e,o=e.getBody();t.set(s.getRng());const r=n.add(e.getBody(),"div",{id:"mcepastebin",class:"mce-pastebin",contentEditable:!0,"data-mce-bogus":"all",style:"position: fixed; top: 50%; width: 10px; height: 10px; overflow: hidden; opacity: 0"},ak);Ce.browser.isFirefox()&&n.setStyle(r,"left",n.getStyle(o,"direction",!0)==="rtl"?65535:-65535),n.bind(r,"beforedeactivate focusin focusout",a=>{a.stopPropagation()}),r.focus(),s.select(r,!0)},Aj=(e,t)=>{const n=e.dom;if(wm(e)){let s;const o=t.get();for(;s=wm(e);)n.remove(s),n.unbind(s);o&&e.selection.setRng(o)}t.set(null)},wm=e=>e.dom.get("mcepastebin"),xj=e=>U(e)&&e.id==="mcepastebin",Nj=e=>{const t=e.dom,n=(a,i)=>{a.appendChild(i),t.remove(i,!0)},[s,...o]=ne(e.getBody().childNodes,xj);D(o,a=>{n(s,a)});const r=t.select("div[id=mcepastebin]",s);for(let a=r.length-1;a>=0;a--){const i=t.create("div");s.insertBefore(i,r[a]),n(i,r[a])}return s?s.innerHTML:""},ik=e=>e===ak,Rj=e=>{const t=et(null);return{create:()=>_j(e,t),remove:()=>Aj(e,t),getEl:()=>wm(e),getHtml:()=>Nj(e),getLastRng:t.get}},lk=(e,t)=>(L.each(t,n=>{ni(n,RegExp)?e=e.replace(n,""):e=e.replace(n[0],n[1])}),e),Tj=e=>{const t=vs(),n=nr({},t);let s="";const o=t.getVoidElements(),r=L.makeMap("script noscript style textarea video audio iframe object"," "),a=t.getBlockElements(),i=l=>{const c=l.name,u=l;if(c==="br"){s+=`
`;return}if(c!=="wbr"){if(o[c]&&(s+=" "),r[c]){s+=" ";return}if(l.type===3&&(s+=l.value),!(l.name in t.getVoidElements())){let f=l.firstChild;if(f)do i(f);while(f=f.next)}a[c]&&u.next&&(s+=`
`,c==="p"&&(s+=`
`))}};return e=lk(e,[/<!\[[^\]]+\]>/g]),i(n.parse(e)),s},ck=e=>(e=lk(e,[/^[\s\S]*<body[^>]*>\s*|\s*<\/body[^>]*>[\s\S]*$/ig,/<!--StartFragment-->|<!--EndFragment-->/g,[/( ?)<span class="Apple-converted-space">\u00a0<\/span>( ?)/g,(n,s,o)=>!s&&!o?" ":Ze],/<br class="Apple-interchange-newline">/g,/<br>$/i]),e),Dj=e=>{let t=0;return()=>e+t++},Pj=e=>{const t=e.toLowerCase(),n={jpg:"jpeg",jpe:"jpeg",jfi:"jpeg",jif:"jpeg",jfif:"jpeg",pjpeg:"jpeg",pjp:"jpeg",svg:"svg+xml"};return L.hasOwn(n,t)?"image/"+n[t]:"image/"+t},Bj=(e,t)=>{const n=nr({sanitize:Eb(e),sandbox_iframes:wb(e),sandbox_iframes_exclusions:Hu(e),convert_unsafe_embeds:VP(e)},e.schema);n.addNodeFilter("meta",o=>{L.each(o,r=>{r.remove()})});const s=n.parse(t,{forced_root_block:!1,isRootContent:!0});return xs({validate:!0},e.schema).serialize(s)},uk=(e,t)=>({content:e,cancelled:t}),Oj=(e,t,n)=>{const s=e.dom.create("div",{style:"display:none"},t),o=hD(e,s,n);return uk(o.node.innerHTML,o.isDefaultPrevented())},Ij=(e,t,n)=>{const s=pD(e,t,n),o=Bj(e,s.content);return e.hasEventListeners("PastePostProcess")&&!s.isDefaultPrevented()?Oj(e,o,n):uk(o,s.isDefaultPrevented())},Fj=(e,t,n)=>Ij(e,t,n),km=(e,t)=>(e.insertContent(t,{merge:_P(e),paste:!0}),!0),_m=e=>/^https?:\/\/[\w\-\/+=.,!;:&%@^~(){}?#]+$/i.test(e),Lj=(e,t)=>_m(t)&&Be(Sb(e),n=>Sc(t.toLowerCase(),`.${n.toLowerCase()}`)),$j=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.insertContent('<img src="'+t+'">')}),!0),Mj=(e,t,n)=>(e.undoManager.extra(()=>{n(e,t)},()=>{e.execCommand("mceInsertLink",!1,t)}),!0),Uj=(e,t,n)=>!e.selection.isCollapsed()&&_m(t)?Mj(e,t,n):!1,zj=(e,t,n)=>Lj(e,t)?$j(e,t,n):!1,Hj=(e,t)=>{L.each([Uj,zj,km],n=>!n(e,t,km))},Wj=(e,t,n)=>{n||!AP(e)?km(e,t):Hj(e,t)},Vj=Dj("mceclip"),jj=e=>{const t=lm();return G0(t,e),im(t),t},fk=(e,t,n,s,o)=>{const r=Fj(e,t,n);if(!r.cancelled){const a=r.content,i=()=>Wj(e,a,s);o?Wl(e,"insertFromPaste",{dataTransfer:jj(a)}).isDefaultPrevented()||(i(),Ha(e,"insertFromPaste")):i()}},Xl=(e,t,n,s)=>{const o=n||rk(t);fk(e,Ej(t),o,!1,s)},Am=(e,t,n)=>{const s=e.dom.encode(t).replace(/\r\n/g,`
`),o=Dp(s,NP(e)),r=kj(o,dt(e),ia(e));fk(e,r,!1,!0,n)},dk=e=>{const t={};if(e&&e.types)for(let n=0;n<e.types.length;n++){const s=e.types[n];try{t[s]=e.getData(s)}catch{t[s]=""}}return t},Ps=(e,t)=>t in e&&e[t].length>0,mk=e=>Ps(e,"text/html")||Ps(e,"text/plain"),qj=(e,t)=>{const n=t.match(/([\s\S]+?)(?:\.[a-z0-9.]+)$/i);return U(n)?e.dom.encode(n[1]):void 0},Kj=(e,t,n,s)=>{const o=Vj(),r=cb(e)&&U(n.name),a=r?qj(e,n.name):o,i=r?n.name:void 0,l=t.create(o,n,s,a,i);return t.add(l),l},Gj=(e,t)=>{cd(t.uri).each(({data:n,type:s,base64Encoded:o})=>{const r=o?n:btoa(n),a=t.file,i=e.editorUpload.blobCache,l=i.getByData(r,s),c=l??Kj(e,i,a,r);Xl(e,`<img src="${c.blobUri()}">`,!1,!0)})},Yj=e=>e.type==="paste",Xj=e=>Promise.all(he(e,t=>Wv(t).then(n=>({file:t,uri:n})))),Zj=e=>{const t=Sb(e);return n=>Xe(n.type,"image/")&&Be(t,s=>Pj(s)===n.type)},Qj=(e,t)=>{const n=t.items?Kt(Lt(t.items),o=>o.kind==="file"?[o.getAsFile()]:[]):[],s=t.files?Lt(t.files):[];return ne(n.length>0?n:s,Zj(e))},gk=(e,t,n)=>{const s=Yj(t)?t.clipboardData:t.dataTransfer;if(zi(e)&&s){const o=Qj(e,s);if(o.length>0)return t.preventDefault(),Xj(o).then(r=>{n&&e.selection.setRng(n),D(r,a=>{Gj(e,a)})}),!0}return!1},Jj=e=>{var t,n;return Ce.os.isAndroid()&&((n=(t=e.clipboardData)===null||t===void 0?void 0:t.items)===null||n===void 0?void 0:n.length)===0},e4=e=>j.metaKeyPressed(e)&&e.keyCode===86||e.shiftKey&&e.keyCode===45,xm=(e,t,n,s,o)=>{let r=ck(n);const a=Ps(t,Yl())||rk(n),i=!a&&Sj(r),l=_m(r);(ik(r)||!r.length||i&&!l)&&(s=!0),(s||l)&&(Ps(t,"text/plain")&&i?r=t["text/plain"]:r=Tj(r)),!ik(r)&&(s?Am(e,r,o):Xl(e,r,a,o))},t4=(e,t,n)=>{let s;const o=()=>t.getLastRng()||e.selection.getRng();e.on("keydown",r=>{e4(r)&&!r.isDefaultPrevented()&&(s=r.shiftKey&&r.keyCode===86)}),e.on("paste",r=>{if(r.isDefaultPrevented()||Jj(r))return;const a=n.get()==="text"||s;s=!1;const i=dk(r.clipboardData);!mk(i)&&gk(e,r,o())||(Ps(i,"text/html")?(r.preventDefault(),xm(e,i,i["text/html"],a,!0)):Ps(i,"text/plain")&&Ps(i,"text/uri-list")?(r.preventDefault(),xm(e,i,i["text/plain"],a,!0)):(t.create(),Jt.setEditorTimeout(e,()=>{const l=t.getHtml();t.remove(),xm(e,i,l,a,!1)},0)))})},n4=e=>{const t=o=>Xe(o,"webkit-fake-url"),n=o=>Xe(o,"data:"),s=o=>{var r;return((r=o.data)===null||r===void 0?void 0:r.paste)===!0};e.parser.addNodeFilter("img",(o,r,a)=>{if(!zi(e)&&s(a))for(const i of o){const l=i.attr("src");J(l)&&!i.attr("data-mce-object")&&l!==Ce.transparentSrc&&(t(l)||!RP(e)&&n(l))&&i.remove()}})},s4=(e,t,n)=>{t4(e,t,n),n4(e)},o4=(e,t)=>{t.get()==="text"?(t.set("html"),sb(e,!1)):(t.set("text"),sb(e,!0)),e.focus()},r4=(e,t)=>{e.addCommand("mceTogglePlainTextPaste",()=>{o4(e,t)}),e.addCommand("mceInsertClipboardContent",(n,s)=>{s.html&&Xl(e,s.html,s.internal,!1),s.text&&Am(e,s.text,!1)})},a4=(e,t,n)=>{if(e)try{return e.clearData(),e.setData("text/html",t),e.setData("text/plain",n),e.setData(Yl(),t),!0}catch{return!1}else return!1},pk=(e,t,n,s)=>{a4(e.clipboardData,t.html,t.text)?(e.preventDefault(),s()):n(t.html,s)},hk=e=>(t,n)=>{const{dom:s,selection:o}=e,r=s.create("div",{contenteditable:"false","data-mce-bogus":"all"}),a=s.create("div",{contenteditable:"true"},t);s.setStyles(r,{position:"fixed",top:"0",left:"-3000px",width:"1000px",overflow:"hidden"}),r.appendChild(a),s.add(e.getBody(),r);const i=o.getRng();a.focus();const l=s.createRng();l.selectNodeContents(a),o.setRng(l),Jt.setEditorTimeout(e,()=>{o.setRng(i),s.remove(r),n()},0)},bk=e=>({html:vj(e.selection.getContent({contextual:!0})),text:e.selection.getContent({format:"text"})}),i4=e=>!!e.dom.getParent(e.selection.getStart(),"td[data-mce-selected],th[data-mce-selected]",e.getBody()),Ck=e=>!e.selection.isCollapsed()||i4(e),l4=e=>t=>{!t.isDefaultPrevented()&&Ck(e)&&e.selection.isEditable()&&pk(t,bk(e),hk(e),()=>{if(Ce.browser.isChromium()||Ce.browser.isFirefox()){const n=e.selection.getRng();Jt.setEditorTimeout(e,()=>{e.selection.setRng(n),e.execCommand("Delete")},0)}else e.execCommand("Delete")})},c4=e=>t=>{!t.isDefaultPrevented()&&Ck(e)&&pk(t,bk(e),hk(e),ce)},u4=e=>{e.on("cut",l4(e)),e.on("copy",c4(e))},yk=(e,t)=>{var n,s;return io.getCaretRangeFromPoint((n=t.clientX)!==null&&n!==void 0?n:0,(s=t.clientY)!==null&&s!==void 0?s:0,e.getDoc())},f4=e=>{const t=e["text/plain"];return t?t.indexOf("file://")===0:!1},vk=(e,t)=>{e.focus(),t&&e.selection.setRng(t)},d4=e=>Be(e.files,t=>/^image\//.test(t.type)),m4=(e,t,n,s)=>{const o=e.getParent(n,a=>qs(t,a));if(!bt(e.getParent(n,"summary")))return!0;if(o&&se(s,"text/html")){const a=new DOMParser().parseFromString(s["text/html"],"text/html").body;return!bt(a.querySelector(o.nodeName.toLowerCase()))}else return!1},g4=e=>{e.on("input",t=>{const n=s=>bt(s.querySelector("summary"));if(t.inputType==="deleteByDrag"){const s=ne(e.dom.select("details"),n);D(s,o=>{Ie(o.firstChild)&&o.firstChild.remove();const r=e.dom.create("summary");r.appendChild(zo().dom),o.prepend(r)})}})},p4=(e,t)=>{yP(e)&&e.on("dragend dragover draggesture dragdrop drop drag",n=>{n.preventDefault(),n.stopPropagation()}),zi(e)||e.on("drop",n=>{const s=n.dataTransfer;s&&d4(s)&&n.preventDefault()}),e.on("drop",n=>{if(n.isDefaultPrevented())return;const s=yk(e,n);if(Ve(s))return;const o=dk(n.dataTransfer),r=Ps(o,Yl());if((!mk(o)||f4(o))&&gk(e,n,s))return;const a=o[Yl()],i=a||o["text/html"]||o["text/plain"],l=m4(e.dom,e.schema,s.startContainer,o),c=t.get();c&&!l||i&&(n.preventDefault(),Jt.setEditorTimeout(e,()=>{e.undoManager.transact(()=>{(a||c&&l)&&e.execCommand("Delete"),vk(e,s);const u=ck(i);o["text/html"]?Xl(e,u,r,!0):Am(e,u,!0)})}))}),e.on("dragstart",n=>{t.set(!0)}),e.on("dragover dragend",n=>{zi(e)&&!t.get()&&(n.preventDefault(),vk(e,yk(e,n))),n.type==="dragend"&&t.set(!1)}),g4(e)},h4=e=>{const t=o=>r=>{o(e,r)},n=vP(e);we(n)&&e.on("PastePreProcess",t(n));const s=EP(e);we(s)&&e.on("PastePostProcess",t(s))},b4=(e,t)=>{e.on("PastePreProcess",n=>{n.content=t(e,n.content,n.internal)})},C4=/rgb\s*\(\s*([0-9]+)\s*,\s*([0-9]+)\s*,\s*([0-9]+)\s*\)/gi,Ek=e=>L.trim(e).replace(C4,Gr).toLowerCase(),y4=(e,t,n)=>{const s=wP(e);if(n||s==="all"||!kP(e))return t;const o=s?s.split(/[, ]/):[];if(o&&s!=="none"){const r=e.dom,a=e.selection.getNode();t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,(i,l,c,u)=>{const f=r.parseStyle(r.decode(c)),d={};for(let h=0;h<o.length;h++){const p=f[o[h]];let b=p,y=r.getStyle(a,o[h],!0);/color/.test(o[h])&&(b=Ek(b),y=Ek(y)),y!==b&&(d[o[h]]=p)}const g=r.serializeStyle(d,"span");return g?l+' style="'+g+'"'+u:l+u})}else t=t.replace(/(<[^>]+) style="([^"]*)"([^>]*>)/gi,"$1$3");return t=t.replace(/(<[^>]+) data-mce-style="([^"]+)"([^>]*>)/gi,(r,a,i,l)=>a+' style="'+i+'"'+l),t},v4=e=>{(Ce.browser.isChromium()||Ce.browser.isSafari())&&b4(e,y4)},E4=e=>{const t=et(!1),n=et(xP(e)?"text":"html"),s=Rj(e);v4(e),r4(e,n),h4(e),e.addQueryStateHandler("mceTogglePlainTextPaste",()=>n.get()==="text"),e.on("PreInit",()=>{u4(e),p4(e,t),s4(e,s,n)})},S4=e=>{e.on("click",t=>{e.dom.getParent(t.target,"details")&&t.preventDefault()})},w4=e=>{e.parser.addNodeFilter("details",t=>{const n=HP(e);D(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})}),e.serializer.addNodeFilter("details",t=>{const n=WP(e);D(t,s=>{n==="expanded"?s.attr("open","open"):n==="collapsed"&&s.attr("open",null)})})},k4=e=>{S4(e),w4(e)},_4=Ie,Sk=I,A4=e=>xe(e.dom),x4=e=>an(e.dom),wk=e=>t=>Ee(C.fromDom(e),t),N4=(e,t,n)=>bs(C.fromDom(e),s=>x4(s)||n.isBlock(be(s)),wk(t)).getOr(C.fromDom(t)).dom,kk=(e,t)=>bs(C.fromDom(e),A4,wk(t)),_k=(e,t,n)=>{const s=new tt(e,t),o=n?s.next.bind(s):s.prev.bind(s);let r=e;for(let a=n?e:o();a&&!_4(a);a=o())En(a)&&(r=a);return r},R4=(e,t,n)=>{const o=N.fromRangeStart(e).getNode(),r=N4(o,t,n),a=_k(o,r,!1),i=_k(o,r,!0),l=document.createRange();return kk(a,r).fold(()=>{Sk(a)?l.setStart(a,0):l.setStartBefore(a)},c=>l.setStartBefore(c.dom)),kk(i,r).fold(()=>{Sk(i)?l.setEnd(i,i.data.length):l.setEndAfter(i)},c=>l.setEndAfter(c.dom)),l},T4=e=>{const t=R4(e.selection.getRng(),e.getBody(),e.schema);e.selection.setRng(Gf(t))},D4=e=>{e.on("mousedown",t=>{t.detail>=3&&(t.preventDefault(),T4(e))})};var cr;(function(e){e.Before="before",e.After="after"})(cr||(cr={}));const P4=(e,t)=>Math.abs(e.left-t),B4=(e,t)=>Math.abs(e.right-t),O4=(e,t)=>e>=t.top&&e<=t.bottom,I4=(e,t)=>e.top<t.bottom&&e.bottom>t.top,F4=(e,t)=>{const n=mT(e,t)/Math.min(e.height,t.height);return I4(e,t)&&n>.5},L4=(e,t)=>{const n=ne(e,s=>O4(t,s));return dT(n).fold(()=>[[],e],s=>{const{pass:o,fail:r}=So(e,a=>F4(a,s));return[o,r]})},$4=(e,t)=>({node:e.node,position:P4(e,t)<B4(e,t)?cr.Before:cr.After}),M4=(e,t,n)=>t>e.left&&t<e.right?0:Math.min(Math.abs(e.left-t),Math.abs(e.right-t)),Nm=(e,t,n,s)=>{const o=f=>En(f.node)?m.some(f):q(f.node)?Nm(Lt(f.node.childNodes),t,n,!1):m.none(),r=(f,d,g)=>o(d).filter(h=>Math.abs(g(f,t,n)-g(h,t,n))<2&&I(h.node)),a=(f,d)=>{const g=$s(f,(h,p)=>d(h,t,n)-d(p,t,n));return wo(g,o).map(h=>s&&!I(h.node)&&g.length>1?r(h,g[1],d).getOr(h):h)},[i,l]=L4(GS(e),n),{pass:c,fail:u}=So(l,f=>f.top<n);return a(i,M4).orThunk(()=>a(u,_h)).orThunk(()=>a(c,_h))},U4=(e,t,n,s)=>{const o=(r,a)=>{const i=c=>q(c)&&c.classList.contains("mce-drag-container"),l=ne(r.dom.childNodes,vr(i));return a.fold(()=>Nm(l,n,s,!0),c=>{const u=ne(l,f=>f!==c.dom);return Nm(u,n,s,!0)}).orThunk(()=>(Ee(r,e)?m.none():$r(r)).bind(u=>o(u,m.some(r))))};return o(t,m.none())},z4=(e,t,n)=>{const s=C.fromDom(e),o=ms(s),a=C.fromPoint(o,t,n).filter(i=>bn(s,i)).getOr(s);return U4(s,a,t,n)},Ak=(e,t,n)=>z4(e,t,n).filter(s=>ua(s.node)).map(s=>$4(s,t)),xk=e=>{var t,n;const s=e.getBoundingClientRect(),o=e.ownerDocument,r=o.documentElement,a=o.defaultView;return{top:s.top+((t=a==null?void 0:a.scrollY)!==null&&t!==void 0?t:0)-r.clientTop,left:s.left+((n=a==null?void 0:a.scrollX)!==null&&n!==void 0?n:0)-r.clientLeft}},H4=e=>e.inline?xk(e.getBody()):{left:0,top:0},W4=e=>{const t=e.getBody();return e.inline?{left:t.scrollLeft,top:t.scrollTop}:{left:0,top:0}},V4=e=>{const t=e.getBody(),n=e.getDoc().documentElement,s={left:t.scrollLeft,top:t.scrollTop},o={left:t.scrollLeft||n.scrollLeft,top:t.scrollTop||n.scrollTop};return e.inline?s:o},j4=(e,t)=>{if(t.target.ownerDocument!==e.getDoc()){const n=xk(e.getContentAreaContainer()),s=V4(e);return{left:t.pageX-n.left+s.left,top:t.pageY-n.top+s.top}}return{left:t.pageX,top:t.pageY}},q4=(e,t,n)=>({pageX:n.left-e.left+t.left,pageY:n.top-e.top+t.top}),K4=(e,t)=>q4(H4(e),W4(e),j4(e,t)),Nk=e=>({target:e,srcElement:e}),G4=(e,t,n,s)=>({...t,dataTransfer:s,type:e,...Nk(n)}),Y4=(e,t,n)=>{const s=Jm("Function not supported on simulated event.");return{bubbles:!0,cancelBubble:!1,cancelable:!0,composed:!1,currentTarget:null,defaultPrevented:!1,eventPhase:0,isTrusted:!0,returnValue:!1,timeStamp:0,type:e,composedPath:s,initEvent:s,preventDefault:ce,stopImmediatePropagation:ce,stopPropagation:ce,AT_TARGET:window.Event.AT_TARGET,BUBBLING_PHASE:window.Event.BUBBLING_PHASE,CAPTURING_PHASE:window.Event.CAPTURING_PHASE,NONE:window.Event.NONE,altKey:!1,button:0,buttons:0,clientX:0,clientY:0,ctrlKey:!1,layerX:0,layerY:0,metaKey:!1,movementX:0,movementY:0,offsetX:0,offsetY:0,pageX:0,pageY:0,relatedTarget:null,screenX:0,screenY:0,shiftKey:!1,x:0,y:0,detail:0,view:null,which:0,initUIEvent:s,initMouseEvent:s,getModifierState:s,dataTransfer:n,...Nk(t)}},X4=(e,t)=>{const n=yV(e);return t==="dragstart"?(W0(n),j0(n)):t==="drop"?(uV(n),im(n)):(fV(n),pV(n)),n},Z4=(e,t,n,s)=>{const o=X4(n,e);return st(s)?Y4(e,t,o):G4(e,s,t,o)},Zl=32,Q4=100,Ql=8,Jl=16,Rk=xe,J4=hT(Rk,an),eq=(e,t,n)=>Rk(n)&&n!==t&&e.isEditable(n.parentElement),tq=(e,t,n)=>Ve(t)||t===n||e.dom.isChildOf(t,n)?!1:e.dom.isEditable(t),nq=(e,t,n,s)=>{const o=e.dom,r=t.cloneNode(!0);o.setStyles(r,{width:n,height:s}),o.setAttrib(r,"data-mce-selected",null);const a=o.create("div",{class:"mce-drag-container","data-mce-bogus":"all",unselectable:"on",contenteditable:"false"});return o.setStyles(a,{position:"absolute",opacity:.5,overflow:"hidden",border:0,padding:0,margin:0,width:n,height:s}),o.setStyles(r,{margin:0,boxSizing:"border-box"}),a.appendChild(r),a},sq=(e,t)=>{e.parentNode!==t&&t.appendChild(e)},ec=(e,t)=>n=>()=>{const s=e==="left"?n.scrollX:n.scrollY;n.scroll({[e]:s+t,behavior:"smooth"})},Tk=ec("left",-Zl),Dk=ec("left",Zl),Pk=ec("top",-Zl),Bk=ec("top",Zl),oq=(e,t,n,s,o,r,a,i,l,c,u,f)=>{let d=0,g=0;e.style.left=t.pageX+"px",e.style.top=t.pageY+"px",t.pageX+n>o&&(d=t.pageX+n-o),t.pageY+s>r&&(g=t.pageY+s-r),e.style.width=n-d+"px",e.style.height=s-g+"px";const h=l.clientHeight,p=l.clientWidth,b=a+l.getBoundingClientRect().top,y=i+l.getBoundingClientRect().left;u.on(v=>{v.intervalId.clear(),v.dragging&&f&&(a+Ql>=h?v.intervalId.set(Bk(c)):a-Ql<=0?v.intervalId.set(Pk(c)):i+Ql>=p?v.intervalId.set(Dk(c)):i-Ql<=0?v.intervalId.set(Tk(c)):b+Jl>=window.innerHeight?v.intervalId.set(Bk(window)):b-Jl<=0?v.intervalId.set(Pk(window)):y+Jl>=window.innerWidth?v.intervalId.set(Dk(window)):y-Jl<=0&&v.intervalId.set(Tk(window)))})},Ok=e=>{e&&e.parentNode&&e.parentNode.removeChild(e)},rq=(e,t)=>{const n=e.getParent(t.parentNode,e.isBlock);Ok(t),n&&n!==e.getRoot()&&e.isEmpty(n)&&Es(C.fromDom(n))},aq=e=>e.button===0,iq=(e,t)=>({pageX:t.pageX-e.relX,pageY:t.pageY+5}),lq=(e,t)=>n=>{if(aq(n)){const s=Ye(t.dom.getParents(n.target),J4).getOr(null);if(U(s)&&eq(t.dom,t.getBody(),s)){const o=t.dom.getPos(s),r=t.getBody(),a=t.getDoc().documentElement;e.set({element:s,dataTransfer:lm(),dragging:!1,screenX:n.screenX,screenY:n.screenY,maxX:(t.inline?r.scrollWidth:a.offsetWidth)-2,maxY:(t.inline?r.scrollHeight:a.offsetHeight)-2,relX:n.pageX-o.x,relY:n.pageY-o.y,width:s.offsetWidth,height:s.offsetHeight,ghost:nq(t,s,s.offsetWidth,s.offsetHeight),intervalId:dA(Q4)})}}},cq=(e,t,n)=>{e._selectionOverrides.hideFakeCaret(),Ak(e.getBody(),t,n).fold(()=>e.selection.placeCaretAt(t,n),s=>{const o=e._selectionOverrides.showCaret(1,s.node,s.position===cr.Before,!1);o?e.selection.setRng(o):e.selection.placeCaretAt(t,n)})},qa=(e,t,n,s,o)=>{t==="dragstart"&&G0(s,e.dom.getOuterHTML(n));const r=Z4(t,n,s,o);return e.dispatch(t,r)},uq=(e,t)=>{const n=ci((o,r)=>cq(t,o,r),0);t.on("remove",n.cancel);const s=e;return o=>e.on(r=>{const a=Math.max(Math.abs(o.screenX-r.screenX),Math.abs(o.screenY-r.screenY));if(!r.dragging&&a>10){const i=qa(t,"dragstart",r.element,r.dataTransfer,o);if(U(i.dataTransfer)&&(r.dataTransfer=i.dataTransfer),i.isDefaultPrevented())return;r.dragging=!0,t.focus()}if(r.dragging){const i=o.currentTarget===t.getDoc().documentElement,l=iq(r,K4(t,o));sq(r.ghost,t.getBody()),oq(r.ghost,l,r.width,r.height,r.maxX,r.maxY,o.clientY,o.clientX,t.getContentAreaContainer(),t.getWin(),s,i),n.throttle(o.clientX,o.clientY)}})},fq=e=>{const t=e.getSel();if(U(t)){const s=t.getRangeAt(0).startContainer;return I(s)?s.parentNode:s}else return null},dq=(e,t)=>n=>{e.on(s=>{var o;if(s.intervalId.clear(),s.dragging){if(tq(t,fq(t.selection),s.element)){const r=(o=t.getDoc().elementFromPoint(n.clientX,n.clientY))!==null&&o!==void 0?o:t.getBody();qa(t,"drop",r,s.dataTransfer,n).isDefaultPrevented()||t.undoManager.transact(()=>{rq(t.dom,s.element),vV(s.dataTransfer).each(i=>t.insertContent(i)),t._selectionOverrides.hideFakeCaret()})}qa(t,"dragend",t.getBody(),s.dataTransfer,n)}}),Fk(e)},Ik=(e,t,n)=>{e.on(s=>{s.intervalId.clear(),s.dragging&&n.fold(()=>qa(t,"dragend",s.element,s.dataTransfer),o=>qa(t,"dragend",s.element,s.dataTransfer,o))}),Fk(e)},mq=(e,t)=>n=>Ik(e,t,m.some(n)),Fk=e=>{e.on(t=>{t.intervalId.clear(),Ok(t.ghost)}),e.clear()},gq=e=>{const t=Qn(),n=_e.DOM,s=document,o=lq(t,e),r=uq(t,e),a=dq(t,e),i=mq(t,e);e.on("mousedown",o),e.on("mousemove",r),e.on("mouseup",a),n.bind(s,"mousemove",r),n.bind(s,"mouseup",i),e.on("remove",()=>{n.unbind(s,"mousemove",r),n.unbind(s,"mouseup",i)}),e.on("keydown",l=>{l.keyCode===j.ESC&&Ik(t,e,m.none())})},pq=e=>{const t=o=>{if(!o.isDefaultPrevented()){const r=o.dataTransfer;r&&(Se(r.types,"Files")||r.files.length>0)&&(o.preventDefault(),o.type==="drop"&&xl(e,"Dropped file type is not supported"))}},n=o=>{el(e,o.target)&&t(o)},s=()=>{const o=_e.DOM,r=e.dom,a=document,i=e.inline?e.getBody():e.getDoc(),l=["drop","dragover"];D(l,c=>{o.bind(a,c,n),r.bind(i,c,t)}),e.on("remove",()=>{D(l,c=>{o.unbind(a,c,n),r.unbind(i,c,t)})})};e.on("init",()=>{Jt.setEditorTimeout(e,s,0)})},hq=e=>{gq(e),uP(e)&&pq(e)},bq=e=>{const t=ci(()=>{if(!e.removed&&e.getBody().contains(document.activeElement)){const n=e.selection.getRng();if(n.collapsed){const s=Ld(e,n,!1);e.selection.setRng(s)}}},0);e.on("focus",()=>{t.throttle()}),e.on("blur",()=>{t.cancel()})},Cq=e=>{e.on("init",()=>{e.on("focusin",t=>{const n=t.target;if($n(n)){const s=uo(e.getBody(),n),o=xe(s)?s:n;e.selection.getNode()!==o&&Fa(e,o).each(r=>e.selection.setRng(r))}})})},Ka=xe,Lk=(e,t)=>uo(e.getBody(),t),yq=e=>{const t=e.selection,n=e.dom,s=e.getBody(),o=oB(e,s,n.isBlock,()=>er(e)),r="sel-"+n.uniqueId(),a="data-mce-selected";let i;const l=H=>U(H)&&n.hasClass(H,"mce-offscreen-selection"),c=H=>H!==s&&(Ka(H)||$n(H))&&n.isChildOf(H,s)&&n.isEditable(H.parentNode),u=H=>{H&&t.setRng(H)},f=(H,x,_,P=!0)=>e.dispatch("ShowCaret",{target:x,direction:H,before:_}).isDefaultPrevented()?null:(P&&t.scrollIntoView(x,H===-1),o.show(_,x)),d=H=>{H.hasAttribute("data-mce-caret")&&(Au(H),t.scrollIntoView(H))},g=()=>{e.on("click",x=>{n.isEditable(x.target)||(x.preventDefault(),e.focus())}),e.on("blur NewBlock",w),e.on("ResizeWindow FullscreenStateChanged",o.reposition),e.on("tap",x=>{const _=x.target,P=Lk(e,_);Ka(P)?(x.preventDefault(),Fa(e,P).each(E)):c(_)&&Fa(e,_).each(E)},!0),e.on("mousedown",x=>{const _=x.target;if(_!==s&&_.nodeName!=="HTML"&&!n.isChildOf(_,s)||!fz(e,x.clientX,x.clientY))return;w(),B();const P=Lk(e,_);Ka(P)?(x.preventDefault(),Fa(e,P).each(E)):Ak(s,x.clientX,x.clientY).each(z=>{x.preventDefault();const X=f(1,z.node,z.position===cr.Before,!1);u(X),Fn(P)?P.focus():e.getBody().focus()})}),e.on("keypress",x=>{j.modifierPressed(x)||Ka(t.getNode())&&x.preventDefault()}),e.on("GetSelectionRange",x=>{let _=x.range;if(i){if(!i.parentNode){i=null;return}_=_.cloneRange(),_.selectNode(i),x.range=_}}),e.on("focusin",x=>{if(o.isShowing()&&e.getBody().contains(x.target)&&x.target!==e.getBody()&&!e.dom.isEditable(x.target.parentNode)){o.hide(),x.target.contains(e.selection.getNode())||(e.selection.select(x.target,!0),e.selection.collapse(!0));const _=E(e.selection.getRng(),!0);_&&e.selection.setRng(_)}}),e.on("SetSelectionRange",x=>{x.range=b(x.range);const _=E(x.range,x.forward);_&&(x.range=_)});const H=x=>q(x)&&x.id==="mcepastebin";e.on("AfterSetSelectionRange",x=>{const _=x.range,P=_.startContainer.parentElement;!p(_)&&!H(P)&&B(),l(P)||w()}),hq(e),bq(e),Cq(e)},h=H=>Gt(H)||Bi(H)||Oi(H),p=H=>h(H.startContainer)||h(H.endContainer),b=H=>{const x=e.schema.getVoidElements(),_=n.createRng(),P=H.startContainer,z=H.startOffset,X=H.endContainer,oe=H.endOffset;return se(x,P.nodeName.toLowerCase())?z===0?_.setStartBefore(P):_.setStartAfter(P):_.setStart(P,z),se(x,X.nodeName.toLowerCase())?oe===0?_.setEndBefore(X):_.setEndAfter(X):_.setEnd(X,oe),_},y=(H,x)=>{const _=C.fromDom(e.getBody()),P=e.getDoc(),z=Ci(_,"#"+r).getOrThunk(()=>{const ae=C.fromHtml('<div data-mce-bogus="all" class="mce-offscreen-selection"></div>',P);return ot(ae,"id",r),je(_,ae),ae}),X=n.createRng();Ro(z),zs(z,[C.fromText(Ze,P),C.fromDom(x),C.fromText(Ze,P)]),X.setStart(z.dom.firstChild,1),X.setEnd(z.dom.lastChild,0),pi(z,{top:n.getPos(H,e.getBody()).y+"px"}),sp(z);const oe=t.getSel();return oe&&(oe.removeAllRanges(),oe.addRange(X)),X},v=H=>{const x=H.cloneNode(!0),_=e.dispatch("ObjectSelected",{target:H,targetClone:x});if(_.isDefaultPrevented())return null;const P=y(H,_.targetClone),z=C.fromDom(H);return D(ut(C.fromDom(e.getBody()),`*[${a}]`),X=>{Ee(z,X)||rt(X,a)}),n.getAttrib(H,a)||H.setAttribute(a,"1"),i=H,B(),P},E=(H,x)=>{if(!H)return null;if(H.collapsed){if(!p(H)){const X=x?1:-1,oe=ga(X,s,H),ae=oe.getNode(!x);if(U(ae)){if(ua(ae))return f(X,ae,x?!oe.isAtEnd():!1,!1);if(Ss(ae)&&xe(ae.nextSibling)){const ve=n.createRng();return ve.setStart(ae,0),ve.setEnd(ae,0),ve}}const ge=oe.getNode(x);if(U(ge)){if(ua(ge))return f(X,ge,x?!1:!oe.isAtEnd(),!1);if(Ss(ge)&&xe(ge.previousSibling)){const ve=n.createRng();return ve.setStart(ge,1),ve.setEnd(ge,1),ve}}}return null}let _=H.startContainer,P=H.startOffset;const z=H.endOffset;if(I(_)&&P===0&&Ka(_.parentNode)&&(_=_.parentNode,P=n.nodeIndex(_),_=_.parentNode),!q(_))return null;if(z===P+1&&_===H.endContainer){const X=_.childNodes[P];if(c(X))return v(X)}return null},w=()=>{i&&i.removeAttribute(a),Ci(C.fromDom(e.getBody()),"#"+r).each(Ne),i=null},T=()=>{o.destroy(),i=null},B=()=>{o.hide()};return Vn(e)||g(),{showCaret:f,showBlockCaretContainer:d,hideFakeCaret:B,destroy:T}},vq=(e,t)=>{let n=t;for(let s=e.previousSibling;I(s);s=s.previousSibling)n+=s.data.length;return n},$k=(e,t,n,s,o)=>{if(I(n)&&(s<0||s>n.data.length))return[];const r=o&&I(n)?[vq(n,s)]:[s];let a=n;for(;a!==t&&a.parentNode;)r.push(e.nodeIndex(a,o)),a=a.parentNode;return a===t?r.reverse():[]},Rm=(e,t,n,s,o,r,a=!1)=>{const i=$k(e,t,n,s,a),l=$k(e,t,o,r,a);return{start:i,end:l}},Mk=(e,t)=>{const n=t.slice(),s=n.pop();return rn(s)?Tt(n,(r,a)=>r.bind(i=>m.from(i.childNodes[a])),m.some(e)).bind(r=>I(r)&&(s<0||s>r.data.length)?m.none():m.some({node:r,offset:s})):m.none()},Uk=(e,t)=>Mk(e,t.start).bind(({node:n,offset:s})=>Mk(e,t.end).map(({node:o,offset:r})=>{const a=document.createRange();return a.setStart(n,s),a.setEnd(o,r),a})),Eq=(e,t,n,s=!1)=>Rm(e,t,n.startContainer,n.startOffset,n.endContainer,n.endOffset,s),ur=(e,t,n)=>{if(t&&e.isEmpty(t)&&!n(t)){const s=t.parentNode;e.remove(t,I(t.firstChild)&&Io(t.firstChild.data)),ur(e,s,n)}},tc=(e,t,n,s=!0)=>{const o=t.startContainer.parentNode,r=t.endContainer.parentNode;t.deleteContents(),s&&!n(t.startContainer)&&(I(t.startContainer)&&t.startContainer.data.length===0&&e.remove(t.startContainer),I(t.endContainer)&&t.endContainer.data.length===0&&e.remove(t.endContainer),ur(e,o,n),o!==r&&ur(e,r,n))},nc=(e,t)=>m.from(e.dom.getParent(t.startContainer,e.dom.isBlock)),Tm=(e,t,n)=>{const s=e.dynamicPatternsLookup({text:n,block:t});return{...e,blockPatterns:Yh(s).concat(e.blockPatterns),inlinePatterns:Xh(s).concat(e.inlinePatterns)}},Dm=(e,t,n,s)=>{const o=e.createRng();return o.setStart(t,0),o.setEnd(n,s),o.toString()},zk=(e,t)=>e.create("span",{"data-mce-type":"bookmark",id:t}),sc=(e,t)=>{const n=e.createRng();return n.setStartAfter(t.start),n.setEndBefore(t.end),n},Hk=(e,t,n)=>{const s=Uk(e.getRoot(),n).getOrDie("Unable to resolve path range"),o=s.startContainer,r=s.endContainer,a=s.endOffset===0?r:r.splitText(s.endOffset),i=s.startOffset===0?o:o.splitText(s.startOffset),l=i.parentNode,c=a.parentNode;return{prefix:t,end:c.insertBefore(zk(e,t+"-end"),a),start:l.insertBefore(zk(e,t+"-start"),i)}},Wk=(e,t,n)=>{ur(e,e.get(t.prefix+"-end"),n),ur(e,e.get(t.prefix+"-start"),n)},Pm=e=>e.start.length===0,Sq=e=>(t,n)=>{const o=t.data.substring(0,n),r=o.lastIndexOf(e.charAt(e.length-1)),a=o.lastIndexOf(e);return a!==-1?a+e.length:r!==-1?r+1:-1},Vk=(e,t,n,s)=>{const o=t.start;return dm(e,s.container,s.offset,Sq(o),n).bind(a=>{var i,l;const c=(l=(i=n.textContent)===null||i===void 0?void 0:i.indexOf(o))!==null&&l!==void 0?l:-1;if(c!==-1&&a.offset>=c+o.length){const f=e.createRng();return f.setStart(a.container,a.offset-o.length),f.setEnd(a.container,a.offset),m.some(f)}else{const f=a.offset-o.length;return fm(a.container,f,n).map(d=>{const g=e.createRng();return g.setStart(d.container,d.offset),g.setEnd(a.container,a.offset),g}).filter(d=>d.toString()===o).orThunk(()=>Vk(e,t,n,kn(a.container,0)))}})},wq=(e,t,n,s,o,r=!1)=>{if(t.start.length===0&&!r){const a=e.createRng();return a.setStart(n,s),a.setEnd(n,s),m.some(a)}return um(n,s,o).bind(a=>Vk(e,t,o,a).bind(l=>{var c;if(r){if(l.endContainer===a.container&&l.endOffset===a.offset)return m.none();if(a.offset===0&&((c=l.endContainer.textContent)===null||c===void 0?void 0:c.length)===l.endOffset)return m.none()}return m.some(l)}))},kq=(e,t,n,s)=>{const o=e.dom,r=o.getRoot(),a=n.pattern,i=n.position.container,l=n.position.offset;return fm(i,l-n.pattern.end.length,t).bind(c=>{const u=Rm(o,r,c.container,c.offset,i,l,s);if(Pm(a))return m.some({matches:[{pattern:a,startRng:u,endRng:u}],position:c});{const f=oc(e,n.remainingPatterns,c.container,c.offset,t,s),d=f.getOr({matches:[],position:c}),g=d.position;return wq(o,a,g.container,g.offset,t,f.isNone()).map(p=>{const b=Eq(o,r,p,s);return{matches:d.matches.concat([{pattern:a,startRng:b,endRng:u}]),position:kn(p.startContainer,p.startOffset)}})}})},oc=(e,t,n,s,o,r)=>{const a=e.dom;return um(n,s,a.getRoot()).bind(i=>{const l=Dm(a,o,n,s);for(let c=0;c<t.length;c++){const u=t[c];if(!Sc(l,u.end))continue;const f=t.slice();f.splice(c,1);const d=kq(e,o,{pattern:u,remainingPatterns:f,position:i},r);if(d.isNone()&&s>0)return oc(e,t,n,s-1,o,r);if(d.isSome())return d}return m.none()})},jk=(e,t,n)=>{e.selection.setRng(n),t.type==="inline-format"?D(t.format,s=>{e.formatter.apply(s)}):e.execCommand(t.cmd,!1,t.value)},_q=(e,t,n,s)=>{const o=sc(e.dom,n);tc(e.dom,o,s),jk(e,t,o)},Aq=(e,t,n,s,o)=>{const r=e.dom,a=sc(r,s),i=sc(r,n);tc(r,i,o),tc(r,a,o);const l={prefix:n.prefix,start:n.end,end:s.start},c=sc(r,l);jk(e,t,c)},xq=(e,t)=>{const n=xr("mce_textpattern"),s=Sr(t,(o,r)=>{const a=Hk(e,n+`_end${o.length}`,r.endRng);return o.concat([{...r,endMarker:a}])},[]);return Sr(s,(o,r)=>{const a=s.length-o.length-1,i=Pm(r.pattern)?r.endMarker:Hk(e,n+`_start${a}`,r.startRng);return o.concat([{...r,startMarker:i}])},[])},Nq=e=>$s(e,(t,n)=>n.end.length-t.end.length),Rq=(e,t)=>{const n=Zn(e,s=>Be(t,o=>s.pattern.start===o.pattern.start&&s.pattern.end===o.pattern.end));return e.length===t.length?n?e:t:e.length>t.length?e:t},qk=(e,t,n,s,o,r)=>{const a=oc(e,o.inlinePatterns,n,s,t,r).fold(()=>[],l=>l.matches),i=oc(e,Nq(o.inlinePatterns),n,s,t,r).fold(()=>[],l=>l.matches);return Rq(a,i)},Kk=(e,t)=>{if(t.length===0)return;const n=e.dom,s=e.selection.getBookmark(),o=xq(n,t);D(o,r=>{const a=n.getParent(r.startMarker.start,n.isBlock),i=l=>l===a;Pm(r.pattern)?_q(e,r.pattern,r.endMarker,i):Aq(e,r.pattern,r.startMarker,r.endMarker,i),Wk(n,r.endMarker,i),Wk(n,r.startMarker,i)}),e.selection.moveToBookmark(s)},Gk=(e,t,n)=>XV(t,0,t).map(s=>{const o=s.container;return rw(o,n.start.length,t).each(r=>{const a=e.createRng();a.setStart(o,0),a.setEnd(r.container,r.offset),tc(e,a,i=>i===t)}),o}),Yk=e=>(t,n)=>{const s=t.dom,o=n.pattern,r=Uk(s.getRoot(),n.range).getOrDie("Unable to resolve path range"),a=(i,l)=>{const c=l.get(i);return De(c)&&_t(c).exists(u=>se(u,"block"))};return nc(t,r).each(i=>{o.type==="block-format"?a(o.format,t.formatter)&&t.undoManager.transact(()=>{e(t.dom,i,o),t.formatter.apply(o.format)}):o.type==="block-command"&&t.undoManager.transact(()=>{e(t.dom,i,o),t.execCommand(o.cmd,!1,o.value)})}),!0},Tq=e=>$s(e,(t,n)=>n.start.length-t.start.length),Xk=e=>(t,n)=>{const s=Tq(t),o=n.replace(Ze," ");return Ye(s,r=>e(r,n,o))},Zk=(e,t)=>(n,s,o,r,a)=>{var i;a===void 0&&(a=(i=s.textContent)!==null&&i!==void 0?i:"");const l=n.dom,c=dt(n);return l.is(s,c)?e(o.blockPatterns,a).map(u=>t&&L.trim(a).length===u.start.length?[]:[{pattern:u,range:Rm(l,l.getRoot(),s,0,s,0,r)}]).getOr([]):[]},Dq=e=>/^\s[^\s]/.test(e),Pq=Yk((e,t,n)=>{Gk(e,t,n).each(s=>{const o=C.fromDom(s),r=Hr(o);Dq(r)&&Cp(o,r.slice(1))})}),Bq=Xk((e,t,n)=>t.indexOf(e.start)===0||n.indexOf(e.start)===0),Oq=Zk(Bq,!0),Iq=(e,t)=>{const n=e.selection.getRng();return nc(e,n).map(s=>{var o;const r=Math.max(0,n.startOffset),a=Tm(t,s,(o=s.textContent)!==null&&o!==void 0?o:""),i=qk(e,s,n.startContainer,r,a,!0),l=Oq(e,s,a,!0);return{inlineMatches:i,blockMatches:l}}).filter(({inlineMatches:s,blockMatches:o})=>o.length>0||s.length>0)},Fq=(e,t)=>{if(t.length===0)return;const n=e.selection.getBookmark();D(t,s=>Pq(e,s)),e.selection.moveToBookmark(n)},Lq=Yk(Gk),$q=Xk((e,t,n)=>t===e.start||n===e.start),Mq=Zk($q,!1),Uq=(e,t)=>{const n=e.selection.getRng();return nc(e,n).map(s=>{const o=Math.max(0,n.startOffset),r=Dm(e.dom,s,n.startContainer,o),a=Tm(t,s,r);return Mq(e,s,a,!1,r)}).filter(s=>s.length>0)},zq=(e,t)=>{D(t,n=>Lq(e,n))},Hq=(e,t)=>Iq(e,t).fold(Pe,({inlineMatches:n,blockMatches:s})=>(e.undoManager.add(),e.undoManager.extra(()=>{e.execCommand("mceInsertNewLine")},()=>{rT(e),Kk(e,n),Fq(e,s);const o=e.selection.getRng(),r=um(o.startContainer,o.startOffset,e.dom.getRoot());e.execCommand("mceInsertNewLine"),r.each(a=>{const i=a.container;i.data.charAt(a.offset-1)===Rr&&(i.deleteData(a.offset-1,1),ur(e.dom,i.parentNode,l=>l===e.dom.getRoot()))})}),!0)),Wq=(e,t)=>{const n=e.selection.getRng();nc(e,n).map(s=>{const o=Math.max(0,n.startOffset-1),r=Dm(e.dom,s,n.startContainer,o),a=Tm(t,s,r),i=qk(e,s,n.startContainer,o,a,!1);i.length>0&&e.undoManager.transact(()=>{Kk(e,i)})})},Vq=(e,t)=>Uq(e,t).fold(Pe,n=>(e.undoManager.transact(()=>{zq(e,n)}),!0)),Qk=(e,t,n)=>{for(let s=0;s<e.length;s++)if(n(e[s],t))return!0;return!1},jq=(e,t)=>Qk(e,t,(n,s)=>n===s.keyCode&&!j.modifierPressed(s)),qq=(e,t)=>Qk(e,t,(n,s)=>n.charCodeAt(0)===s.charCode),Kq=e=>{const t=[",",".",";",":","!","?"],n=[32],s=()=>ZT(TP(e).filter(a=>a.type==="inline-command"||a.type==="block-command"?e.queryCommandSupported(a.cmd):!0),DP(e)),o=()=>LP(e);e.on("keydown",a=>{if(a.keyCode===13&&!j.modifierPressed(a)&&e.selection.isCollapsed()&&e.selection.isEditable()){const i=Fu(s(),"enter");(i.inlinePatterns.length>0||i.blockPatterns.length>0||o())&&Hq(e,i)&&a.preventDefault()}},!0),e.on("keydown",a=>{if(a.keyCode===32&&e.selection.isCollapsed()&&e.selection.isEditable()){const i=Fu(s(),"space");(i.blockPatterns.length>0||o())&&Vq(e,i)&&a.preventDefault()}},!0);const r=()=>{if(e.selection.isCollapsed()&&e.selection.isEditable()){const a=Fu(s(),"space");(a.inlinePatterns.length>0||o())&&Wq(e,a)}};e.on("keyup",a=>{jq(n,a)&&r()}),e.on("keypress",a=>{qq(t,a)&&Jt.setEditorTimeout(e,r)})},Gq=e=>{Kq(e)},Yq=e=>{const t=L.each,n=j.BACKSPACE,s=j.DELETE,o=e.dom,r=e.selection,a=e.parser,i=Ce.browser,l=i.isFirefox(),c=i.isChromium()||i.isSafari(),u=Ce.deviceType.isiPhone()||Ce.deviceType.isiPad(),f=Ce.os.isMacOS()||Ce.os.isiOS(),d=(R,O)=>{try{e.getDoc().execCommand(R,!1,String(O))}catch{}},g=R=>R.isDefaultPrevented(),h=()=>{const R=K=>{const ie=o.create("body"),le=K.cloneContents();return ie.appendChild(le),r.serializer.serialize(ie,{format:"html"})},O=K=>{const ie=R(K),le=o.createRng();le.selectNode(e.getBody());const ye=R(le);return ie===ye};e.on("keydown",K=>{const ie=K.keyCode;if(!g(K)&&(ie===s||ie===n)&&e.selection.isEditable()){const le=e.selection.isCollapsed(),ye=e.getBody();if(le&&!rs(e.schema,ye)||!le&&!O(e.selection.getRng()))return;K.preventDefault(),e.setContent(""),ye.firstChild&&o.isBlock(ye.firstChild)?e.selection.setCursorLocation(ye.firstChild,0):e.selection.setCursorLocation(ye,0),e.nodeChanged()}})},p=()=>{e.shortcuts.add("meta+a",null,"SelectAll")},b=()=>{e.inline||o.bind(e.getDoc(),"mousedown mouseup",R=>{let O;if(R.target===e.getDoc().documentElement)if(O=r.getRng(),e.getBody().focus(),R.type==="mousedown"){if(Gt(O.startContainer))return;r.placeCaretAt(R.clientX,R.clientY)}else r.setRng(O)})},y=()=>{e.on("keydown",R=>{if(!g(R)&&R.keyCode===n){if(!e.getBody().getElementsByTagName("hr").length)return;if(r.isCollapsed()&&r.getRng().startOffset===0){const O=r.getNode(),K=O.previousSibling;if(O.nodeName==="HR"){o.remove(O),R.preventDefault();return}K&&K.nodeName&&K.nodeName.toLowerCase()==="hr"&&(o.remove(K),R.preventDefault())}}})},v=()=>{Range.prototype.getClientRects||e.on("mousedown",R=>{if(!g(R)&&R.target.nodeName==="HTML"){const O=e.getBody();O.blur(),Jt.setEditorTimeout(e,()=>{O.focus()})}})},E=()=>{const R=Cb(e);e.on("click",O=>{const K=O.target;/^(IMG|HR)$/.test(K.nodeName)&&o.isEditable(K)&&(O.preventDefault(),e.selection.select(K),e.nodeChanged()),K.nodeName==="A"&&o.hasClass(K,R)&&K.childNodes.length===0&&o.isEditable(K.parentNode)&&(O.preventDefault(),r.select(K))})},w=()=>{const R=O=>O.nodeName==="IMG"&&e.dom.isEditable(O);e.on("mousedown",O=>{at(m.from(O.clientX),m.from(O.clientY),(K,ie)=>{const le=e.getDoc().caretPositionFromPoint(K,ie);if(le&&R(le.offsetNode)){const ye=le.offsetNode.getBoundingClientRect();O.preventDefault(),e.hasFocus()||e.focus(),e.selection.select(le.offsetNode),O.clientX<ye.left||O.clientY<ye.top?e.selection.collapse(!0):(O.clientX>ye.right||O.clientY>ye.bottom)&&e.selection.collapse(!1)}})})},T=()=>{const R=()=>{const K=o.getAttribs(r.getStart().cloneNode(!1));return()=>{const ie=r.getStart();ie!==e.getBody()&&(o.setAttrib(ie,"style",null),t(K,le=>{ie.setAttributeNode(le.cloneNode(!0))}))}},O=()=>!r.isCollapsed()&&o.getParent(r.getStart(),o.isBlock)!==o.getParent(r.getEnd(),o.isBlock);e.on("keypress",K=>{let ie;return!g(K)&&(K.keyCode===8||K.keyCode===46)&&O()?(ie=R(),e.getDoc().execCommand("delete",!1),ie(),K.preventDefault(),!1):!0}),o.bind(e.getDoc(),"cut",K=>{if(!g(K)&&O()){const ie=R();Jt.setEditorTimeout(e,()=>{ie()})}})},B=()=>{e.on("keydown",R=>{if(!g(R)&&R.keyCode===n&&r.isCollapsed()&&r.getRng().startOffset===0){const O=r.getNode().previousSibling;if(O&&O.nodeName&&O.nodeName.toLowerCase()==="table")return R.preventDefault(),!1}return!0})},H=()=>{e.on("keydown",R=>{if(g(R)||R.keyCode!==j.BACKSPACE)return;let O=r.getRng();const K=O.startContainer,ie=O.startOffset,le=o.getRoot();let ye=K;if(!(!O.collapsed||ie!==0)){for(;ye.parentNode&&ye.parentNode.firstChild===ye&&ye.parentNode!==le;)ye=ye.parentNode;ye.nodeName==="BLOCKQUOTE"&&(e.formatter.toggle("blockquote",void 0,ye),O=o.createRng(),O.setStart(K,0),O.setEnd(K,0),r.setRng(O))}})},x=()=>{const R=()=>{d("StyleWithCSS",!1),d("enableInlineTableEditing",!1),gb(e)||d("enableObjectResizing",!1)};hb(e)||e.on("BeforeExecCommand mousedown",R)},_=()=>{const R=()=>{t(o.select("a:not([data-mce-block])"),O=>{var K;let ie=O.parentNode;const le=o.getRoot();if((ie==null?void 0:ie.lastChild)===O){for(;ie&&!o.isBlock(ie);){if(((K=ie.parentNode)===null||K===void 0?void 0:K.lastChild)!==ie||ie===le)return;ie=ie.parentNode}o.add(ie,"br",{"data-mce-bogus":1})}})};e.on("SetContent ExecCommand",O=>{(O.type==="setcontent"||O.command==="mceInsertLink")&&R()})},P=()=>{e.on("init",()=>{d("DefaultParagraphSeparator",dt(e))})},z=R=>{const O=R.getBody(),K=R.selection.getRng();return K.startContainer===K.endContainer&&K.startContainer===O&&K.startOffset===0&&K.endOffset===O.childNodes.length},X=()=>{e.on("keyup focusin mouseup",R=>{!j.modifierPressed(R)&&!z(e)&&r.normalize()},!0)},oe=()=>{e.contentStyles.push("img:-moz-broken {-moz-force-broken-image-icon:1;min-width:24px;min-height:24px}")},ae=()=>{e.inline||e.on("keydown",()=>{document.activeElement===document.body&&e.getWin().focus()})},ge=()=>{e.inline||(e.contentStyles.push("body {min-height: 150px}"),e.on("click",R=>{let O;R.target.nodeName==="HTML"&&(O=e.selection.getRng(),e.getBody().focus(),e.selection.setRng(O),e.selection.normalize(),e.nodeChanged())}))},ve=()=>{f&&e.on("keydown",R=>{j.metaKeyPressed(R)&&!R.shiftKey&&(R.keyCode===37||R.keyCode===39)&&(R.preventDefault(),e.selection.getSel().modify("move",R.keyCode===37?"backward":"forward","lineboundary"))})},$e=()=>{e.on("click",R=>{let O=R.target;do if(O.tagName==="A"){R.preventDefault();return}while(O=O.parentNode)}),e.contentStyles.push(".mce-content-body {-webkit-touch-callout: none}")},ze=()=>{e.on("init",()=>{e.dom.bind(e.getBody(),"submit",R=>{R.preventDefault()})})},Ke=()=>{a.addNodeFilter("br",R=>{let O=R.length;for(;O--;)R[O].attr("class")==="Apple-interchange-newline"&&R[O].remove()})},M=ce,Y=()=>{if(!l||e.removed)return!1;const R=e.selection.getSel();return!R||!R.rangeCount||R.rangeCount===0},me=()=>{c&&(b(),E(),ze(),p(),u&&(ae(),ge(),$e())),l&&(v(),x(),oe(),ve())},pe=()=>{H(),h(),Ce.windowsPhone||X(),c&&(b(),E(),P(),ze(),B(),Ke(),u?(ae(),ge(),$e()):p()),l&&(w(),y(),v(),T(),x(),_(),oe(),ve(),B())};return Vn(e)?me():pe(),{refreshContentEditable:M,isHidden:Y}},Xq=e=>e.toLowerCase()==="gpl",Zq=e=>e.length>=64&&e.length<=255,Qq=e=>Xq(e)||Zq(e)?"VALID":"INVALID",Jq=e=>{const t=jP(e);!J(qP(e))&&(st(t)||Qq(t)==="INVALID")&&console.warn("TinyMCE is running in evaluation mode. Provide a valid license key or add license_key: 'gpl' to the init config to agree to the open source license terms. Read more at https://www.tiny.cloud/license-key/")},Bm=_e.DOM,e9=(e,t)=>{const n=C.fromDom(e.getBody()),s=Fc(ps(n)),o=C.fromTag("style");ot(o,"type","text/css"),je(o,C.fromText(t)),je(s,o),e.on("remove",()=>{Ne(o)})},t9=e=>e.inline?e.getElement().nodeName.toLowerCase():void 0,Om=e=>Ar(e,t=>st(t)===!1),Jk=e=>{const t=e.options.get,n=e.editorUpload.blobCache;return Om({allow_conditional_comments:t("allow_conditional_comments"),allow_html_data_urls:t("allow_html_data_urls"),allow_svg_data_urls:t("allow_svg_data_urls"),allow_html_in_named_anchor:t("allow_html_in_named_anchor"),allow_script_urls:t("allow_script_urls"),allow_mathml_annotation_encodings:t("allow_mathml_annotation_encodings"),allow_unsafe_link_target:t("allow_unsafe_link_target"),convert_unsafe_embeds:t("convert_unsafe_embeds"),convert_fonts_to_spans:t("convert_fonts_to_spans"),extended_mathml_attributes:t("extended_mathml_attributes"),extended_mathml_elements:t("extended_mathml_elements"),fix_list_elements:t("fix_list_elements"),font_size_legacy_values:t("font_size_legacy_values"),forced_root_block:t("forced_root_block"),forced_root_block_attrs:t("forced_root_block_attrs"),preserve_cdata:t("preserve_cdata"),inline_styles:t("inline_styles"),root_name:t9(e),sandbox_iframes:t("sandbox_iframes"),sandbox_iframes_exclusions:Hu(e),sanitize:t("xss_sanitization"),validate:!0,blob_cache:n,document:e.getDoc()})},e_=e=>{const t=e.options.get;return Om({custom_elements:t("custom_elements"),extended_valid_elements:t("extended_valid_elements"),invalid_elements:t("invalid_elements"),invalid_styles:t("invalid_styles"),schema:t("schema"),valid_children:t("valid_children"),valid_classes:t("valid_classes"),valid_elements:t("valid_elements"),valid_styles:t("valid_styles"),verify_html:t("verify_html"),padd_empty_block_inline_children:t("format_empty_lines")})},n9=e=>{const t=e.options.get;return{...Jk(e),...e_(e),...Om({remove_trailing_brs:t("remove_trailing_brs"),pad_empty_with_br:t("pad_empty_with_br"),url_converter:t("url_converter"),url_converter_scope:t("url_converter_scope"),element_format:t("element_format"),entities:t("entities"),entity_encoding:t("entity_encoding"),indent:t("indent"),indent_after:t("indent_after"),indent_before:t("indent_before")})}},s9=e=>{const t=nr(Jk(e),e.schema);return t.addAttributeFilter("src,href,style,tabindex",(n,s)=>{const o=e.dom,r="data-mce-"+s;let a=n.length;for(;a--;){const i=n[a];let l=i.attr(s);if(l&&!i.attr(r)){if(l.indexOf("data:")===0||l.indexOf("blob:")===0)continue;s==="style"?(l=o.serializeStyle(o.parseStyle(l),i.name),l.length||(l=null),i.attr(r,l),i.attr(s,l)):s==="tabindex"?(i.attr(r,l),i.attr(s,null)):i.attr(r,e.convertURL(l,s,i.name))}}}),t.addNodeFilter("script",n=>{let s=n.length;for(;s--;){const o=n[s],r=o.attr("type")||"no/type";r.indexOf("mce-")!==0&&o.attr("type","mce-"+r)}}),OP(e)&&t.addNodeFilter("#cdata",n=>{var s;let o=n.length;for(;o--;){const r=n[o];r.type=8,r.name="#comment",r.value="[CDATA["+e.dom.encode((s=r.value)!==null&&s!==void 0?s:"")+"]]"}}),t.addNodeFilter("p,h1,h2,h3,h4,h5,h6,div",n=>{let s=n.length;const o=e.schema.getNonEmptyElements();for(;s--;){const r=n[s];r.isEmpty(o)&&r.getAll("br").length===0&&r.append(new yt("br",1))}}),t},o9=e=>{const t=hP(e);t&&Jt.setEditorTimeout(e,()=>{let n;t===!0?n=e:n=e.editorManager.get(t),n&&!n.destroyed&&(n.focus(),n.selection.scrollIntoView())},100)},r9=e=>{const t=e.dom.getRoot();!e.inline&&(!Yi(e)||e.selection.getStart(!0)===t)&&mt(t).each(n=>{const s=n.getNode(),o=Ln(s)?mt(s).getOr(n):n;e.selection.setRng(o.toRange())})},a9=e=>{e.bindPendingEventDelegates(),e.initialized=!0,lD(e),e.focus(!0),r9(e),e.nodeChanged({initial:!0});const t=gP(e);we(t)&&t.call(e,e),o9(e),ls(e)&&QE(e,!0)},Im=e=>e.inline?e.ui.styleSheetLoader:e.dom.styleSheetLoader,i9=(e,t,n)=>{const{pass:s,fail:o}=So(t,i=>tinymce.Resource.has(Pd(i))),a=[...s.map(i=>{const l=tinymce.Resource.get(Pd(i));return J(l)?Promise.resolve(Im(e).loadRawCss(i,l)):Promise.resolve()}),Im(e).loadAll(o)];return e.inline?a:a.concat([e.ui.styleSheetLoader.loadAll(n)])},t_=e=>{const t=Im(e),n=mb(e),s=e.contentCSS,o=()=>{t.unloadAll(s),e.inline||e.ui.styleSheetLoader.unloadAll(n)},r=()=>{e.removed?o():e.on("remove",o)};if(e.contentStyles.length>0){let l="";L.each(e.contentStyles,c=>{l+=c+`\r
`}),e.dom.addStyle(l)}const a=Promise.all(i9(e,s,n)).then(r).catch(r),i=WD(e);return i&&e9(e,i),a},l9=e=>{const t=e.getDoc(),n=e.getBody();aD(e),bP(e)||(t.body.spellcheck=!1,Bm.setAttrib(n,"spellcheck","false")),e.quirks=Yq(e),iD(e);const s=VD(e);s!==void 0&&(n.dir=s);const o=CP(e);o&&e.on("BeforeSetContent",r=>{L.each(o,a=>{r.content=r.content.replace(a,i=>"<!--mce:protected "+escape(i)+"-->")})}),e.on("SetContent",()=>{e.addVisual(e.getBody())}),e.on("compositionstart compositionend",r=>{e.composing=r.type==="compositionstart"})},c9=e=>{Vn(e)||e.load({initial:!0,format:"html"}),e.startContent=e.getContent({format:"raw"})},Fm=e=>{e.removed!==!0&&(c9(e),a9(e))},u9=e=>{let t=!1;const n=setTimeout(()=>{t||e.setProgressState(!0)},500);return()=>{clearTimeout(n),t=!0,e.setProgressState(!1)}},n_=e=>{const t=e.getElement();let n=e.getDoc();e.inline&&(Bm.addClass(t,"mce-content-body"),e.contentDocument=n=document,e.contentWindow=window,e.bodyElement=t,e.contentAreaContainer=t);const s=e.getBody();s.disabled=!0,e.readonly=hb(e),e._editableRoot=lP(e),!Hi(e)&&e.hasEditableRoot()&&(e.inline&&Bm.getStyle(s,"position",!0)==="static"&&(s.style.position="relative"),s.contentEditable="true"),s.disabled=!1,e.editorUpload=Zz(e),e.schema=vs(e_(e)),e.dom=_e(n,{keep_values:!0,url_converter:e.convertURL,url_converter_scope:e,update_styles:!0,root_element:e.inline?e.getBody():null,collect:e.inline,schema:e.schema,contentCssCors:MD(e),referrerPolicy:Mu(e),onSetAttrib:a=>{e.dispatch("SetAttrib",a)}}),e.parser=s9(e),e.serializer=UE(n9(e),e),e.selection=ME(e.dom,e.getWin(),e.serializer,e),e.annotator=hC(e),e.formatter=aS(e),e.undoManager=lS(e),e._nodeChangeDispatcher=new yj(e),e._selectionOverrides=yq(e),kW(e),k4(e),BW(e),Vn(e)||(D4(e),Gq(e));const o=Cj(e);EW(e,o),RW(e),dH(e),E4(e);const r=HM(e);l9(e),Jq(e),r.fold(()=>{const a=u9(e);t_(e).then(()=>{Fm(e),a()})},a=>{e.setProgressState(!0),t_(e).then(()=>{a().then(i=>{e.setProgressState(!1),Fm(e),OE(e)},i=>{e.notificationManager.open({type:"error",text:String(i)}),Fm(e),OE(e)})})})},Lm=_e.DOM,f9=(e,t,n,s)=>{const o=C.fromTag("iframe");return s.each(r=>ot(o,"tabindex",r)),ts(o,n),ts(o,{id:e+"_ifr",frameBorder:"0",allowTransparency:"true",title:t}),Bo(o,"tox-edit-area__iframe"),o},d9=e=>{let t=kD(e)+"<html><head>";ab(e)!==e.documentBaseUrl&&(t+='<base href="'+e.documentBaseURI.getURI()+'" />'),t+='<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />';const n=_D(e),s=AD(e),o=e.translate(yb(e));return ib(e)&&(t+='<meta http-equiv="Content-Security-Policy" content="'+ib(e)+'" />'),t+=`</head><body id="${n}" class="mce-content-body ${s}" data-id="${e.id}" aria-label="${o}"><br></body></html>`,t},m9=(e,t)=>{const n=Ce.browser.isFirefox()?yb(e):"Rich Text Area",s=e.translate(n),o=ns(C.fromDom(e.getElement()),"tabindex").bind(li),r=f9(e.id,s,wD(e),o).dom;r.onload=()=>{r.onload=null,e.dispatch("load")},e.contentAreaContainer=t.iframeContainer,e.iframeElement=r,e.iframeHTML=d9(e),Lm.add(t.iframeContainer,r)},g9=e=>{const t=e.iframeElement,n=()=>{e.contentDocument=t.contentDocument,n_(e)};if(FP(e)||Ce.browser.isFirefox()){const s=e.getDoc();s.open(),s.write(e.iframeHTML),s.close(),n()}else{const s=Cx(C.fromDom(t),"load",()=>{s.unbind(),n()});t.srcdoc=e.iframeHTML}},p9=(e,t)=>{m9(e,t),t.editorContainer&&(t.editorContainer.style.display=e.orgDisplay,e.hidden=Lm.isHidden(t.editorContainer)),e.getElement().style.display="none",Lm.setAttrib(e.id,"aria-hidden","true"),e.getElement().style.visibility=e.orgVisibility,g9(e)},s_=_e.DOM,h9=(e,t,n)=>{const s=or.get(n),o=or.urls[n]||e.documentBaseUrl.replace(/\/$/,"");if(n=L.trim(n),s&&L.inArray(t,n)===-1){if(e.plugins[n])return;try{const r=s(e,o)||{};e.plugins[n]=r,we(r.init)&&(r.init(e,o),t.push(n))}catch(r){Sz(e,n,r)}}},b9=e=>e.replace(/^\-/,""),C9=e=>{const t=[];D(Ui(e),n=>{h9(e,t,b9(n))})},y9=e=>{const t=L.trim(ub(e)),n=e.ui.registry.getAll().icons,s={...Al.get("default").icons,...Al.get(t).icons};Ae(s,(o,r)=>{se(n,r)||e.ui.registry.addIcon(r,o)})},v9=e=>{const t=jo(e);if(J(t)){const n=go.get(t);e.theme=n(e,go.urls[t])||{},we(e.theme.init)&&e.theme.init(e,go.urls[t]||e.documentBaseUrl.replace(/\/$/,""))}else e.theme={}},E9=e=>{const t=Uu(e),n=sr.get(t);e.model=n(e,sr.urls[t])},S9=e=>{const t=e.theme.renderUI;return t?t():r_(e)},w9=e=>{const t=e.getElement(),s=jo(e)(e,t);return s.editorContainer.nodeType&&(s.editorContainer.id=s.editorContainer.id||e.id+"_parent"),s.iframeContainer&&s.iframeContainer.nodeType&&(s.iframeContainer.id=s.iframeContainer.id||e.id+"_iframecontainer"),s.height=s.iframeHeight?s.iframeHeight:t.offsetHeight,s},o_=(e,t)=>({editorContainer:e,iframeContainer:t,api:{}}),k9=e=>{const t=s_.create("div");return s_.insertAfter(t,e),o_(t,t)},r_=e=>{const t=e.getElement();return e.inline?o_(null):k9(t)},_9=e=>{const t=e.getElement();return e.orgDisplay=t.style.display,J(jo(e))?S9(e):we(jo(e))?w9(e):r_(e)},A9=(e,t)=>{const n={show:m.from(t.show).getOr(ce),hide:m.from(t.hide).getOr(ce),isEnabled:m.from(t.isEnabled).getOr(Ue),setEnabled:s=>{s&&(e.mode.get()==="readonly"||ls(e))||m.from(t.setEnabled).each(r=>r(s))}};e.ui={...e.ui,...n}},x9=async e=>{e.dispatch("ScriptsLoaded"),y9(e),v9(e),E9(e),C9(e);const t=await _9(e);A9(e,m.from(t.api).getOr({})),e.editorContainer=t.editorContainer,Uz(e),e.inline?n_(e):p9(e,{editorContainer:t.editorContainer,iframeContainer:t.iframeContainer})},Co=_e.DOM,a_=e=>e.charAt(0)==="-",N9=(e,t)=>{const n=fb(t),s=UD(t);if(!vn.hasCode(n)&&n!=="en"){const o=Tn(s)?s:`${t.editorManager.baseURL}/langs/${n}.js`;e.add(o).catch(()=>{yz(t,o,n)})}},R9=(e,t)=>{const n=jo(e);if(J(n)&&!a_(n)&&!se(go.urls,n)){const s=YD(e),o=s?e.documentBaseURI.toAbsolute(s):`themes/${n}/theme${t}.js`;go.load(n,o).catch(()=>{vz(e,o,n)})}},T9=(e,t)=>{const n=Uu(e);if(n!=="plugin"&&!se(sr.urls,n)){const s=XD(e),o=J(s)?e.documentBaseURI.toAbsolute(s):`models/${n}/model${t}.js`;sr.load(n,o).catch(()=>{Ez(e,o,n)})}},D9=e=>m.from(OD(e)).filter(Tn).map(t=>({url:t,name:m.none()})),i_=(e,t,n)=>m.from(t).filter(s=>Tn(s)&&!Al.has(s)).map(s=>({url:`${e.editorManager.baseURL}/icons/${s}/icons${n}.js`,name:m.some(s)})),P9=(e,t,n)=>{const s=i_(t,"default",n),o=D9(t).orThunk(()=>i_(t,ub(t),""));D(iA([s,o]),r=>{e.add(r.url).catch(()=>{Cz(t,r.url,r.name.getOrUndefined())})})},B9=(e,t)=>{const n=(s,o)=>{or.load(s,o).catch(()=>{bz(e,o,s)})};Ae(cP(e),(s,o)=>{n(o,s),e.options.set("plugins",Ui(e).concat(o))}),D(Ui(e),s=>{s=L.trim(s),s&&!or.urls[s]&&!a_(s)&&n(s,`plugins/${s}/plugin${t}.js`)})},O9=e=>{const t=jo(e);return!J(t)||U(go.get(t))},I9=e=>{const t=Uu(e);return U(sr.get(t))},F9=(e,t)=>{const n=as.ScriptLoader,s=()=>{!e.removed&&O9(e)&&I9(e)&&x9(e)};R9(e,t),T9(e,t),N9(n,e),P9(n,e,t),B9(e,t),n.loadQueue().then(s,s)},L9=(e,t)=>Vp.forElement(e,{contentCssCors:bb(t),referrerPolicy:Mu(t)}),$9=e=>{const t=e.id;vn.setCode(fb(e));const n=()=>{Co.unbind(window,"ready",n),e.render()};if(!Ys.Event.domLoaded){Co.bind(window,"ready",n);return}if(!e.getElement())return;const s=C.fromDom(e.getElement()),o=ip(s);e.on("remove",()=>{tg(s.dom.attributes,a=>rt(s,a.name)),ts(s,o)}),e.ui.styleSheetLoader=L9(s,e),zu(e)?e.inline=!0:(e.orgVisibility=e.getElement().style.visibility,e.getElement().style.visibility="hidden");const r=e.getElement().form||Co.getParent(t,"form");r&&(e.formElement=r,nP(e)&&!Qc(e.getElement())&&(Co.insertAfter(Co.create("input",{type:"hidden",name:t}),t),e.hasHiddenInput=!0),e.formEventDelegate=a=>{e.dispatch(a.type,a)},Co.bind(r,"submit reset",e.formEventDelegate),e.on("reset",()=>{e.resetContent()}),sP(e)&&!r.submit.nodeType&&!r.submit.length&&!r._mceOldSubmit&&(r._mceOldSubmit=r.submit,r.submit=()=>(e.editorManager.triggerSave(),e.setDirty(!1),r._mceOldSubmit(r)))),e.windowManager=KE(e),e.notificationManager=qE(e),UP(e)&&e.on("GetContent",a=>{a.save&&(a.content=Co.encode(a.content))}),oP(e)&&e.on("submit",()=>{e.initialized&&e.save()}),rP(e)&&(e._beforeUnload=()=>{e.initialized&&!e.destroyed&&!e.isHidden()&&e.save({format:"raw",no_events:!0,set_dirty:!1})},e.editorManager.on("BeforeUnload",e._beforeUnload)),e.editorManager.add(e),F9(e,e.suffix)},M9=(e,t)=>{e._editableRoot!==t&&(e._editableRoot=t,ls(e)||(e.getBody().contentEditable=String(e.hasEditableRoot()),e.nodeChanged()),bD(e,t))},U9=e=>e._editableRoot,z9=(e,t)=>({sections:W(e),options:W(t)}),l_=pn().deviceType,c_=l_.isPhone(),H9=l_.isTablet(),Ga=e=>{if(Ve(e))return[];{const t=De(e)?e:e.split(/[ ,]/),n=he(t,xo);return ne(n,Tn)}},W9=(e,t)=>{const n=tA(t,(s,o)=>Se(e,o));return z9(n.t,n.f)},V9=(e,t,n={})=>{const s=e.sections(),o=Oe(s,t).getOr({});return L.extend({},n,o)},$m=(e,t)=>se(e.sections(),t),j9=(e,t)=>$m(e,t)?e.sections()[t]:{},q9=(e,t)=>({...{table_grid:!1,object_resizing:!1,resize:!1,toolbar_mode:Oe(e,"toolbar_mode").getOr("scrolling"),toolbar_sticky:!1},...t?{menubar:!1}:{}}),K9=(e,t)=>{var n;const s=(n=t.external_plugins)!==null&&n!==void 0?n:{};return e&&e.external_plugins?L.extend({},e.external_plugins,s):s},G9=(e,t)=>[...Ga(e),...Ga(t)],Y9=(e,t,n,s)=>e&&$m(t,"mobile")?s:n,X9=(e,t,n,s)=>{const o=Ga(n.forced_plugins),r=Ga(s.plugins),a=j9(t,"mobile"),i=a.plugins?Ga(a.plugins):r,l=Y9(e,t,r,i),c=G9(o,l);return L.extend(s,{forced_plugins:o,plugins:c})},Z9=(e,t)=>e&&$m(t,"mobile"),Q9=(e,t,n,s,o)=>{var r;const a=e?{mobile:q9((r=o.mobile)!==null&&r!==void 0?r:{},t)}:{},i=W9(["mobile"],ii(a,o)),l=L.extend(n,s,i.options(),Z9(e,i)?V9(i,"mobile"):{},{external_plugins:K9(s,i.options())});return X9(e,i,s,l)},J9=(e,t)=>{const n=fg(t);return Q9(c_||H9,c_,n,e,n)},e6=(e,t)=>mU(e,t),t6=e=>{const t=(s,o)=>{e.formatter.toggle(s,o),e.nodeChanged()},n=s=>()=>{D("left,center,right,justify".split(","),o=>{s!==o&&e.formatter.remove("align"+o)}),s!=="none"&&t("align"+s)};e.editorCommands.addCommands({JustifyLeft:n("left"),JustifyCenter:n("center"),JustifyRight:n("right"),JustifyFull:n("justify"),JustifyNone:n("none")})},n6=e=>{const t=n=>()=>{const s=e.selection,o=s.isCollapsed()?[e.dom.getParent(s.getNode(),e.dom.isBlock)]:s.getSelectedBlocks();return Be(o,r=>U(e.formatter.matchNode(r,n)))};e.editorCommands.addCommands({JustifyLeft:t("alignleft"),JustifyCenter:t("aligncenter"),JustifyRight:t("alignright"),JustifyFull:t("alignjustify")},"state")},s6=e=>{t6(e),n6(e)},o6=e=>{e.editorCommands.addCommands({"Cut,Copy,Paste":t=>{const n=e.getDoc();let s;try{n.execCommand(t)}catch{s=!0}if(t==="paste"&&!n.queryCommandEnabled(t)&&(s=!0),s||!n.queryCommandSupported(t)){let o=e.translate("Your browser doesn't support direct access to the clipboard. Please use the Ctrl+X/C/V keyboard shortcuts instead.");(Ce.os.isMacOS()||Ce.os.isiOS())&&(o=o.replace(/Ctrl\+/g,"⌘+")),e.notificationManager.open({text:o,type:"error"})}}})},r6=(e,t,n,s)=>{const o=C.fromDom(e.getRoot());return Sa(o,N.fromRangeStart(t),s)?n=n.replace(/^ /,"&nbsp;"):n=n.replace(/^&nbsp;/," "),wa(o,N.fromRangeEnd(t),s)?n=n.replace(/(&nbsp;| )(<br( \/)>)?$/,"&nbsp;"):n=n.replace(/&nbsp;(<br( \/)?>)?$/," "),n},a6=e=>{if(typeof e!="string"){const t=L.extend({paste:e.paste,data:{paste:e.paste}},e);return{content:e.content,details:t}}return{content:e,details:{}}},i6=(e,t)=>{const n=e.selection,s=e.dom;return/^ | $/.test(t)?r6(s,n.getRng(),t,e.schema):t},rc=(e,t)=>{if(e.selection.isEditable()){const{content:n,details:s}=a6(t);vd(e,{...s,content:i6(e,n),format:"html",set:!1,selection:!0}).each(o=>{const r=fU(e,o.content,s);Ed(e,r,o),e.addVisual()})}},l6=e=>{e.editorCommands.addCommands({mceCleanup:()=>{const t=e.selection.getBookmark();e.setContent(e.getContent()),e.selection.moveToBookmark(t)},insertImage:(t,n,s)=>{rc(e,e.dom.createHTML("img",{src:s}))},insertHorizontalRule:()=>{e.execCommand("mceInsertContent",!1,"<hr>")},insertText:(t,n,s)=>{rc(e,e.dom.encode(s))},insertHTML:(t,n,s)=>{rc(e,s)},mceInsertContent:(t,n,s)=>{rc(e,s)},mceSetContent:(t,n,s)=>{e.setContent(s)},mceReplaceContent:(t,n,s)=>{e.execCommand("mceInsertContent",!1,s.replace(/\{\$selection\}/g,e.selection.getContent({format:"text"})))},mceNewDocument:()=>{e.setContent(SP(e))}})},c6={"font-size":"size","font-family":"face"},u6=Fr("font"),f6=(e,t,n)=>{const s=r=>hi(r,e).orThunk(()=>u6(r)?Oe(c6,e).bind(a=>ns(r,a)):m.none()),o=r=>Ee(C.fromDom(t),r);return Yc(C.fromDom(n),r=>s(r),o)},d6=e=>e.replace(/[\'\"\\]/g,"").replace(/,\s+/g,","),m6=(e,t)=>m.from(_e.DOM.getStyle(t,e,!0)),u_=e=>(t,n)=>m.from(n).map(C.fromDom).filter(Ut).bind(s=>f6(e,t,s.dom).or(m6(e,s.dom))).getOr(""),g6=u_("font-size"),p6=Nn(d6,u_("font-family")),h6=e=>mt(e.getBody()).bind(t=>{const n=t.container();return m.from(I(n)?n.parentNode:n)}),b6=e=>m.from(e.selection.getRng()).bind(t=>{const n=e.getBody();return t.startContainer===n&&t.startOffset===0?m.none():m.from(e.selection.getStart(!0))}),C6=(e,t)=>b6(e).orThunk(G(h6,e)).map(C.fromDom).filter(Ut).bind(t),Mm=(e,t)=>C6(e,Zm(m.some,t)),f_=(e,t)=>{if(/^[0-9.]+$/.test(t)){const n=parseInt(t,10);if(n>=1&&n<=7){const s=$P(e),o=MP(e);return o.length>0?o[n-1]||t:s[n-1]||t}else return t}else return t},y6=e=>{const t=e.split(/\s*,\s*/);return he(t,n=>n.indexOf(" ")!==-1&&!(Xe(n,'"')||Xe(n,"'"))?`'${n}'`:n).join(",")},v6=(e,t)=>{const n=f_(e,t);e.formatter.toggle("fontname",{value:y6(n)}),e.nodeChanged()},E6=e=>Mm(e,t=>p6(e.getBody(),t.dom)).getOr(""),S6=(e,t)=>{e.formatter.toggle("fontsize",{value:f_(e,t)}),e.nodeChanged()},w6=e=>Mm(e,t=>g6(e.getBody(),t.dom)).getOr(""),k6=e=>Mm(e,t=>{const n=C.fromDom(e.getBody()),s=Yc(t,r=>hi(r,"line-height"),G(Ee,n)),o=()=>{const r=parseFloat(In(t,"line-height")),a=parseFloat(In(t,"font-size"));return String(r/a)};return s.getOrThunk(o)}).getOr(""),_6=(e,t)=>{e.formatter.toggle("lineheight",{value:String(t)}),e.nodeChanged()},A6=e=>{const t=(n,s)=>{e.formatter.toggle(n,s),e.nodeChanged()};e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>{t(n)},"ForeColor,HiliteColor":(n,s,o)=>{t(n,{value:o})},BackColor:(n,s,o)=>{t("hilitecolor",{value:o})},FontName:(n,s,o)=>{v6(e,o)},FontSize:(n,s,o)=>{S6(e,o)},LineHeight:(n,s,o)=>{_6(e,o)},Lang:(n,s,o)=>{var r;t(n,{value:o.code,customValue:(r=o.customCode)!==null&&r!==void 0?r:null})},RemoveFormat:n=>{e.formatter.remove(n)},mceBlockQuote:()=>{t("blockquote")},FormatBlock:(n,s,o)=>{t(J(o)?o:"p")},mceToggleFormat:(n,s,o)=>{t(o)}})},x6=e=>{const t=n=>e.formatter.match(n);e.editorCommands.addCommands({"Bold,Italic,Underline,Strikethrough,Superscript,Subscript":n=>t(n),mceBlockQuote:()=>t("blockquote")},"state"),e.editorCommands.addQueryValueHandler("FontName",()=>E6(e)),e.editorCommands.addQueryValueHandler("FontSize",()=>w6(e)),e.editorCommands.addQueryValueHandler("LineHeight",()=>k6(e))},N6=e=>{A6(e),x6(e)},R6=e=>{e.editorCommands.addCommands({mceAddUndoLevel:()=>{e.undoManager.add()},mceEndUndoLevel:()=>{e.undoManager.add()},Undo:()=>{e.undoManager.undo()},Redo:()=>{e.undoManager.redo()}})},T6=e=>{e.editorCommands.addCommands({Indent:()=>{CW(e)},Outdent:()=>{b0(e)}}),e.editorCommands.addCommands({Outdent:()=>m0(e)},"state")},D6=e=>{const t=(n,s,o)=>{if(e.mode.isReadOnly())return;const r=J(o)?{href:o}:o,a=e.dom.getParent(e.selection.getNode(),"a");nt(r)&&J(r.href)&&(r.href=r.href.replace(/ /g,"%20"),(!a||!r.href)&&e.formatter.remove("link"),r.href&&e.formatter.apply("link",r,a))};e.editorCommands.addCommands({unlink:()=>{if(e.selection.isEditable()){if(e.selection.isCollapsed()){const n=e.dom.getParent(e.selection.getStart(),"a");n&&e.dom.remove(n,!0);return}e.formatter.remove("link")}},mceInsertLink:t,createLink:t})},P6=(e,t,n,s)=>{const o=e.dom,r=i=>o.isBlock(i)&&i.parentElement===n,a=r(t)?t:o.getParent(s,r,n);return m.from(a).map(C.fromDom)},d_=(e,t)=>{if(e.mode.isReadOnly())return;const n=e.dom,s=e.selection.getRng(),o=t?e.selection.getStart():e.selection.getEnd(),r=t?s.startContainer:s.endContainer,a=Wa(n,r);if(!a||!a.isContentEditable)return;const i=t?Dt:es,l=dt(e);P6(e,o,a,r).each(c=>{const u=Fw(e,r,c.dom,a,!1,l);i(c,C.fromDom(u)),e.selection.setCursorLocation(u,0),e.dispatch("NewBlock",{newBlock:u}),Ha(e,"insertParagraph")})},B6=e=>d_(e,!0),O6=e=>d_(e,!1),I6=e=>{e.editorCommands.addCommands({InsertNewBlockBefore:()=>{B6(e)},InsertNewBlockAfter:()=>{O6(e)}})},F6=e=>{e.editorCommands.addCommands({insertParagraph:()=>{Gl(Uw,e)},mceInsertNewLine:(t,n,s)=>{Kw(e,s)},InsertLineBreak:(t,n,s)=>{Gl(Ww,e)}})},L6=e=>{e.editorCommands.addCommands({mceSelectNodeDepth:(t,n,s)=>{let o=0;e.dom.getParent(e.selection.getNode(),r=>q(r)&&o++===s?(e.selection.select(r),!1):!0,e.getBody())},mceSelectNode:(t,n,s)=>{e.selection.select(s)},selectAll:()=>{const t=e.dom.getParent(e.selection.getStart(),an);if(t){const n=e.dom.createRng();n.selectNodeContents(t),e.selection.setRng(n)}}})},$6=e=>{e.editorCommands.addCommands({mceRemoveNode:(t,n,s)=>{const o=s??e.selection.getNode();if(o!==e.getBody()){const r=e.selection.getBookmark();e.dom.remove(o,!0),e.selection.moveToBookmark(r)}},mcePrint:()=>{e.getWin().print()},mceFocus:(t,n,s)=>{F1(e,s===!0)},mceToggleVisualAid:()=>{e.hasVisual=!e.hasVisual,e.addVisual()}})},M6=e=>{s6(e),o6(e),R6(e),L6(e),l6(e),D6(e),T6(e),I6(e),F6(e),N6(e),$6(e)},U6=["toggleview"],m_=e=>Se(U6,e.toLowerCase());class g_{constructor(t){this.commands={state:{},exec:{},value:{}},this.editor=t}execCommand(t,n=!1,s,o){const r=this.editor,a=t.toLowerCase(),i=o==null?void 0:o.skip_focus;if(r.removed||(a!=="mcefocus"&&(!/^(mceAddUndoLevel|mceEndUndoLevel)$/i.test(a)&&!i?r.focus():m1(r)),r.dispatch("BeforeExecCommand",{command:t,ui:n,value:s}).isDefaultPrevented()))return!1;const c=this.commands.exec[a];return we(c)?(c(a,n,s),r.dispatch("ExecCommand",{command:t,ui:n,value:s}),!0):!1}queryCommandState(t){if(!m_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return!1;const n=t.toLowerCase(),s=this.commands.state[n];return we(s)?s(n):!1}queryCommandValue(t){if(!m_(t)&&this.editor.quirks.isHidden()||this.editor.removed)return"";const n=t.toLowerCase(),s=this.commands.value[n];return we(s)?s(n):""}addCommands(t,n="exec"){const s=this.commands;Ae(t,(o,r)=>{D(r.toLowerCase().split(","),a=>{s[n][a]=o})})}addCommand(t,n,s){const o=t.toLowerCase();this.commands.exec[o]=(r,a,i)=>n.call(s??this.editor,a,i)}queryCommandSupported(t){const n=t.toLowerCase();return!!this.commands.exec[n]}addQueryStateHandler(t,n,s){this.commands.state[t.toLowerCase()]=()=>n.call(s??this.editor)}addQueryValueHandler(t,n,s){this.commands.value[t.toLowerCase()]=()=>n.call(s??this.editor)}}const z6=L.makeMap("focus blur focusin focusout click dblclick mousedown mouseup mousemove mouseover beforepaste paste cut copy selectionchange mouseout mouseenter mouseleave wheel keydown keypress keyup input beforeinput contextmenu dragstart dragend dragover draggesture dragdrop drop drag submit compositionstart compositionend compositionupdate touchstart touchmove touchend touchcancel"," ");class Um{static isNative(t){return!!z6[t.toLowerCase()]}constructor(t){this.bindings={},this.settings=t||{},this.scope=this.settings.scope||this,this.toggleEvent=this.settings.toggleEvent||Pe}fire(t,n){return this.dispatch(t,n)}dispatch(t,n){const s=t.toLowerCase(),o=Cu(s,n??{},this.scope);this.settings.beforeFire&&this.settings.beforeFire(o);const r=this.bindings[s];if(r)for(let a=0,i=r.length;a<i;a++){const l=r[a];if(!l.removed){if(l.once&&this.off(s,l.func),o.isImmediatePropagationStopped())return o;if(l.func.call(this.scope,o)===!1)return o.preventDefault(),o}}return o}on(t,n,s,o){if(n===!1&&(n=Pe),n){const r={func:n,removed:!1};o&&L.extend(r,o);const a=t.toLowerCase().split(" ");let i=a.length;for(;i--;){const l=a[i];let c=this.bindings[l];c||(c=[],this.toggleEvent(l,!0)),s?c=[r,...c]:c=[...c,r],this.bindings[l]=c}}return this}off(t,n){if(t){const s=t.toLowerCase().split(" ");let o=s.length;for(;o--;){const r=s[o];let a=this.bindings[r];if(!r)return Ae(this.bindings,(i,l)=>{this.toggleEvent(l,!1),delete this.bindings[l]}),this;if(a){if(!n)a.length=0;else{const i=So(a,l=>l.func===n);a=i.fail,this.bindings[r]=a,D(i.pass,l=>{l.removed=!0})}a.length||(this.toggleEvent(t,!1),delete this.bindings[r])}}}else Ae(this.bindings,(s,o)=>{this.toggleEvent(o,!1)}),this.bindings={};return this}once(t,n,s){return this.on(t,n,s,{once:!0})}has(t){t=t.toLowerCase();const n=this.bindings[t];return!(!n||n.length===0)}}const Ya=e=>(e._eventDispatcher||(e._eventDispatcher=new Um({scope:e,toggleEvent:(t,n)=>{Um.isNative(t)&&e.toggleNativeEvent&&e.toggleNativeEvent(t,n)}})),e._eventDispatcher),zm={fire(e,t,n){return console.warn('The "fire" event api has been deprecated and will be removed in TinyMCE 9. Use "dispatch" instead.',new Error().stack),this.dispatch(e,t,n)},dispatch(e,t,n){const s=this;if(s.removed&&e!=="remove"&&e!=="detach")return Cu(e.toLowerCase(),t??{},s);const o=Ya(s).dispatch(e,t);if(n!==!1&&s.parent){let r=s.parent();for(;r&&!o.isPropagationStopped();)r.dispatch(e,o,!1),r=r.parent?r.parent():void 0}return o},on(e,t,n){return Ya(this).on(e,t,n)},off(e,t){return Ya(this).off(e,t)},once(e,t){return Ya(this).once(e,t)},hasEventListeners(e){return Ya(this).has(e)}},ac=_e.DOM;let yo;const ic=(e,t)=>{if(t==="selectionchange")return e.getDoc();if(!e.inline&&/^(?:mouse|touch|click|contextmenu|drop|dragover|dragend)/.test(t))return e.getDoc().documentElement;const n=pb(e);return n?(e.eventRoot||(e.eventRoot=ac.select(n)[0]),e.eventRoot):e.getBody()},H6=e=>!e.hidden&&!ls(e),p_=(e,t,n)=>{H6(e)?e.dispatch(t,n):ls(e)&&Bz(e,n)},h_=(e,t)=>{if(e.delegates||(e.delegates={}),e.delegates[t]||e.removed)return;const n=ic(e,t);if(pb(e)){if(yo||(yo={},e.editorManager.on("removeEditor",()=>{e.editorManager.activeEditor||yo&&(Ae(yo,(o,r)=>{e.dom.unbind(ic(e,r))}),yo=null)})),yo[t])return;const s=o=>{const r=o.target,a=e.editorManager.get();let i=a.length;for(;i--;){const l=a[i].getBody();(l===r||ac.isChildOf(r,l))&&p_(a[i],t,o)}};yo[t]=s,ac.bind(n,t,s)}else{const s=o=>{p_(e,t,o)};ac.bind(n,t,s),e.delegates[t]=s}},b_={...zm,bindPendingEventDelegates(){const e=this;L.each(e._pendingNativeEvents,t=>{h_(e,t)})},toggleNativeEvent(e,t){const n=this;e==="focus"||e==="blur"||n.removed||(t?n.initialized?h_(n,e):n._pendingNativeEvents?n._pendingNativeEvents.push(e):n._pendingNativeEvents=[e]:n.initialized&&n.delegates&&(n.dom.unbind(ic(n,e),e,n.delegates[e]),delete n.delegates[e]))},unbindAllNativeEvents(){const e=this,t=e.getBody(),n=e.dom;e.delegates&&(Ae(e.delegates,(s,o)=>{e.dom.unbind(ic(e,o),o,s)}),delete e.delegates),!e.inline&&t&&n&&(t.onload=null,n.unbind(e.getWin()),n.unbind(e.getDoc())),n&&(n.unbind(t),n.unbind(e.getContainer()))}},W6=e=>J(e)?{value:e.split(/[ ,]/),valid:!0}:Ls(e,J)?{value:e,valid:!0}:{valid:!1,message:"The value must be a string[] or a comma/space separated string."},V6=e=>{const t=(()=>{switch(e){case"array":return De;case"boolean":return Xn;case"function":return we;case"number":return rn;case"object":return nt;case"string":return J;case"string[]":return W6;case"object[]":return n=>Ls(n,nt);case"regexp":return n=>ni(n,RegExp);default:return Ue}})();return n=>Hm(n,t,`The value must be a ${e}.`)},j6=e=>J(e.processor),C_=(e,t)=>{const n=Nr(t.message)?"":`. ${t.message}`;return e+n},y_=e=>e.valid,Hm=(e,t,n="")=>{const s=t(e);return Xn(s)?s?{value:e,valid:!0}:{valid:!1,message:n}:s},q6=(e,t,n)=>{if(!st(t)){const s=Hm(t,n);if(y_(s))return s.value;console.error(C_(`Invalid default value passed for the "${e}" option`,s))}},K6=(e,t,n=t)=>{const s={},o={},r=(g,h,p)=>{const b=Hm(h,p);return y_(b)?(o[g]=b.value,!0):(console.warn(C_(`Invalid value passed for the ${g} option`,b)),!1)},a=(g,h)=>{const p=j6(h)?V6(h.processor):h.processor,b=q6(g,h.default,p);s[g]={...h,default:b,processor:p},Oe(o,g).orThunk(()=>Oe(t,g)).each(v=>r(g,v,p))},i=g=>se(s,g);return{register:a,isRegistered:i,get:g=>Oe(o,g).orThunk(()=>Oe(s,g).map(h=>h.default)).getOrUndefined(),set:(g,h)=>{if(i(g)){const p=s[g];return p.immutable?(console.error(`"${g}" is an immutable option and cannot be updated`),!1):r(g,h,p.processor)}else return console.warn(`"${g}" is not a registered option. Ensure the option has been registered before setting a value.`),!1},unset:g=>{const h=i(g);return h&&delete o[g],h},isSet:g=>se(o,g),debug:()=>{try{console.log(JSON.parse(JSON.stringify(n,(g,h)=>Xn(h)||rn(h)||J(h)||bt(h)||De(h)||si(h)?h:Object.prototype.toString.call(h))))}catch(g){console.error(g)}}}},G6=(e,t)=>{e.dom.contentEditable=t?"true":"false"},Y6=(e,t)=>{const n=C.fromDom(e.getBody());t?(e.readonly=!0,e.hasEditableRoot()&&G6(n,!0),XE(e)):(e.readonly=!1,ZE(e))},fr=e=>e.readonly,X6=e=>{const t=e.undoManager.add();U(t)&&(e.undoManager.undo(),e.undoManager.reset())},Z6=e=>Be(e,t=>t.type==="characterData"||t.type==="childList"),Q6=e=>{const t=s=>{fr(e)&&Z6(s)&&X6(e)},n=new MutationObserver(t);e.on("beforeinput paste cut dragend dragover draggesture dragdrop drop drag",s=>{fr(e)&&s.preventDefault()}),e.on("BeforeExecCommand",s=>{(s.command==="Undo"||s.command==="Redo")&&fr(e)&&s.preventDefault()}),e.on("compositionstart",()=>{fr(e)&&n.observe(e.getBody(),{characterData:!0,childList:!0,subtree:!0})}),e.on("compositionend",()=>{if(fr(e)){const s=n.takeRecords();t(s)}n.disconnect()})},J6=["design","readonly"],v_=(e,t,n,s)=>{const o=n[t.get()],r=n[s];try{r.activate()}catch(a){console.error(`problem while activating editor mode ${s}:`,a);return}o.deactivate(),o.editorReadOnly!==r.editorReadOnly&&Y6(e,r.editorReadOnly),t.set(s),sD(e,s)},e5=(e,t,n,s)=>{if(!(s===n.get()||e.initialized&&ls(e))){if(!se(t,s))throw new Error(`Editor mode '${s}' is invalid`);e.initialized?v_(e,n,t,s):e.on("init",()=>v_(e,n,t,s))}},t5=(e,t,n)=>{if(Se(J6,t))throw new Error(`Cannot override default mode ${t}`);return{...e,[t]:{...n,deactivate:()=>{try{n.deactivate()}catch(s){console.error(`problem while deactivating editor mode ${t}:`,s)}}}}},n5=e=>{const t=et("design"),n=et({design:{activate:ce,deactivate:ce,editorReadOnly:!1},readonly:{activate:ce,deactivate:ce,editorReadOnly:!0}});return Q6(e),Iz(e),{isReadOnly:()=>fr(e),set:s=>e5(e,n.get(),t,s),get:()=>t.get(),register:(s,o)=>{n.set(t5(n.get(),s,o))}}},Wm=L.each,Vm=L.explode,s5={f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123},E_=L.makeMap("alt,ctrl,shift,meta,access"),o5=e=>e in E_,r5=e=>{const t={},n=Ce.os.isMacOS()||Ce.os.isiOS();Wm(Vm(e.toLowerCase(),"+"),r=>{o5(r)?t[r]=!0:/^[0-9]{2,}$/.test(r)?t.keyCode=parseInt(r,10):(t.charCode=r.charCodeAt(0),t.keyCode=s5[r]||r.toUpperCase().charCodeAt(0))});const s=[t.keyCode];let o;for(o in E_)t[o]?s.push(o):t[o]=!1;return t.id=s.join(","),t.access&&(t.alt=!0,n?t.ctrl=!0:t.shift=!0),t.meta&&(n?t.meta=!0:(t.ctrl=!0,t.meta=!1)),t};class S_{constructor(t){this.shortcuts={},this.pendingPatterns=[],this.editor=t;const n=this;t.on("keyup keypress keydown",s=>{(n.hasModifier(s)||n.isFunctionKey(s))&&!s.isDefaultPrevented()&&(Wm(n.shortcuts,o=>{n.matchShortcut(s,o)&&(n.pendingPatterns=o.subpatterns.slice(0),s.type==="keydown"&&n.executeShortcutAction(o))}),n.matchShortcut(s,n.pendingPatterns[0])&&(n.pendingPatterns.length===1&&s.type==="keydown"&&n.executeShortcutAction(n.pendingPatterns[0]),n.pendingPatterns.shift()))})}add(t,n,s,o){const r=this,a=r.normalizeCommandFunc(s);return Wm(Vm(L.trim(t)),i=>{const l=r.createShortcut(i,n,a,o);r.shortcuts[l.id]=l}),!0}remove(t){const n=this.createShortcut(t);return this.shortcuts[n.id]?(delete this.shortcuts[n.id],!0):!1}normalizeCommandFunc(t){const n=this,s=t;return typeof s=="string"?()=>{n.editor.execCommand(s,!1,null)}:L.isArray(s)?()=>{n.editor.execCommand(s[0],s[1],s[2])}:s}createShortcut(t,n,s,o){const r=L.map(Vm(t,">"),r5);return r[r.length-1]=L.extend(r[r.length-1],{func:s,scope:o||this.editor}),L.extend(r[0],{desc:this.editor.translate(n),subpatterns:r.slice(1)})}hasModifier(t){return t.altKey||t.ctrlKey||t.metaKey}isFunctionKey(t){return t.type==="keydown"&&t.keyCode>=112&&t.keyCode<=123}matchShortcut(t,n){return!n||n.ctrl!==t.ctrlKey||n.meta!==t.metaKey||n.alt!==t.altKey||n.shift!==t.shiftKey?!1:t.keyCode===n.keyCode||t.charCode&&t.charCode===n.charCode?(t.preventDefault(),!0):!1}executeShortcutAction(t){return t.func?t.func.call(t.scope):null}}const a5=()=>{const e=V3();return{addAutocompleter:e.addAutocompleter,addButton:e.addButton,addContextForm:e.addContextForm,addContextMenu:e.addContextMenu,addContextToolbar:e.addContextToolbar,addIcon:e.addIcon,addMenuButton:e.addMenuButton,addMenuItem:e.addMenuItem,addNestedMenuItem:e.addNestedMenuItem,addSidebar:e.addSidebar,addSplitButton:e.addSplitButton,addToggleButton:e.addToggleButton,addGroupToolbarButton:e.addGroupToolbarButton,addToggleMenuItem:e.addToggleMenuItem,addView:e.addView,addContext:e.addContext,getAll:e.getAll}},vo=_e.DOM,w_=L.extend,i5=L.each;class lc{constructor(t,n,s){this.plugins={},this.contentCSS=[],this.contentStyles=[],this.loadedCSS={},this.isNotDirty=!1,this.composing=!1,this.destroyed=!1,this.hasHiddenInput=!1,this.iframeElement=null,this.initialized=!1,this.readonly=!1,this.removed=!1,this.startContent="",this._pendingNativeEvents=[],this._skinLoaded=!1,this._editableRoot=!0,this.editorManager=s,this.documentBaseUrl=s.documentBaseURL,w_(this,b_);const o=this;this.id=t,this.hidden=!1;const r=J9(s.defaultOptions,n);this.options=K6(o,r,n),SD(o);const a=this.options.get;a("deprecation_warnings")&&QU(n,r);const i=a("suffix");i&&(s.suffix=i),this.suffix=s.suffix;const l=a("base_url");l&&s._setBaseUrl(l),this.baseUri=s.baseURI;const c=Mu(o);c&&(as.ScriptLoader._setReferrerPolicy(c),_e.DOM.styleSheetLoader._setReferrerPolicy(c));const u=bb(o);U(u)&&_e.DOM.styleSheetLoader._setContentCssCors(u),Ct.languageLoad=a("language_load"),Ct.baseURL=s.baseURL,this.setDirty(!1),this.documentBaseURI=new un(ab(o),{base_uri:this.baseUri}),this.baseURI=this.baseUri,this.inline=zu(o),this.hasVisual=fP(o),this.shortcuts=new S_(this),this.editorCommands=new g_(this),M6(this);const f=a("cache_suffix");f&&(Ce.cacheSuffix=f.replace(/^[\?\&]+/,"")),this.ui={registry:a5(),styleSheetLoader:void 0,show:ce,hide:ce,setEnabled:ce,isEnabled:Ue},this.mode=n5(o),s.dispatch("SetupEditor",{editor:this});const d=mP(o);we(d)&&d.call(o,o)}render(){$9(this)}focus(t){this.execCommand("mceFocus",!1,t)}hasFocus(){return er(this)}translate(t){return vn.translate(t)}getParam(t,n,s){const o=this.options;return o.isRegistered(t)||(U(s)?o.register(t,{processor:s,default:n}):o.register(t,{processor:Ue,default:n})),!o.isSet(t)&&!st(n)?n:o.get(t)}hasPlugin(t,n){return Se(Ui(this),t)?n?or.get(t)!==void 0:!0:!1}nodeChanged(t){this._nodeChangeDispatcher.nodeChanged(t)}addCommand(t,n,s){this.editorCommands.addCommand(t,n,s)}addQueryStateHandler(t,n,s){this.editorCommands.addQueryStateHandler(t,n,s)}addQueryValueHandler(t,n,s){this.editorCommands.addQueryValueHandler(t,n,s)}addShortcut(t,n,s,o){this.shortcuts.add(t,n,s,o)}execCommand(t,n,s,o){return this.editorCommands.execCommand(t,n,s,o)}queryCommandState(t){return this.editorCommands.queryCommandState(t)}queryCommandValue(t){return this.editorCommands.queryCommandValue(t)}queryCommandSupported(t){return this.editorCommands.queryCommandSupported(t)}show(){const t=this;t.hidden&&(t.hidden=!1,t.inline?t.getBody().contentEditable="true":(vo.show(t.getContainer()),vo.hide(t.id)),t.load(),t.dispatch("show"))}hide(){const t=this;t.hidden||(t.save(),t.inline?(t.getBody().contentEditable="false",t===t.editorManager.focusedEditor&&(t.editorManager.focusedEditor=null)):(vo.hide(t.getContainer()),vo.setStyle(t.id,"display",t.orgDisplay)),t.hidden=!0,t.dispatch("hide"))}isHidden(){return this.hidden}setProgressState(t,n){this.dispatch("ProgressState",{state:t,time:n})}load(t={}){const n=this,s=n.getElement();if(n.removed)return"";if(s){const o={...t,load:!0},r=Qc(s)?s.value:s.innerHTML,a=n.setContent(r,o);return o.no_events||n.dispatch("LoadContent",{...o,element:s}),a}else return""}save(t={}){const n=this;let s=n.getElement();if(!s||!n.initialized||n.removed)return"";const o={...t,save:!0,element:s};let r=n.getContent(o);const a={...o,content:r};if(a.no_events||n.dispatch("SaveContent",a),a.format==="raw"&&n.dispatch("RawSaveContent",a),r=a.content,Qc(s))s.value=r;else{(t.is_removing||!n.inline)&&(s.innerHTML=r);const i=vo.getParent(n.id,"form");i&&i5(i.elements,l=>l.name===n.id?(l.value=r,!1):!0)}return a.element=o.element=s=null,a.set_dirty!==!1&&n.setDirty(!1),r}setContent(t,n){return Td(this,t,n)}getContent(t){return MU(this,t)}insertContent(t,n){n&&(t=w_({content:t},n)),this.execCommand("mceInsertContent",!1,t)}resetContent(t){t===void 0?Td(this,this.startContent,{format:"raw"}):Td(this,t),this.undoManager.reset(),this.setDirty(!1),this.nodeChanged()}isDirty(){return!this.isNotDirty}setDirty(t){const n=!this.isNotDirty;this.isNotDirty=!t,t&&t!==n&&this.dispatch("dirty")}getContainer(){const t=this;return t.container||(t.container=t.editorContainer||vo.get(t.id+"_parent")),t.container}getContentAreaContainer(){return this.contentAreaContainer}getElement(){return this.targetElm||(this.targetElm=vo.get(this.id)),this.targetElm}getWin(){const t=this;if(!t.contentWindow){const n=t.iframeElement;n&&(t.contentWindow=n.contentWindow)}return t.contentWindow}getDoc(){const t=this;if(!t.contentDocument){const n=t.getWin();n&&(t.contentDocument=n.document)}return t.contentDocument}getBody(){var t,n;const s=this.getDoc();return(n=(t=this.bodyElement)!==null&&t!==void 0?t:s==null?void 0:s.body)!==null&&n!==void 0?n:null}convertURL(t,n,s){const o=this,r=o.options.get,a=pP(o);if(we(a))return a.call(o,t,s,!0,n);if(!r("convert_urls")||s==="link"||nt(s)&&s.nodeName==="LINK"||t.indexOf("file:")===0||t.length===0)return t;const i=new un(t);return i.protocol!=="http"&&i.protocol!=="https"&&i.protocol!==""?t:r("relative_urls")?o.documentBaseURI.toRelative(t):(t=o.documentBaseURI.toAbsolute(t,r("remove_script_host")),t)}addVisual(t){e6(this,t)}setEditableRoot(t){M9(this,t)}hasEditableRoot(){return U9(this)}remove(){nz(this)}destroy(t){sz(this,t)}uploadImages(){return this.editorUpload.uploadImages()}_scanForImages(){return this.editorUpload.scanForImages()}}const dr=_e.DOM,cc=L.each;let k_=!1,uc,Nt=[];const fc=e=>{const t=e.type;cc(Bs.get(),n=>{switch(t){case"scroll":n.dispatch("ScrollWindow",e);break;case"resize":n.dispatch("ResizeWindow",e);break}})},__=e=>{if(e!==k_){const t=_e.DOM;e?(t.bind(window,"resize",fc),t.bind(window,"scroll",fc)):(t.unbind(window,"resize",fc),t.unbind(window,"scroll",fc)),k_=e}},A_=e=>{const t=Nt;return Nt=ne(Nt,n=>e!==n),Bs.activeEditor===e&&(Bs.activeEditor=Nt.length>0?Nt[0]:null),Bs.focusedEditor===e&&(Bs.focusedEditor=null),t.length!==Nt.length},l5=e=>{e&&e.initialized&&!(e.getContainer()||e.getBody()).parentNode&&(A_(e),e.unbindAllNativeEvents(),e.destroy(!0),e.removed=!0)},c5=document.compatMode!=="CSS1Compat",Bs={...zm,baseURI:null,baseURL:null,defaultOptions:{},documentBaseURL:null,suffix:null,majorVersion:"7",minorVersion:"9.1",releaseDate:"2025-05-29",i18n:vn,activeEditor:null,focusedEditor:null,setup(){const e=this;let t="",n="",s=un.getDocumentBaseUrl(document.location);/^[^:]+:\/\/\/?[^\/]+\//.test(s)&&(s=s.replace(/[\?#].*$/,"").replace(/[\/\\][^\/]+$/,""),/[\/\\]$/.test(s)||(s+="/"));const o=window.tinymce||window.tinyMCEPreInit;if(o)t=o.base||o.baseURL,n=o.suffix;else{const r=document.getElementsByTagName("script");for(let a=0;a<r.length;a++){const i=r[a].src||"";if(i==="")continue;const l=i.substring(i.lastIndexOf("/"));if(/tinymce(\.full|\.jquery|)(\.min|\.dev|)\.js/.test(i)){l.indexOf(".min")!==-1&&(n=".min"),t=i.substring(0,i.lastIndexOf("/"));break}}if(!t&&document.currentScript){const a=document.currentScript.src;a.indexOf(".min")!==-1&&(n=".min"),t=a.substring(0,a.lastIndexOf("/"))}}e.baseURL=new un(s).toAbsolute(t),e.documentBaseURL=s,e.baseURI=new un(e.baseURL),e.suffix=n,A1(e)},overrideDefaults(e){const t=e.base_url;t&&this._setBaseUrl(t);const n=e.suffix;n&&(this.suffix=n),this.defaultOptions=e;const s=e.plugin_base_urls;s!==void 0&&Ae(s,(o,r)=>{Ct.PluginManager.urls[r]=o})},init(e){const t=this;let n;const s=L.makeMap("area base basefont br col frame hr img input isindex link meta param embed source wbr track colgroup option table tbody tfoot thead tr th td script noscript style textarea video audio iframe object menu"," "),o=(u,f)=>u.inline&&f.tagName.toLowerCase()in s,r=u=>{let f=u.id;return f||(f=Oe(u,"name").filter(d=>!dr.get(d)).getOrThunk(dr.uniqueId),u.setAttribute("id",f)),f},a=u=>{const f=e[u];if(f)return f.apply(t,[])},i=u=>Ce.browser.isIE()||Ce.browser.isEdge()?(Nl("TinyMCE does not support the browser you are using. For a list of supported browsers please see: https://www.tiny.cloud/docs/tinymce/7/support/#supportedwebbrowsers"),[]):c5?(Nl("Failed to initialize the editor as the document is not in standards mode. TinyMCE requires standards mode."),[]):J(u.selector)?dr.select(u.selector):U(u.target)?[u.target]:[];let l=u=>{n=u};const c=()=>{let u=0;const f=[];let d;const g=(h,p,b)=>{const y=new lc(h,p,t);f.push(y),y.on("init",()=>{++u===d.length&&l(f)}),y.targetElm=y.targetElm||b,y.render()};dr.unbind(window,"ready",c),a("onpageload"),d=og(i(e)),L.each(d,h=>{l5(t.get(h.id))}),d=L.grep(d,h=>!t.get(h.id)),d.length===0?l([]):cc(d,h=>{o(e,h)?Nl("Could not initialize inline editor on invalid inline target element",h):g(r(h),e,h)})};return dr.bind(window,"ready",c),new Promise(u=>{n?u(n):l=f=>{u(f)}})},get(e){return arguments.length===0?Nt.slice(0):J(e)?Ye(Nt,t=>t.id===e).getOr(null):rn(e)&&Nt[e]?Nt[e]:null},add(e){const t=this,n=t.get(e.id);return n===e||(n===null&&Nt.push(e),__(!0),t.activeEditor=e,t.dispatch("AddEditor",{editor:e}),uc||(uc=s=>{const o=t.dispatch("BeforeUnload");if(o.returnValue)return s.preventDefault(),s.returnValue=o.returnValue,o.returnValue},window.addEventListener("beforeunload",uc))),e},createEditor(e,t){return this.add(new lc(e,t,this))},remove(e){const t=this;let n;if(!e){for(let s=Nt.length-1;s>=0;s--)t.remove(Nt[s]);return}if(J(e)){cc(dr.select(e),s=>{n=t.get(s.id),n&&t.remove(n)});return}return n=e,bt(t.get(n.id))?null:(A_(n)&&t.dispatch("RemoveEditor",{editor:n}),Nt.length===0&&window.removeEventListener("beforeunload",uc),n.remove(),__(Nt.length>0),n)},execCommand(e,t,n){var s;const o=this,r=nt(n)?(s=n.id)!==null&&s!==void 0?s:n.index:n;switch(e){case"mceAddEditor":{if(!o.get(r)){const a=n.options;new lc(r,a,o).render()}return!0}case"mceRemoveEditor":{const a=o.get(r);return a&&a.remove(),!0}case"mceToggleEditor":{const a=o.get(r);return a?(a.isHidden()?a.show():a.hide(),!0):(o.execCommand("mceAddEditor",!1,n),!0)}}return o.activeEditor?o.activeEditor.execCommand(e,t,n):!1},triggerSave:()=>{cc(Nt,e=>{e.save()})},addI18n:(e,t)=>{vn.add(e,t)},translate:e=>vn.translate(e),setActive(e){const t=this.activeEditor;this.activeEditor!==e&&(t&&t.dispatch("deactivate",{relatedTarget:e}),e.dispatch("activate",{relatedTarget:t})),this.activeEditor=e},_setBaseUrl(e){this.baseURL=new un(this.documentBaseURL).toAbsolute(e.replace(/\/+$/,"")),this.baseURI=new un(this.baseURL)}};Bs.setup();const u5=(()=>{const e=Qn(),t=r=>({items:r,types:$t(r),getType:a=>Oe(r,a).getOrUndefined()}),n=r=>{e.set(r)},s=()=>e.get().getOrUndefined(),o=e.clear;return{FakeClipboardItem:t,write:n,read:s,clear:o}})(),x_=Math.min,mr=Math.max,dc=Math.round,N_=(e,t,n)=>{let s=t.x,o=t.y;const r=e.w,a=e.h,i=t.w,l=t.h,c=(n||"").split("");return c[0]==="b"&&(o+=l),c[1]==="r"&&(s+=i),c[0]==="c"&&(o+=dc(l/2)),c[1]==="c"&&(s+=dc(i/2)),c[3]==="b"&&(o-=a),c[4]==="r"&&(s-=r),c[3]==="c"&&(o-=dc(a/2)),c[4]==="c"&&(s-=dc(r/2)),gr(s,o,r,a)},f5=(e,t,n,s)=>{for(let o=0;o<s.length;o++){const r=N_(e,t,s[o]);if(r.x>=n.x&&r.x+r.w<=n.w+n.x&&r.y>=n.y&&r.y+r.h<=n.h+n.y)return s[o]}return null},d5=(e,t,n)=>gr(e.x-t,e.y-n,e.w+t*2,e.h+n*2),m5=(e,t)=>{const n=mr(e.x,t.x),s=mr(e.y,t.y),o=x_(e.x+e.w,t.x+t.w),r=x_(e.y+e.h,t.y+t.h);return o-n<0||r-s<0?null:gr(n,s,o-n,r-s)},g5=(e,t,n)=>{let s=e.x,o=e.y,r=e.x+e.w,a=e.y+e.h;const i=t.x+t.w,l=t.y+t.h,c=mr(0,t.x-s),u=mr(0,t.y-o),f=mr(0,r-i),d=mr(0,a-l);return s+=c,o+=u,n&&(r+=c,a+=u,s-=f,o-=d),r-=f,a-=d,gr(s,o,r-s,a-o)},gr=(e,t,n,s)=>({x:e,y:t,w:n,h:s}),p5={inflate:d5,relativePosition:N_,findBestRelativePosition:f5,intersect:m5,clamp:g5,create:gr,fromClientRect:e=>gr(e.left,e.top,e.width,e.height)},h5=(e,t,n=1e3)=>{let s=!1,o=null;const r=c=>(...u)=>{s||(s=!0,o!==null&&(window.clearTimeout(o),o=null),c.apply(null,u))},a=r(e),i=r(t);return{start:(...c)=>{!s&&o===null&&(o=window.setTimeout(()=>i.apply(null,c),n))},resolve:a,reject:i}},b5=(()=>{const e={},t={},n={};return{load:(l,c)=>{const u=`Script at URL "${c}" failed to load`,f=`Script at URL "${c}" did not call \`tinymce.Resource.add('${l}', data)\` within 1 second`;if(e[l]!==void 0)return e[l];{const d=new Promise((g,h)=>{const p=h5(g,h);t[l]=p.resolve,as.ScriptLoader.loadScript(c).then(()=>p.start(f),()=>p.reject(u))});return e[l]=d,d}},add:(l,c)=>{t[l]!==void 0&&(t[l](c),delete t[l]),e[l]=Promise.resolve(c),n[l]=c},has:l=>l in n,get:l=>n[l],unload:l=>{delete e[l],delete n[l]}}})(),C5=()=>(()=>{let e={},t=[];const n={getItem:s=>{const o=e[s];return o||null},setItem:(s,o)=>{t.push(s),e[s]=String(o)},key:s=>t[s],removeItem:s=>{t=t.filter(o=>o===s),delete e[s]},clear:()=>{t=[],e={}},length:0};return Object.defineProperty(n,"length",{get:()=>t.length,configurable:!1,enumerable:!1}),n})();let Xa;try{const e="__storage_test__";Xa=window.localStorage,Xa.setItem(e,e),Xa.removeItem(e)}catch{Xa=C5()}var y5=Xa;const v5={geom:{Rect:p5},util:{Delay:Jt,Tools:L,VK:j,URI:un,EventDispatcher:Um,Observable:zm,I18n:vn,LocalStorage:y5,ImageUploader:Gz},dom:{EventUtils:Ys,TreeWalker:tt,TextSeeker:Zs,DOMUtils:_e,ScriptLoader:as,RangeUtils:io,Serializer:UE,StyleSheetLoader:Wp,ControlSelection:AC,BookmarkManager:Ca,Selection:ME,Event:Ys.Event},html:{Styles:bu,Entities:Gs,Node:yt,Schema:vs,DomParser:nr,Writer:JC,Serializer:xs},Env:Ce,AddOnManager:Ct,Annotator:hC,Formatter:aS,UndoManager:lS,EditorCommands:g_,WindowManager:KE,NotificationManager:qE,EditorObservable:b_,Shortcuts:S_,Editor:lc,FocusManager:EC,EditorManager:Bs,DOM:_e.DOM,ScriptLoader:as.ScriptLoader,PluginManager:or,ThemeManager:go,ModelManager:sr,IconManager:Al,Resource:b5,FakeClipboard:u5,trim:L.trim,isArray:L.isArray,is:L.is,toArray:L.toArray,makeMap:L.makeMap,each:L.each,map:L.map,grep:L.grep,inArray:L.inArray,extend:L.extend,walk:L.walk,resolve:L.resolve,explode:L.explode,_addCacheSuffix:L._addCacheSuffix},R_=L.extend(Bs,v5),E5=e=>{try{z_.exports=e}catch{}};(e=>{window.tinymce=e,window.tinyMCE=e})(R_),E5(R_)})()})(k5);
